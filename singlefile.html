<!DOCTYPE html>
<html lang="en">

<head>
<script id="phantom-bootloader">
(function() {
    window.VFS_DATA = window.VFS_DATA || parent.VFS_DATA || {"index.html":"<!DOCTYPE html>\r\n<html lang=\"en\">\r\n\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n    <title>Phantom Unblocked</title>\r\n    <link rel=\"icon\" href=\"favicon.svg\" type=\"image/svg+xml\">\r\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css\">\r\n    <!-- Google Tag Manager -->\r\n    <script>(function (w, d, s, l, i) {\r\n            w[l] = w[l] || []; w[l].push({\r\n                'gtm.start':\r\n                    new Date().getTime(), event: 'gtm.js'\r\n            }); var f = d.getElementsByTagName(s)[0],\r\n                j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =\r\n                    'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);\r\n        })(window, document, 'script', 'dataLayer', 'GTM-5LMBC27Z');</script>\r\n    <!-- End Google Tag Manager -->\r\n    <style>\r\n        * {\r\n            margin: 0;\r\n            padding: 0;\r\n            box-sizing: border-box;\r\n        }\r\n\r\n        html,\r\n        body {\r\n            width: 100%;\r\n            height: 100%;\r\n            overflow: hidden;\r\n            background: var(--bg, #0a0a0a);\r\n            font-family: 'Inter', -apple-system, sans-serif;\r\n        }\r\n\r\n\r\n        .loading-screen {\r\n            position: fixed;\r\n            inset: 0;\r\n            background: rgba(10, 10, 10, 0.6);\r\n            backdrop-filter: blur(15px);\r\n            -webkit-backdrop-filter: blur(15px);\r\n            display: flex;\r\n            flex-direction: column;\r\n            align-items: center;\r\n            justify-content: center;\r\n            z-index: 10000;\r\n        }\r\n\r\n        .loading-screen.hidden {\r\n            opacity: 0;\r\n            visibility: hidden;\r\n            pointer-events: none;\r\n            transition: opacity 0.5s ease-in-out, visibility 0.5s;\r\n        }\r\n\r\n        .loading-logo {\r\n            font-size: 2.5rem;\r\n            font-weight: 700;\r\n            margin-bottom: 24px;\r\n            display: flex;\r\n            align-items: center;\r\n            gap: 14px;\r\n        }\r\n\r\n        .loading-logo i {\r\n            color: var(--text-muted, #a1a1aa);\r\n        }\r\n\r\n        .loading-logo span {\r\n            background: linear-gradient(90deg, var(--text, #e4e4e7) 0%, var(--text-muted, #a1a1aa) 40%, var(--text-dim, #52525b) 100%);\r\n            -webkit-background-clip: text;\r\n            -webkit-text-fill-color: transparent;\r\n            background-clip: text;\r\n        }\r\n\r\n        .loading-spinner {\r\n            width: 40px;\r\n            height: 40px;\r\n            border: 3px solid var(--border, #1f1f1f);\r\n            border-top-color: var(--text-muted, #71717a);\r\n            border-radius: 50%;\r\n            animation: spin 0.8s linear infinite;\r\n        }\r\n\r\n        @keyframes spin {\r\n            to {\r\n                transform: rotate(360deg);\r\n            }\r\n        }\r\n\r\n        .loading-text {\r\n            margin-top: 16px;\r\n            color: var(--text-dim, #52525b);\r\n            font-size: 0.875rem;\r\n        }\r\n\r\n\r\n        .launch-screen {\r\n            position: fixed;\r\n            inset: 0;\r\n            background: rgba(10, 10, 10, 0.6);\r\n            backdrop-filter: blur(15px);\r\n            -webkit-backdrop-filter: blur(15px);\r\n            display: flex;\r\n            flex-direction: column;\r\n            align-items: center;\r\n            justify-content: center;\r\n            z-index: 9999;\r\n        }\r\n\r\n        .launch-screen.hidden {\r\n            display: none;\r\n        }\r\n\r\n        .launch-button {\r\n            background: var(--surface);\r\n            color: var(--text-muted);\r\n            border: none;\r\n            padding: 24px 48px;\r\n            border-radius: var(--radius-lg);\r\n            font-size: 1.25rem;\r\n            font-weight: 600;\r\n            cursor: pointer;\r\n            transition: opacity 0.2s;\r\n            margin-top: 16px;\r\n            width: 100%;\r\n            max-width: 300px;\r\n            opacity: 0.75;\r\n        }\r\n\r\n        .launch-button:hover {\r\n            opacity: 0.5;\r\n        }\r\n\r\n        iframe {\r\n            width: 100%;\r\n            height: 100%;\r\n            border: none;\r\n        }\r\n\r\n        /* Panic white screen */\r\n        #panic-overlay {\r\n            position: fixed;\r\n            inset: 0;\r\n            background: white;\r\n            z-index: 99999;\r\n            display: none;\r\n        }\r\n    </style>\r\n    <script>\n// site config\r\n\r\nwindow.SITE_CONFIG = {\r\n    name: \"Phantom\",\r\n    fullName: \"Phantom Unblocked\",\r\n    version: \"1.0.12\",\r\n\r\n    changelog: [\r\n        \"1.0.12: tiny fixxes and changes\",\r\n        \"some code consolidation and fixxes\",\r\n        \"suggest features in the discord server\"\r\n    ],\r\n\r\n    // quotes\r\n    quotes: [\r\n        \"lebron lebron lebronn james\",\r\n        \"so tuff\",\r\n        \"it is what it is\",\r\n        \"do ur work\",\r\n        \"this is what happens when u dont touch grass\",\r\n        \"FULL BOX\",\r\n        \"FULL PIECE\",\r\n        \"200!\",\r\n        \"press esc + refresh + power button for hacks\",\r\n        \"press ctrl+x to hide your screen\",\r\n        \"change the tab title and favicon in settings\",\r\n        \"TEACHERR!\",\r\n        \"1 pump\",\r\n        \"303 headshot\",\r\n        \"bros prolly a 60 ovr\",\r\n        \"take the L lil bro\",  \r\n        \"lebron is OUR goat\",\r\n        \"stop looking at my screen\",\r\n    ],\r\n\r\n    // todo\r\n    // *** for strikethrough\r\n    // ** for bold\r\n    todos: [\r\n        \"***fixxed aboutblank opening while securly is on (previously if popups were off it would load intab instead of clickto launch now it will use clicktolaunch unless popups are blocked)***\",\r\n        \"***fix the proxy***\",\r\n        \"***fix panic panickey, add quote talking about it***\",\r\n        \"***fix theatermode, make it hide buttons after a few seconds and ensure all content is being displayed and move the description to the bottom***\",\r\n        \"***change back player to use old styling, change the surface to use background colors for the bottom part where description is shown, looking just like the background***\",\r\n        \"***add image and video support for backgrounds***\",\r\n        \"***fix aichat, make the title use the same ai request as the users question unless its in image mode where it will use text mode and fix ai chat to remember modes better***\",\r\n        \"***add cloaking to quotes***\",\r\n        \"***add a default cloak and fix it so icons work in aboutblank for whatever reason they only work when you go to settings in aboutblank where it correctly applies***\",\r\n        \"***for search suggestions add highlighting for whatever will happen when you click enter, in search suggestions fix all games not sending you to the games page***\",\r\n        \"***fix games to make multi library the default, put it in config.js***\",\r\n        \"***rename movies shortcut in index2.html to primeshows, add shortcuts to main pages in the topbar and change the current shortcuts to more popular games***\",\r\n        \"***make announcements show even on first visit unlike changelog and allow disabling it via settings***\",\r\n        \"***fix leave comformation asking u to leave each time you click something***\",\r\n        \"***change the shortcuts on the main page to include pages***\",\r\n        \"***add movies to the search bar in main page***\",\r\n        \"***fix background not turning off soon***\",\r\n        \"***fix music page to hide youtube player unless toggled via 3 dot small button, and always shown on proxy mode, fix all the controls for video time, volume***\",\r\n        \"**add singlefile this is lowk so hard i dont really understand it**\",\r\n        \"**advertise phantom (too much work tbh)**\",\r\n        \"**add a watch page for youtube and twitch**\",\r\n        \"**add a miniplayer for music**\",\r\n        \"***shorten some page's code***\",\r\n        \"***fix paths in search autocomplete***\",\r\n        \"***fix markdown in ai not using correct text colors***\",\r\n        \"***make backgrounds show in the loading screen***\",\r\n        \"***fix icons for topbar in code.html***\",\r\n        \"**fix wisp server not notifying or autoswitiching when offline in proxy**\",\r\n        \"***fix code runner open not working at all***\",\r\n        \"***make backgrounds show in player.html***\",\r\n        \"***make backgrounds show in staticsjv2***\",\r\n        \"***make player.html player controls use theme colros not hardcoded***\",\r\n        \"***make ai chat and music sidebar go all the way down and up with borders***\",\r\n        \"**make the only song in music be lebron lebron lebron james**\",\r\n        \"**fix music controls**\",\r\n        \"***finish extra page into credits and make this todo be tucked away somewhere and not the main part of it***\"\r\n    ],\r\n    defaultWisp: \"wss://glseries.net/wisp/\",\r\n    wispServers: [\r\n        { name: \"GLSeries Wisp\", url: \"wss://glseries.net/wisp/\" },\r\n        { name: \"Rhw's Wisp\", url: \"wss://wisp.rhw.one/\" },\r\n    ],\r\n\r\n    discord: {\r\n        inviteUrl: \"https://discord.gg/tHWx9NXp5p\",\r\n        widgetServer: \"1447673724017971324\",\r\n        widgetChannel: \"1447673726228496617\",\r\n    },\r\n\r\n    firstVisitCloak: false, //fake error page\r\n    defaults: {\r\n        cloakMode: \"about:blank\",\r\n        tabTitle: \"You've already responded\",\r\n        tabFavicon: \"https://ssl.gstatic.com/docs/spreadsheets/forms/forms_icon_2023q4.ico\",\r\n        cloakRotation: false,\r\n        cloakInterval: 5000,\r\n        panicKey: \"x\",\r\n        panicModifiers: [\"ctrl\", \"shift\"],\r\n        panicUrl: \"https://classroom.google.com\",\r\n        maxMovieRating: \"R\",\r\n        gameLibrary: \"multi\",\r\n        discordWidget: true,\r\n        miniplayer: true,\r\n        leaveConfirmation: false,\r\n        showChangelogOnUpdate: true,\r\n        themeRotation: true,\r\n        lastThemeRotation: 0,\r\n        backgroundRotation: true,\r\n        lastBackgroundRotation: 0,\r\n        lastSeenFeatured: 'none',\r\n        background: { type: 'color', value: '#0a0a0a' },\r\n        customBackground: { id: 'none', type: 'none' },\r\n        accentColor: '#ffffff',\r\n        surfaceColor: '#0f0f0f',\r\n        secondaryColor: '#2e2e33',\r\n        textColor: '#e4e4e7',\r\n    },\r\n\r\n    themePresets: {\r\n        dark: { name: 'Dark (Default)', bg: { type: 'color', value: '#0a0a0a' }, surface: '#0f0f0f', surfaceHover: '#1a1a1a', surfaceActive: '#252525', secondary: '#2e2e33', border: '#2a2a2a', borderLight: '#2a2a2a', text: '#e4e4e7', textSec: '#71717a', textDim: '#52525b', accent: '#ffffff' },\r\n        midnight: { name: 'Midnight', bg: { type: 'color', value: '#000000' }, surface: '#050505', surfaceHover: '#111111', surfaceActive: '#1a1a1a', secondary: '#111111', border: '#1a1a1a', borderLight: '#111111', text: '#ededed', textSec: '#a3a3a3', textDim: '#737373', accent: '#d4d4d4' },\r\n        abyss: { name: 'Abyss', bg: { type: 'color', value: '#020617' }, surface: '#0f172a', surfaceHover: '#1e293b', surfaceActive: '#334155', secondary: '#1e293b', border: '#1e293b', borderLight: '#1e293b', text: '#f1f5f9', textSec: '#94a3b8', textDim: '#64748b', accent: '#38bdf8' },\r\n        phantom: { name: 'Phantom', bg: { type: 'color', value: '#0f0a14' }, surface: '#1a0f24', surfaceHover: '#2e1a40', surfaceActive: '#4c2a5c', secondary: '#2e1a40', border: '#2e1a40', borderLight: '#2e1a40', text: '#f3e8ff', textSec: '#d8b4fe', textDim: '#c084fc', accent: '#c084fc' },\r\n        rosepine: { name: 'Rose Pine', bg: { type: 'color', value: '#191724' }, surface: '#1f1d2e', surfaceHover: '#26233a', surfaceActive: '#524f67', secondary: '#26233a', border: '#26233a', borderLight: '#1f1d2e', text: '#e0def4', textSec: '#908caa', textDim: '#6e6a86', accent: '#ebbcba' },\r\n        ocean: { name: 'Oceanic', bg: { type: 'color', value: '#011627' }, surface: '#0b2942', surfaceHover: '#1d3b53', surfaceActive: '#2d4b63', secondary: '#0b2942', border: '#1d3b53', borderLight: '#0b2942', text: '#d6deeb', textSec: '#5f7e97', textDim: '#011627', accent: '#7fdbca' },\r\n        forest: { name: 'Forest', bg: { type: 'color', value: '#020d06' }, surface: '#051a0d', surfaceHover: '#0a2e17', surfaceActive: '#0f4221', secondary: '#051a0d', border: '#0a2e17', borderLight: '#051a0d', text: '#ecfdf5', textSec: '#6ee7b7', textDim: '#064e3b', accent: '#10b981' },\r\n        crimson: { name: 'Crimson', bg: { type: 'color', value: '#1a0505' }, surface: '#230a0a', surfaceHover: '#7b0a0aff', surfaceActive: '#7f1d1d', secondary: '#230a0a', border: '#480f0fff', borderLight: '#230a0a', text: '#fef2f2', textSec: '#fecaca', textDim: '#450a0a', accent: '#ef4444' },\r\n        flame: { name: 'Flame', bg: { type: 'color', value: '#0c0202' }, surface: '#1c0a0a', surfaceHover: '#451a03', surfaceActive: '#9a3412', secondary: '#1c0a0a', border: '#451a03', borderLight: '#9a3412', text: '#fff7ed', textSec: '#fdba74', textDim: '#ea580c', accent: '#f59e0b' }\r\n    },\r\n\r\n    backgroundPresets: [\r\n        { id: 'none', name: 'None (Theme Default)', type: 'none' },\r\n        { id: 'Night sky', name: 'Night sky', type: 'image', url: 'https://images.pexels.com/photos/5675745/pexels-photo-5675745.jpeg', overlay: 0.3 },\r\n        { id: 'winter-mountains', name: 'Winter mountains', type: 'image', url: 'https://images.pexels.com/photos/1287145/pexels-photo-1287145.jpeg', overlay: 0.3 },\r\n        { id: 'f1 car', name: 'F1 Car', type: 'image', url: 'https://images.pexels.com/photos/14401632/pexels-photo-14401632.jpeg', overlay: 0.3 },\r\n        { id: 'moon-landing', name: 'Moon Landing', type: 'image', url: 'https://images.pexels.com/photos/41162/moon-landing-apollo-11-nasa-buzz-aldrin-41162.jpeg', overlay: 0.3, objectPosition: 'top left', active: true },\r\n        { id: 'turtle', name: 'Turtle', type: 'image', url: 'https://images.unsplash.com/photo-1501791187590-9ef2612ba1eb?q=80&w=1932&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D', overlay: 0.3 },\r\n        { id: 'road', name: 'Road', type: 'image', url: 'https://images.unsplash.com/photo-1508233620467-f79f1e317a05', overlay: 0.3 },\r\n        { id: 'railroad', name: 'Railroad', type: 'image', url: 'https://images.unsplash.com/photo-1505832018823-50331d70d237', overlay: 0.3 },\r\n        { id: 'mountain', name: 'Mountain', type: 'image', url: 'https://raw.githubusercontent.com/evanhnry/brave-wallpapers/refs/heads/main/Brave/clay-banks-u27Rrbs9Dwc-unsplash.jpg', overlay: 0.3 },\r\n    ],\r\n\r\n    cloakPresets: [\r\n        { name: \"Phantom\", icon: \"/favicon.svg\", title: \"Phantom Unblocked\" },\r\n        { name: \"Edpuzzle\", icon: \"https://edpuzzle.imgix.net/favicons/favicon-32.png\", title: \"Edpuzzle\" },\r\n        { name: \"Google Docs\", icon: \"https://ssl.gstatic.com/docs/documents/images/kix-favicon7.ico\", title: \"Untitled document - Google Docs\" },\r\n        { name: \"Canvas\", icon: \"https://du11hjcvx0uqb.cloudfront.net/dist/images/favicon-e10d657a73.ico\", title: \"Dashboard\" },\r\n        { name: \"Desmos\", icon: \"https://www.desmos.com/favicon.ico\", title: \"Desmos | Graphing Calculator\" },\r\n        { name: \"Khan Academy\", icon: \"https://cdn.kastatic.org/images/favicon.ico\", title: \"Khan Academy\" },\r\n        { name: \"Wikipedia\", icon: \"https://en.wikipedia.org/favicon.ico\", title: \"World War II - Wikipedia\" },\r\n        { name: \"Classroom\", icon: \"https://ssl.gstatic.com/classroom/favicon.png\", title: \"Home - Classroom\" },\r\n        { name: \"Canva\", icon: \"https://static.canva.com/static/images/android-192x192-2.png\", title: \"Home - Canva\" },\r\n        { name: \"Quiz\", icon: \"https://ssl.gstatic.com/docs/spreadsheets/forms/forms_icon_2023q4.ico\", title: \"You've already responded\" },\r\n        { name: \"Blooket\", icon: \"https://play.blooket.com/favicon.ico\", title: \"Play Blooket | Blooket\" },\r\n        { name: \"Gmail\", icon: \"https://ssl.gstatic.com/ui/v1/icons/mail/rfr/gmail.ico\", title: \"Gmail\" },\r\n        { name: \"YouTube\", icon: \"https://www.youtube.com/favicon.ico\", title: \"YouTube\" },\r\n        { name: \"Powerschool\", icon: \"https://waverlyk12.powerschool.com/favicon.ico\", title: \"Grades and Attendance\" },\r\n        { name: \"nothing\", icon: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=\", title: \"\\u200B\" },\r\n    ]\r\n}\r\n\r\n\r\n\n</script>\r\n    <script>\n// settings handler\r\n(function () {\r\n    'use strict';\r\n\r\n    const STORAGE_KEY = 'void_settings';\r\n\r\n    const getDefaults = () => {\r\n        return window.SITE_CONFIG?.defaults || {\r\n            cloakMode: 'none',\r\n            cloakRotation: false,\r\n            cloakInterval: 5000,\r\n            panicKey: 'x',\r\n            panicModifiers: ['ctrl', 'shift'],\r\n            panicUrl: 'https://classroom.google.com',\r\n            maxMovieRating: 'R',\r\n            offlineGames: [],\r\n            gameLibrary: 'multi',\r\n            leaveConfirmation: false\r\n        };\r\n    };\r\n\r\n    const load = () => {\r\n        try {\r\n            const stored = localStorage.getItem(STORAGE_KEY);\r\n            if (stored) {\r\n                return { ...getDefaults(), ...JSON.parse(stored) };\r\n            }\r\n        } catch (e) {\r\n            console.warn('Failed to load settings:', e);\r\n        }\r\n        return getDefaults();\r\n    };\r\n\r\n    const save = (settings) => {\r\n        try {\r\n            localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n            window.dispatchEvent(new CustomEvent('settings-changed', { detail: settings }));\r\n            if (window.parent !== window) {\r\n                window.parent.postMessage({ type: 'settings-update' }, '*');\r\n            }\r\n        } catch (e) {\r\n            console.warn('Failed to save settings:', e);\r\n        }\r\n    };\r\n\r\n    let _settings = load();\r\n\r\n    window.Settings = {\r\n        get(key) { return _settings[key]; },\r\n\r\n        getAll() { return { ..._settings }; },\r\n\r\n        set(key, value) {\r\n            _settings[key] = value;\r\n            save(_settings);\r\n            this.apply();\r\n            return value;\r\n        },\r\n\r\n        update(partial) {\r\n            _settings = { ..._settings, ...partial };\r\n            save(_settings);\r\n            this.apply();\r\n        },\r\n\r\n        reset() {\r\n            _settings = getDefaults();\r\n            save(_settings);\r\n            this.apply();\r\n        },\r\n\r\n        apply() {\r\n            const root = document.documentElement;\r\n            const s = _settings;\r\n            const d = window.SITE_CONFIG?.defaults || {};\r\n\r\n            const vars = {\r\n                '--accent': s.accentColor || d.accentColor || '#ffffff',\r\n                '--surface': s.surfaceColor || d.surfaceColor || '#0f0f0f',\r\n                '--surface-hover': s.surfaceHoverColor || d.surfaceHoverColor || '#1a1a1a',\r\n                '--surface-active': s.surfaceActiveColor || d.surfaceActiveColor || '#252525',\r\n                '--secondary': s.secondaryColor || d.secondaryColor || '#2e2e33',\r\n                '--border': s.borderColor || d.borderColor || '#1f1f1f',\r\n                '--border-light': s.borderLightColor || d.borderLightColor || '#2a2a2a',\r\n                '--text': s.textColor || d.textColor || '#e4e4e7',\r\n                '--text-muted': s.textSecondaryColor || d.textSecondaryColor || '#71717a',\r\n                '--text-dim': s.textDimColor || d.textDimColor || '#52525b',\r\n                '--toggle': s.toggleColor || d.toggleColor,\r\n                '--toggle-knob': s.toggleKnobColor || d.toggleKnobColor\r\n            };\r\n\r\n            Object.entries(vars).forEach(([key, val]) => {\r\n                if (val) root.style.setProperty(key, val);\r\n            });\r\n\r\n            const themeBg = s.background || d.background || { type: 'color', value: '#0a0a0a' };\r\n            const customBg = s.customBackground;\r\n            const isCustomActive = customBg && customBg.type !== 'none';\r\n\r\n            if (themeBg.type === 'color') {\r\n                root.style.setProperty('--bg', themeBg.value);\r\n            }\r\n\r\n            if (isCustomActive && customBg.url) {\r\n                root.style.setProperty('--bg-image', `url(${customBg.url})`);\r\n\r\n                let position = customBg.objectPosition;\r\n                if (customBg.id && customBg.id !== 'custom') {\r\n                    const preset = window.SITE_CONFIG?.backgroundPresets?.find(b => b.id === customBg.id);\r\n                    if (preset?.objectPosition) position = preset.objectPosition;\r\n                }\r\n\r\n                root.style.setProperty('--bg-image-position', position || 'center');\r\n            } else if (themeBg.type === 'image' || themeBg.type === 'video') {\r\n                root.style.setProperty('--bg-image', `url(${themeBg.value || themeBg.url})`);\r\n                root.style.setProperty('--bg-image-position', themeBg.objectPosition || 'center');\r\n            } else if (themeBg.type === 'gradient') {\r\n                root.style.setProperty('--bg-image', themeBg.value || themeBg.url);\r\n                root.style.setProperty('--bg-image-position', 'center');\r\n            } else {\r\n                root.style.setProperty('--bg-image', 'none');\r\n            }\r\n        },\r\n\r\n        onChange(callback) {\r\n            window.addEventListener('settings-changed', (e) => callback(e.detail));\r\n        },\r\n\r\n        isRatingAllowed(rating) {\r\n            if (!rating || rating === 'NR' || rating === 'NC-17') return false;\r\n            const ratingOrder = ['G', 'PG', 'PG-13', 'R'];\r\n            const maxIndex = ratingOrder.indexOf(_settings.maxMovieRating);\r\n            const ratingIndex = ratingOrder.indexOf(rating);\r\n            return maxIndex !== -1 && ratingIndex !== -1 && ratingIndex <= maxIndex;\r\n        }\r\n    };\r\n\r\n    // panic button go brr\r\n    const handlePanic = (e) => {\r\n        const mods = _settings.panicModifiers || [];\r\n        const key = _settings.panicKey || 'x';\r\n\r\n        if (mods.includes('ctrl') !== e.ctrlKey) return;\r\n        if (mods.includes('shift') !== e.shiftKey) return;\r\n        if (mods.includes('alt') !== e.altKey) return;\r\n\r\n        if (e.key.toLowerCase() === key.toLowerCase()) {\r\n            e.preventDefault();\r\n            const overlayId = 'panic-overlay';\r\n            let overlay = window.parent?.document?.getElementById(overlayId) || document.getElementById(overlayId);\r\n\r\n            if (!overlay) {\r\n                overlay = document.createElement('div');\r\n                overlay.id = overlayId;\r\n                overlay.style.cssText = 'position:fixed;inset:0;background:white;z-index:99999;';\r\n                document.body.appendChild(overlay);\r\n            } else {\r\n                overlay.style.display = 'block';\r\n            }\r\n\r\n            window.location.replace(_settings.panicUrl || 'https://classroom.google.com');\r\n        }\r\n    };\r\n\r\n    const init = () => {\r\n        try { Settings.apply() } catch(e) { console.error("Settings failed", e) };\r\n\r\n        const featured = window.SITE_CONFIG?.featuredBackground;\r\n        const activePreset = window.SITE_CONFIG?.backgroundPresets?.find(p => p.active);\r\n\r\n        const target = activePreset || featured;\r\n\r\n        if (target?.id && target.id !== _settings.lastSeenFeatured) {\r\n            Settings.update({\r\n                customBackground: target,\r\n                lastSeenFeatured: target.id,\r\n                backgroundRotation: false\r\n            });\r\n        }\r\n\r\n        document.addEventListener('keydown', handlePanic, true);\r\n\r\n        window.addEventListener('storage', (e) => {\r\n            if (e.key === STORAGE_KEY) {\r\n                _settings = load();\r\n                Settings.apply();\r\n                window.dispatchEvent(new CustomEvent('settings-changed', { detail: _settings }));\r\n            }\r\n        });\r\n\r\n        window.addEventListener('message', (e) => {\r\n            if (e.data?.type === 'settings-update' || e.data === 'updateCloak') {\r\n                _settings = load();\r\n                Settings.apply();\r\n                window.dispatchEvent(new CustomEvent('settings-changed', { detail: _settings }));\r\n            }\r\n        });\r\n\r\n        window.addEventListener('beforeunload', (e) => {\r\n            if (document.getElementById('main-frame') && _settings.leaveConfirmation) {\r\n                e.preventDefault();\r\n                return e.returnValue = '';\r\n            }\r\n        });\r\n    };\r\n\r\n    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', init);\r\n    else init();\r\n})();\r\n\n</script>\r\n    <script>\n// background stuff\r\n(function () {\r\n    'use strict';\r\n\r\n    if (window.BackgroundManager) return;\r\n\r\n    const YOUTUBE_REGEX = /(?:youtube\\.com\\/watch\\?v=|youtu\\.be\\/|youtube\\.com\\/embed\\/)([a-zA-Z0-9_-]{11})/;\r\n\r\n    const BackgroundManager = {\r\n        container: null,\r\n        mediaLayer: null,\r\n        elements: { video: null, image: null, iframe: null },\r\n        current: { type: null, url: null },\r\n        cacheName: 'phantom-bg-cache-v2',\r\n\r\n        init() {\r\n            this.container = document.createElement('div');\r\n            this.container.className = 'phantom-background';\r\n            this.container.innerHTML = '<div class=\"phantom-background-overlay\"></div><div class=\"phantom-background-layer\"></div>';\r\n            this.mediaLayer = this.container.querySelector('.phantom-background-layer');\r\n            document.body.insertBefore(this.container, document.body.firstChild);\r\n\r\n            const apply = () => this.applyBackground();\r\n            window.addEventListener('settings-changed', apply);\r\n            window.addEventListener('storage', apply);\r\n            window.addEventListener('beforeunload', () => this.cleanup());\r\n            window.addEventListener('pagehide', () => this.cleanup());\r\n\r\n            document.addEventListener('visibilitychange', () => {\r\n                const video = this.elements.video;\r\n                if (!video) return;\r\n                if (document.hidden) video.pause();\r\n                else if (this.current.type === 'video') video.play().catch(() => { });\r\n            });\r\n\r\n            this.applyBackground();\r\n        },\r\n\r\n        applyBackground() {\r\n            if (!this.container) return; // Wait for init() to create the container\r\n\r\n            const s = window.Settings?.getAll() || {};\r\n            const custom = s.customBackground;\r\n            const theme = s.background || {};\r\n\r\n            let type = null, url = null, pos = null, overlay = 0.4;\r\n\r\n            if (custom && custom.type !== 'none') {\r\n                // Refresh from config if possible to get latest props like objectPosition\r\n                if (custom.id && custom.id !== 'custom') {\r\n                    const preset = window.SITE_CONFIG?.backgroundPresets?.find(b => b.id === custom.id);\r\n                    if (preset) Object.assign(custom, preset);\r\n                }\r\n                ({ type, url, objectPosition: pos, overlay = 0.4 } = custom);\r\n            } else if (theme.type === 'image' || theme.type === 'video' || theme.type === 'youtube') {\r\n                type = theme.type;\r\n                url = theme.value || theme.url;\r\n                pos = theme.objectPosition;\r\n                overlay = theme.overlay || 0.4;\r\n            }\r\n\r\n            document.documentElement.style.setProperty('--bg-overlay', overlay);\r\n\r\n            // Handle common positioning typos and normalize\r\n            if (pos && typeof pos === 'string') {\r\n                pos = pos.toLowerCase().trim()\r\n                    .replace(/\\s+/g, ' ') // Normalize multiple spaces\r\n                    .replace('topleft', 'top left')\r\n                    .replace('topright', 'top right')\r\n                    .replace('bottomleft', 'bottom left')\r\n                    .replace('bottomright', 'bottom right')\r\n                    .replace('centercenter', 'center')\r\n                    .replace('centerleft', 'center left')\r\n                    .replace('centerright', 'center right');\r\n            }\r\n\r\n            document.documentElement.style.setProperty('--bg-image-position', pos || 'center');\r\n\r\n            if (!type || !url) {\r\n                this.clear();\r\n                document.documentElement.style.backgroundColor = 'var(--bg)';\r\n                document.documentElement.style.setProperty('--bg-image-position', 'center');\r\n                return;\r\n            }\r\n            if (this.current.type === type && this.current.url === url) return;\r\n\r\n            this.current = { type, url };\r\n\r\n            if (type === 'video' || url.match(/\\.(mp4|webm|ogg|mov|m4v)$/i)) {\r\n                this.clearMedia();\r\n                this.createVideo(url, pos);\r\n                this.container.classList.add('active');\r\n                document.documentElement.classList.add('phantom-bg-active');\r\n                document.body.classList.add('phantom-bg-active');\r\n            } else if (type === 'youtube' || YOUTUBE_REGEX.test(url)) {\r\n                this.clearMedia();\r\n                this.createYouTube(url, pos);\r\n                this.container.classList.add('active');\r\n                document.documentElement.classList.add('phantom-bg-active');\r\n                document.body.classList.add('phantom-bg-active');\r\n            } else if (type === 'image') {\r\n                this.handleImageBackground(url, pos);\r\n            }\r\n        },\r\n\r\n        async getProxiedCachedUrl(url) {\r\n            // Local images don't need proxying\r\n            if (!url.startsWith('http') || url.includes(location.hostname)) return url;\r\n\r\n            // Try direct load first (faster)\r\n            try {\r\n                const directTest = await fetch(url, { method: 'HEAD', mode: 'cors' });\r\n                if (directTest.ok) return url;\r\n            } catch (e) {\r\n                // CORS blocked, need to proxy\r\n            }\r\n\r\n            // Wait for BareMux (max 500ms)\r\n            let retries = 0;\r\n            while (!window.BareMux && retries < 5) {\r\n                await new Promise(r => setTimeout(r, 100));\r\n                retries++;\r\n            }\r\n\r\n            if (!window.BareMux) {\r\n                console.warn(\"Background: BareMux not found, trying direct URL.\");\r\n                return url; // Try direct anyway\r\n            }\r\n\r\n            try {\r\n                const client = new window.BareMux.BareClient();\r\n                const response = await client.fetch(url);\r\n                if (!response.ok) throw new Error('Proxy fetch failed');\r\n\r\n                const blob = await response.blob();\r\n                return URL.createObjectURL(blob);\r\n            } catch (error) {\r\n                console.error(\"Background proxy failed:\", error);\r\n                return url; // Fallback to direct URL\r\n            }\r\n        },\r\n\r\n        async handleImageBackground(url, pos) {\r\n            // Pre-load the image (proxied/cached or direct)\r\n            const finalUrl = await this.getProxiedCachedUrl(url);\r\n\r\n            // Check if this is still the current background after async fetch\r\n            if (this.current.url !== url) {\r\n                if (finalUrl && finalUrl.startsWith('blob:')) URL.revokeObjectURL(finalUrl);\r\n                return;\r\n            }\r\n\r\n            this.clearMedia();\r\n            this.createImage(finalUrl, pos);\r\n        },\r\n\r\n        createVideo(url, pos) {\r\n            const el = Object.assign(document.createElement('video'), {\r\n                className: 'phantom-background-media', src: url, autoplay: true, loop: true, muted: true, playsInline: true, volume: 0\r\n            });\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n            el.onerror = () => (this.elements.video = null);\r\n            this.elements.video = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        createImage(url, pos) {\r\n            const el = Object.assign(document.createElement('img'), {\r\n                className: 'phantom-background-media',\r\n                src: url\r\n            });\r\n\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n\r\n            el.onload = () => {\r\n                if (this.current.url === url || url.startsWith('blob:')) {\r\n                    this.container.classList.add('active');\r\n                    document.documentElement.classList.add('phantom-bg-active');\r\n                    document.body.classList.add('phantom-bg-active');\r\n                }\r\n            };\r\n            el.onerror = () => {\r\n                console.warn(\"Background image failed to load:\", url);\r\n                if (this.elements.image === el) this.elements.image = null;\r\n            };\r\n\r\n            this.elements.image = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        // youtube logic\r\n        createYouTube(url, pos) {\r\n            const id = url.match(YOUTUBE_REGEX)?.[1];\r\n            if (!id) return;\r\n            const el = Object.assign(document.createElement('iframe'), {\r\n                className: 'phantom-background-media',\r\n                src: `https://www.youtube.com/embed/${id}?autoplay=1&loop=1&playlist=${id}&controls=0&modestbranding=1&rel=0&mute=1&enablejsapi=1`,\r\n                allow: 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture'\r\n            });\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n            this.elements.iframe = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        clearMedia() {\r\n            Object.entries(this.elements).forEach(([key, el]) => {\r\n                if (!el) return;\r\n                if (key === 'video') { el.pause(); el.src = ''; }\r\n                if (key === 'iframe') el.src = 'about:blank';\r\n                if (key === 'image' && el.src.startsWith('blob:')) {\r\n                    URL.revokeObjectURL(el.src);\r\n                }\r\n                el.remove();\r\n                this.elements[key] = null;\r\n            });\r\n        },\r\n\r\n        clear() {\r\n            this.clearMedia();\r\n            this.current = { type: null, url: null };\r\n            document.documentElement.classList.remove('phantom-bg-active');\r\n            document.body.classList.remove('phantom-bg-active');\r\n            document.documentElement.style.backgroundColor = '';\r\n            if (this.container) this.container.classList.remove('active');\r\n        },\r\n\r\n        cleanup() {\r\n            this.clearMedia();\r\n        }\r\n    };\r\n\r\n    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', () => BackgroundManager.init());\r\n    else BackgroundManager.init();\r\n\r\n    window.BackgroundManager = BackgroundManager;\r\n})();\r\n\n</script>\r\n    <script>\n// stealth mode\r\n(function () {\r\n    'use strict';\r\n\r\n    let rotationInterval = null;\r\n    let currentPresetIndex = 0;\r\n    const original = { title: document.title, favicon: document.querySelector('link[rel=\"icon\"]')?.href };\r\n\r\n    const getPresets = () => [...(window.SITE_CONFIG?.cloakPresets || []), ...(window.Settings?.get('customCloaks') || [])];\r\n\r\n    const setTitle = (title) => {\r\n        if (!title) return;\r\n        document.title = title;\r\n        try { if (window.top !== window.self) window.top.document.title = title; } catch { }\r\n    };\r\n\r\n    const setFavicon = (href) => {\r\n        if (!href) return;\r\n        [document, window.top?.document].filter(d => { try { return d; } catch { return false; } }).forEach(doc => {\r\n            doc.querySelectorAll('link[rel*=\"icon\"]').forEach(l => l.remove());\r\n            const link = doc.createElement('link');\r\n            link.rel = 'icon';\r\n            link.href = href;\r\n            doc.head.appendChild(link);\r\n        });\r\n    };\r\n\r\n    const apply = (p) => {\r\n        if (p) {\r\n            setTitle(p.title);\r\n            setFavicon(p.icon || p.favicon);\r\n        } else {\r\n            const s = window.Settings?.getAll() || {};\r\n            setTitle(s.tabTitle || window.SITE_CONFIG?.defaults?.tabTitle);\r\n            setFavicon(s.tabFavicon || window.SITE_CONFIG?.defaults?.tabFavicon);\r\n        }\r\n    };\r\n\r\n    const startRotation = (ms) => {\r\n        stopRotation();\r\n        const presets = getPresets();\r\n        if (presets.length < 2) return apply(presets[0]);\r\n        rotationInterval = setInterval(() => {\r\n            currentPresetIndex = (currentPresetIndex + 1) % presets.length;\r\n            apply(presets[currentPresetIndex]);\r\n        }, ms);\r\n    };\r\n\r\n    const stopRotation = () => { if (rotationInterval) { clearInterval(rotationInterval); rotationInterval = null; } };\r\n\r\n    const redirectOriginal = () => {\r\n        const targets = [\"https://classroom.google.com\", \"https://drive.google.com\", \"https://google.com\", \"https://kahoot.it\", \"https://edpuzzle.com\"];\r\n        window.location.replace(targets[Math.floor(Math.random() * targets.length)]);\r\n    };\r\n\r\n    const getPopupContent = (url) => {\r\n        const s = window.Settings?.getAll() || {};\r\n        const title = s.tabTitle || window.SITE_CONFIG?.defaults?.tabTitle || 'Google';\r\n        const icon = s.tabFavicon || window.SITE_CONFIG?.defaults?.tabFavicon || 'https://www.google.com/favicon.ico';\r\n        return `<!DOCTYPE html><html><head><title>${title}</title><link rel=\"icon\" href=\"${icon}\"><style>* {margin:0;padding:0;height:100%;overflow:hidden;} iframe{width:100%;height:100%;border:none;}</style></head><body><iframe src=\"${url}\"></iframe></body></html>`;\r\n    };\r\n\r\n    // Try to open popup and monitor if it survives for 500ms\r\n    // Returns: { success: true } if popup works and stays open\r\n    // Returns: { success: false, reason: 'blocked' } if window.open returned null\r\n    // Returns: { success: false, reason: 'killed' } if popup was closed by extension (like Securly)\r\n    const tryPopup = (url) => {\r\n        return new Promise((resolve) => {\r\n            const win = window.open('about:blank', '_blank');\r\n\r\n            // Popup completely blocked by browser\r\n            if (!win) {\r\n                resolve({ success: false, reason: 'blocked' });\r\n                return;\r\n            }\r\n\r\n            // Write the actual content to popup\r\n            try {\r\n                win.document.write(getPopupContent(url));\r\n                win.document.close();\r\n            } catch (e) {\r\n                try { win.close(); } catch { }\r\n                resolve({ success: false, reason: 'killed' });\r\n                return;\r\n            }\r\n\r\n            // Use a single timeout to avoid background throttling (which causes a 5s delay).\r\n            // When the original tab loses focus, browsers throttle timers to ~1s minimum.\r\n            // If the timer runs, we check once and redirect immediately.\r\n            const timeoutMs = 200;\r\n\r\n            setTimeout(() => {\r\n                if (win.closed) {\r\n                    resolve({ success: false, reason: 'killed' });\r\n                } else {\r\n                    resolve({ success: true });\r\n                    redirectOriginal(); // Instant redirect\r\n                }\r\n            }, timeoutMs);\r\n        });\r\n    };\r\n\r\n    // Load content in-tab (fallback)\r\n    const loadInTab = () => {\r\n        const iframe = document.getElementById('main-frame');\r\n        if (iframe && !iframe.src) iframe.src = 'index2.html';\r\n        apply();\r\n    };\r\n\r\n    // Show launch screen with callback for when button is clicked\r\n    const showLaunchScreen = (onLaunch) => {\r\n        const ls = document.getElementById('launch-screen');\r\n        if (ls) {\r\n            ls.classList.remove('hidden');\r\n            document.getElementById('launch-button').onclick = onLaunch;\r\n        }\r\n    };\r\n\r\n    // Attempt popup with fallback:\r\n    // 1. Try real popup -> if works (survives 500ms), redirect original tab\r\n    // 2. If blocked (null) -> show click-to-launch (user gesture might help)\r\n    // 3. If killed (closed by Securly) -> load in-tab directly\r\n    // 4. If click-to-launch popup also fails -> load in-tab\r\n    const attemptCloakedLaunch = async (url, hideOverlay = null) => {\r\n        const result = await tryPopup(url);\r\n\r\n        if (result.success) {\r\n            // Popup worked and is still open! redirectOriginal() was already called\r\n            return true;\r\n        }\r\n\r\n        if (result.reason === 'blocked') {\r\n            // Popup was blocked (window.open returned null)\r\n            // Show click-to-launch - user gesture might bypass popup blocker\r\n            if (hideOverlay) hideOverlay();\r\n\r\n            showLaunchScreen(async () => {\r\n                document.getElementById('launch-screen').classList.add('hidden');\r\n\r\n                // Try popup again with user gesture\r\n                const retryResult = await tryPopup(url);\r\n                if (!retryResult.success) {\r\n                    // Even with user click, popup failed - load in-tab\r\n                    loadInTab();\r\n                }\r\n                // If success, redirectOriginal() was called inside tryPopup\r\n            });\r\n            return true; // Handled (showing launch screen)\r\n        }\r\n\r\n        // reason === 'killed' - Securly/extension killed the popup, go straight to in-tab\r\n        if (hideOverlay) hideOverlay();\r\n        loadInTab();\r\n        return false;\r\n    };\r\n\r\n    const init = async () => {\r\n        const s = window.Settings?.getAll() || {};\r\n        const fvKey = 'phantom_fv';\r\n        const urlParams = new URLSearchParams(window.location.search);\r\n\r\n        // Handle fake mode (legacy)\r\n        if (urlParams.has('fake')) {\r\n            showLaunchScreen(async () => {\r\n                document.getElementById('launch-screen').classList.add('hidden');\r\n                if (s.cloakMode === 'about:blank') {\r\n                    const result = await tryPopup(window.location.href.split('?')[0]);\r\n                    if (result.success) return; // redirectOriginal was called\r\n                }\r\n                loadInTab();\r\n            });\r\n            return;\r\n        }\r\n\r\n        // Handle first visit cloak (fake error page)\r\n        if (window.SITE_CONFIG?.firstVisitCloak && !localStorage.getItem(fvKey)) {\r\n            const overlay = document.getElementById('fv-cloak');\r\n            if (overlay) {\r\n                overlay.style.display = 'block';\r\n                document.title = window.location.hostname;\r\n                document.querySelectorAll(\"link[rel*='icon']\").forEach(l => l.remove());\r\n                const link = document.createElement('link');\r\n                link.rel = 'icon';\r\n                link.href = 'data:,';\r\n                document.head.appendChild(link);\r\n\r\n                const onKey = async (e) => {\r\n                    if (e.key.toLowerCase() === 'c') {\r\n                        localStorage.setItem(fvKey, '1');\r\n                        document.removeEventListener('keydown', onKey);\r\n\r\n                        if (s.cloakMode === 'about:blank') {\r\n                            await attemptCloakedLaunch(window.location.href, () => {\r\n                                overlay.style.display = 'none';\r\n                            });\r\n                        } else {\r\n                            overlay.style.display = 'none';\r\n                            apply();\r\n                            loadInTab();\r\n                        }\r\n                    }\r\n                };\r\n                document.addEventListener('keydown', onKey);\r\n            }\r\n            return;\r\n        }\r\n\r\n        // Normal visit - not first time, no fake mode\r\n        if (window.top === window.self && s.cloakMode === 'about:blank') {\r\n            await attemptCloakedLaunch(window.location.href);\r\n            return;\r\n        }\r\n\r\n        loadInTab();\r\n        if (s.rotateCloaks) startRotation((s.rotateInterval || 5) * 1000);\r\n    };\r\n\r\n    window.Cloaking = { init, apply, startRotation, stopRotation, tryPopup, loadInTab };\r\n\r\n    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', () => setTimeout(init, 100));\r\n    else setTimeout(init, 100);\r\n\r\n    window.addEventListener('settings-changed', (e) => {\r\n        apply();\r\n        if (e.detail.rotateCloaks) startRotation((e.detail.rotateInterval || 5) * 1000);\r\n        else stopRotation();\r\n    });\r\n})();\r\n\n</script>\r\n    <script>\nwindow.Quotes = {\r\n    // Use data from config, fallback to empty array if not found\r\n    getData() {\r\n        return (window.SITE_CONFIG && window.SITE_CONFIG.quotes) || [];\r\n    },\r\n\r\n    getRandom() {\r\n        const data = this.getData();\r\n        if (!data.length) return null; // Return null if no quotes\r\n        return data[Math.floor(Math.random() * data.length)];\r\n    },\r\n    init(force = false) {\r\n        const quote = this.getRandom();\r\n        if (!quote) return; // Do nothing if no quotes\r\n\r\n        const targets = [\r\n            '#quote',\r\n            '#quote-display',\r\n            '#subtitle',\r\n            '.page-subtitle',\r\n            '.extra-hero p',\r\n            '.loading-text'\r\n        ];\r\n\r\n        targets.forEach(selector => {\r\n            document.querySelectorAll(selector).forEach(el => {\r\n                // Only update if force is true, or it's empty, or has placeholder text\r\n                const text = el.textContent.trim();\r\n                if (force || !text || text === 'Loading...' || text.includes('Stream movies') || text.includes('Customize your')) {\r\n                    el.textContent = quote;\r\n                }\r\n            });\r\n        });\r\n    }\r\n};\r\n\r\nwindow.QUOTES = window.Quotes.getData();\r\n\r\n// Run automatically on load\r\nif (document.readyState === 'loading') {\r\n    document.addEventListener('DOMContentLoaded', () => window.Quotes.init());\r\n} else {\r\n    window.Quotes.init();\r\n}\r\n\n</script>\r\n    <script>Settings.apply();</script>\r\n    <style>\n/* Base styles and variables derived from erorr.html */\r\n:root {\r\n    --background-color: #fff;\r\n    --error-code-color: #5f6368;\r\n    --google-blue-100: rgb(210, 227, 252);\r\n    --google-blue-300: rgb(138, 180, 248);\r\n    --google-blue-600: rgb(26, 115, 232);\r\n    --google-blue-700: rgb(25, 103, 210);\r\n    --google-gray-100: rgb(241, 243, 244);\r\n    --google-gray-300: rgb(218, 220, 224);\r\n    --google-gray-500: rgb(154, 160, 166);\r\n    --google-gray-50: rgb(248, 249, 250);\r\n    --google-gray-600: rgb(128, 134, 139);\r\n    --google-gray-700: rgb(95, 99, 104);\r\n    --google-gray-800: rgb(60, 64, 67);\r\n    --google-gray-900: rgb(32, 33, 36);\r\n    --heading-color: var(--google-gray-900);\r\n    --link-color: rgb(88, 88, 88);\r\n    --primary-button-fill-color-active: var(--google-blue-700);\r\n    --primary-button-fill-color: var(--google-blue-600);\r\n    --primary-button-text-color: #fff;\r\n    --quiet-background-color: rgb(247, 247, 247);\r\n    --secondary-button-border-color: var(--google-gray-500);\r\n    --secondary-button-fill-color: #fff;\r\n    --secondary-button-hover-border-color: var(--google-gray-600);\r\n    --secondary-button-hover-fill-color: var(--google-gray-50);\r\n    --secondary-button-text-color: var(--google-gray-700);\r\n    --small-link-color: var(--google-gray-700);\r\n    --text-color: var(--google-gray-700);\r\n}\r\n\r\n.neterror {\r\n    background: var(--background-color);\r\n    color: var(--text-color);\r\n    word-wrap: break-word;\r\n    font-family: 'Segoe UI', Tahoma, sans-serif;\r\n    margin: 0;\r\n    font-size: 100%;\r\n}\r\n\r\n@media (prefers-color-scheme: dark) {\r\n\r\n    :root,\r\n    .neterror {\r\n        --background-color: var(--google-gray-900);\r\n        --error-code-color: var(--google-gray-500);\r\n        --heading-color: var(--google-gray-500);\r\n        --link-color: var(--google-blue-300);\r\n        --primary-button-fill-color-active: rgb(129, 162, 208);\r\n        --primary-button-fill-color: var(--google-blue-300);\r\n        --primary-button-text-color: var(--google-gray-900);\r\n        --quiet-background-color: var(--background-color);\r\n        --secondary-button-border-color: var(--google-gray-700);\r\n        --secondary-button-fill-color: var(--google-gray-900);\r\n        --secondary-button-hover-fill-color: rgb(48, 51, 57);\r\n        --secondary-button-text-color: var(--google-blue-300);\r\n        --small-link-color: var(--google-blue-300);\r\n        --text-color: var(--google-gray-500);\r\n    }\r\n}\r\n\r\n#fv-cloak.neterror {\r\n    position: fixed;\r\n    inset: 0;\r\n    z-index: 2147483647;\r\n    display: none;\r\n}\r\n\r\n/* Layout & Typography */\r\n.neterror .interstitial-wrapper {\r\n    box-sizing: border-box;\r\n    font-size: 1.0em;\r\n    line-height: 1.6em;\r\n    margin: 14vh auto 0;\r\n    max-width: 650px;\r\n    width: 100%;\r\n    padding: 0 24px;\r\n}\r\n\r\n.neterror h1 {\r\n    color: var(--heading-color);\r\n    font-size: 1.6em;\r\n    font-weight: normal;\r\n    line-height: 1.25em;\r\n    margin-bottom: 16px;\r\n    margin-top: 0;\r\n    word-wrap: break-word;\r\n}\r\n\r\n.neterror h1 span {\r\n    font-weight: 500;\r\n}\r\n\r\n.neterror p {\r\n    margin: 0;\r\n}\r\n\r\n.neterror a {\r\n    color: var(--link-color);\r\n    text-decoration: none;\r\n}\r\n\r\n.neterror .icon {\r\n    height: 72px;\r\n    margin: 0 0 40px;\r\n    width: 72px;\r\n    background-repeat: no-repeat;\r\n    background-size: 100%;\r\n    display: inline-block;\r\n}\r\n\r\n.neterror .icon-generic {\r\n    content: image-set(url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJAAAACQAQMAAADdiHD7AAAABlBMVEUAAABTU1OoaSf/AAAAAXRSTlMAQObYZgAAAFJJREFUeF7t0cENgDAMQ9FwYgxG6WjpaIzCCAxQxVggFuDiCvlLOeRdHR9yzjncHVoq3npu+wQUrUuJHylSTmBaespJyJQoObUeyxDQb3bEm5Au81c0pSCD8HYAAAAASUVORK5CYII=) 2x);\r\n}\r\n\r\n@media (prefers-color-scheme: dark) {\r\n    .neterror .icon {\r\n        filter: invert(1);\r\n    }\r\n}\r\n\r\n.neterror .error-code {\r\n    color: var(--error-code-color);\r\n    font-size: .8em;\r\n    margin-top: 12px;\r\n    text-transform: uppercase;\r\n}\r\n\r\n/* Navigation / Buttons */\r\n.neterror .nav-wrapper {\r\n    margin-top: 51px;\r\n}\r\n\r\n.neterror .nav-wrapper::after {\r\n    clear: both;\r\n    content: '';\r\n    display: table;\r\n    width: 100%;\r\n}\r\n\r\n.neterror button {\r\n    appearance: auto;\r\n    background-color: rgb(193, 196, 255);\r\n    border: none;\r\n    border-radius: 20px;\r\n    box-sizing: border-box;\r\n    color: rgb(32, 33, 36);\r\n    cursor: pointer;\r\n    display: block;\r\n    float: right;\r\n    font-family: Arial;\r\n    font-size: 13.125px;\r\n    font-weight: 400;\r\n    height: 33.3333px;\r\n    padding: 9px;\r\n    text-align: center;\r\n    transition: background-color 0.15s;\r\n    user-select: none;\r\n    width: 59.5833px;\r\n}\r\n\r\n.neterror .suggested-left>#control-buttons {\r\n    float: left;\r\n}\r\n\r\n/* Mobile tweaks */\r\n@media (max-width: 420px) {\r\n    .neterror .nav-wrapper .secondary-button {\r\n        float: none;\r\n        margin: 16px 0 0;\r\n        padding: 16px;\r\n        width: 100%;\r\n    }\r\n\r\n    .neterror button {\r\n        float: none;\r\n        width: 100%;\r\n    }\r\n\r\n    .neterror .suggested-left>#control-buttons {\r\n        float: none;\r\n    }\r\n}\r\n\r\n/* Fixed nav for strict heights/widths */\r\n@media (min-width: 240px) and (max-width: 420px) and (min-height: 401px),\r\n(min-width: 421px) and (min-height: 240px) and (max-height: 560px) {\r\n    .neterror .nav-wrapper {\r\n        background: var(--background-color);\r\n        bottom: 0;\r\n        box-shadow: 0 -12px 24px var(--background-color);\r\n        left: 0;\r\n        margin: 0 auto;\r\n        max-width: 1000px;\r\n        padding-inline-end: 24px;\r\n        padding-inline-start: 24px;\r\n        position: fixed;\r\n        right: 0;\r\n        width: 100%;\r\n        z-index: 2;\r\n        padding-bottom: 24px;\r\n        padding-top: 24px;\r\n    }\r\n\r\n    .neterror .interstitial-wrapper {\r\n        max-width: 736px;\r\n    }\r\n\r\n    .neterror #main-content {\r\n        padding-bottom: 40px;\r\n    }\r\n}\n</style>\r\n    <style>\n/**\r\n * PHANTOM - BACKGROUND STYLES\r\n */\r\n.phantom-background {\r\n    position: fixed;\r\n    inset: 0;\r\n    width: 100vw;\r\n    height: 100vh;\r\n    z-index: -1;\r\n    overflow: hidden;\r\n    background: transparent;\r\n    pointer-events: none;\r\n    opacity: 1;\r\n    transition: background-color 0.3s ease;\r\n}\r\n\r\n.phantom-background.active {\r\n    opacity: 1;\r\n}\r\n\r\n.phantom-background-overlay {\r\n    position: absolute;\r\n    inset: 0;\r\n    z-index: 2;\r\n    background: rgba(0, 0, 0, var(--bg-overlay, 0.4));\r\n    transition: background-color 0.3s ease;\r\n}\r\n\r\n.phantom-background-layer {\r\n    position: absolute;\r\n    inset: 0;\r\n    z-index: 1;\r\n    transition: opacity 0.3s ease-in-out;\r\n}\r\n\r\n.phantom-background-media {\r\n    width: 100%;\r\n    height: 100%;\r\n    object-fit: cover;\r\n    object-position: var(--bg-image-position, center);\r\n    display: block;\r\n    border: none;\r\n}\r\n\r\n/* Video and Iframe positioning for full background cover */\r\n.phantom-background-layer video.phantom-background-media,\r\n.phantom-background-layer iframe.phantom-background-media {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    transform: none;\r\n    pointer-events: none;\r\n    min-width: 100%;\r\n    min-height: 100%;\r\n    max-width: none;\r\n    max-height: none;\r\n    object-position: var(--bg-image-position, center);\r\n}\r\n\r\n/* Ensure iframes cover entire background */\r\n.phantom-background-layer iframe.phantom-background-media {\r\n    border: none;\r\n    object-fit: cover;\r\n}\r\n\r\n/* Ensure content on top remains readable */\r\nhtml {\r\n    background-color: var(--bg);\r\n}\r\n\r\nbody {\r\n    position: relative;\r\n    z-index: 0;\r\n    background: transparent !important;\r\n    /* Allow background to show through */\r\n}\r\n\r\n/* Specific adjustments for transparency if needed */\r\n.main-content,\r\n.home-page {\r\n    background: transparent !important;\r\n}\r\n\r\n/* Glassmorphism for containers when background is active */\r\n.phantom-background.active~.offline-banner,\r\n.phantom-background.active~.home-page .card,\r\n.phantom-background.active~.home-page .featured-card,\r\n.phantom-background.active~.home-page .search-bar,\r\n.phantom-background.active~.settings-panel {\r\n    backdrop-filter: blur(10px);\r\n    -webkit-backdrop-filter: blur(10px);\r\n    background: rgba(15, 15, 15, 0.7) !important;\r\n}\n</style>\r\n\r\n</head>\r\n\r\n<body>\r\n    <!-- Google Tag Manager (noscript) -->\r\n    <noscript><iframe src=\"https://www.googletagmanager.com/ns.html?id=GTM-5LMBC27Z\" height=\"0\" width=\"0\"\r\n            style=\"display:none;visibility:hidden\"></iframe></noscript>\r\n    <!-- End Google Tag Manager (noscript) -->\r\n    <!-- First Visit Cloak Layer -->\r\n    <div id=\"fv-cloak\" class=\"neterror\">\r\n        <div id=\"main-frame-error\" class=\"interstitial-wrapper\">\r\n            <div id=\"main-content\">\r\n                <div class=\"icon icon-generic\"></div>\r\n                <div id=\"main-message\">\r\n                    <h1>\r\n                        <span>This site cant be reached</span>\r\n                    </h1>\r\n                    <p>\r\n                        <strong id=\"origin-text\"></strong>s <abbr id=\"dnsDefinition\">DNS address</abbr> could not be\r\n                        found.\r\n                        Diagnosing the problem.\r\n                    </p>\r\n                    <div class=\"error-code\">DNS_PROBE_POSSIBLE</div>\r\n                </div>\r\n            </div>\r\n            <div id=\"buttons\" class=\"nav-wrapper suggested-left\">\r\n                <div id=\"control-buttons\">\r\n                    <button id=\"reload-button\" class=\"text-button\" onclick=\"location.reload()\">Reload</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <script>\r\n            {\r\n                const origin = window.location.hostname || \"This site\";\r\n                document.getElementById(\"origin-text\").textContent = origin;\r\n\r\n                // Immediate cloak check to prevent flash\r\n                try {\r\n                    const STORAGE_KEY = 'phantom_fv';\r\n                    const hasBypassed = localStorage.getItem(STORAGE_KEY);\r\n                    const urlParams = new URLSearchParams(window.location.search);\r\n                    const isFakeMode = urlParams.has('fake');\r\n\r\n                    if (window.SITE_CONFIG.firstVisitCloak && !hasBypassed && !isFakeMode) {\r\n                        const overlay = document.getElementById('fv-cloak');\r\n                        if (overlay) overlay.style.display = 'block';\r\n                        document.title = origin;\r\n\r\n                        // Remove favicon for fake error page\r\n                        document.querySelectorAll(\"link[rel*='icon']\").forEach(l => l.remove());\r\n                        const link = document.createElement('link');\r\n                        link.rel = 'icon';\r\n                        link.href = 'data:,';\r\n                        document.head.appendChild(link);\r\n\r\n                        // Hide loading screen immediately if possible\r\n                        const style = document.createElement('style');\r\n                        style.innerHTML = '#loading-screen { display: none !important; }';\r\n                        document.head.appendChild(style);\r\n\r\n                        // Set up bypass on reload button\r\n                        document.getElementById('reload-button').onclick = function () {\r\n                            localStorage.setItem(STORAGE_KEY, 'true');\r\n                            overlay.style.display = 'none';\r\n                            document.getElementById('main-frame').src = 'index2.html';\r\n                            document.title = 'Phantom Unblocked'; // Reset title\r\n\r\n                            // Restore favicon\r\n                            document.querySelectorAll(\"link[rel*='icon']\").forEach(l => l.remove());\r\n                            const link = document.createElement('link');\r\n                            link.rel = 'icon';\r\n                            link.href = 'favicon.svg';\r\n                            document.head.appendChild(link);\r\n                        };\r\n                    } else {\r\n                        // If no cloak, load main content immediately\r\n                        document.getElementById('main-frame').src = 'index2.html';\r\n                    }\r\n                } catch (e) { }\r\n            }\r\n        </script>\r\n    </div>\r\n\r\n    <!-- Loading Screen -->\r\n    <div id=\"loading-screen\" class=\"loading-screen\">\r\n        <div class=\"loading-logo\">\r\n            <i class=\"fa-solid fa-ghost\"></i>\r\n            <span>Phantom</span>\r\n        </div>\r\n        <div class=\"loading-spinner\"></div>\r\n        <div class=\"loading-text\">Loading...</div>\r\n    </div>\r\n\r\n    <!-- Launch Screen -->\r\n    <div id=\"launch-screen\" class=\"launch-screen hidden\">\r\n        <div class=\"loading-logo\">\r\n            <i class=\"fa-solid fa-ghost\"></i>\r\n            <span>Phantom</span>\r\n        </div>\r\n        <button id=\"launch-button\" class=\"launch-button\"> Launch Phantom</button>\r\n    </div>\r\n\r\n    <!-- Panic White Screen Overlay -->\r\n    <div id=\"panic-overlay\"></div>\r\n\r\n    <iframe id=\"main-frame\"></iframe>\r\n\r\n    <script>\n// rotation\r\n(function () {\r\n    'use strict';\r\n\r\n    const checkRotation = () => {\r\n        if (!window.Settings) return;\r\n        const settings = window.Settings.getAll();\r\n        const now = Date.now();\r\n        const TWO_DAYS = 172800000;\r\n\r\n        // theme\r\n        if (settings.themeRotation) {\r\n            const lastRotation = settings.lastThemeRotation || 0;\r\n            if (now - lastRotation >= TWO_DAYS) {\r\n                const presets = window.SITE_CONFIG?.themePresets || {};\r\n                const keys = Object.keys(presets);\r\n                if (keys.length > 0) {\r\n                    let randomKey;\r\n                    if (lastRotation === 0) {\r\n                        const allowed = ['dark', 'midnight'].filter(k => keys.includes(k));\r\n                        randomKey = allowed.length > 0 ? allowed[Math.floor(Math.random() * allowed.length)] : keys[0];\r\n                    } else if (keys.length > 1) {\r\n                        let attempts = 0;\r\n                        do {\r\n                            randomKey = keys[Math.floor(Math.random() * keys.length)];\r\n                            attempts++;\r\n                        } while (presets[randomKey].surface === settings.surfaceColor && attempts < 5);\r\n                    } else {\r\n                        randomKey = keys[0];\r\n                    }\r\n\r\n                    if (randomKey) {\r\n                        const theme = presets[randomKey];\r\n                        window.Settings.update({\r\n                            background: theme.bg,\r\n                            surfaceColor: theme.surface,\r\n                            surfaceHoverColor: theme.surfaceHover,\r\n                            surfaceActiveColor: theme.surfaceActive,\r\n                            secondaryColor: theme.secondary,\r\n                            borderColor: theme.border,\r\n                            borderLightColor: theme.borderLight,\r\n                            textColor: theme.text,\r\n                            textSecondaryColor: theme.textSec,\r\n                            textDimColor: theme.textDim,\r\n                            accentColor: theme.accent,\r\n                            lastThemeRotation: now\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // bg\r\n        if (settings.backgroundRotation) {\r\n            const lastRotation = settings.lastBackgroundRotation || 0;\r\n            if (now - lastRotation >= TWO_DAYS) {\r\n                const presets = (window.SITE_CONFIG?.backgroundPresets || []).filter(p => p.id !== 'none' && p.id !== 'custom');\r\n                if (presets.length > 0) {\r\n                    let randomPreset;\r\n                    if (presets.length > 1) {\r\n                        let attempts = 0;\r\n                        const currentId = settings.customBackground?.id;\r\n                        do {\r\n                            randomPreset = presets[Math.floor(Math.random() * presets.length)];\r\n                            attempts++;\r\n                        } while (randomPreset.id === currentId && attempts < 5);\r\n                    } else {\r\n                        randomPreset = presets[0];\r\n                    }\r\n                    if (randomPreset) {\r\n                        window.Settings.update({\r\n                            customBackground: randomPreset,\r\n                            lastBackgroundRotation: now\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    if (document.readyState === 'loading') {\r\n        document.addEventListener('DOMContentLoaded', checkRotation);\r\n    } else {\r\n        checkRotation();\r\n    }\r\n})();\r\n\n</script>\r\n\r\n    <script>\r\n        const loadingScreen = document.getElementById('loading-screen');\r\n        const iframe = document.getElementById('main-frame');\r\n        let loadStartTime = Date.now();\r\n        let fallbackTimer = setTimeout(hideLoading, 3500);\r\n\r\n        function showLoading() {\r\n            loadingScreen.classList.remove('hidden');\r\n            if (window.Quotes) window.Quotes.init(true);\r\n            loadStartTime = Date.now();\r\n\r\n            clearTimeout(fallbackTimer);\r\n            fallbackTimer = setTimeout(hideLoading, 3500);\r\n        }\r\n\r\n        function hideLoading() {\r\n            clearTimeout(fallbackTimer);\r\n\r\n            // Min time 0.5s (500ms)\r\n            const minTime = 500;\r\n            const elapsed = Date.now() - loadStartTime;\r\n            const remaining = Math.max(0, minTime - elapsed);\r\n\r\n            setTimeout(() => {\r\n                loadingScreen.classList.add('hidden');\r\n            }, remaining);\r\n\r\n            // Re-attach listener to the new window for next navigation\r\n            try {\r\n                if (iframe.contentWindow) {\r\n                    iframe.contentWindow.removeEventListener('unload', showLoading);\r\n                    iframe.contentWindow.addEventListener('unload', () => {\r\n                        requestAnimationFrame(showLoading);\r\n                    });\r\n                }\r\n            } catch (e) { }\r\n        }\r\n\r\n        // Listen for iframe load events\r\n        iframe.addEventListener('load', hideLoading);\r\n\r\n        // Expose to children if needed\r\n        window.showLoading = showLoading;\r\n        window.hideLoading = hideLoading;\r\n\r\n        console.log('press c to enter');\r\n    </script>\r\n</body>\r\n\r\n</html>","index2.html":"<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Phantom Unblocked</title>\n    <link rel=\"icon\" href=\"favicon.svg\" type=\"image/svg+xml\">\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css\">\n    <style>\n/* phantom styling */\r\n\r\n@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');\r\n\r\n/* variables */\r\n:root {\r\n    /* Core colors (can be overridden by user settings) */\r\n    --bg: #0a0a0a;\r\n    --surface: #0f0f0f;\r\n    --surface-hover: #1a1a1a;\r\n    --surface-active: #252525;\r\n    --border: #1f1f1f;\r\n    --border-light: #2a2a2a;\r\n\r\n    /* Text */\r\n    --text: #e4e4e7;\r\n    --text-muted: #71717a;\r\n    --text-dim: #52525b;\r\n\r\n    /* Accent (customizable) */\r\n    --accent: #ffffff;\r\n    --accent-dim: rgba(255, 255, 255, 0.8);\r\n    --accent-glow: rgba(255, 255, 255, 0.1);\r\n\r\n    /* Status colors */\r\n    --success: #22c55e;\r\n    --warning: #f59e0b;\r\n    --error: #ef4444;\r\n    --info: #3b82f6;\r\n\r\n    /* Shadows */\r\n    --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.3);\r\n    --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.4);\r\n    --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.5);\r\n    --shadow-xl: 0 16px 48px rgba(0, 0, 0, 0.6);\r\n\r\n    /* Spacing */\r\n    --space-xs: 4px;\r\n    --space-sm: 8px;\r\n    --space-md: 16px;\r\n    --space-lg: 24px;\r\n    --space-xl: 32px;\r\n    --space-2xl: 48px;\r\n\r\n    /* Border radius */\r\n    --radius-sm: 4px;\r\n    --radius-md: 8px;\r\n    --radius-lg: 12px;\r\n    --radius-xl: 16px;\r\n    --radius-full: 9999px;\r\n\r\n    /* Transitions */\r\n    --transition-fast: 0.1s ease;\r\n    --transition-normal: 0.2s ease;\r\n    --transition-slow: 0.3s ease;\r\n\r\n    /* Z-index layers */\r\n    --z-base: 1;\r\n    --z-dropdown: 100;\r\n    --z-sticky: 500;\r\n    --z-modal: 1000;\r\n    --z-toast: 2000;\r\n    --z-max: 9999;\r\n\r\n    /* Typography */\r\n    --font-sans: 'Inter', system-ui, -apple-system, sans-serif;\r\n    --font-mono: 'JetBrains Mono', 'Fira Code', monospace;\r\n\r\n    /* Background (customizable) */\r\n    --bg-image: none;\r\n}\r\n\r\n/* base */\r\n*,\r\n*::before,\r\n*::after {\r\n    box-sizing: border-box;\r\n    margin: 0;\r\n    padding: 0;\r\n}\r\n\r\nhtml {\r\n    font-size: 16px;\r\n    scroll-behavior: smooth;\r\n    -webkit-font-smoothing: antialiased;\r\n    -moz-osx-font-smoothing: grayscale;\r\n}\r\n\r\nbody {\r\n    font-family: var(--font-sans);\r\n    background: var(--bg);\r\n    background-image: var(--bg-image);\r\n    background-size: cover;\r\n    background-position: var(--bg-image-position, center);\r\n    background-attachment: fixed;\r\n    color: var(--text);\r\n    line-height: 1.5;\r\n    min-height: 100vh;\r\n    overflow-x: hidden;\r\n}\r\n\r\n/* Ensure background manager takes precedence */\r\nhtml.phantom-bg-active body {\r\n    background: transparent !important;\r\n    background-image: none !important;\r\n}\r\n\r\n/* Selection */\r\n::selection {\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n}\r\n\r\n/* Focus states */\r\n:focus-visible {\r\n    outline: 2px solid var(--accent);\r\n    outline-offset: 2px;\r\n}\r\n\r\n/* Links */\r\na {\r\n    color: var(--accent);\r\n    text-decoration: none;\r\n    transition: opacity var(--transition-fast);\r\n}\r\n\r\na:hover {\r\n    opacity: 0.8;\r\n}\r\n\r\n/* Scrollbar */\r\n::-webkit-scrollbar {\r\n    width: 8px;\r\n    height: 8px;\r\n}\r\n\r\n::-webkit-scrollbar-track {\r\n    background: var(--surface);\r\n}\r\n\r\n::-webkit-scrollbar-thumb {\r\n    background: var(--border-light);\r\n    border-radius: var(--radius-full);\r\n}\r\n\r\n::-webkit-scrollbar-thumb:hover {\r\n    background: var(--text-muted);\r\n}\r\n\r\n/* text */\r\nh1,\r\nh2,\r\nh3,\r\nh4,\r\nh5,\r\nh6 {\r\n    font-weight: 600;\r\n    line-height: 1.2;\r\n    color: var(--text);\r\n}\r\n\r\nh1 {\r\n    font-size: 2.5rem;\r\n}\r\n\r\nh2 {\r\n    font-size: 2rem;\r\n}\r\n\r\nh3 {\r\n    font-size: 1.5rem;\r\n}\r\n\r\nh4 {\r\n    font-size: 1.25rem;\r\n}\r\n\r\nh5 {\r\n    font-size: 1rem;\r\n}\r\n\r\nh6 {\r\n    font-size: 0.875rem;\r\n}\r\n\r\np {\r\n    color: var(--text-muted);\r\n    line-height: 1.6;\r\n}\r\n\r\n.text-sm {\r\n    font-size: 0.875rem;\r\n}\r\n\r\n.text-xs {\r\n    font-size: 0.75rem;\r\n}\r\n\r\n.text-lg {\r\n    font-size: 1.125rem;\r\n}\r\n\r\n.text-muted {\r\n    color: var(--text-muted);\r\n}\r\n\r\n.text-dim {\r\n    color: var(--text-dim);\r\n}\r\n\r\n.text-center {\r\n    text-align: center;\r\n}\r\n\r\n/* buttons */\r\n.btn {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    gap: var(--space-sm);\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-family: var(--font-sans);\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-md);\r\n    background: var(--surface);\r\n    color: var(--text);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n    white-space: nowrap;\r\n}\r\n\r\n.btn:hover {\r\n    background: var(--surface-hover);\r\n    border-color: var(--border-light);\r\n}\r\n\r\n.btn:active {\r\n    background: var(--surface-active);\r\n    transform: scale(0.98);\r\n}\r\n\r\n.btn-primary {\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n    border-color: var(--accent);\r\n}\r\n\r\n.btn-primary:hover {\r\n    opacity: 0.9;\r\n    background: var(--accent);\r\n}\r\n\r\n.btn-ghost {\r\n    background: transparent;\r\n    border-color: transparent;\r\n}\r\n\r\n.btn-ghost:hover {\r\n    background: var(--surface-hover);\r\n}\r\n\r\n.btn-icon {\r\n    width: 36px;\r\n    height: 36px;\r\n    padding: 0;\r\n    border-radius: var(--radius-md);\r\n}\r\n\r\n.btn-sm {\r\n    padding: var(--space-xs) var(--space-sm);\r\n    font-size: 0.75rem;\r\n}\r\n\r\n.btn-lg {\r\n    padding: var(--space-md) var(--space-lg);\r\n    font-size: 1rem;\r\n}\r\n\r\n/* inputs */\r\n.input {\r\n    width: 100%;\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-family: var(--font-sans);\r\n    font-size: 0.875rem;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-md);\r\n    color: var(--text);\r\n    transition: border-color var(--transition-fast);\r\n}\r\n\r\n.input:hover {\r\n    border-color: var(--border-light);\r\n}\r\n\r\n.input:focus {\r\n    outline: none;\r\n    border-color: var(--accent);\r\n}\r\n\r\n.input::placeholder {\r\n    color: var(--text-dim);\r\n}\r\n\r\n.input-group {\r\n    display: flex;\r\n    gap: var(--space-sm);\r\n}\r\n\r\n.input-group .input {\r\n    flex: 1;\r\n}\r\n\r\n/* Select */\r\n.select {\r\n    appearance: none;\r\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%2371717a' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E\");\r\n    background-repeat: no-repeat;\r\n    background-position: right 12px center;\r\n    padding-right: 36px;\r\n    cursor: pointer;\r\n}\r\n\r\n/* Checkbox/Toggle */\r\n.toggle {\r\n    position: relative;\r\n    width: 44px;\r\n    height: 24px;\r\n    background: var(--border);\r\n    border-radius: var(--radius-full);\r\n    cursor: pointer;\r\n    transition: background var(--transition-fast);\r\n}\r\n\r\n.toggle::after {\r\n    content: '';\r\n    position: absolute;\r\n    top: 2px;\r\n    left: 2px;\r\n    width: 20px;\r\n    height: 20px;\r\n    background: var(--text);\r\n    border-radius: 50%;\r\n    transition: transform var(--transition-fast);\r\n}\r\n\r\n.toggle.active {\r\n    background: var(--accent);\r\n}\r\n\r\n.toggle.active::after {\r\n    transform: translateX(20px);\r\n    background: var(--bg);\r\n}\r\n\r\n/* cards */\r\n.card {\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-lg);\r\n    overflow: hidden;\r\n    transition: all var(--transition-normal);\r\n}\r\n\r\n.card:hover {\r\n    border-color: var(--border-light);\r\n    box-shadow: var(--shadow-md);\r\n}\r\n\r\n.card-header {\r\n    padding: var(--space-md);\r\n    border-bottom: 1px solid var(--border);\r\n}\r\n\r\n.card-body {\r\n    padding: var(--space-md);\r\n}\r\n\r\n.card-footer {\r\n    padding: var(--space-md);\r\n    border-top: 1px solid var(--border);\r\n}\r\n\r\n\r\n/* Featured badge */\r\n.badge-featured {\r\n    position: absolute;\r\n    top: var(--space-sm);\r\n    left: var(--space-sm);\r\n    padding: var(--space-xs) var(--space-sm);\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n    font-size: 0.625rem;\r\n    font-weight: 700;\r\n    text-transform: uppercase;\r\n    letter-spacing: 0.05em;\r\n    border-radius: var(--radius-sm);\r\n}\r\n\r\n/* Favorite star */\r\n.favorite-btn {\r\n    position: absolute;\r\n    top: var(--space-sm);\r\n    right: var(--space-sm);\r\n    width: 32px;\r\n    height: 32px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background: rgba(0, 0, 0, 0.5);\r\n    border: none;\r\n    border-radius: 50%;\r\n    color: var(--text-muted);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n    opacity: 0;\r\n}\r\n\r\n.media-card:hover .favorite-btn {\r\n    opacity: 1;\r\n}\r\n\r\n.favorite-btn:hover {\r\n    background: rgba(0, 0, 0, 0.7);\r\n    color: var(--text);\r\n}\r\n\r\n.favorite-btn.active {\r\n    color: #fbbf24;\r\n    opacity: 1;\r\n}\r\n\r\n/* grid */\r\n.grid {\r\n    display: grid;\r\n    gap: var(--space-md);\r\n}\r\n\r\n.grid-cols-2 {\r\n    grid-template-columns: repeat(2, 1fr);\r\n}\r\n\r\n.grid-cols-3 {\r\n    grid-template-columns: repeat(3, 1fr);\r\n}\r\n\r\n.grid-cols-4 {\r\n    grid-template-columns: repeat(4, 1fr);\r\n}\r\n\r\n.grid-cols-5 {\r\n    grid-template-columns: repeat(5, 1fr);\r\n}\r\n\r\n.grid-cols-6 {\r\n    grid-template-columns: repeat(6, 1fr);\r\n}\r\n\r\n/* Auto-fit grid for responsive cards */\r\n.grid-auto {\r\n    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));\r\n}\r\n\r\n.grid-auto-lg {\r\n    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\r\n}\r\n\r\n/* flex */\r\n.flex {\r\n    display: flex;\r\n}\r\n\r\n.flex-col {\r\n    flex-direction: column;\r\n}\r\n\r\n.flex-wrap {\r\n    flex-wrap: wrap;\r\n}\r\n\r\n.items-center {\r\n    align-items: center;\r\n}\r\n\r\n.items-start {\r\n    align-items: flex-start;\r\n}\r\n\r\n.items-end {\r\n    align-items: flex-end;\r\n}\r\n\r\n.justify-center {\r\n    justify-content: center;\r\n}\r\n\r\n.justify-between {\r\n    justify-content: space-between;\r\n}\r\n\r\n.justify-end {\r\n    justify-content: flex-end;\r\n}\r\n\r\n.gap-xs {\r\n    gap: var(--space-xs);\r\n}\r\n\r\n.gap-sm {\r\n    gap: var(--space-sm);\r\n}\r\n\r\n.gap-md {\r\n    gap: var(--space-md);\r\n}\r\n\r\n.gap-lg {\r\n    gap: var(--space-lg);\r\n}\r\n\r\n.flex-1 {\r\n    flex: 1;\r\n}\r\n\r\n/* spacing */\r\n.p-xs {\r\n    padding: var(--space-xs);\r\n}\r\n\r\n.p-sm {\r\n    padding: var(--space-sm);\r\n}\r\n\r\n.p-md {\r\n    padding: var(--space-md);\r\n}\r\n\r\n.p-lg {\r\n    padding: var(--space-lg);\r\n}\r\n\r\n.p-xl {\r\n    padding: var(--space-xl);\r\n}\r\n\r\n.m-xs {\r\n    margin: var(--space-xs);\r\n}\r\n\r\n.m-sm {\r\n    margin: var(--space-sm);\r\n}\r\n\r\n.m-md {\r\n    margin: var(--space-md);\r\n}\r\n\r\n.m-lg {\r\n    margin: var(--space-lg);\r\n}\r\n\r\n.mt-sm {\r\n    margin-top: var(--space-sm);\r\n}\r\n\r\n.mt-md {\r\n    margin-top: var(--space-md);\r\n}\r\n\r\n.mt-lg {\r\n    margin-top: var(--space-lg);\r\n}\r\n\r\n.mb-sm {\r\n    margin-bottom: var(--space-sm);\r\n}\r\n\r\n.mb-md {\r\n    margin-bottom: var(--space-md);\r\n}\r\n\r\n.mb-lg {\r\n    margin-bottom: var(--space-lg);\r\n}\r\n\r\n/* modals */\r\n.modal-overlay {\r\n    position: fixed;\r\n    inset: 0;\r\n    background: rgba(0, 0, 0, 0.8);\r\n    backdrop-filter: blur(4px);\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    z-index: var(--z-modal);\r\n    opacity: 0;\r\n    visibility: hidden;\r\n    transition: all var(--transition-normal);\r\n}\r\n\r\n.modal-overlay.show {\r\n    opacity: 1;\r\n    visibility: visible;\r\n}\r\n\r\n.modal {\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-xl);\r\n    max-width: 90vw;\r\n    max-height: 90vh;\r\n    overflow: hidden;\r\n    transform: scale(0.95);\r\n    transition: transform var(--transition-normal);\r\n}\r\n\r\n.modal-overlay.show .modal {\r\n    transform: scale(1);\r\n}\r\n\r\n.modal-header {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    padding: var(--space-md);\r\n    border-bottom: 1px solid var(--border);\r\n}\r\n\r\n.modal-title {\r\n    font-size: 1rem;\r\n    font-weight: 600;\r\n}\r\n\r\n.modal-close {\r\n    width: 32px;\r\n    height: 32px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background: transparent;\r\n    border: none;\r\n    color: var(--text-muted);\r\n    cursor: pointer;\r\n    border-radius: var(--radius-md);\r\n    transition: all var(--transition-fast);\r\n}\r\n\r\n.modal-close:hover {\r\n    background: var(--surface-hover);\r\n    color: var(--text);\r\n}\r\n\r\n.modal-body {\r\n    padding: var(--space-md);\r\n    overflow-y: auto;\r\n}\r\n\r\n.modal-footer {\r\n    display: flex;\r\n    justify-content: flex-end;\r\n    gap: var(--space-sm);\r\n    padding: var(--space-md);\r\n    border-top: 1px solid var(--border);\r\n}\r\n\r\n/* tabs */\r\n.tabs {\r\n    display: flex;\r\n    gap: 2px;\r\n    background: var(--surface);\r\n    padding: var(--space-xs);\r\n    border-radius: var(--radius-md);\r\n    border: 1px solid var(--border);\r\n}\r\n\r\n.tab {\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    color: var(--text-muted);\r\n    background: transparent;\r\n    border: none;\r\n    border-radius: var(--radius-sm);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n}\r\n\r\n.tab:hover {\r\n    color: var(--text);\r\n}\r\n\r\n.tab.active {\r\n    background: var(--surface-hover);\r\n    color: var(--text);\r\n}\r\n\r\n/* search */\r\n\r\n/* ============================================\r\n   OFFLINE INDICATOR\r\n   ============================================ */\r\n.offline-banner {\r\n    position: fixed;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    padding: var(--space-sm) var(--space-md);\r\n    background: var(--warning);\r\n    color: var(--bg);\r\n    text-align: center;\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    z-index: var(--z-toast);\r\n    transform: translateY(-100%);\r\n    transition: transform var(--transition-normal);\r\n}\r\n\r\n.offline-banner.show {\r\n    transform: translateY(0);\r\n}\r\n\r\n.offline-badge {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    gap: var(--space-xs);\r\n    padding: var(--space-xs) var(--space-sm);\r\n    background: var(--warning);\r\n    color: var(--bg);\r\n    font-size: 0.625rem;\r\n    font-weight: 600;\r\n    text-transform: uppercase;\r\n    border-radius: var(--radius-sm);\r\n}\r\n\r\n/* ============================================\r\n   LOADING STATES\r\n   ============================================ */\r\n.skeleton {\r\n    background: linear-gradient(90deg, var(--surface) 0%, var(--surface-hover) 50%, var(--surface) 100%);\r\n    background-size: 200% 100%;\r\n    animation: shimmer 1.5s infinite;\r\n    border-radius: var(--radius-md);\r\n}\r\n\r\n@keyframes shimmer {\r\n    0% {\r\n        background-position: 200% 0;\r\n    }\r\n\r\n    100% {\r\n        background-position: -200% 0;\r\n    }\r\n}\r\n\r\n.spinner {\r\n    width: 24px;\r\n    height: 24px;\r\n    border: 2px solid var(--border);\r\n    border-top-color: var(--accent);\r\n    border-radius: 50%;\r\n    animation: spin 0.8s linear infinite;\r\n}\r\n\r\n@keyframes spin {\r\n    to {\r\n        transform: rotate(360deg);\r\n    }\r\n}\r\n\r\n/* ============================================\r\n   ANIMATIONS\r\n   ============================================ */\r\n@keyframes fadeIn {\r\n    from {\r\n        opacity: 0;\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n    }\r\n}\r\n\r\n@keyframes slideUp {\r\n    from {\r\n        opacity: 0;\r\n        transform: translateY(10px);\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n        transform: translateY(0);\r\n    }\r\n}\r\n\r\n@keyframes scaleIn {\r\n    from {\r\n        opacity: 0;\r\n        transform: scale(0.95);\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n        transform: scale(1);\r\n    }\r\n}\r\n\r\n.animate-fadeIn {\r\n    animation: fadeIn var(--transition-normal) ease;\r\n}\r\n\r\n.animate-slideUp {\r\n    animation: slideUp var(--transition-normal) ease;\r\n}\r\n\r\n.animate-scaleIn {\r\n    animation: scaleIn var(--transition-normal) ease;\r\n}\r\n\r\n/* ============================================\r\n   UTILITIES\r\n   ============================================ */\r\n.hidden {\r\n    display: none !important;\r\n}\r\n\r\n.sr-only {\r\n    position: absolute;\r\n    width: 1px;\r\n    height: 1px;\r\n    padding: 0;\r\n    margin: -1px;\r\n    overflow: hidden;\r\n    clip: rect(0, 0, 0, 0);\r\n    border: 0;\r\n}\r\n\r\n.truncate {\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n}\r\n\r\n.w-full {\r\n    width: 100%;\r\n}\r\n\r\n.h-full {\r\n    height: 100%;\r\n}\r\n\r\n.relative {\r\n    position: relative;\r\n}\r\n\r\n.absolute {\r\n    position: absolute;\r\n}\r\n\r\n.fixed {\r\n    position: fixed;\r\n}\r\n\r\n.inset-0 {\r\n    inset: 0;\r\n}\r\n\r\n/* ============================================\r\n   RESPONSIVE\r\n   ============================================ */\r\n@media (max-width: 768px) {\r\n    h1 {\r\n        font-size: 1.75rem;\r\n    }\r\n\r\n    h2 {\r\n        font-size: 1.5rem;\r\n    }\r\n\r\n    h3 {\r\n        font-size: 1.25rem;\r\n    }\r\n\r\n    .grid-auto {\r\n        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));\r\n    }\r\n\r\n    .hide-mobile {\r\n        display: none !important;\r\n    }\r\n}\r\n\r\n@media (min-width: 769px) {\r\n    .hide-desktop {\r\n        display: none !important;\r\n    }\r\n}\n</style>\n    <style>\n/* PhantomSearch - Autocomplete Dropdown Styles */\r\n\r\n.search-autocomplete {\r\n    position: absolute;\r\n    top: 100%;\r\n    left: 0;\r\n    right: 0;\r\n    margin-top: 8px;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-lg, 12px);\r\n    box-shadow: var(--shadow-lg, 0 8px 24px rgba(0, 0, 0, 0.5));\r\n    overflow: hidden;\r\n    z-index: var(--z-dropdown, 100);\r\n    opacity: 0;\r\n    visibility: hidden;\r\n    transform: translateY(-8px);\r\n    transition: opacity 0.15s ease, transform 0.15s ease, visibility 0.15s;\r\n}\r\n\r\n.search-autocomplete.open {\r\n    opacity: 1;\r\n    visibility: visible;\r\n    transform: translateY(0);\r\n}\r\n\r\n.search-autocomplete-item {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 12px;\r\n    padding: 12px 16px;\r\n    cursor: pointer;\r\n    transition: background 0.1s ease, box-shadow 0.1s ease;\r\n    position: relative;\r\n}\r\n\r\n.search-autocomplete-item:hover {\r\n    background: var(--surface-hover);\r\n}\r\n\r\n/* Selected item with soft accent glow */\r\n.search-autocomplete-item.selected {\r\n    background: var(--surface-hover);\r\n    box-shadow: inset 0 0 0 1.5px rgba(255, 255, 255, 0.25);\r\n    border-radius: 8px;\r\n}\r\n\r\n/* Small enter icon on the right for the selected item */\r\n.search-autocomplete-item.selected::after {\r\n    content: '';\r\n    position: absolute;\r\n    right: 12px;\r\n    top: 50%;\r\n    transform: translateY(-50%);\r\n    font-size: 11px;\r\n    color: var(--text-muted);\r\n    opacity: 0.7;\r\n    pointer-events: none;\r\n}\r\n\r\n.search-autocomplete-icon {\r\n    width: 24px;\r\n    height: 24px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    color: var(--text-muted);\r\n    font-size: 14px;\r\n    flex-shrink: 0;\r\n    overflow: hidden;\r\n    border-radius: 4px;\r\n}\r\n\r\n.search-autocomplete-item.selected .search-autocomplete-icon,\r\n.search-autocomplete-item:hover .search-autocomplete-icon {\r\n    color: var(--accent, #fff);\r\n}\r\n\r\n/* Thumbnail/poster support */\r\n.search-autocomplete-thumb {\r\n    width: 100%;\r\n    height: 100%;\r\n    object-fit: cover;\r\n    display: block;\r\n}\r\n\r\n.search-autocomplete-text {\r\n    flex: 1;\r\n    font-size: 14px;\r\n    color: var(--text);\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n    padding-right: 20px;\r\n}\r\n\r\n.search-autocomplete-type {\r\n    font-size: 11px;\r\n    color: var(--text-dim);\r\n    text-transform: uppercase;\r\n    letter-spacing: 0.05em;\r\n    flex-shrink: 0;\r\n    padding: 2px 6px;\r\n    background: var(--surface-active, rgba(255, 255, 255, 0.05));\r\n    border-radius: 4px;\r\n    margin-right: 16px;\r\n}\r\n\r\n/* Separator before web search (last item) */\r\n.search-autocomplete-item[data-index]:last-child {\r\n    border-top: 1px solid var(--border);\r\n    margin-top: 4px;\r\n    padding-top: 12px;\r\n}\r\n\r\n/* Responsive */\r\n@media (max-width: 640px) {\r\n    .search-autocomplete-item {\r\n        padding: 10px 14px;\r\n        gap: 10px;\r\n    }\r\n\r\n    .search-autocomplete-text {\r\n        font-size: 13px;\r\n        padding-right: 0;\r\n    }\r\n\r\n    .search-autocomplete-type {\r\n        font-size: 10px;\r\n        margin-right: 0;\r\n    }\r\n\r\n    .search-autocomplete-item.selected::after {\r\n        display: none;\r\n    }\r\n}\n</style>\n    <style>\n/* Topbar Styles - Clean & Dark */\r\n/* Note: Inter font is imported in main.css */\r\n\r\nbody {\r\n    margin: 0;\r\n    padding: 0;\r\n    background-color: var(--bg);\r\n    font-family: 'Inter', sans-serif;\r\n}\r\n\r\n#topbar-container {\r\n    position: fixed;\r\n    top: 11px;\r\n    left: 50%;\r\n    transform: translateX(-50%);\r\n    background-color: var(--surface);\r\n    border-radius: 9999px;\r\n    padding: 8px 14px;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 10px;\r\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);\r\n    z-index: 10000;\r\n    border: 1px solid var(--border);\r\n    height: 48px;\r\n    box-sizing: border-box;\r\n}\r\n\r\n#topbar-container::before {\r\n    content: '';\r\n    position: absolute;\r\n    top: -7px;\r\n    bottom: -7px;\r\n    left: -7px;\r\n    right: -7px;\r\n    z-index: -1;\r\n    border-radius: 9999px;\r\n}\r\n\r\n.logo-section {\r\n    display: flex;\r\n    align-items: center;\r\n    padding-right: 10px;\r\n    border-right: 1px solid var(--border);\r\n    height: 32px;\r\n    text-decoration: none;\r\n    color: inherit;\r\n}\r\n\r\n.logo-placeholder {\r\n    width: 28px;\r\n    height: 28px;\r\n    background-color: var(--surface-hover);\r\n    border-radius: 6px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    color: var(--text-muted);\r\n}\r\n\r\n.logo-placeholder i,\r\n.logo-placeholder svg {\r\n    width: 16px;\r\n    height: 16px;\r\n}\r\n\r\n.nav-buttons {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 4px;\r\n}\r\n\r\n.nav-separator {\r\n    width: 1px;\r\n    height: 20px;\r\n    background-color: var(--border);\r\n    margin: 0 6px;\r\n}\r\n\r\n.nav-btn {\r\n    background: transparent;\r\n    border: none;\r\n    color: var(--text-muted);\r\n    text-decoration: none;\r\n    display: flex;\r\n    align-items: center;\r\n    padding: 6px 10px;\r\n    border-radius: 99px;\r\n    height: 32px;\r\n    box-sizing: border-box;\r\n    transition: color 0.15s, background-color 0.15s;\r\n    position: relative;\r\n}\r\n\r\n.nav-badge-beta {\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n    font-size: 8px;\r\n    font-weight: 700;\r\n    color: var(--text);\r\n    background: var(--secondary);\r\n    padding: 2px 4px;\r\n    border-radius: 4px;\r\n    line-height: 1;\r\n    transform: translate(20%, -20%);\r\n    pointer-events: none;\r\n}\r\n\r\n.nav-btn:hover {\r\n    color: var(--text);\r\n    background-color: var(--surface-hover);\r\n}\r\n\r\n.nav-btn i,\r\n.nav-btn svg {\r\n    width: 18px;\r\n    height: 18px;\r\n    min-width: 18px;\r\n}\r\n\r\n.nav-btn span {\r\n    max-width: 0;\r\n    opacity: 0;\r\n    margin-left: 0;\r\n    overflow: hidden;\r\n    white-space: nowrap;\r\n    font-weight: 500;\r\n    font-size: 13px;\r\n    transition: max-width 0.23s ease, opacity 0.17s ease, margin-left 0.23s ease;\r\n}\r\n\r\n#topbar-container:hover .nav-btn span {\r\n    max-width: 70px;\r\n    opacity: 1;\r\n    margin-left: 8px;\r\n}\n</style>\n    <style>\n/**\r\n * PHANTOM - BACKGROUND STYLES\r\n */\r\n.phantom-background {\r\n    position: fixed;\r\n    inset: 0;\r\n    width: 100vw;\r\n    height: 100vh;\r\n    z-index: -1;\r\n    overflow: hidden;\r\n    background: transparent;\r\n    pointer-events: none;\r\n    opacity: 1;\r\n    transition: background-color 0.3s ease;\r\n}\r\n\r\n.phantom-background.active {\r\n    opacity: 1;\r\n}\r\n\r\n.phantom-background-overlay {\r\n    position: absolute;\r\n    inset: 0;\r\n    z-index: 2;\r\n    background: rgba(0, 0, 0, var(--bg-overlay, 0.4));\r\n    transition: background-color 0.3s ease;\r\n}\r\n\r\n.phantom-background-layer {\r\n    position: absolute;\r\n    inset: 0;\r\n    z-index: 1;\r\n    transition: opacity 0.3s ease-in-out;\r\n}\r\n\r\n.phantom-background-media {\r\n    width: 100%;\r\n    height: 100%;\r\n    object-fit: cover;\r\n    object-position: var(--bg-image-position, center);\r\n    display: block;\r\n    border: none;\r\n}\r\n\r\n/* Video and Iframe positioning for full background cover */\r\n.phantom-background-layer video.phantom-background-media,\r\n.phantom-background-layer iframe.phantom-background-media {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    transform: none;\r\n    pointer-events: none;\r\n    min-width: 100%;\r\n    min-height: 100%;\r\n    max-width: none;\r\n    max-height: none;\r\n    object-position: var(--bg-image-position, center);\r\n}\r\n\r\n/* Ensure iframes cover entire background */\r\n.phantom-background-layer iframe.phantom-background-media {\r\n    border: none;\r\n    object-fit: cover;\r\n}\r\n\r\n/* Ensure content on top remains readable */\r\nhtml {\r\n    background-color: var(--bg);\r\n}\r\n\r\nbody {\r\n    position: relative;\r\n    z-index: 0;\r\n    background: transparent !important;\r\n    /* Allow background to show through */\r\n}\r\n\r\n/* Specific adjustments for transparency if needed */\r\n.main-content,\r\n.home-page {\r\n    background: transparent !important;\r\n}\r\n\r\n/* Glassmorphism for containers when background is active */\r\n.phantom-background.active~.offline-banner,\r\n.phantom-background.active~.home-page .card,\r\n.phantom-background.active~.home-page .featured-card,\r\n.phantom-background.active~.home-page .search-bar,\r\n.phantom-background.active~.settings-panel {\r\n    backdrop-filter: blur(10px);\r\n    -webkit-backdrop-filter: blur(10px);\r\n    background: rgba(15, 15, 15, 0.7) !important;\r\n}\n</style>\n\n    <style>\n        html,\n        body {\n            height: 100%;\n        }\n\n        .home-page {\n            min-height: 100vh;\n            display: flex;\n            flex-direction: column;\n        }\n\n        .main-content {\n            flex: 1;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n            padding: 80px 24px 40px;\n            text-align: center;\n        }\n\n        .site-title {\n            font-size: 2.5rem;\n            font-weight: 700;\n            margin-bottom: 8px;\n            letter-spacing: -0.02em;\n            background: linear-gradient(90deg, #e4e4e7 0%, #a1a1aa 40%, #52525b 100%);\n            -webkit-background-clip: text;\n            -webkit-text-fill-color: transparent;\n            background-clip: text;\n        }\n\n        .site-subtitle {\n            font-size: 1rem;\n            color: var(--text-muted);\n            margin-bottom: 32px;\n            min-height: 24px;\n        }\n\n        /* Search Bar */\n        .search-container {\n            width: 100%;\n            max-width: 500px;\n            margin-bottom: 48px;\n        }\n\n        .search-bar {\n            display: flex;\n            align-items: center;\n            gap: 12px;\n            padding: 14px 20px;\n            background: var(--surface);\n            border: 1px solid var(--border);\n            border-radius: 9999px;\n            transition: border-color 0.2s, box-shadow 0.2s, background 0.2s;\n        }\n\n        .search-bar:hover {\n            background: var(--surface-hover);\n        }\n\n        .search-bar:focus-within {\n            border-color: var(--text-muted);\n            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);\n        }\n\n        .search-bar i {\n            color: var(--text-muted);\n            font-size: 1rem;\n        }\n\n        .search-bar input {\n            flex: 1;\n            background: transparent;\n            border: none;\n            outline: none;\n            color: var(--text);\n            font-size: 1rem;\n        }\n\n        .search-bar input::placeholder {\n            color: var(--text-muted);\n        }\n\n        /* Featured Section */\n        .featured-section {\n            width: 100%;\n            max-width: 800px;\n        }\n\n        .section-header {\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            gap: 8px;\n            margin-bottom: 16px;\n        }\n\n        .section-title {\n            font-size: 0.75rem;\n            font-weight: 600;\n            color: var(--text-muted);\n            text-transform: uppercase;\n            letter-spacing: 0.05em;\n        }\n\n        .star-icon {\n            color: #fbbf24;\n            font-size: 0.875rem;\n        }\n\n        .featured-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));\n            gap: 12px;\n        }\n\n        .featured-card {\n            background: var(--surface);\n            border: 1px solid var(--border);\n            border-radius: 10px;\n            padding: 14px 10px;\n            text-align: center;\n            cursor: pointer;\n            transition: all 0.15s;\n            text-decoration: none;\n            color: var(--text);\n        }\n\n        .featured-card:hover {\n            background: var(--surface-hover);\n            border-color: var(--border-light);\n            transform: translateY(-2px);\n        }\n\n        .featured-card-icon {\n            width: 40px;\n            height: 40px;\n            margin: 0 auto 8px;\n            border-radius: 8px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            font-size: 1.125rem;\n            overflow: hidden;\n        }\n\n        .featured-card-icon img {\n            width: 100%;\n            height: 100%;\n            object-fit: cover;\n            border-radius: 8px;\n        }\n\n        .featured-card-title {\n            font-size: 0.75rem;\n            font-weight: 600;\n            white-space: nowrap;\n            overflow: hidden;\n            text-overflow: ellipsis;\n        }\n\n\n\n\n\n        @media (max-width: 640px) {\n            .site-title {\n                font-size: 1.75rem;\n            }\n\n            .featured-grid {\n                grid-template-columns: repeat(3, 1fr);\n                gap: 8px;\n            }\n\n\n        }\n    </style>\n    <script>\n// site config\r\n\r\nwindow.SITE_CONFIG = {\r\n    name: \"Phantom\",\r\n    fullName: \"Phantom Unblocked\",\r\n    version: \"1.0.12\",\r\n\r\n    changelog: [\r\n        \"1.0.12: tiny fixxes and changes\",\r\n        \"some code consolidation and fixxes\",\r\n        \"suggest features in the discord server\"\r\n    ],\r\n\r\n    // quotes\r\n    quotes: [\r\n        \"lebron lebron lebronn james\",\r\n        \"so tuff\",\r\n        \"it is what it is\",\r\n        \"do ur work\",\r\n        \"this is what happens when u dont touch grass\",\r\n        \"FULL BOX\",\r\n        \"FULL PIECE\",\r\n        \"200!\",\r\n        \"press esc + refresh + power button for hacks\",\r\n        \"press ctrl+x to hide your screen\",\r\n        \"change the tab title and favicon in settings\",\r\n        \"TEACHERR!\",\r\n        \"1 pump\",\r\n        \"303 headshot\",\r\n        \"bros prolly a 60 ovr\",\r\n        \"take the L lil bro\",  \r\n        \"lebron is OUR goat\",\r\n        \"stop looking at my screen\",\r\n    ],\r\n\r\n    // todo\r\n    // *** for strikethrough\r\n    // ** for bold\r\n    todos: [\r\n        \"***fixxed aboutblank opening while securly is on (previously if popups were off it would load intab instead of clickto launch now it will use clicktolaunch unless popups are blocked)***\",\r\n        \"***fix the proxy***\",\r\n        \"***fix panic panickey, add quote talking about it***\",\r\n        \"***fix theatermode, make it hide buttons after a few seconds and ensure all content is being displayed and move the description to the bottom***\",\r\n        \"***change back player to use old styling, change the surface to use background colors for the bottom part where description is shown, looking just like the background***\",\r\n        \"***add image and video support for backgrounds***\",\r\n        \"***fix aichat, make the title use the same ai request as the users question unless its in image mode where it will use text mode and fix ai chat to remember modes better***\",\r\n        \"***add cloaking to quotes***\",\r\n        \"***add a default cloak and fix it so icons work in aboutblank for whatever reason they only work when you go to settings in aboutblank where it correctly applies***\",\r\n        \"***for search suggestions add highlighting for whatever will happen when you click enter, in search suggestions fix all games not sending you to the games page***\",\r\n        \"***fix games to make multi library the default, put it in config.js***\",\r\n        \"***rename movies shortcut in index2.html to primeshows, add shortcuts to main pages in the topbar and change the current shortcuts to more popular games***\",\r\n        \"***make announcements show even on first visit unlike changelog and allow disabling it via settings***\",\r\n        \"***fix leave comformation asking u to leave each time you click something***\",\r\n        \"***change the shortcuts on the main page to include pages***\",\r\n        \"***add movies to the search bar in main page***\",\r\n        \"***fix background not turning off soon***\",\r\n        \"***fix music page to hide youtube player unless toggled via 3 dot small button, and always shown on proxy mode, fix all the controls for video time, volume***\",\r\n        \"**add singlefile this is lowk so hard i dont really understand it**\",\r\n        \"**advertise phantom (too much work tbh)**\",\r\n        \"**add a watch page for youtube and twitch**\",\r\n        \"**add a miniplayer for music**\",\r\n        \"***shorten some page's code***\",\r\n        \"***fix paths in search autocomplete***\",\r\n        \"***fix markdown in ai not using correct text colors***\",\r\n        \"***make backgrounds show in the loading screen***\",\r\n        \"***fix icons for topbar in code.html***\",\r\n        \"**fix wisp server not notifying or autoswitiching when offline in proxy**\",\r\n        \"***fix code runner open not working at all***\",\r\n        \"***make backgrounds show in player.html***\",\r\n        \"***make backgrounds show in staticsjv2***\",\r\n        \"***make player.html player controls use theme colros not hardcoded***\",\r\n        \"***make ai chat and music sidebar go all the way down and up with borders***\",\r\n        \"**make the only song in music be lebron lebron lebron james**\",\r\n        \"**fix music controls**\",\r\n        \"***finish extra page into credits and make this todo be tucked away somewhere and not the main part of it***\"\r\n    ],\r\n    defaultWisp: \"wss://glseries.net/wisp/\",\r\n    wispServers: [\r\n        { name: \"GLSeries Wisp\", url: \"wss://glseries.net/wisp/\" },\r\n        { name: \"Rhw's Wisp\", url: \"wss://wisp.rhw.one/\" },\r\n    ],\r\n\r\n    discord: {\r\n        inviteUrl: \"https://discord.gg/tHWx9NXp5p\",\r\n        widgetServer: \"1447673724017971324\",\r\n        widgetChannel: \"1447673726228496617\",\r\n    },\r\n\r\n    firstVisitCloak: false, //fake error page\r\n    defaults: {\r\n        cloakMode: \"about:blank\",\r\n        tabTitle: \"You've already responded\",\r\n        tabFavicon: \"https://ssl.gstatic.com/docs/spreadsheets/forms/forms_icon_2023q4.ico\",\r\n        cloakRotation: false,\r\n        cloakInterval: 5000,\r\n        panicKey: \"x\",\r\n        panicModifiers: [\"ctrl\", \"shift\"],\r\n        panicUrl: \"https://classroom.google.com\",\r\n        maxMovieRating: \"R\",\r\n        gameLibrary: \"multi\",\r\n        discordWidget: true,\r\n        miniplayer: true,\r\n        leaveConfirmation: false,\r\n        showChangelogOnUpdate: true,\r\n        themeRotation: true,\r\n        lastThemeRotation: 0,\r\n        backgroundRotation: true,\r\n        lastBackgroundRotation: 0,\r\n        lastSeenFeatured: 'none',\r\n        background: { type: 'color', value: '#0a0a0a' },\r\n        customBackground: { id: 'none', type: 'none' },\r\n        accentColor: '#ffffff',\r\n        surfaceColor: '#0f0f0f',\r\n        secondaryColor: '#2e2e33',\r\n        textColor: '#e4e4e7',\r\n    },\r\n\r\n    themePresets: {\r\n        dark: { name: 'Dark (Default)', bg: { type: 'color', value: '#0a0a0a' }, surface: '#0f0f0f', surfaceHover: '#1a1a1a', surfaceActive: '#252525', secondary: '#2e2e33', border: '#2a2a2a', borderLight: '#2a2a2a', text: '#e4e4e7', textSec: '#71717a', textDim: '#52525b', accent: '#ffffff' },\r\n        midnight: { name: 'Midnight', bg: { type: 'color', value: '#000000' }, surface: '#050505', surfaceHover: '#111111', surfaceActive: '#1a1a1a', secondary: '#111111', border: '#1a1a1a', borderLight: '#111111', text: '#ededed', textSec: '#a3a3a3', textDim: '#737373', accent: '#d4d4d4' },\r\n        abyss: { name: 'Abyss', bg: { type: 'color', value: '#020617' }, surface: '#0f172a', surfaceHover: '#1e293b', surfaceActive: '#334155', secondary: '#1e293b', border: '#1e293b', borderLight: '#1e293b', text: '#f1f5f9', textSec: '#94a3b8', textDim: '#64748b', accent: '#38bdf8' },\r\n        phantom: { name: 'Phantom', bg: { type: 'color', value: '#0f0a14' }, surface: '#1a0f24', surfaceHover: '#2e1a40', surfaceActive: '#4c2a5c', secondary: '#2e1a40', border: '#2e1a40', borderLight: '#2e1a40', text: '#f3e8ff', textSec: '#d8b4fe', textDim: '#c084fc', accent: '#c084fc' },\r\n        rosepine: { name: 'Rose Pine', bg: { type: 'color', value: '#191724' }, surface: '#1f1d2e', surfaceHover: '#26233a', surfaceActive: '#524f67', secondary: '#26233a', border: '#26233a', borderLight: '#1f1d2e', text: '#e0def4', textSec: '#908caa', textDim: '#6e6a86', accent: '#ebbcba' },\r\n        ocean: { name: 'Oceanic', bg: { type: 'color', value: '#011627' }, surface: '#0b2942', surfaceHover: '#1d3b53', surfaceActive: '#2d4b63', secondary: '#0b2942', border: '#1d3b53', borderLight: '#0b2942', text: '#d6deeb', textSec: '#5f7e97', textDim: '#011627', accent: '#7fdbca' },\r\n        forest: { name: 'Forest', bg: { type: 'color', value: '#020d06' }, surface: '#051a0d', surfaceHover: '#0a2e17', surfaceActive: '#0f4221', secondary: '#051a0d', border: '#0a2e17', borderLight: '#051a0d', text: '#ecfdf5', textSec: '#6ee7b7', textDim: '#064e3b', accent: '#10b981' },\r\n        crimson: { name: 'Crimson', bg: { type: 'color', value: '#1a0505' }, surface: '#230a0a', surfaceHover: '#7b0a0aff', surfaceActive: '#7f1d1d', secondary: '#230a0a', border: '#480f0fff', borderLight: '#230a0a', text: '#fef2f2', textSec: '#fecaca', textDim: '#450a0a', accent: '#ef4444' },\r\n        flame: { name: 'Flame', bg: { type: 'color', value: '#0c0202' }, surface: '#1c0a0a', surfaceHover: '#451a03', surfaceActive: '#9a3412', secondary: '#1c0a0a', border: '#451a03', borderLight: '#9a3412', text: '#fff7ed', textSec: '#fdba74', textDim: '#ea580c', accent: '#f59e0b' }\r\n    },\r\n\r\n    backgroundPresets: [\r\n        { id: 'none', name: 'None (Theme Default)', type: 'none' },\r\n        { id: 'Night sky', name: 'Night sky', type: 'image', url: 'https://images.pexels.com/photos/5675745/pexels-photo-5675745.jpeg', overlay: 0.3 },\r\n        { id: 'winter-mountains', name: 'Winter mountains', type: 'image', url: 'https://images.pexels.com/photos/1287145/pexels-photo-1287145.jpeg', overlay: 0.3 },\r\n        { id: 'f1 car', name: 'F1 Car', type: 'image', url: 'https://images.pexels.com/photos/14401632/pexels-photo-14401632.jpeg', overlay: 0.3 },\r\n        { id: 'moon-landing', name: 'Moon Landing', type: 'image', url: 'https://images.pexels.com/photos/41162/moon-landing-apollo-11-nasa-buzz-aldrin-41162.jpeg', overlay: 0.3, objectPosition: 'top left', active: true },\r\n        { id: 'turtle', name: 'Turtle', type: 'image', url: 'https://images.unsplash.com/photo-1501791187590-9ef2612ba1eb?q=80&w=1932&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D', overlay: 0.3 },\r\n        { id: 'road', name: 'Road', type: 'image', url: 'https://images.unsplash.com/photo-1508233620467-f79f1e317a05', overlay: 0.3 },\r\n        { id: 'railroad', name: 'Railroad', type: 'image', url: 'https://images.unsplash.com/photo-1505832018823-50331d70d237', overlay: 0.3 },\r\n        { id: 'mountain', name: 'Mountain', type: 'image', url: 'https://raw.githubusercontent.com/evanhnry/brave-wallpapers/refs/heads/main/Brave/clay-banks-u27Rrbs9Dwc-unsplash.jpg', overlay: 0.3 },\r\n    ],\r\n\r\n    cloakPresets: [\r\n        { name: \"Phantom\", icon: \"/favicon.svg\", title: \"Phantom Unblocked\" },\r\n        { name: \"Edpuzzle\", icon: \"https://edpuzzle.imgix.net/favicons/favicon-32.png\", title: \"Edpuzzle\" },\r\n        { name: \"Google Docs\", icon: \"https://ssl.gstatic.com/docs/documents/images/kix-favicon7.ico\", title: \"Untitled document - Google Docs\" },\r\n        { name: \"Canvas\", icon: \"https://du11hjcvx0uqb.cloudfront.net/dist/images/favicon-e10d657a73.ico\", title: \"Dashboard\" },\r\n        { name: \"Desmos\", icon: \"https://www.desmos.com/favicon.ico\", title: \"Desmos | Graphing Calculator\" },\r\n        { name: \"Khan Academy\", icon: \"https://cdn.kastatic.org/images/favicon.ico\", title: \"Khan Academy\" },\r\n        { name: \"Wikipedia\", icon: \"https://en.wikipedia.org/favicon.ico\", title: \"World War II - Wikipedia\" },\r\n        { name: \"Classroom\", icon: \"https://ssl.gstatic.com/classroom/favicon.png\", title: \"Home - Classroom\" },\r\n        { name: \"Canva\", icon: \"https://static.canva.com/static/images/android-192x192-2.png\", title: \"Home - Canva\" },\r\n        { name: \"Quiz\", icon: \"https://ssl.gstatic.com/docs/spreadsheets/forms/forms_icon_2023q4.ico\", title: \"You've already responded\" },\r\n        { name: \"Blooket\", icon: \"https://play.blooket.com/favicon.ico\", title: \"Play Blooket | Blooket\" },\r\n        { name: \"Gmail\", icon: \"https://ssl.gstatic.com/ui/v1/icons/mail/rfr/gmail.ico\", title: \"Gmail\" },\r\n        { name: \"YouTube\", icon: \"https://www.youtube.com/favicon.ico\", title: \"YouTube\" },\r\n        { name: \"Powerschool\", icon: \"https://waverlyk12.powerschool.com/favicon.ico\", title: \"Grades and Attendance\" },\r\n        { name: \"nothing\", icon: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=\", title: \"\\u200B\" },\r\n    ]\r\n}\r\n\r\n\r\n\n</script>\n    <script>\n// settings handler\r\n(function () {\r\n    'use strict';\r\n\r\n    const STORAGE_KEY = 'void_settings';\r\n\r\n    const getDefaults = () => {\r\n        return window.SITE_CONFIG?.defaults || {\r\n            cloakMode: 'none',\r\n            cloakRotation: false,\r\n            cloakInterval: 5000,\r\n            panicKey: 'x',\r\n            panicModifiers: ['ctrl', 'shift'],\r\n            panicUrl: 'https://classroom.google.com',\r\n            maxMovieRating: 'R',\r\n            offlineGames: [],\r\n            gameLibrary: 'multi',\r\n            leaveConfirmation: false\r\n        };\r\n    };\r\n\r\n    const load = () => {\r\n        try {\r\n            const stored = localStorage.getItem(STORAGE_KEY);\r\n            if (stored) {\r\n                return { ...getDefaults(), ...JSON.parse(stored) };\r\n            }\r\n        } catch (e) {\r\n            console.warn('Failed to load settings:', e);\r\n        }\r\n        return getDefaults();\r\n    };\r\n\r\n    const save = (settings) => {\r\n        try {\r\n            localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n            window.dispatchEvent(new CustomEvent('settings-changed', { detail: settings }));\r\n            if (window.parent !== window) {\r\n                window.parent.postMessage({ type: 'settings-update' }, '*');\r\n            }\r\n        } catch (e) {\r\n            console.warn('Failed to save settings:', e);\r\n        }\r\n    };\r\n\r\n    let _settings = load();\r\n\r\n    window.Settings = {\r\n        get(key) { return _settings[key]; },\r\n\r\n        getAll() { return { ..._settings }; },\r\n\r\n        set(key, value) {\r\n            _settings[key] = value;\r\n            save(_settings);\r\n            this.apply();\r\n            return value;\r\n        },\r\n\r\n        update(partial) {\r\n            _settings = { ..._settings, ...partial };\r\n            save(_settings);\r\n            this.apply();\r\n        },\r\n\r\n        reset() {\r\n            _settings = getDefaults();\r\n            save(_settings);\r\n            this.apply();\r\n        },\r\n\r\n        apply() {\r\n            const root = document.documentElement;\r\n            const s = _settings;\r\n            const d = window.SITE_CONFIG?.defaults || {};\r\n\r\n            const vars = {\r\n                '--accent': s.accentColor || d.accentColor || '#ffffff',\r\n                '--surface': s.surfaceColor || d.surfaceColor || '#0f0f0f',\r\n                '--surface-hover': s.surfaceHoverColor || d.surfaceHoverColor || '#1a1a1a',\r\n                '--surface-active': s.surfaceActiveColor || d.surfaceActiveColor || '#252525',\r\n                '--secondary': s.secondaryColor || d.secondaryColor || '#2e2e33',\r\n                '--border': s.borderColor || d.borderColor || '#1f1f1f',\r\n                '--border-light': s.borderLightColor || d.borderLightColor || '#2a2a2a',\r\n                '--text': s.textColor || d.textColor || '#e4e4e7',\r\n                '--text-muted': s.textSecondaryColor || d.textSecondaryColor || '#71717a',\r\n                '--text-dim': s.textDimColor || d.textDimColor || '#52525b',\r\n                '--toggle': s.toggleColor || d.toggleColor,\r\n                '--toggle-knob': s.toggleKnobColor || d.toggleKnobColor\r\n            };\r\n\r\n            Object.entries(vars).forEach(([key, val]) => {\r\n                if (val) root.style.setProperty(key, val);\r\n            });\r\n\r\n            const themeBg = s.background || d.background || { type: 'color', value: '#0a0a0a' };\r\n            const customBg = s.customBackground;\r\n            const isCustomActive = customBg && customBg.type !== 'none';\r\n\r\n            if (themeBg.type === 'color') {\r\n                root.style.setProperty('--bg', themeBg.value);\r\n            }\r\n\r\n            if (isCustomActive && customBg.url) {\r\n                root.style.setProperty('--bg-image', `url(${customBg.url})`);\r\n\r\n                let position = customBg.objectPosition;\r\n                if (customBg.id && customBg.id !== 'custom') {\r\n                    const preset = window.SITE_CONFIG?.backgroundPresets?.find(b => b.id === customBg.id);\r\n                    if (preset?.objectPosition) position = preset.objectPosition;\r\n                }\r\n\r\n                root.style.setProperty('--bg-image-position', position || 'center');\r\n            } else if (themeBg.type === 'image' || themeBg.type === 'video') {\r\n                root.style.setProperty('--bg-image', `url(${themeBg.value || themeBg.url})`);\r\n                root.style.setProperty('--bg-image-position', themeBg.objectPosition || 'center');\r\n            } else if (themeBg.type === 'gradient') {\r\n                root.style.setProperty('--bg-image', themeBg.value || themeBg.url);\r\n                root.style.setProperty('--bg-image-position', 'center');\r\n            } else {\r\n                root.style.setProperty('--bg-image', 'none');\r\n            }\r\n        },\r\n\r\n        onChange(callback) {\r\n            window.addEventListener('settings-changed', (e) => callback(e.detail));\r\n        },\r\n\r\n        isRatingAllowed(rating) {\r\n            if (!rating || rating === 'NR' || rating === 'NC-17') return false;\r\n            const ratingOrder = ['G', 'PG', 'PG-13', 'R'];\r\n            const maxIndex = ratingOrder.indexOf(_settings.maxMovieRating);\r\n            const ratingIndex = ratingOrder.indexOf(rating);\r\n            return maxIndex !== -1 && ratingIndex !== -1 && ratingIndex <= maxIndex;\r\n        }\r\n    };\r\n\r\n    // panic button go brr\r\n    const handlePanic = (e) => {\r\n        const mods = _settings.panicModifiers || [];\r\n        const key = _settings.panicKey || 'x';\r\n\r\n        if (mods.includes('ctrl') !== e.ctrlKey) return;\r\n        if (mods.includes('shift') !== e.shiftKey) return;\r\n        if (mods.includes('alt') !== e.altKey) return;\r\n\r\n        if (e.key.toLowerCase() === key.toLowerCase()) {\r\n            e.preventDefault();\r\n            const overlayId = 'panic-overlay';\r\n            let overlay = window.parent?.document?.getElementById(overlayId) || document.getElementById(overlayId);\r\n\r\n            if (!overlay) {\r\n                overlay = document.createElement('div');\r\n                overlay.id = overlayId;\r\n                overlay.style.cssText = 'position:fixed;inset:0;background:white;z-index:99999;';\r\n                document.body.appendChild(overlay);\r\n            } else {\r\n                overlay.style.display = 'block';\r\n            }\r\n\r\n            window.location.replace(_settings.panicUrl || 'https://classroom.google.com');\r\n        }\r\n    };\r\n\r\n    const init = () => {\r\n        Settings.apply();\r\n\r\n        const featured = window.SITE_CONFIG?.featuredBackground;\r\n        const activePreset = window.SITE_CONFIG?.backgroundPresets?.find(p => p.active);\r\n\r\n        const target = activePreset || featured;\r\n\r\n        if (target?.id && target.id !== _settings.lastSeenFeatured) {\r\n            Settings.update({\r\n                customBackground: target,\r\n                lastSeenFeatured: target.id,\r\n                backgroundRotation: false\r\n            });\r\n        }\r\n\r\n        document.addEventListener('keydown', handlePanic, true);\r\n\r\n        window.addEventListener('storage', (e) => {\r\n            if (e.key === STORAGE_KEY) {\r\n                _settings = load();\r\n                Settings.apply();\r\n                window.dispatchEvent(new CustomEvent('settings-changed', { detail: _settings }));\r\n            }\r\n        });\r\n\r\n        window.addEventListener('message', (e) => {\r\n            if (e.data?.type === 'settings-update' || e.data === 'updateCloak') {\r\n                _settings = load();\r\n                Settings.apply();\r\n                window.dispatchEvent(new CustomEvent('settings-changed', { detail: _settings }));\r\n            }\r\n        });\r\n\r\n        window.addEventListener('beforeunload', (e) => {\r\n            if (document.getElementById('main-frame') && _settings.leaveConfirmation) {\r\n                e.preventDefault();\r\n                return e.returnValue = '';\r\n            }\r\n        });\r\n    };\r\n\r\n    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', init);\r\n    else init();\r\n})();\r\n\n</script>\n    <script>\n// background stuff\r\n(function () {\r\n    'use strict';\r\n\r\n    if (window.BackgroundManager) return;\r\n\r\n    const YOUTUBE_REGEX = /(?:youtube\\.com\\/watch\\?v=|youtu\\.be\\/|youtube\\.com\\/embed\\/)([a-zA-Z0-9_-]{11})/;\r\n\r\n    const BackgroundManager = {\r\n        container: null,\r\n        mediaLayer: null,\r\n        elements: { video: null, image: null, iframe: null },\r\n        current: { type: null, url: null },\r\n        cacheName: 'phantom-bg-cache-v2',\r\n\r\n        init() {\r\n            this.container = document.createElement('div');\r\n            this.container.className = 'phantom-background';\r\n            this.container.innerHTML = '<div class=\"phantom-background-overlay\"></div><div class=\"phantom-background-layer\"></div>';\r\n            this.mediaLayer = this.container.querySelector('.phantom-background-layer');\r\n            document.body.insertBefore(this.container, document.body.firstChild);\r\n\r\n            const apply = () => this.applyBackground();\r\n            window.addEventListener('settings-changed', apply);\r\n            window.addEventListener('storage', apply);\r\n            window.addEventListener('beforeunload', () => this.cleanup());\r\n            window.addEventListener('pagehide', () => this.cleanup());\r\n\r\n            document.addEventListener('visibilitychange', () => {\r\n                const video = this.elements.video;\r\n                if (!video) return;\r\n                if (document.hidden) video.pause();\r\n                else if (this.current.type === 'video') video.play().catch(() => { });\r\n            });\r\n\r\n            this.applyBackground();\r\n        },\r\n\r\n        applyBackground() {\r\n            if (!this.container) return; // Wait for init() to create the container\r\n\r\n            const s = window.Settings?.getAll() || {};\r\n            const custom = s.customBackground;\r\n            const theme = s.background || {};\r\n\r\n            let type = null, url = null, pos = null, overlay = 0.4;\r\n\r\n            if (custom && custom.type !== 'none') {\r\n                // Refresh from config if possible to get latest props like objectPosition\r\n                if (custom.id && custom.id !== 'custom') {\r\n                    const preset = window.SITE_CONFIG?.backgroundPresets?.find(b => b.id === custom.id);\r\n                    if (preset) Object.assign(custom, preset);\r\n                }\r\n                ({ type, url, objectPosition: pos, overlay = 0.4 } = custom);\r\n            } else if (theme.type === 'image' || theme.type === 'video' || theme.type === 'youtube') {\r\n                type = theme.type;\r\n                url = theme.value || theme.url;\r\n                pos = theme.objectPosition;\r\n                overlay = theme.overlay || 0.4;\r\n            }\r\n\r\n            document.documentElement.style.setProperty('--bg-overlay', overlay);\r\n\r\n            // Handle common positioning typos and normalize\r\n            if (pos && typeof pos === 'string') {\r\n                pos = pos.toLowerCase().trim()\r\n                    .replace(/\\s+/g, ' ') // Normalize multiple spaces\r\n                    .replace('topleft', 'top left')\r\n                    .replace('topright', 'top right')\r\n                    .replace('bottomleft', 'bottom left')\r\n                    .replace('bottomright', 'bottom right')\r\n                    .replace('centercenter', 'center')\r\n                    .replace('centerleft', 'center left')\r\n                    .replace('centerright', 'center right');\r\n            }\r\n\r\n            document.documentElement.style.setProperty('--bg-image-position', pos || 'center');\r\n\r\n            if (!type || !url) {\r\n                this.clear();\r\n                document.documentElement.style.backgroundColor = 'var(--bg)';\r\n                document.documentElement.style.setProperty('--bg-image-position', 'center');\r\n                return;\r\n            }\r\n            if (this.current.type === type && this.current.url === url) return;\r\n\r\n            this.current = { type, url };\r\n\r\n            if (type === 'video' || url.match(/\\.(mp4|webm|ogg|mov|m4v)$/i)) {\r\n                this.clearMedia();\r\n                this.createVideo(url, pos);\r\n                this.container.classList.add('active');\r\n                document.documentElement.classList.add('phantom-bg-active');\r\n                document.body.classList.add('phantom-bg-active');\r\n            } else if (type === 'youtube' || YOUTUBE_REGEX.test(url)) {\r\n                this.clearMedia();\r\n                this.createYouTube(url, pos);\r\n                this.container.classList.add('active');\r\n                document.documentElement.classList.add('phantom-bg-active');\r\n                document.body.classList.add('phantom-bg-active');\r\n            } else if (type === 'image') {\r\n                this.handleImageBackground(url, pos);\r\n            }\r\n        },\r\n\r\n        async getProxiedCachedUrl(url) {\r\n            // Local images don't need proxying\r\n            if (!url.startsWith('http') || url.includes(location.hostname)) return url;\r\n\r\n            // Try direct load first (faster)\r\n            try {\r\n                const directTest = await fetch(url, { method: 'HEAD', mode: 'cors' });\r\n                if (directTest.ok) return url;\r\n            } catch (e) {\r\n                // CORS blocked, need to proxy\r\n            }\r\n\r\n            // Wait for BareMux (max 500ms)\r\n            let retries = 0;\r\n            while (!window.BareMux && retries < 5) {\r\n                await new Promise(r => setTimeout(r, 100));\r\n                retries++;\r\n            }\r\n\r\n            if (!window.BareMux) {\r\n                console.warn(\"Background: BareMux not found, trying direct URL.\");\r\n                return url; // Try direct anyway\r\n            }\r\n\r\n            try {\r\n                const client = new window.BareMux.BareClient();\r\n                const response = await client.fetch(url);\r\n                if (!response.ok) throw new Error('Proxy fetch failed');\r\n\r\n                const blob = await response.blob();\r\n                return URL.createObjectURL(blob);\r\n            } catch (error) {\r\n                console.error(\"Background proxy failed:\", error);\r\n                return url; // Fallback to direct URL\r\n            }\r\n        },\r\n\r\n        async handleImageBackground(url, pos) {\r\n            // Pre-load the image (proxied/cached or direct)\r\n            const finalUrl = await this.getProxiedCachedUrl(url);\r\n\r\n            // Check if this is still the current background after async fetch\r\n            if (this.current.url !== url) {\r\n                if (finalUrl && finalUrl.startsWith('blob:')) URL.revokeObjectURL(finalUrl);\r\n                return;\r\n            }\r\n\r\n            this.clearMedia();\r\n            this.createImage(finalUrl, pos);\r\n        },\r\n\r\n        createVideo(url, pos) {\r\n            const el = Object.assign(document.createElement('video'), {\r\n                className: 'phantom-background-media', src: url, autoplay: true, loop: true, muted: true, playsInline: true, volume: 0\r\n            });\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n            el.onerror = () => (this.elements.video = null);\r\n            this.elements.video = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        createImage(url, pos) {\r\n            const el = Object.assign(document.createElement('img'), {\r\n                className: 'phantom-background-media',\r\n                src: url\r\n            });\r\n\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n\r\n            el.onload = () => {\r\n                if (this.current.url === url || url.startsWith('blob:')) {\r\n                    this.container.classList.add('active');\r\n                    document.documentElement.classList.add('phantom-bg-active');\r\n                    document.body.classList.add('phantom-bg-active');\r\n                }\r\n            };\r\n            el.onerror = () => {\r\n                console.warn(\"Background image failed to load:\", url);\r\n                if (this.elements.image === el) this.elements.image = null;\r\n            };\r\n\r\n            this.elements.image = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        // youtube logic\r\n        createYouTube(url, pos) {\r\n            const id = url.match(YOUTUBE_REGEX)?.[1];\r\n            if (!id) return;\r\n            const el = Object.assign(document.createElement('iframe'), {\r\n                className: 'phantom-background-media',\r\n                src: `https://www.youtube.com/embed/${id}?autoplay=1&loop=1&playlist=${id}&controls=0&modestbranding=1&rel=0&mute=1&enablejsapi=1`,\r\n                allow: 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture'\r\n            });\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n            this.elements.iframe = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        clearMedia() {\r\n            Object.entries(this.elements).forEach(([key, el]) => {\r\n                if (!el) return;\r\n                if (key === 'video') { el.pause(); el.src = ''; }\r\n                if (key === 'iframe') el.src = 'about:blank';\r\n                if (key === 'image' && el.src.startsWith('blob:')) {\r\n                    URL.revokeObjectURL(el.src);\r\n                }\r\n                el.remove();\r\n                this.elements[key] = null;\r\n            });\r\n        },\r\n\r\n        clear() {\r\n            this.clearMedia();\r\n            this.current = { type: null, url: null };\r\n            document.documentElement.classList.remove('phantom-bg-active');\r\n            document.body.classList.remove('phantom-bg-active');\r\n            document.documentElement.style.backgroundColor = '';\r\n            if (this.container) this.container.classList.remove('active');\r\n        },\r\n\r\n        cleanup() {\r\n            this.clearMedia();\r\n        }\r\n    };\r\n\r\n    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', () => BackgroundManager.init());\r\n    else BackgroundManager.init();\r\n\r\n    window.BackgroundManager = BackgroundManager;\r\n})();\r\n\n</script>\n    <script>\n// stealth mode\r\n(function () {\r\n    'use strict';\r\n\r\n    let rotationInterval = null;\r\n    let currentPresetIndex = 0;\r\n    const original = { title: document.title, favicon: document.querySelector('link[rel=\"icon\"]')?.href };\r\n\r\n    const getPresets = () => [...(window.SITE_CONFIG?.cloakPresets || []), ...(window.Settings?.get('customCloaks') || [])];\r\n\r\n    const setTitle = (title) => {\r\n        if (!title) return;\r\n        document.title = title;\r\n        try { if (window.top !== window.self) window.top.document.title = title; } catch { }\r\n    };\r\n\r\n    const setFavicon = (href) => {\r\n        if (!href) return;\r\n        [document, window.top?.document].filter(d => { try { return d; } catch { return false; } }).forEach(doc => {\r\n            doc.querySelectorAll('link[rel*=\"icon\"]').forEach(l => l.remove());\r\n            const link = doc.createElement('link');\r\n            link.rel = 'icon';\r\n            link.href = href;\r\n            doc.head.appendChild(link);\r\n        });\r\n    };\r\n\r\n    const apply = (p) => {\r\n        if (p) {\r\n            setTitle(p.title);\r\n            setFavicon(p.icon || p.favicon);\r\n        } else {\r\n            const s = window.Settings?.getAll() || {};\r\n            setTitle(s.tabTitle || window.SITE_CONFIG?.defaults?.tabTitle);\r\n            setFavicon(s.tabFavicon || window.SITE_CONFIG?.defaults?.tabFavicon);\r\n        }\r\n    };\r\n\r\n    const startRotation = (ms) => {\r\n        stopRotation();\r\n        const presets = getPresets();\r\n        if (presets.length < 2) return apply(presets[0]);\r\n        rotationInterval = setInterval(() => {\r\n            currentPresetIndex = (currentPresetIndex + 1) % presets.length;\r\n            apply(presets[currentPresetIndex]);\r\n        }, ms);\r\n    };\r\n\r\n    const stopRotation = () => { if (rotationInterval) { clearInterval(rotationInterval); rotationInterval = null; } };\r\n\r\n    const redirectOriginal = () => {\r\n        const targets = [\"https://classroom.google.com\", \"https://drive.google.com\", \"https://google.com\", \"https://kahoot.it\", \"https://edpuzzle.com\"];\r\n        window.location.replace(targets[Math.floor(Math.random() * targets.length)]);\r\n    };\r\n\r\n    const getPopupContent = (url) => {\r\n        const s = window.Settings?.getAll() || {};\r\n        const title = s.tabTitle || window.SITE_CONFIG?.defaults?.tabTitle || 'Google';\r\n        const icon = s.tabFavicon || window.SITE_CONFIG?.defaults?.tabFavicon || 'https://www.google.com/favicon.ico';\r\n        return `<!DOCTYPE html><html><head><title>${title}</title><link rel=\"icon\" href=\"${icon}\"><style>* {margin:0;padding:0;height:100%;overflow:hidden;} iframe{width:100%;height:100%;border:none;}</style></head><body><iframe src=\"${url}\"></iframe></body></html>`;\r\n    };\r\n\r\n    // Try to open popup and monitor if it survives for 500ms\r\n    // Returns: { success: true } if popup works and stays open\r\n    // Returns: { success: false, reason: 'blocked' } if window.open returned null\r\n    // Returns: { success: false, reason: 'killed' } if popup was closed by extension (like Securly)\r\n    const tryPopup = (url) => {\r\n        return new Promise((resolve) => {\r\n            const win = window.open('about:blank', '_blank');\r\n\r\n            // Popup completely blocked by browser\r\n            if (!win) {\r\n                resolve({ success: false, reason: 'blocked' });\r\n                return;\r\n            }\r\n\r\n            // Write the actual content to popup\r\n            try {\r\n                win.document.write(getPopupContent(url));\r\n                win.document.close();\r\n            } catch (e) {\r\n                try { win.close(); } catch { }\r\n                resolve({ success: false, reason: 'killed' });\r\n                return;\r\n            }\r\n\r\n            // Use a single timeout to avoid background throttling (which causes a 5s delay).\r\n            // When the original tab loses focus, browsers throttle timers to ~1s minimum.\r\n            // If the timer runs, we check once and redirect immediately.\r\n            const timeoutMs = 200;\r\n\r\n            setTimeout(() => {\r\n                if (win.closed) {\r\n                    resolve({ success: false, reason: 'killed' });\r\n                } else {\r\n                    resolve({ success: true });\r\n                    redirectOriginal(); // Instant redirect\r\n                }\r\n            }, timeoutMs);\r\n        });\r\n    };\r\n\r\n    // Load content in-tab (fallback)\r\n    const loadInTab = () => {\r\n        const iframe = document.getElementById('main-frame');\r\n        if (iframe && !iframe.src) iframe.src = 'index2.html';\r\n        apply();\r\n    };\r\n\r\n    // Show launch screen with callback for when button is clicked\r\n    const showLaunchScreen = (onLaunch) => {\r\n        const ls = document.getElementById('launch-screen');\r\n        if (ls) {\r\n            ls.classList.remove('hidden');\r\n            document.getElementById('launch-button').onclick = onLaunch;\r\n        }\r\n    };\r\n\r\n    // Attempt popup with fallback:\r\n    // 1. Try real popup -> if works (survives 500ms), redirect original tab\r\n    // 2. If blocked (null) -> show click-to-launch (user gesture might help)\r\n    // 3. If killed (closed by Securly) -> load in-tab directly\r\n    // 4. If click-to-launch popup also fails -> load in-tab\r\n    const attemptCloakedLaunch = async (url, hideOverlay = null) => {\r\n        const result = await tryPopup(url);\r\n\r\n        if (result.success) {\r\n            // Popup worked and is still open! redirectOriginal() was already called\r\n            return true;\r\n        }\r\n\r\n        if (result.reason === 'blocked') {\r\n            // Popup was blocked (window.open returned null)\r\n            // Show click-to-launch - user gesture might bypass popup blocker\r\n            if (hideOverlay) hideOverlay();\r\n\r\n            showLaunchScreen(async () => {\r\n                document.getElementById('launch-screen').classList.add('hidden');\r\n\r\n                // Try popup again with user gesture\r\n                const retryResult = await tryPopup(url);\r\n                if (!retryResult.success) {\r\n                    // Even with user click, popup failed - load in-tab\r\n                    loadInTab();\r\n                }\r\n                // If success, redirectOriginal() was called inside tryPopup\r\n            });\r\n            return true; // Handled (showing launch screen)\r\n        }\r\n\r\n        // reason === 'killed' - Securly/extension killed the popup, go straight to in-tab\r\n        if (hideOverlay) hideOverlay();\r\n        loadInTab();\r\n        return false;\r\n    };\r\n\r\n    const init = async () => {\r\n        const s = window.Settings?.getAll() || {};\r\n        const fvKey = 'phantom_fv';\r\n        const urlParams = new URLSearchParams(window.location.search);\r\n\r\n        // Handle fake mode (legacy)\r\n        if (urlParams.has('fake')) {\r\n            showLaunchScreen(async () => {\r\n                document.getElementById('launch-screen').classList.add('hidden');\r\n                if (s.cloakMode === 'about:blank') {\r\n                    const result = await tryPopup(window.location.href.split('?')[0]);\r\n                    if (result.success) return; // redirectOriginal was called\r\n                }\r\n                loadInTab();\r\n            });\r\n            return;\r\n        }\r\n\r\n        // Handle first visit cloak (fake error page)\r\n        if (window.SITE_CONFIG?.firstVisitCloak && !localStorage.getItem(fvKey)) {\r\n            const overlay = document.getElementById('fv-cloak');\r\n            if (overlay) {\r\n                overlay.style.display = 'block';\r\n                document.title = window.location.hostname;\r\n                document.querySelectorAll(\"link[rel*='icon']\").forEach(l => l.remove());\r\n                const link = document.createElement('link');\r\n                link.rel = 'icon';\r\n                link.href = 'data:,';\r\n                document.head.appendChild(link);\r\n\r\n                const onKey = async (e) => {\r\n                    if (e.key.toLowerCase() === 'c') {\r\n                        localStorage.setItem(fvKey, '1');\r\n                        document.removeEventListener('keydown', onKey);\r\n\r\n                        if (s.cloakMode === 'about:blank') {\r\n                            await attemptCloakedLaunch(window.location.href, () => {\r\n                                overlay.style.display = 'none';\r\n                            });\r\n                        } else {\r\n                            overlay.style.display = 'none';\r\n                            apply();\r\n                            loadInTab();\r\n                        }\r\n                    }\r\n                };\r\n                document.addEventListener('keydown', onKey);\r\n            }\r\n            return;\r\n        }\r\n\r\n        // Normal visit - not first time, no fake mode\r\n        if (window.top === window.self && s.cloakMode === 'about:blank') {\r\n            await attemptCloakedLaunch(window.location.href);\r\n            return;\r\n        }\r\n\r\n        loadInTab();\r\n        if (s.rotateCloaks) startRotation((s.rotateInterval || 5) * 1000);\r\n    };\r\n\r\n    window.Cloaking = { init, apply, startRotation, stopRotation, tryPopup, loadInTab };\r\n\r\n    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', () => setTimeout(init, 100));\r\n    else setTimeout(init, 100);\r\n\r\n    window.addEventListener('settings-changed', (e) => {\r\n        apply();\r\n        if (e.detail.rotateCloaks) startRotation((e.detail.rotateInterval || 5) * 1000);\r\n        else stopRotation();\r\n    });\r\n})();\r\n\n</script>\n    <script>\nwindow.Quotes = {\r\n    // Use data from config, fallback to empty array if not found\r\n    getData() {\r\n        return (window.SITE_CONFIG && window.SITE_CONFIG.quotes) || [];\r\n    },\r\n\r\n    getRandom() {\r\n        const data = this.getData();\r\n        if (!data.length) return null; // Return null if no quotes\r\n        return data[Math.floor(Math.random() * data.length)];\r\n    },\r\n    init(force = false) {\r\n        const quote = this.getRandom();\r\n        if (!quote) return; // Do nothing if no quotes\r\n\r\n        const targets = [\r\n            '#quote',\r\n            '#quote-display',\r\n            '#subtitle',\r\n            '.page-subtitle',\r\n            '.extra-hero p',\r\n            '.loading-text'\r\n        ];\r\n\r\n        targets.forEach(selector => {\r\n            document.querySelectorAll(selector).forEach(el => {\r\n                // Only update if force is true, or it's empty, or has placeholder text\r\n                const text = el.textContent.trim();\r\n                if (force || !text || text === 'Loading...' || text.includes('Stream movies') || text.includes('Customize your')) {\r\n                    el.textContent = quote;\r\n                }\r\n            });\r\n        });\r\n    }\r\n};\r\n\r\nwindow.QUOTES = window.Quotes.getData();\r\n\r\n// Run automatically on load\r\nif (document.readyState === 'loading') {\r\n    document.addEventListener('DOMContentLoaded', () => window.Quotes.init());\r\n} else {\r\n    window.Quotes.init();\r\n}\r\n\n</script>\n    <script>\n(function () {\r\n    const style = document.createElement('style');\r\n    style.textContent = `\r\n        .notify-container { position: fixed; top: 16px; right: 16px; z-index: 99999; display: flex; flex-direction: column; gap: 8px; pointer-events: none; font-family: 'Inter', sans-serif; }\r\n        .notify-toast { display: flex; align-items: center; gap: 12px; padding: 12px 16px; background: rgba(15, 15, 15, 0.9); backdrop-filter: blur(10px); border: 1px solid var(--border, #1f1f1f); border-radius: 10px; color: #e4e4e7; font-size: 13px; min-width: 280px; max-width: 380px; box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4); pointer-events: auto; transform: translateX(120%); opacity: 0; transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1), opacity 0.3s ease; position: relative; overflow: hidden; }\r\n        .notify-toast.show { transform: translateX(0); opacity: 1; }\r\n        .notify-toast.hiding { transform: translateX(120%); opacity: 0; }\r\n        .notify-icon { width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }\r\n        .notify-icon svg { width: 18px; height: 18px; }\r\n        .notify-content { flex: 1; line-height: 1.4; }\r\n        .notify-title { font-weight: 600; margin-bottom: 2px; }\r\n        .notify-message { color: #a1a1aa; font-size: 12px; }\r\n        .notify-close { background: none; border: none; color: #52525b; cursor: pointer; padding: 4px; border-radius: 4px; display: flex; align-items: center; justify-content: center; }\r\n        .notify-close:hover { background: rgba(255,255,255,0.1); color: #fff; }\r\n        .notify-close svg { width: 14px; height: 14px; }\r\n        .notify-toast.success { border-left: 3px solid #22c55e; } .notify-toast.success .notify-icon { color: #22c55e; }\r\n        .notify-toast.error { border-left: 3px solid #ef4444; } .notify-toast.error .notify-icon { color: #ef4444; }\r\n        .notify-toast.warning { border-left: 3px solid #f59e0b; } .notify-toast.warning .notify-icon { color: #f59e0b; }\r\n        .notify-toast.info { border-left: 3px solid #3b82f6; } .notify-toast.info .notify-icon { color: #3b82f6; }\r\n        .notify-progress { position: absolute; bottom: 0; left: 0; height: 2px; background: rgba(255, 255, 255, 0.2); transition: width linear; }\r\n    `;\r\n    document.head.appendChild(style);\r\n\r\n    let container = null;\r\n    const getContainer = () => container || (container = document.body.appendChild(Object.assign(document.createElement('div'), { className: 'notify-container' })));\r\n\r\n    const icons = {\r\n        success: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"20 6 9 17 4 12\"></polyline></svg>`,\r\n        error: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"15\" y1=\"9\" x2=\"9\" y2=\"15\"></line><line x1=\"9\" y1=\"9\" x2=\"15\" y2=\"15\"></line></svg>`,\r\n        warning: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\"></path><line x1=\"12\" y1=\"9\" x2=\"12\" y2=\"13\"></line><line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\"></line></svg>`,\r\n        info: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"12\" y1=\"16\" x2=\"12\" y2=\"12\"></line><line x1=\"12\" y1=\"8\" x2=\"12.01\" y2=\"8\"></line></svg>`,\r\n        close: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line><line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line></svg>`\r\n    };\r\n\r\n    function notify(type, title, msg = '', dur = 4000) {\r\n        const t = document.createElement('div');\r\n        t.className = `notify-toast ${type}`;\r\n        t.innerHTML = `<div class=\"notify-icon\">${icons[type]}</div><div class=\"notify-content\"><div class=\"notify-title\">${title}</div><div class=\"notify-message\">${msg}</div></div><button class=\"notify-close\">${icons.close}</button><div class=\"notify-progress\"></div>`;\r\n        const p = t.querySelector('.notify-progress');\r\n        const dismiss = () => { t.classList.add('hiding'); setTimeout(() => t.remove(), 300); };\r\n        t.querySelector('.notify-close').onclick = dismiss;\r\n        p.style.width = '100%';\r\n        setTimeout(() => { p.style.transition = `width ${dur}ms linear`; p.style.width = '0%'; }, 50);\r\n        let timer = setTimeout(dismiss, dur);\r\n        t.onmouseenter = () => { clearTimeout(timer); p.style.transition = 'none'; };\r\n        t.onmouseleave = () => {\r\n            const rem = (parseFloat(getComputedStyle(p).width) / t.offsetWidth) * dur;\r\n            p.style.transition = `width ${rem}ms linear`; p.style.width = '0%';\r\n            timer = setTimeout(dismiss, rem);\r\n        };\r\n        getContainer().appendChild(t);\r\n        requestAnimationFrame(() => t.classList.add('show'));\r\n    }\r\n\r\n    window.Notify = {\r\n        success: (a, b, c) => notify('success', a, b, c),\r\n        error: (a, b, c) => notify('error', a, b, c),\r\n        warning: (a, b, c) => notify('warning', a, b, c),\r\n        info: (a, b, c) => notify('info', a, b, c)\r\n    };\r\n})();\r\n\n</script>\n    <script>\n// rotation\r\n(function () {\r\n    'use strict';\r\n\r\n    const checkRotation = () => {\r\n        if (!window.Settings) return;\r\n        const settings = window.Settings.getAll();\r\n        const now = Date.now();\r\n        const TWO_DAYS = 172800000;\r\n\r\n        // theme\r\n        if (settings.themeRotation) {\r\n            const lastRotation = settings.lastThemeRotation || 0;\r\n            if (now - lastRotation >= TWO_DAYS) {\r\n                const presets = window.SITE_CONFIG?.themePresets || {};\r\n                const keys = Object.keys(presets);\r\n                if (keys.length > 0) {\r\n                    let randomKey;\r\n                    if (lastRotation === 0) {\r\n                        const allowed = ['dark', 'midnight'].filter(k => keys.includes(k));\r\n                        randomKey = allowed.length > 0 ? allowed[Math.floor(Math.random() * allowed.length)] : keys[0];\r\n                    } else if (keys.length > 1) {\r\n                        let attempts = 0;\r\n                        do {\r\n                            randomKey = keys[Math.floor(Math.random() * keys.length)];\r\n                            attempts++;\r\n                        } while (presets[randomKey].surface === settings.surfaceColor && attempts < 5);\r\n                    } else {\r\n                        randomKey = keys[0];\r\n                    }\r\n\r\n                    if (randomKey) {\r\n                        const theme = presets[randomKey];\r\n                        window.Settings.update({\r\n                            background: theme.bg,\r\n                            surfaceColor: theme.surface,\r\n                            surfaceHoverColor: theme.surfaceHover,\r\n                            surfaceActiveColor: theme.surfaceActive,\r\n                            secondaryColor: theme.secondary,\r\n                            borderColor: theme.border,\r\n                            borderLightColor: theme.borderLight,\r\n                            textColor: theme.text,\r\n                            textSecondaryColor: theme.textSec,\r\n                            textDimColor: theme.textDim,\r\n                            accentColor: theme.accent,\r\n                            lastThemeRotation: now\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // bg\r\n        if (settings.backgroundRotation) {\r\n            const lastRotation = settings.lastBackgroundRotation || 0;\r\n            if (now - lastRotation >= TWO_DAYS) {\r\n                const presets = (window.SITE_CONFIG?.backgroundPresets || []).filter(p => p.id !== 'none' && p.id !== 'custom');\r\n                if (presets.length > 0) {\r\n                    let randomPreset;\r\n                    if (presets.length > 1) {\r\n                        let attempts = 0;\r\n                        const currentId = settings.customBackground?.id;\r\n                        do {\r\n                            randomPreset = presets[Math.floor(Math.random() * presets.length)];\r\n                            attempts++;\r\n                        } while (randomPreset.id === currentId && attempts < 5);\r\n                    } else {\r\n                        randomPreset = presets[0];\r\n                    }\r\n                    if (randomPreset) {\r\n                        window.Settings.update({\r\n                            customBackground: randomPreset,\r\n                            lastBackgroundRotation: now\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    if (document.readyState === 'loading') {\r\n        document.addEventListener('DOMContentLoaded', checkRotation);\r\n    } else {\r\n        checkRotation();\r\n    }\r\n})();\r\n\n</script>\n    <script>\nconst FeaturedGames = {\r\n    games: [\r\n        { name: 'Fortnite', icon: 'fa-solid fa-crosshairs', url: 'pages/player.html?type=game&title=Fortnite&url=https://nowgg.fun/apps/aptoide/5874/aptoide.html?deep_link=aptoidesearch://com.epicgames.fortnite' },\r\n        { name: 'Games', icon: 'fa-solid fa-gamepad', url: 'pages/games.html' },\r\n        { name: 'Movies', icon: 'fa-solid fa-film', url: 'pages/movies.html' },\r\n        { name: 'PhantomAI', icon: 'fa-solid fa-robot', url: 'pages/chat.html' },\r\n        { name: 'Music', icon: 'fa-solid fa-music', url: 'pages/music.html' },\r\n        { name: 'Roblox', icon: 'fa-solid fa-cubes', url: 'pages/player.html?type=game&title=Roblox&url=https://nowgg.fun/apps/aptoide/5874/aptoide.html?deep_link=aptoidesearch://roblox.com.roblox' },\r\n        { name: 'Settings', icon: 'fa-solid fa-cog', url: 'pages/settings.html' },\r\n        { name: 'Retro Bowl', gameName: 'Retro Bowl' },\r\n        { name: 'Geometry Dash', gameName: 'Geometry Dash Lite (REMAKE)' },\r\n        { name: 'OvO', gameName: 'ovofixxed' },\r\n        { name: 'Basket Random', gameName: 'Basket Random' },\r\n        { name: 'Code Runner', icon: 'fa-solid fa-code', url: 'pages/code.html' }\r\n    ],\r\n\r\n    async load() {\r\n        try {\r\n            const data = await (await fetch(\"https://cdn.jsdelivr.net/gh/gn-math/assets@latest/zones.json\")).json();\r\n            const map = new Map(data.map(g => [\r\n                (g.name || g.title).replace(/\\.html$|-a\\.html$/i, '').replace(/[-_]/g, ' ').replace(/([a-z])([A-Z])/g, '$1 $2').replace(/\\b\\w/g, l => l.toUpperCase()).trim(),\r\n                (g.url || g.file)?.replace('{HTML_URL}', \"https://cdn.jsdelivr.net/gh/gn-math/html@main\").replace('-a.html', '.html')\r\n            ]));\r\n\r\n            const preloads = this.games.map(async g => {\r\n                if (!g.gameName) return;\r\n                const url = map.get(g.gameName);\r\n                if (url) {\r\n                    g.url = `pages/player.html?type=game&title=${encodeURIComponent(g.name)}&url=${encodeURIComponent(url)}`;\r\n                    g.img = `https://cdn.jsdelivr.net/gh/gn-math/assets@latest/images/${g.gameName.toLowerCase().replace(/\\s+/g, '-')}.png`;\r\n\r\n                    // Trigger preload without blocking the map\r\n                    const img = new Image();\r\n                    img.src = g.img;\r\n                } else {\r\n                    g.url = 'pages/games.html'; g.icon = 'fa-solid fa-gamepad';\r\n                }\r\n            });\r\n            await Promise.all(preloads);\r\n        } catch (e) {\r\n            console.error(e);\r\n            this.games.forEach(g => g.gameName && (g.url = 'pages/games.html', g.icon = 'fa-solid fa-gamepad'));\r\n        }\r\n    }\r\n};\r\n\r\nwindow.FeaturedGames = FeaturedGames;\n</script>\n    <script>\n/**\r\n * This file dynamically loads the UGS (Unblocked Games) library from the external source.\r\n * Source: https://github.com/bubbls/ugs-singlefile/blob/main/games.js\r\n */\r\n\r\nwindow.UGS_FILES_PROMISE = (async () => {\r\n    try {\r\n        // Use JSDelivr CDN for fast and reliable access to the GitHub file\r\n        const response = await fetch('https://cdn.jsdelivr.net/gh/bubbls/ugs-singlefile@main/games.js');\r\n        if (!response.ok) throw new Error('CDN response not OK');\r\n\r\n        const text = await response.text();\r\n\r\n        // Extract the 'files' array from the source code\r\n        // The source format is: const files = [ ... ];\r\n        const match = text.match(/const files = (\\[[\\s\\S]*?\\]);/);\r\n\r\n        if (match && match[1]) {\r\n            // Evaluates the array string into a real JavaScript array\r\n            // We use eval here because we are fetching a trusted script literal\r\n            const files = eval(match[1]);\r\n            window.UGS_FILES = files;\r\n            console.log(`[UGS] Successfully loaded ${files.length} games from CDN.`);\r\n            return files;\r\n        } else {\r\n            throw new Error('Could not parse files array from source');\r\n        }\r\n    } catch (error) {\r\n        console.error('[UGS] Failed to load games from CDN:', error);\r\n        window.UGS_FILES = window.UGS_FILES || [];\r\n        return window.UGS_FILES;\r\n    }\r\n})();\r\n\n</script>\n    <script>\nconst ZONES_1_URL = \"https://cdn.jsdelivr.net/gh/gn-math/assets@latest/zones.json\";\r\nconst HTML_PREFIX_1 = \"https://cdn.jsdelivr.net/gh/gn-math/html@main\";\r\nconst COVER_PREFIX_1 = \"https://cdn.jsdelivr.net/gh/gn-math/covers@main\";\r\nconst UGS_PREFIX = \"https://cdn.jsdelivr.net/gh/bubbls/ugs-singlefile/UGS-Files/\";\r\n\r\nconst Gloader = {\r\n    CACHE_KEY: 'phantom_games_cache',\r\n    EXPIRY_MS: 7 * 24 * 60 * 60 * 1000, // 7 Days\r\n\r\n    async load(lib = 'multi') {\r\n        const cached = localStorage.getItem(this.CACHE_KEY);\r\n        if (cached) {\r\n            try {\r\n                const { timestamp, data } = JSON.parse(cached);\r\n                if (Date.now() - timestamp < this.EXPIRY_MS && data.length > 0) {\r\n                    return data;\r\n                }\r\n            } catch (e) {\r\n                console.warn('Cache parse failed', e);\r\n            }\r\n        }\r\n\r\n        const games = await this.fetchGames(lib);\r\n        try {\r\n            localStorage.setItem(this.CACHE_KEY, JSON.stringify({\r\n                timestamp: Date.now(),\r\n                data: games\r\n            }));\r\n        } catch (e) {\r\n            console.warn('Cache write failed (storage full?)', e);\r\n        }\r\n        return games;\r\n    },\r\n\r\n    async fetchGames(lib) {\r\n        if (lib === 'lib1' || lib === 'gnmath') return this.loadGnmath();\r\n        if (lib === 'lib2' || lib === 'ugs') return this.loadUGS();\r\n\r\n        const [g, u] = await Promise.all([this.loadGnmath(), this.loadUGS()]);\r\n        return [...g, ...u];\r\n    },\r\n\r\n    async loadGnmath() {\r\n        try {\r\n            const res = await fetch(ZONES_1_URL);\r\n            const data = await res.json();\r\n            return data.map(g => ({\r\n                name: this.formatName((g.name || g.title).replace('-a.html', '')),\r\n                url: (g.url || g.file)?.replace('{HTML_URL}', HTML_PREFIX_1).replace('-a.html', '.html'),\r\n                img: (g.cover || g.img || g.image)?.replace('{COVER_URL}', COVER_PREFIX_1),\r\n                type: 'gnmath',\r\n                normalized: this.normalize(g.name || g.title)\r\n            }));\r\n        } catch (e) {\r\n            console.error('Gnmath load failed', e);\r\n            return [];\r\n        }\r\n    },\r\n\r\n    async loadUGS() {\r\n        if (!window.UGS_FILES && window.UGS_FILES_PROMISE) {\r\n            await window.UGS_FILES_PROMISE;\r\n        }\r\n        if (!window.UGS_FILES) return [];\r\n        return window.UGS_FILES.map(file => {\r\n            const name = file.replace(/^cl/i, '');\r\n            return {\r\n                name: this.formatName(name),\r\n                url: `${UGS_PREFIX}${encodeURIComponent(file.includes('.') ? file : file + '.html')}`,\r\n                type: 'ugs',\r\n                normalized: this.normalize(name)\r\n            };\r\n        });\r\n    },\r\n\r\n    formatName(name) {\r\n        return name ? name.replace(/\\.html$/i, '')\r\n            .replace(/[-_]/g, ' ')\r\n            .replace(/([a-z])([A-Z])/g, '$1 $2')\r\n            .replace(/\\(\\d+\\)$/, '')\r\n            .replace(/\\b\\w/g, l => l.toUpperCase())\r\n            .trim() : '';\r\n    },\r\n\r\n    normalize(name) {\r\n        return name ? name.toLowerCase().replace(/[^a-z0-9]/g, '').trim() : '';\r\n    }\r\n};\r\n\r\nwindow.Gloader = Gloader;\r\n\n</script>\n    <script>\nconst PhantomSearch = {\r\n    inputEl: null,\r\n    dropdownEl: null,\r\n    suggestions: [],\r\n    selectedIndex: 0,\r\n    isOpen: false,\r\n    allGames: [],\r\n    rootPrefix: '',\r\n    searchTimeout: null,\r\n    movieCache: {},\r\n\r\n    pages: [\r\n        { name: 'Games', url: 'pages/games.html', icon: 'fa-gamepad', type: 'page', keywords: ['all games', 'play games', 'unblocked games', 'game library'] },\r\n        { name: 'Movies & TV', url: 'pages/movies.html', icon: 'fa-film', type: 'page', keywords: ['netflix', 'streaming', 'shows', 'tv', 'watch'] },\r\n        { name: 'AI Chatbot', url: 'pages/chatbot.html', icon: 'fa-robot', type: 'page', keywords: ['chat', 'gpt', 'phantomai', 'bot', 'ai'] },\r\n        { name: 'Code Editor', url: 'pages/code.html', icon: 'fa-code', type: 'page', keywords: ['coding', 'ide', 'editor', 'html', 'js', 'javascript'] },\r\n        { name: 'Music', url: 'pages/music.html', icon: 'fa-music', type: 'page', keywords: ['songs', 'spotify', 'audio', 'beats', 'listen'] },\r\n        { name: 'Settings', url: 'pages/settings.html', icon: 'fa-gear', type: 'page', keywords: ['preferences', 'cloak', 'panic', 'theme', 'options'] },\r\n        { name: 'Disclaimer', url: 'pages/disclaimer.html', icon: 'fa-scale-balanced', type: 'page', keywords: ['legal', 'notice'] },\r\n        { name: 'Terms of Service', url: 'pages/terms.html', icon: 'fa-file-contract', type: 'page', keywords: ['tos', 'rules'] }\r\n    ],\r\n\r\n    popularDomains: [\r\n        { domain: 'google.com', name: 'Google' }, { domain: 'youtube.com', name: 'YouTube' },\r\n        { domain: 'tiktok.com', name: 'TikTok' }, { domain: 'chatgpt.com', name: 'ChatGPT' },\r\n        { domain: 'roblox.com', name: 'Roblox', isGame: true }, { domain: 'discord.com', name: 'Discord' },\r\n        { domain: 'spotify.com', name: 'Spotify' }, { domain: 'twitch.tv', name: 'Twitch' },\r\n        { domain: 'poki.com', name: 'Poki' }, { domain: 'crazygames.com', name: 'CrazyGames' },\r\n        { domain: 'coolmathgames.com', name: 'CoolMathGames' }, { domain: 'chess.com', name: 'Chess.com' },\r\n        { domain: 'geoguessr.com', name: 'GeoGuessr' }, { domain: 'amazon.com', name: 'Amazon' },\r\n        { domain: 'github.com', name: 'GitHub' }, { domain: 'x.com', name: 'X (Twitter)' },\r\n        { domain: 'instagram.com', name: 'Instagram' }, { domain: 'wikipedia.org', name: 'Wikipedia' }\r\n    ],\r\n\r\n    async init(inputId) {\r\n        this.inputEl = document.getElementById(inputId);\r\n        if (!this.inputEl) return;\r\n\r\n        const script = document.currentScript || Array.from(document.querySelectorAll('script')).find(s => s.src.includes('scripts/search.js'));\r\n        if (script && script.src.includes('scripts/search.js')) {\r\n            this.rootPrefix = script.src.split('scripts/search.js')[0];\r\n        }\r\n\r\n        this.createDropdown();\r\n        this.inputEl.addEventListener('input', (e) => this.onInput(e));\r\n        this.inputEl.addEventListener('keydown', (e) => this.onKeydown(e));\r\n        this.inputEl.addEventListener('focus', () => this.onFocus());\r\n        document.addEventListener('click', (e) => this.onClickOutside(e));\r\n\r\n        // Use Gloader for data\r\n        if (window.Gloader) {\r\n            this.allGames = await window.Gloader.load();\r\n        } else {\r\n            console.warn('Gloader not found');\r\n        }\r\n    },\r\n\r\n    createDropdown() {\r\n        this.dropdownEl = document.createElement('div');\r\n        this.dropdownEl.className = 'search-autocomplete';\r\n        this.dropdownEl.role = 'listbox';\r\n        const container = this.inputEl.closest('.search-container') || this.inputEl.parentElement;\r\n        container.style.position = 'relative';\r\n        container.appendChild(this.dropdownEl);\r\n    },\r\n\r\n    onInput(e) {\r\n        const query = e.target.value.trim();\r\n        if (!query) { this.hide(); return; }\r\n        this.search(query);\r\n        clearTimeout(this.searchTimeout);\r\n        this.searchTimeout = setTimeout(() => {\r\n            if (query.length >= 2) this.fetchExternalResults(query);\r\n        }, 300);\r\n    },\r\n\r\n    onFocus() {\r\n        if (this.inputEl.value.trim().length > 0 && this.suggestions.length > 0) this.show();\r\n    },\r\n\r\n    onKeydown(e) {\r\n        if (!this.isOpen) return;\r\n        if (e.key === 'ArrowDown') {\r\n            e.preventDefault();\r\n            this.selectedIndex = Math.min(this.selectedIndex + 1, this.suggestions.length - 1);\r\n            this.updateSelection();\r\n        } else if (e.key === 'ArrowUp') {\r\n            e.preventDefault();\r\n            this.selectedIndex = Math.max(this.selectedIndex - 1, 0);\r\n            this.updateSelection();\r\n        } else if (e.key === 'Enter') {\r\n            e.preventDefault();\r\n            if (this.suggestions.length) this.selectItem(this.suggestions[this.selectedIndex]);\r\n        } else if (e.key === 'Escape') this.hide();\r\n    },\r\n\r\n    onClickOutside(e) {\r\n        if (!this.dropdownEl.contains(e.target) && e.target !== this.inputEl) this.hide();\r\n    },\r\n\r\n    search(query, externalResults = null) {\r\n        const q = query.toLowerCase();\r\n        const results = [];\r\n        const seen = new Set();\r\n        const add = (item) => {\r\n            if (seen.has(item.name)) return; // Simple dedup by name for now\r\n            seen.add(item.name);\r\n            results.push(item);\r\n        };\r\n\r\n        // 1. GAMES & PAGES (High Priority)\r\n        this.allGames\r\n            .filter(g => g.name.toLowerCase().includes(q) || (g.normalized && g.normalized.includes(q)))\r\n            .sort((a, b) => { // Basic relevance sort\r\n                const aName = a.name.toLowerCase();\r\n                const bName = b.name.toLowerCase();\r\n\r\n                // Prioritize exact matches\r\n                if (aName === q && bName !== q) return -1;\r\n                if (bName === q && aName !== q) return 1;\r\n\r\n                // Prioritize startsWith\r\n                const aStarts = aName.startsWith(q);\r\n                const bStarts = bName.startsWith(q);\r\n                if (aStarts && !bStarts) return -1;\r\n                if (bStarts && !aStarts) return 1;\r\n\r\n                // Secondary sort: Gnmath (source='gnmath') over UGS (source='ugs')\r\n                if (a.source === 'gnmath' && b.source !== 'gnmath') return -1;\r\n                if (b.source === 'gnmath' && a.source !== 'gnmath') return 1;\r\n\r\n                return 0;\r\n            })\r\n            .slice(0, 3) // Limit to 3 games\r\n            .forEach(g => {\r\n                // Treat gnmath and ugs as 'game' for both label and URL construction\r\n                if (g.type === 'gnmath' || g.type === 'ugs' || g.type === 'game') {\r\n                    const normalized = g.normalized || g.name.toLowerCase().replace(/[^a-z0-9]/g, '');\r\n                    const finalUrl = `${this.rootPrefix}pages/games.html?gamename=${normalized}`;\r\n                    // Overwrite type to 'game' so the label renderer shows \"Game\"\r\n                    add({ ...g, url: finalUrl, type: 'game' });\r\n                } else {\r\n                    // Fallback for unknown types (though unlikely based on gloader)\r\n                    const finalUrl = g.url.startsWith('http') ? g.url : this.rootPrefix + g.url;\r\n                    add({ ...g, url: finalUrl });\r\n                }\r\n            });\r\n\r\n        this.pages\r\n            .filter(p => p.name.toLowerCase().includes(q) || (p.keywords && p.keywords.some(k => k.includes(q))))\r\n            .forEach(p => add({ ...p, url: this.rootPrefix + p.url }));\r\n\r\n        // 2. DOMAINS (User requested Priority)\r\n        this.popularDomains\r\n            .filter(d => d.domain.includes(q) || d.name.toLowerCase().includes(q))\r\n            .slice(0, 2)\r\n            .forEach(d => add({\r\n                name: d.name, type: 'domain', icon: 'fa-globe',\r\n                url: d.url || `${this.rootPrefix}staticsjv2/index.html#${encodeURIComponent('https://' + d.domain)}`\r\n            }));\r\n\r\n        // 3. MOVIES & TV (Strict Limits: Max 2 Movies, Max 1 TV)\r\n        if (externalResults) {\r\n            const movies = [];\r\n            const tvs = [];\r\n            externalResults.forEach(m => {\r\n                const type = m.media_type || 'movie';\r\n                const item = {\r\n                    name: m.title || m.name,\r\n                    id: m.id,\r\n                    overview: m.overview,\r\n                    media_type: type, // 'movie' or 'tv'\r\n                    type: type,\r\n                    img: m.poster_path ? 'https://image.tmdb.org/t/p/w92' + m.poster_path : null,\r\n                    url: `${this.rootPrefix}pages/player.html?type=${type}&id=${m.id}&title=${encodeURIComponent(m.title || m.name)}`\r\n                };\r\n                if (type === 'movie') movies.push(item);\r\n                else if (type === 'tv') tvs.push(item);\r\n            });\r\n\r\n            // Add Max 2 Movies\r\n            movies.slice(0, 2).forEach(m => add(m));\r\n            // Add Max 1 TV\r\n            tvs.slice(0, 1).forEach(t => add(t));\r\n        }\r\n\r\n        const MAX_TOTAL = 6;\r\n        let finalSuggestions = results.slice(0, MAX_TOTAL);\r\n\r\n        // Always add Web Search\r\n        finalSuggestions.push({\r\n            name: `Search the web for \"${query}\"`,\r\n            query: query,\r\n            type: 'web',\r\n            icon: 'fa-search'\r\n        });\r\n\r\n        this.suggestions = finalSuggestions;\r\n        this.render();\r\n        this.show();\r\n    },\r\n\r\n    async fetchExternalResults(query) {\r\n        if (this.movieCache[query]) {\r\n            this.search(query, this.movieCache[query]);\r\n            return;\r\n        }\r\n        const API_KEY = window.API_KEY || '2713804610e1e236b1cf44bfac3a7776';\r\n        try {\r\n            const res = await fetch(`https://api.themoviedb.org/3/search/multi?api_key=${API_KEY}&query=${encodeURIComponent(query)}&include_adult=false`);\r\n            const data = await res.json();\r\n            const valid = data.results.filter(r => (r.media_type === 'movie' || r.media_type === 'tv') && r.poster_path);\r\n            this.movieCache[query] = valid;\r\n            this.search(query, valid);\r\n        } catch (e) {\r\n            console.warn('External search failed', e);\r\n        }\r\n    },\r\n\r\n    render() {\r\n        if (!this.suggestions.length) { this.dropdownEl.innerHTML = ''; return; }\r\n        const labels = { game: 'Game', page: 'Page', movie: 'Movie', tv: 'TV Show', domain: 'Website', web: 'Search' };\r\n\r\n        this.dropdownEl.innerHTML = this.suggestions.map((item, i) => {\r\n            const icon = item.img ?\r\n                `<img src=\"${item.img}\" class=\"search-autocomplete-thumb\" alt=\"\">` :\r\n                `<i class=\"fa-solid ${item.icon || 'fa-gamepad'}\"></i>`;\r\n\r\n            return `\r\n                <div class=\"search-autocomplete-item${i === this.selectedIndex ? ' selected' : ''}\" data-index=\"${i}\">\r\n                    <span class=\"search-autocomplete-icon\">${icon}</span>\r\n                    <span class=\"search-autocomplete-text\">${this.escapeHtml(item.name)}</span>\r\n                    <span class=\"search-autocomplete-type\">${labels[item.type] || 'Result'}</span>\r\n                </div>`;\r\n        }).join('');\r\n\r\n        this.dropdownEl.querySelectorAll('.search-autocomplete-item').forEach((el, i) => {\r\n            el.onclick = () => this.selectItem(this.suggestions[i]);\r\n            el.onmouseenter = () => { this.selectedIndex = i; this.updateSelection(); };\r\n        });\r\n    },\r\n\r\n    updateSelection() {\r\n        this.dropdownEl.querySelectorAll('.search-autocomplete-item').forEach((el, i) =>\r\n            el.classList.toggle('selected', i === this.selectedIndex));\r\n    },\r\n\r\n    selectItem(item) {\r\n        this.hide();\r\n        if (item.type === 'web') {\r\n            const isUrl = item.query.includes('.') && !item.query.includes(' ');\r\n            const url = isUrl ? (item.query.startsWith('http') ? item.query : 'https://' + item.query) :\r\n                'https://search.brave.com/search?q=' + encodeURIComponent(item.query);\r\n            window.location.href = this.rootPrefix + 'staticsjv2/index.html#' + encodeURIComponent(url);\r\n        } else if (item.url) {\r\n            if (item.type === 'movie' || item.type === 'tv') {\r\n                const mediaData = {\r\n                    id: item.id, title: item.name, overview: item.overview,\r\n                    media_type: item.media_type\r\n                };\r\n                sessionStorage.setItem('currentMovie', JSON.stringify(mediaData));\r\n                if (item.type === 'tv' && !item.url.includes('season=')) item.url += '&season=1&episode=1';\r\n            }\r\n            window.location.href = item.url;\r\n        }\r\n    },\r\n\r\n    show() { this.isOpen = true; this.dropdownEl.classList.add('open'); },\r\n    hide() { this.isOpen = false; this.selectedIndex = 0; this.dropdownEl.classList.remove('open'); },\r\n    escapeHtml(t) { const d = document.createElement('div'); d.textContent = t; return d.innerHTML; }\r\n};\r\n\r\ndocument.addEventListener('DOMContentLoaded', () => PhantomSearch.init('search-input'));\r\nwindow.PhantomSearch = PhantomSearch;\r\n\n</script>\n    <script src=\"https://cdn.jsdelivr.net/gh/Destroyed12121/Staticsj@main/JS/scramjet.all.js\"></script>\n    <script type=\"module\">\n        import * as BareMux from \"https://cdn.jsdelivr.net/npm/@mercuryworkshop/bare-mux/dist/index.mjs\";\n        window.BareMux = BareMux;\n    </script>\n</head>\n\n<body>\n    <div class=\"offline-banner\" id=\"offline-banner\">\n        <i class=\"fa-solid fa-wifi-slash\"></i>\n        <span>You're offline</span>\n    </div>\n\n    <div class=\"home-page\">\n        <script>\n// topbar\r\n(function () {\r\n    let rootPrefix = '';\r\n    const scriptName = 'components/topbar.js';\r\n    const scripts = document.getElementsByTagName('script');\r\n    for (let i = 0; i < scripts.length; i++) {\r\n        const src = scripts[i].getAttribute('src');\r\n        if (src && src.includes(scriptName)) {\r\n            rootPrefix = src.split(scriptName)[0];\r\n            break;\r\n        }\r\n    }\r\n\r\n    if (!window.lucide && !document.querySelector('script[src*=\"lucide\"]')) {\r\n        const script = document.createElement('script');\r\n        script.src = 'https://unpkg.com/lucide@latest';\r\n        script.onload = () => {\r\n            if (window.lucide) lucide.createIcons();\r\n        };\r\n        document.head.appendChild(script);\r\n    }\r\n\r\n    initTopbar();\r\n\r\n    function createTopbar() {\r\n        const topbarContainer = document.createElement('div');\r\n        topbarContainer.id = 'topbar-container';\r\n\r\n        const logoSection = document.createElement('a');\r\n        logoSection.className = 'logo-section';\r\n        logoSection.href = rootPrefix + 'index2.html';\r\n        logoSection.innerHTML = '<div class=\"logo-placeholder\"><i data-lucide=\"zap\"></i></div>';\r\n        topbarContainer.appendChild(logoSection);\r\n\r\n        const navButtons = document.createElement('div');\r\n        navButtons.className = 'nav-buttons';\r\n\r\n        const buttons = [\r\n            { name: 'Music', icon: 'music', link: 'pages/music.html', badge: 'BETA' },\r\n            { name: 'Movies', icon: 'film', link: 'pages/movies.html' },\r\n            { name: 'Games', icon: 'gamepad-2', link: 'pages/games.html' },\r\n            { name: 'Watch', icon: 'play', link: 'pages/watch.html' },\r\n            { name: 'Search', icon: 'search', link: 'staticsjv2/index.html' },\r\n            { name: 'AI Chat', icon: 'bot', link: 'pages/chat.html' },\r\n            { separator: true },\r\n            { name: 'Settings', icon: 'settings', link: 'pages/settings.html' }\r\n        ];\r\n\r\n        buttons.forEach(btn => {\r\n            if (btn.separator) {\r\n                const separator = document.createElement('div');\r\n                separator.className = 'nav-separator';\r\n                navButtons.appendChild(separator);\r\n                return;\r\n            }\r\n\r\n            const link = document.createElement('a');   \r\n            link.href = rootPrefix + btn.link;\r\n            link.className = 'nav-btn';\r\n\r\n            const icon = document.createElement('i');\r\n            icon.setAttribute('data-lucide', btn.icon);\r\n            link.appendChild(icon);\r\n\r\n            const span = document.createElement('span');\r\n            span.textContent = btn.name;\r\n            link.appendChild(span);\r\n\r\n            if (btn.badge) {\r\n                const badge = document.createElement('div');\r\n                badge.className = 'nav-badge-beta';\r\n                badge.textContent = btn.badge;\r\n                link.appendChild(badge);\r\n            }\r\n\r\n            navButtons.appendChild(link);\r\n        });\r\n\r\n        topbarContainer.appendChild(navButtons);\r\n        document.body.prepend(topbarContainer);\r\n\r\n        if (window.lucide) {\r\n            lucide.createIcons();\r\n        }\r\n    }\r\n\r\n    function initTopbar() {\r\n        if (document.readyState === 'loading') {\r\n            document.addEventListener('DOMContentLoaded', createTopbar);\r\n        } else {\r\n            createTopbar();\r\n        }\r\n    }\r\n})();\r\n\n</script>\n\n        <main class=\"main-content\">\n            <h1 class=\"site-title\">Phantom Unblocked</h1>\n            <p class=\"site-subtitle\" id=\"subtitle\"></p>\n\n            <!-- Search Bar -->\n            <div class=\"search-container\">\n                <form class=\"search-bar\" onsubmit=\"handleSearch(event)\">\n                    <i class=\"fa-solid fa-search\"></i>\n                    <input type=\"text\" id=\"search-input\" placeholder=\"Search the web and games...\" autocomplete=\"off\">\n                </form>\n            </div>\n\n            <!-- Featured -->\n            <section class=\"featured-section\">\n                <div class=\"section-header\">\n                    <i class=\"fa-solid fa-star star-icon\"></i>\n                    <span class=\"section-title\">Featured</span>\n                </div>\n                <div class=\"featured-grid\" id=\"featured-grid\"></div>\n            </section>\n        </main>\n\n    </div>\n\n\n    <script>\n\n\n        // Featured games\n        (async () => {\n            await window.FeaturedGames.load();\n            const featuredGames = window.FeaturedGames.games || [];\n\n            const grid = document.getElementById('featured-grid');\n            if (!grid) return;\n\n            const fragment = document.createDocumentFragment();\n            featuredGames.forEach(g => {\n                const card = document.createElement('a');\n                card.href = g.url;\n                card.className = 'featured-card';\n                card.innerHTML = `\n                    <div class=\"featured-card-icon\" style=\"background: ${g.gameName ? 'transparent' : 'var(--surface-hover)'}; color: var(--text-muted);\">\n                        ${g.img ? `<img src=\"${g.img}\" loading=\"eager\" onerror=\"this.parentElement.innerHTML='<i class=\\\\'fa-solid fa-gamepad\\\\'></i>'\">` : `<i class=\"${g.icon}\"></i>`}\n                    </div>\n                    <div class=\"featured-card-title\">${g.name}</div>\n                `;\n                fragment.appendChild(card);\n            });\n            grid.appendChild(fragment);\n        })();\n\n\n\n        // Theme notification\n        window.addEventListener('load', () => {\n            setTimeout(() => {\n                if (window.Notify) {\n                    window.Notify.info(\"Appearance\", \"Don't like your theme? Change it in settings!\", 6000);\n                }\n            }, 1500);\n        });\n    </script>\n\n    <script>\n// footer\r\n(function () {\r\n    'use strict';\r\n\r\n    let rootPrefix = '';\r\n    const scriptName = 'components/footer.js';\r\n    const scripts = document.getElementsByTagName('script');\r\n    for (let i = 0; i < scripts.length; i++) {\r\n        const src = scripts[i].getAttribute('src');\r\n        if (src && src.includes(scriptName)) {\r\n            rootPrefix = src.split(scriptName)[0];\r\n            break;\r\n        }\r\n    }\r\n\r\n    const config = window.SITE_CONFIG || { name: 'Phantom', version: '1.0.0', discord: { inviteUrl: '#' }, changelog: [], cloakPresets: [] };\r\n    const STORAGE_KEY = 'void_settings';\r\n    let storedSettings = {};\r\n    try { storedSettings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n\r\n    // settings\r\n    let settings = { ...(config.defaults || {}), ...storedSettings };\r\n\r\n    const footer = document.createElement('footer');\r\n    footer.id = 'site-footer';\r\n    footer.innerHTML = `\r\n        <style>\r\n            #site-footer {\r\n                margin-top: 0px;\r\n                padding: 20px;\r\n                border-top: 1px solid var(--border, #1f1f1f);\r\n                text-align: center;\r\n                background: transparent;\r\n            }\r\n            #site-footer .footer-links {\r\n                display: flex;\r\n                gap: 16px;\r\n                justify-content: center;\r\n                margin-bottom: 8px;\r\n                flex-wrap: wrap;\r\n            }\r\n            #site-footer .footer-link {\r\n                font-size: 12px;\r\n                color: var(--text-muted, #71717a);\r\n                text-decoration: none;\r\n                transition: color 0.15s;\r\n                font-family: 'Inter', sans-serif;\r\n                cursor: pointer;\r\n            }\r\n            #site-footer .footer-link:hover {\r\n                color: var(--text, #e4e4e7);\r\n            }\r\n            #site-footer .footer-version {\r\n                font-size: 11px;\r\n                color: var(--text-dim, #52525b);\r\n                cursor: pointer;\r\n                font-family: 'Inter', sans-serif;\r\n            }\r\n            #site-footer .footer-version:hover {\r\n                color: var(--text-muted, #71717a);\r\n            }\r\n        </style>\r\n        <div class=\"footer-links\">\r\n            <a href=\"${rootPrefix}pages/settings.html\" class=\"footer-link\"><i class=\"fa-solid fa-gear\"></i> Settings</a>\r\n            <a id=\"footer-changelog\" class=\"footer-link\"><i class=\"fa-solid fa-clock-rotate-left\"></i> Changelog</a>\r\n            <a href=\"${config.discord?.inviteUrl || '#'}\" target=\"_blank\" class=\"footer-link\"><i class=\"fa-brands fa-discord\"></i> Discord</a>\r\n            <a href=\"${rootPrefix}pages/terms.html\" class=\"footer-link\">Terms</a>\r\n            <a href=\"${rootPrefix}pages/disclaimer.html\" class=\"footer-link\">Disclaimer</a>\r\n            <a href=\"${rootPrefix}pages/extra.html\" class=\"footer-link\">Credits</a>\r\n        </div>\r\n        <span class=\"footer-version\" id=\"footer-version\">${config.name || 'Phantom'} v${config.version || '1.0.0'}</span>\r\n    `;\r\n\r\n    document.body.appendChild(footer);\r\n\r\n\r\n\r\n    // gtm\r\n    // Inject GTM head script if not already present\r\n    if (!document.querySelector('script[src*=\"googletagmanager.com/gtm.js\"]')) {\r\n        window.dataLayer = window.dataLayer || [];\r\n        window.dataLayer.push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' });\r\n        const gtmScript = document.createElement('script');\r\n        gtmScript.async = true;\r\n        gtmScript.src = 'https://www.googletagmanager.com/gtm.js?id=GTM-5LMBC27Z';\r\n        document.head.insertBefore(gtmScript, document.head.firstChild);\r\n    }\r\n\r\n    // Add GTM noscript fallback (for pages that don't have it in HTML)\r\n    if (!document.querySelector('noscript iframe[src*=\"googletagmanager\"]')) {\r\n        const gtmNoscript = document.createElement('noscript');\r\n        gtmNoscript.innerHTML = '<iframe src=\"https://www.googletagmanager.com/ns.html?id=GTM-5LMBC27Z\" height=\"0\" width=\"0\" style=\"display:none;visibility:hidden\"></iframe>';\r\n        document.body.insertBefore(gtmNoscript, document.body.firstChild);\r\n    }\r\n\r\n    const openChangelog = (e, customTitle, customContent) => {\r\n        if (e && e.preventDefault) e.preventDefault();\r\n        const changes = customContent || config.changelog || ['No changes listed'];\r\n\r\n        // Use standard modal structure from main.css\r\n        const overlay = document.createElement('div');\r\n        overlay.className = 'modal-overlay';\r\n\r\n        overlay.innerHTML = `\r\n            <div class=\"modal\" style=\"width: 400px; max-width: 90vw;\">\r\n                <div class=\"modal-header\">\r\n                    <h3 class=\"modal-title\">${customTitle || 'What\\'s New in v' + config.version}</h3>\r\n                    <button class=\"modal-close\"><i class=\"fa-solid fa-xmark\"></i></button>\r\n                </div>\r\n                <div class=\"modal-body\">\r\n                    <ul style=\"margin: 0; padding-left: 20px; color: var(--text-muted); font-size: 0.875rem; line-height: 1.6;\">\r\n                        ${changes.map(c => '<li>' + c + '</li>').join('')}\r\n                    </ul>\r\n                </div>\r\n                <div class=\"modal-footer\">\r\n                    <a href=\"${config.discord?.inviteUrl || '#'}\" target=\"_blank\" style=\"color: #5865F2; text-decoration: none; font-size: 13px; display: inline-flex; align-items: center; gap: 6px;\">\r\n                        <i class=\"fa-brands fa-discord\"></i> Join Discord\r\n                    </a>\r\n                </div>\r\n            </div>\r\n        `;\r\n\r\n        document.body.appendChild(overlay);\r\n\r\n        // Trigger animation\r\n        requestAnimationFrame(() => overlay.classList.add('show'));\r\n\r\n        const close = () => {\r\n            overlay.classList.remove('show');\r\n            setTimeout(() => overlay.remove(), 200);\r\n        };\r\n\r\n        overlay.querySelector('.modal-close').onclick = close;\r\n        overlay.onclick = (e) => { if (e.target === overlay) close(); };\r\n    };\r\n\r\n    // Expose openChangelog globally\r\n    window.openChangelog = openChangelog;\r\n\r\n    const changelogBtn = document.getElementById('footer-changelog');\r\n    if (changelogBtn) changelogBtn.onclick = openChangelog;\r\n\r\n    const versionBtn = document.getElementById('footer-version');\r\n    if (versionBtn) versionBtn.onclick = openChangelog;\r\n\r\n    // sync\r\n    // syncRemoteChangelog removed - using local config\r\n\r\n\r\n    // Initialize Sync\r\n    // syncRemoteChangelog();\r\n\r\n    const currentVersion = config.version;\r\n    const lastVersion = settings.lastVersion;\r\n\r\n    if (settings.showChangelogOnUpdate && lastVersion && lastVersion !== currentVersion) {\r\n        setTimeout(() => {\r\n            openChangelog();\r\n            settings.lastVersion = currentVersion;\r\n            localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n        }, 1000);\r\n    } else if (!lastVersion) {\r\n        settings.lastVersion = currentVersion;\r\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n    }\r\n\r\n    // panic\r\n    if (settings.panicKey) {\r\n        document.addEventListener('keydown', (e) => {\r\n            const keys = settings.panicModifiers || ['ctrl', 'shift'];\r\n            const triggerKey = settings.panicKey.toLowerCase();\r\n            const pressedKey = e.key.toLowerCase();\r\n\r\n            // Check modifiers\r\n            const ctrlMatch = keys.includes('ctrl') === e.ctrlKey;\r\n            const shiftMatch = keys.includes('shift') === e.shiftKey;\r\n            const altMatch = keys.includes('alt') === e.altKey;\r\n\r\n            if (ctrlMatch && shiftMatch && altMatch && pressedKey === triggerKey) {\r\n                e.preventDefault();\r\n\r\n                // Show white screen instantly (if panic-overlay exists in parent)\r\n                const parentOverlay = window.parent?.document?.getElementById('panic-overlay');\r\n                if (parentOverlay) {\r\n                    parentOverlay.style.display = 'block';\r\n                } else {\r\n                    // Create overlay if it doesn't exist\r\n                    const overlay = document.createElement('div');\r\n                    overlay.id = 'panic-overlay';\r\n                    overlay.style.cssText = 'position:fixed;inset:0;background:white;z-index:99999;';\r\n                    document.body.appendChild(overlay);\r\n                }\r\n\r\n                // Redirect immediately\r\n                const url = settings.panicUrl || 'https://classroom.google.com';\r\n                try { window.top.location.href = url; } catch { window.location.href = url; }\r\n            }\r\n        }, true); // Use capture phase for faster response\r\n    }\r\n\r\n    // Cloaking logic has been moved to scripts/cloaking.js for better synchronization.\r\n    // If you need cloaking on a specific page, include that script.\r\n\r\n\r\n    window.addEventListener('beforeunload', (e) => {\r\n        // Reload settings to get latest value\r\n        try { settings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n\r\n        if (window.top === window.self && settings.leaveConfirmation) {\r\n            e.preventDefault();\r\n            e.returnValue = '';\r\n            return '';\r\n        }\r\n    });\r\n\r\n    // discord\r\n    let crateInstance = null;\r\n\r\n    function initDiscord() {\r\n        if (settings.discordWidget && config.discord && config.discord.widgetServer && config.discord.widgetChannel) {\r\n            // Check if already loaded\r\n            if (document.querySelector('script[src*=\"@widgetbot/crate\"]')) {\r\n                if (crateInstance) crateInstance.show();\r\n                return;\r\n            }\r\n\r\n            const crateScript = document.createElement('script');\r\n            crateScript.src = 'https://cdn.jsdelivr.net/npm/@widgetbot/crate@3';\r\n            crateScript.async = true;\r\n            crateScript.defer = true;\r\n            crateScript.onload = () => {\r\n                crateInstance = new Crate({\r\n                    server: config.discord.widgetServer,\r\n                    channel: config.discord.widgetChannel,\r\n                    glyph: ['https://cdn.discordapp.com/embed/avatars/0.png', '100%'],\r\n                    location: ['bottom', 'right']\r\n                });\r\n            };\r\n            document.body.appendChild(crateScript);\r\n        } else {\r\n            // Hide if disabled\r\n            if (crateInstance) crateInstance.hide();\r\n        }\r\n    }\r\n\r\n    // Initialize\r\n    initDiscord();\r\n\r\n    // Listen for settings change to toggle dynamically\r\n    window.addEventListener('storage', (e) => {\r\n        if (e.key === STORAGE_KEY) {\r\n            try { settings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n            initDiscord();\r\n        }\r\n    });\r\n\r\n    // Listen for internal event\r\n    window.addEventListener('settings-changed', (e) => {\r\n        settings = e.detail;\r\n        initDiscord();\r\n    });\r\n\r\n    // counters\r\n    // Only show on home page (index2.html) checking if main-content exists\r\n    const mainContent = document.querySelector('.main-content');\r\n    // Ensure we are on the home page view (search bar checks etc) or just check existence\r\n    if (mainContent && document.querySelector('.featured-section')) {\r\n        const counterContainer = document.createElement('div');\r\n        counterContainer.id = 'supercounters-wrapper';\r\n        counterContainer.style.marginTop = '24px';\r\n        counterContainer.style.textAlign = 'center';\r\n        counterContainer.style.opacity = '0.8';\r\n\r\n        // Use iframe to isolate document.write from the widget\r\n        const iframe = document.createElement('iframe');\r\n        iframe.style.border = 'none';\r\n        iframe.style.width = '150px';\r\n        iframe.style.height = '40px';\r\n        iframe.style.overflow = 'hidden';\r\n\r\n        // Widget code\r\n        const widgetCode = `\r\n            <html>\r\n            <body style=\"margin:0;display:flex;justify-content:center;align-items:center;background:transparent;\">\r\n                <script type=\"text/javascript\" src=\"//widget.supercounters.com/ssl/online_i.js\"><\\/script>\r\n                <script type=\"text/javascript\">sc_online_i(1726449,\"ffffff\",\"000000\");<\\/script>\r\n            </body>\r\n            </html>\r\n        `;\r\n\r\n        iframe.srcdoc = widgetCode;\r\n        counterContainer.appendChild(iframe);\r\n        mainContent.appendChild(counterContainer);\r\n    }\r\n})();\r\n\n</script>\n    <script>\n// proxy\n\nconst ProxyInit = {\n    DEFAULT_WISP: window.SITE_CONFIG?.defaultWisp || \"wss://glseries.net/wisp/\",\n    WISP_SERVERS: window.SITE_CONFIG?.wispServers || [],\n    BASE_PATH: (window.STATICSJ_BASE_PATH || \"/staticsjv2/\").replace(/\\/?$/, '/'),\n\n    async ping(url, timeout = 2000) {\n        return new Promise(res => {\n            const start = Date.now();\n            try {\n                const ws = new WebSocket(url);\n                const timer = setTimeout(() => { try { ws.close(); } catch { } res({ url, success: false }); }, timeout);\n                ws.onopen = () => { clearTimeout(timer); const latency = Date.now() - start; try { ws.close(); } catch { } res({ url, success: true, latency }); };\n                ws.onerror = () => { clearTimeout(timer); res({ url, success: false }); };\n            } catch { res({ url, success: false }); }\n        });\n    },\n\n    async findBest() {\n        if (localStorage.getItem('wispAutoswitch') === 'false' || !this.WISP_SERVERS.length) return localStorage.getItem(\"proxServer\") || this.DEFAULT_WISP;\n        const results = await Promise.all(this.WISP_SERVERS.map(s => this.ping(s.url)));\n        const working = results.filter(r => r.success).sort((a, b) => a.latency - b.latency);\n        return working[0]?.url || this.DEFAULT_WISP;\n    },\n\n    async init() {\n        try {\n            if (window.Notify) window.Notify.info(\"Initializing\", \"Starting proxy service...\");\n\n            const best = await this.findBest();\n            localStorage.setItem(\"proxServer\", best);\n\n            let attempts = 0;\n            while (!window.BareMux && attempts < 50) { await new Promise(r => setTimeout(r, 100)); attempts++; }\n            if (!window.BareMux || typeof $scramjetLoadController === 'undefined') throw new Error(\"Proxy libs failed to load\");\n\n            const { ScramjetController } = $scramjetLoadController();\n            const scramjet = new ScramjetController({\n                prefix: this.BASE_PATH + \"scramjet/\",\n                files: {\n                    wasm: \"https://cdn.jsdelivr.net/gh/Destroyed12121/Staticsj@main/JS/scramjet.wasm.wasm\",\n                    all: \"https://cdn.jsdelivr.net/gh/Destroyed12121/Staticsj@main/JS/scramjet.all.js\",\n                    sync: \"https://cdn.jsdelivr.net/gh/Destroyed12121/Staticsj@main/JS/scramjet.sync.js\"\n                }\n            });\n            await scramjet.init();\n\n            if ('serviceWorker' in navigator) {\n                const reg = await navigator.serviceWorker.register(this.BASE_PATH + \"sw.js\", { scope: this.BASE_PATH });\n                const config = {\n                    type: \"config\",\n                    wispurl: best,\n                    servers: [...this.WISP_SERVERS, ...JSON.parse(localStorage.getItem('customWisps') || '[]')],\n                    autoswitch: localStorage.getItem('wispAutoswitch') !== 'false'\n                };\n\n                const send = () => reg.active?.postMessage(config);\n                send(); setTimeout(send, 500);\n\n                const conn = new BareMux.BareMuxConnection(this.BASE_PATH + \"bareworker.js\");\n                await conn.setTransport(\"https://cdn.jsdelivr.net/npm/@mercuryworkshop/epoxy-transport/dist/index.mjs\", [{ wisp: best }]);\n\n                if (window.Notify) window.Notify.success(\"Ready\", \"Proxy service initialized\");\n            }\n        } catch (e) {\n            console.error(e);\n            if (window.Notify) window.Notify.error(\"Failed\", e.message);\n        }\n    }\n};\n\nProxyInit.init();\n\nwindow.addEventListener('message', async (e) => {\n    if (e.data?.type === 'proxy-fetch' && e.data.url) {\n        try {\n            const res = await fetch(e.data.url);\n            e.source.postMessage({ type: 'proxy-fetch-result', url: e.data.url, blob: await res.blob() }, '*');\n        } catch (err) { }\n    }\n});\n</script>\n</body>\n\n</html>","pages/chat.html":"<!DOCTYPE html>\r\n<html lang=\"en\">\r\n\r\n<head>\r\n  <meta charset=\"UTF-8\">\r\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n  <meta name=\"description\" content=\"Phantom AI\">\r\n  <title>Phantom AI</title>\r\n\r\n  <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css\">\r\n  <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css\">\r\n  <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css\">\r\n  <style>\n/* phantom styling */\r\n\r\n@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');\r\n\r\n/* variables */\r\n:root {\r\n    /* Core colors (can be overridden by user settings) */\r\n    --bg: #0a0a0a;\r\n    --surface: #0f0f0f;\r\n    --surface-hover: #1a1a1a;\r\n    --surface-active: #252525;\r\n    --border: #1f1f1f;\r\n    --border-light: #2a2a2a;\r\n\r\n    /* Text */\r\n    --text: #e4e4e7;\r\n    --text-muted: #71717a;\r\n    --text-dim: #52525b;\r\n\r\n    /* Accent (customizable) */\r\n    --accent: #ffffff;\r\n    --accent-dim: rgba(255, 255, 255, 0.8);\r\n    --accent-glow: rgba(255, 255, 255, 0.1);\r\n\r\n    /* Status colors */\r\n    --success: #22c55e;\r\n    --warning: #f59e0b;\r\n    --error: #ef4444;\r\n    --info: #3b82f6;\r\n\r\n    /* Shadows */\r\n    --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.3);\r\n    --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.4);\r\n    --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.5);\r\n    --shadow-xl: 0 16px 48px rgba(0, 0, 0, 0.6);\r\n\r\n    /* Spacing */\r\n    --space-xs: 4px;\r\n    --space-sm: 8px;\r\n    --space-md: 16px;\r\n    --space-lg: 24px;\r\n    --space-xl: 32px;\r\n    --space-2xl: 48px;\r\n\r\n    /* Border radius */\r\n    --radius-sm: 4px;\r\n    --radius-md: 8px;\r\n    --radius-lg: 12px;\r\n    --radius-xl: 16px;\r\n    --radius-full: 9999px;\r\n\r\n    /* Transitions */\r\n    --transition-fast: 0.1s ease;\r\n    --transition-normal: 0.2s ease;\r\n    --transition-slow: 0.3s ease;\r\n\r\n    /* Z-index layers */\r\n    --z-base: 1;\r\n    --z-dropdown: 100;\r\n    --z-sticky: 500;\r\n    --z-modal: 1000;\r\n    --z-toast: 2000;\r\n    --z-max: 9999;\r\n\r\n    /* Typography */\r\n    --font-sans: 'Inter', system-ui, -apple-system, sans-serif;\r\n    --font-mono: 'JetBrains Mono', 'Fira Code', monospace;\r\n\r\n    /* Background (customizable) */\r\n    --bg-image: none;\r\n}\r\n\r\n/* base */\r\n*,\r\n*::before,\r\n*::after {\r\n    box-sizing: border-box;\r\n    margin: 0;\r\n    padding: 0;\r\n}\r\n\r\nhtml {\r\n    font-size: 16px;\r\n    scroll-behavior: smooth;\r\n    -webkit-font-smoothing: antialiased;\r\n    -moz-osx-font-smoothing: grayscale;\r\n}\r\n\r\nbody {\r\n    font-family: var(--font-sans);\r\n    background: var(--bg);\r\n    background-image: var(--bg-image);\r\n    background-size: cover;\r\n    background-position: var(--bg-image-position, center);\r\n    background-attachment: fixed;\r\n    color: var(--text);\r\n    line-height: 1.5;\r\n    min-height: 100vh;\r\n    overflow-x: hidden;\r\n}\r\n\r\n/* Ensure background manager takes precedence */\r\nhtml.phantom-bg-active body {\r\n    background: transparent !important;\r\n    background-image: none !important;\r\n}\r\n\r\n/* Selection */\r\n::selection {\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n}\r\n\r\n/* Focus states */\r\n:focus-visible {\r\n    outline: 2px solid var(--accent);\r\n    outline-offset: 2px;\r\n}\r\n\r\n/* Links */\r\na {\r\n    color: var(--accent);\r\n    text-decoration: none;\r\n    transition: opacity var(--transition-fast);\r\n}\r\n\r\na:hover {\r\n    opacity: 0.8;\r\n}\r\n\r\n/* Scrollbar */\r\n::-webkit-scrollbar {\r\n    width: 8px;\r\n    height: 8px;\r\n}\r\n\r\n::-webkit-scrollbar-track {\r\n    background: var(--surface);\r\n}\r\n\r\n::-webkit-scrollbar-thumb {\r\n    background: var(--border-light);\r\n    border-radius: var(--radius-full);\r\n}\r\n\r\n::-webkit-scrollbar-thumb:hover {\r\n    background: var(--text-muted);\r\n}\r\n\r\n/* text */\r\nh1,\r\nh2,\r\nh3,\r\nh4,\r\nh5,\r\nh6 {\r\n    font-weight: 600;\r\n    line-height: 1.2;\r\n    color: var(--text);\r\n}\r\n\r\nh1 {\r\n    font-size: 2.5rem;\r\n}\r\n\r\nh2 {\r\n    font-size: 2rem;\r\n}\r\n\r\nh3 {\r\n    font-size: 1.5rem;\r\n}\r\n\r\nh4 {\r\n    font-size: 1.25rem;\r\n}\r\n\r\nh5 {\r\n    font-size: 1rem;\r\n}\r\n\r\nh6 {\r\n    font-size: 0.875rem;\r\n}\r\n\r\np {\r\n    color: var(--text-muted);\r\n    line-height: 1.6;\r\n}\r\n\r\n.text-sm {\r\n    font-size: 0.875rem;\r\n}\r\n\r\n.text-xs {\r\n    font-size: 0.75rem;\r\n}\r\n\r\n.text-lg {\r\n    font-size: 1.125rem;\r\n}\r\n\r\n.text-muted {\r\n    color: var(--text-muted);\r\n}\r\n\r\n.text-dim {\r\n    color: var(--text-dim);\r\n}\r\n\r\n.text-center {\r\n    text-align: center;\r\n}\r\n\r\n/* buttons */\r\n.btn {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    gap: var(--space-sm);\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-family: var(--font-sans);\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-md);\r\n    background: var(--surface);\r\n    color: var(--text);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n    white-space: nowrap;\r\n}\r\n\r\n.btn:hover {\r\n    background: var(--surface-hover);\r\n    border-color: var(--border-light);\r\n}\r\n\r\n.btn:active {\r\n    background: var(--surface-active);\r\n    transform: scale(0.98);\r\n}\r\n\r\n.btn-primary {\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n    border-color: var(--accent);\r\n}\r\n\r\n.btn-primary:hover {\r\n    opacity: 0.9;\r\n    background: var(--accent);\r\n}\r\n\r\n.btn-ghost {\r\n    background: transparent;\r\n    border-color: transparent;\r\n}\r\n\r\n.btn-ghost:hover {\r\n    background: var(--surface-hover);\r\n}\r\n\r\n.btn-icon {\r\n    width: 36px;\r\n    height: 36px;\r\n    padding: 0;\r\n    border-radius: var(--radius-md);\r\n}\r\n\r\n.btn-sm {\r\n    padding: var(--space-xs) var(--space-sm);\r\n    font-size: 0.75rem;\r\n}\r\n\r\n.btn-lg {\r\n    padding: var(--space-md) var(--space-lg);\r\n    font-size: 1rem;\r\n}\r\n\r\n/* inputs */\r\n.input {\r\n    width: 100%;\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-family: var(--font-sans);\r\n    font-size: 0.875rem;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-md);\r\n    color: var(--text);\r\n    transition: border-color var(--transition-fast);\r\n}\r\n\r\n.input:hover {\r\n    border-color: var(--border-light);\r\n}\r\n\r\n.input:focus {\r\n    outline: none;\r\n    border-color: var(--accent);\r\n}\r\n\r\n.input::placeholder {\r\n    color: var(--text-dim);\r\n}\r\n\r\n.input-group {\r\n    display: flex;\r\n    gap: var(--space-sm);\r\n}\r\n\r\n.input-group .input {\r\n    flex: 1;\r\n}\r\n\r\n/* Select */\r\n.select {\r\n    appearance: none;\r\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%2371717a' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E\");\r\n    background-repeat: no-repeat;\r\n    background-position: right 12px center;\r\n    padding-right: 36px;\r\n    cursor: pointer;\r\n}\r\n\r\n/* Checkbox/Toggle */\r\n.toggle {\r\n    position: relative;\r\n    width: 44px;\r\n    height: 24px;\r\n    background: var(--border);\r\n    border-radius: var(--radius-full);\r\n    cursor: pointer;\r\n    transition: background var(--transition-fast);\r\n}\r\n\r\n.toggle::after {\r\n    content: '';\r\n    position: absolute;\r\n    top: 2px;\r\n    left: 2px;\r\n    width: 20px;\r\n    height: 20px;\r\n    background: var(--text);\r\n    border-radius: 50%;\r\n    transition: transform var(--transition-fast);\r\n}\r\n\r\n.toggle.active {\r\n    background: var(--accent);\r\n}\r\n\r\n.toggle.active::after {\r\n    transform: translateX(20px);\r\n    background: var(--bg);\r\n}\r\n\r\n/* cards */\r\n.card {\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-lg);\r\n    overflow: hidden;\r\n    transition: all var(--transition-normal);\r\n}\r\n\r\n.card:hover {\r\n    border-color: var(--border-light);\r\n    box-shadow: var(--shadow-md);\r\n}\r\n\r\n.card-header {\r\n    padding: var(--space-md);\r\n    border-bottom: 1px solid var(--border);\r\n}\r\n\r\n.card-body {\r\n    padding: var(--space-md);\r\n}\r\n\r\n.card-footer {\r\n    padding: var(--space-md);\r\n    border-top: 1px solid var(--border);\r\n}\r\n\r\n\r\n/* Featured badge */\r\n.badge-featured {\r\n    position: absolute;\r\n    top: var(--space-sm);\r\n    left: var(--space-sm);\r\n    padding: var(--space-xs) var(--space-sm);\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n    font-size: 0.625rem;\r\n    font-weight: 700;\r\n    text-transform: uppercase;\r\n    letter-spacing: 0.05em;\r\n    border-radius: var(--radius-sm);\r\n}\r\n\r\n/* Favorite star */\r\n.favorite-btn {\r\n    position: absolute;\r\n    top: var(--space-sm);\r\n    right: var(--space-sm);\r\n    width: 32px;\r\n    height: 32px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background: rgba(0, 0, 0, 0.5);\r\n    border: none;\r\n    border-radius: 50%;\r\n    color: var(--text-muted);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n    opacity: 0;\r\n}\r\n\r\n.media-card:hover .favorite-btn {\r\n    opacity: 1;\r\n}\r\n\r\n.favorite-btn:hover {\r\n    background: rgba(0, 0, 0, 0.7);\r\n    color: var(--text);\r\n}\r\n\r\n.favorite-btn.active {\r\n    color: #fbbf24;\r\n    opacity: 1;\r\n}\r\n\r\n/* grid */\r\n.grid {\r\n    display: grid;\r\n    gap: var(--space-md);\r\n}\r\n\r\n.grid-cols-2 {\r\n    grid-template-columns: repeat(2, 1fr);\r\n}\r\n\r\n.grid-cols-3 {\r\n    grid-template-columns: repeat(3, 1fr);\r\n}\r\n\r\n.grid-cols-4 {\r\n    grid-template-columns: repeat(4, 1fr);\r\n}\r\n\r\n.grid-cols-5 {\r\n    grid-template-columns: repeat(5, 1fr);\r\n}\r\n\r\n.grid-cols-6 {\r\n    grid-template-columns: repeat(6, 1fr);\r\n}\r\n\r\n/* Auto-fit grid for responsive cards */\r\n.grid-auto {\r\n    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));\r\n}\r\n\r\n.grid-auto-lg {\r\n    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\r\n}\r\n\r\n/* flex */\r\n.flex {\r\n    display: flex;\r\n}\r\n\r\n.flex-col {\r\n    flex-direction: column;\r\n}\r\n\r\n.flex-wrap {\r\n    flex-wrap: wrap;\r\n}\r\n\r\n.items-center {\r\n    align-items: center;\r\n}\r\n\r\n.items-start {\r\n    align-items: flex-start;\r\n}\r\n\r\n.items-end {\r\n    align-items: flex-end;\r\n}\r\n\r\n.justify-center {\r\n    justify-content: center;\r\n}\r\n\r\n.justify-between {\r\n    justify-content: space-between;\r\n}\r\n\r\n.justify-end {\r\n    justify-content: flex-end;\r\n}\r\n\r\n.gap-xs {\r\n    gap: var(--space-xs);\r\n}\r\n\r\n.gap-sm {\r\n    gap: var(--space-sm);\r\n}\r\n\r\n.gap-md {\r\n    gap: var(--space-md);\r\n}\r\n\r\n.gap-lg {\r\n    gap: var(--space-lg);\r\n}\r\n\r\n.flex-1 {\r\n    flex: 1;\r\n}\r\n\r\n/* spacing */\r\n.p-xs {\r\n    padding: var(--space-xs);\r\n}\r\n\r\n.p-sm {\r\n    padding: var(--space-sm);\r\n}\r\n\r\n.p-md {\r\n    padding: var(--space-md);\r\n}\r\n\r\n.p-lg {\r\n    padding: var(--space-lg);\r\n}\r\n\r\n.p-xl {\r\n    padding: var(--space-xl);\r\n}\r\n\r\n.m-xs {\r\n    margin: var(--space-xs);\r\n}\r\n\r\n.m-sm {\r\n    margin: var(--space-sm);\r\n}\r\n\r\n.m-md {\r\n    margin: var(--space-md);\r\n}\r\n\r\n.m-lg {\r\n    margin: var(--space-lg);\r\n}\r\n\r\n.mt-sm {\r\n    margin-top: var(--space-sm);\r\n}\r\n\r\n.mt-md {\r\n    margin-top: var(--space-md);\r\n}\r\n\r\n.mt-lg {\r\n    margin-top: var(--space-lg);\r\n}\r\n\r\n.mb-sm {\r\n    margin-bottom: var(--space-sm);\r\n}\r\n\r\n.mb-md {\r\n    margin-bottom: var(--space-md);\r\n}\r\n\r\n.mb-lg {\r\n    margin-bottom: var(--space-lg);\r\n}\r\n\r\n/* modals */\r\n.modal-overlay {\r\n    position: fixed;\r\n    inset: 0;\r\n    background: rgba(0, 0, 0, 0.8);\r\n    backdrop-filter: blur(4px);\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    z-index: var(--z-modal);\r\n    opacity: 0;\r\n    visibility: hidden;\r\n    transition: all var(--transition-normal);\r\n}\r\n\r\n.modal-overlay.show {\r\n    opacity: 1;\r\n    visibility: visible;\r\n}\r\n\r\n.modal {\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-xl);\r\n    max-width: 90vw;\r\n    max-height: 90vh;\r\n    overflow: hidden;\r\n    transform: scale(0.95);\r\n    transition: transform var(--transition-normal);\r\n}\r\n\r\n.modal-overlay.show .modal {\r\n    transform: scale(1);\r\n}\r\n\r\n.modal-header {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    padding: var(--space-md);\r\n    border-bottom: 1px solid var(--border);\r\n}\r\n\r\n.modal-title {\r\n    font-size: 1rem;\r\n    font-weight: 600;\r\n}\r\n\r\n.modal-close {\r\n    width: 32px;\r\n    height: 32px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background: transparent;\r\n    border: none;\r\n    color: var(--text-muted);\r\n    cursor: pointer;\r\n    border-radius: var(--radius-md);\r\n    transition: all var(--transition-fast);\r\n}\r\n\r\n.modal-close:hover {\r\n    background: var(--surface-hover);\r\n    color: var(--text);\r\n}\r\n\r\n.modal-body {\r\n    padding: var(--space-md);\r\n    overflow-y: auto;\r\n}\r\n\r\n.modal-footer {\r\n    display: flex;\r\n    justify-content: flex-end;\r\n    gap: var(--space-sm);\r\n    padding: var(--space-md);\r\n    border-top: 1px solid var(--border);\r\n}\r\n\r\n/* tabs */\r\n.tabs {\r\n    display: flex;\r\n    gap: 2px;\r\n    background: var(--surface);\r\n    padding: var(--space-xs);\r\n    border-radius: var(--radius-md);\r\n    border: 1px solid var(--border);\r\n}\r\n\r\n.tab {\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    color: var(--text-muted);\r\n    background: transparent;\r\n    border: none;\r\n    border-radius: var(--radius-sm);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n}\r\n\r\n.tab:hover {\r\n    color: var(--text);\r\n}\r\n\r\n.tab.active {\r\n    background: var(--surface-hover);\r\n    color: var(--text);\r\n}\r\n\r\n/* search */\r\n\r\n/* ============================================\r\n   OFFLINE INDICATOR\r\n   ============================================ */\r\n.offline-banner {\r\n    position: fixed;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    padding: var(--space-sm) var(--space-md);\r\n    background: var(--warning);\r\n    color: var(--bg);\r\n    text-align: center;\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    z-index: var(--z-toast);\r\n    transform: translateY(-100%);\r\n    transition: transform var(--transition-normal);\r\n}\r\n\r\n.offline-banner.show {\r\n    transform: translateY(0);\r\n}\r\n\r\n.offline-badge {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    gap: var(--space-xs);\r\n    padding: var(--space-xs) var(--space-sm);\r\n    background: var(--warning);\r\n    color: var(--bg);\r\n    font-size: 0.625rem;\r\n    font-weight: 600;\r\n    text-transform: uppercase;\r\n    border-radius: var(--radius-sm);\r\n}\r\n\r\n/* ============================================\r\n   LOADING STATES\r\n   ============================================ */\r\n.skeleton {\r\n    background: linear-gradient(90deg, var(--surface) 0%, var(--surface-hover) 50%, var(--surface) 100%);\r\n    background-size: 200% 100%;\r\n    animation: shimmer 1.5s infinite;\r\n    border-radius: var(--radius-md);\r\n}\r\n\r\n@keyframes shimmer {\r\n    0% {\r\n        background-position: 200% 0;\r\n    }\r\n\r\n    100% {\r\n        background-position: -200% 0;\r\n    }\r\n}\r\n\r\n.spinner {\r\n    width: 24px;\r\n    height: 24px;\r\n    border: 2px solid var(--border);\r\n    border-top-color: var(--accent);\r\n    border-radius: 50%;\r\n    animation: spin 0.8s linear infinite;\r\n}\r\n\r\n@keyframes spin {\r\n    to {\r\n        transform: rotate(360deg);\r\n    }\r\n}\r\n\r\n/* ============================================\r\n   ANIMATIONS\r\n   ============================================ */\r\n@keyframes fadeIn {\r\n    from {\r\n        opacity: 0;\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n    }\r\n}\r\n\r\n@keyframes slideUp {\r\n    from {\r\n        opacity: 0;\r\n        transform: translateY(10px);\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n        transform: translateY(0);\r\n    }\r\n}\r\n\r\n@keyframes scaleIn {\r\n    from {\r\n        opacity: 0;\r\n        transform: scale(0.95);\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n        transform: scale(1);\r\n    }\r\n}\r\n\r\n.animate-fadeIn {\r\n    animation: fadeIn var(--transition-normal) ease;\r\n}\r\n\r\n.animate-slideUp {\r\n    animation: slideUp var(--transition-normal) ease;\r\n}\r\n\r\n.animate-scaleIn {\r\n    animation: scaleIn var(--transition-normal) ease;\r\n}\r\n\r\n/* ============================================\r\n   UTILITIES\r\n   ============================================ */\r\n.hidden {\r\n    display: none !important;\r\n}\r\n\r\n.sr-only {\r\n    position: absolute;\r\n    width: 1px;\r\n    height: 1px;\r\n    padding: 0;\r\n    margin: -1px;\r\n    overflow: hidden;\r\n    clip: rect(0, 0, 0, 0);\r\n    border: 0;\r\n}\r\n\r\n.truncate {\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n}\r\n\r\n.w-full {\r\n    width: 100%;\r\n}\r\n\r\n.h-full {\r\n    height: 100%;\r\n}\r\n\r\n.relative {\r\n    position: relative;\r\n}\r\n\r\n.absolute {\r\n    position: absolute;\r\n}\r\n\r\n.fixed {\r\n    position: fixed;\r\n}\r\n\r\n.inset-0 {\r\n    inset: 0;\r\n}\r\n\r\n/* ============================================\r\n   RESPONSIVE\r\n   ============================================ */\r\n@media (max-width: 768px) {\r\n    h1 {\r\n        font-size: 1.75rem;\r\n    }\r\n\r\n    h2 {\r\n        font-size: 1.5rem;\r\n    }\r\n\r\n    h3 {\r\n        font-size: 1.25rem;\r\n    }\r\n\r\n    .grid-auto {\r\n        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));\r\n    }\r\n\r\n    .hide-mobile {\r\n        display: none !important;\r\n    }\r\n}\r\n\r\n@media (min-width: 769px) {\r\n    .hide-desktop {\r\n        display: none !important;\r\n    }\r\n}\n</style>\r\n  <style>\n/* Topbar Styles - Clean & Dark */\r\n/* Note: Inter font is imported in main.css */\r\n\r\nbody {\r\n    margin: 0;\r\n    padding: 0;\r\n    background-color: var(--bg);\r\n    font-family: 'Inter', sans-serif;\r\n}\r\n\r\n#topbar-container {\r\n    position: fixed;\r\n    top: 11px;\r\n    left: 50%;\r\n    transform: translateX(-50%);\r\n    background-color: var(--surface);\r\n    border-radius: 9999px;\r\n    padding: 8px 14px;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 10px;\r\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);\r\n    z-index: 10000;\r\n    border: 1px solid var(--border);\r\n    height: 48px;\r\n    box-sizing: border-box;\r\n}\r\n\r\n#topbar-container::before {\r\n    content: '';\r\n    position: absolute;\r\n    top: -7px;\r\n    bottom: -7px;\r\n    left: -7px;\r\n    right: -7px;\r\n    z-index: -1;\r\n    border-radius: 9999px;\r\n}\r\n\r\n.logo-section {\r\n    display: flex;\r\n    align-items: center;\r\n    padding-right: 10px;\r\n    border-right: 1px solid var(--border);\r\n    height: 32px;\r\n    text-decoration: none;\r\n    color: inherit;\r\n}\r\n\r\n.logo-placeholder {\r\n    width: 28px;\r\n    height: 28px;\r\n    background-color: var(--surface-hover);\r\n    border-radius: 6px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    color: var(--text-muted);\r\n}\r\n\r\n.logo-placeholder i,\r\n.logo-placeholder svg {\r\n    width: 16px;\r\n    height: 16px;\r\n}\r\n\r\n.nav-buttons {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 4px;\r\n}\r\n\r\n.nav-separator {\r\n    width: 1px;\r\n    height: 20px;\r\n    background-color: var(--border);\r\n    margin: 0 6px;\r\n}\r\n\r\n.nav-btn {\r\n    background: transparent;\r\n    border: none;\r\n    color: var(--text-muted);\r\n    text-decoration: none;\r\n    display: flex;\r\n    align-items: center;\r\n    padding: 6px 10px;\r\n    border-radius: 99px;\r\n    height: 32px;\r\n    box-sizing: border-box;\r\n    transition: color 0.15s, background-color 0.15s;\r\n    position: relative;\r\n}\r\n\r\n.nav-badge-beta {\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n    font-size: 8px;\r\n    font-weight: 700;\r\n    color: var(--text);\r\n    background: var(--secondary);\r\n    padding: 2px 4px;\r\n    border-radius: 4px;\r\n    line-height: 1;\r\n    transform: translate(20%, -20%);\r\n    pointer-events: none;\r\n}\r\n\r\n.nav-btn:hover {\r\n    color: var(--text);\r\n    background-color: var(--surface-hover);\r\n}\r\n\r\n.nav-btn i,\r\n.nav-btn svg {\r\n    width: 18px;\r\n    height: 18px;\r\n    min-width: 18px;\r\n}\r\n\r\n.nav-btn span {\r\n    max-width: 0;\r\n    opacity: 0;\r\n    margin-left: 0;\r\n    overflow: hidden;\r\n    white-space: nowrap;\r\n    font-weight: 500;\r\n    font-size: 13px;\r\n    transition: max-width 0.23s ease, opacity 0.17s ease, margin-left 0.23s ease;\r\n}\r\n\r\n#topbar-container:hover .nav-btn span {\r\n    max-width: 70px;\r\n    opacity: 1;\r\n    margin-left: 8px;\r\n}\n</style>\r\n  <style>\n.app-container {\r\n    display: flex;\r\n    height: 100vh;\r\n    position: relative;\r\n    overflow: hidden;\r\n}\r\n\r\n.sidebar {\r\n    width: 280px;\r\n    background: rgba(15, 15, 15, 0.85);\r\n    backdrop-filter: blur(12px);\r\n    -webkit-backdrop-filter: blur(12px);\r\n    display: flex;\r\n    flex-direction: column;\r\n    transition: width var(--transition-normal), transform var(--transition-normal);\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    bottom: 0;\r\n    border-right: 1px solid var(--border);\r\n    z-index: 10;\r\n}\r\n\r\n.sidebar.collapsed {\r\n    width: 0;\r\n    overflow: hidden;\r\n}\r\n\r\n.sidebar-header {\r\n    padding: 70px var(--space-lg) var(--space-md);\r\n    font-size: 1.1rem;\r\n}\r\n\r\n.brand-section {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 8px;\r\n    color: var(--text);\r\n    font-weight: 600;\r\n}\r\n\r\n.brand-section svg {\r\n    width: 20px;\r\n    height: 20px;\r\n    color: var(--text-muted);\r\n}\r\n\r\n.chat-title,\r\n.hero-title {\r\n    background: linear-gradient(90deg, var(--text) 0%, var(--text-muted) 50%, var(--text-dim) 100%);\r\n    -webkit-background-clip: text;\r\n    background-clip: text;\r\n    -webkit-text-fill-color: transparent;\r\n    font-weight: 700;\r\n}\r\n\r\n.new-chat-btn {\r\n    margin: var(--space-sm) var(--space-md) var(--space-md);\r\n    background: rgba(255, 255, 255, 0.06);\r\n    color: var(--text);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-md);\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-weight: 500;\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 8px;\r\n    font-size: 0.875rem;\r\n}\r\n\r\n.new-chat-btn:hover {\r\n    background: rgba(255, 255, 255, 0.1);\r\n    border-color: var(--border-light);\r\n}\r\n\r\n.conversations {\r\n    flex: 1;\r\n    overflow-y: auto;\r\n    padding: 0 var(--space-sm);\r\n}\r\n\r\n.conversation-item {\r\n    padding: var(--space-sm) var(--space-md);\r\n    border-radius: var(--radius-md);\r\n    cursor: pointer;\r\n    color: var(--text-muted);\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    margin-bottom: 2px;\r\n    transition: all var(--transition-fast);\r\n}\r\n\r\n.conversation-title {\r\n    flex: 1;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n    white-space: nowrap;\r\n    font-size: 0.875rem;\r\n}\r\n\r\n.conversation-item:hover,\r\n.conversation-item.active {\r\n    background: rgba(255, 255, 255, 0.08);\r\n    color: var(--text);\r\n}\r\n\r\n.delete-btn {\r\n    background: transparent;\r\n    border: none;\r\n    color: var(--text-dim);\r\n    cursor: pointer;\r\n    padding: var(--space-xs);\r\n    border-radius: var(--radius-sm);\r\n    transition: all var(--transition-fast);\r\n    opacity: 0;\r\n}\r\n\r\n.conversation-item:hover .delete-btn {\r\n    opacity: 1;\r\n}\r\n\r\n.delete-btn:hover {\r\n    background: rgba(239, 68, 68, 0.15);\r\n    color: var(--error);\r\n}\r\n\r\n/* Main Content */\r\n.main-content {\r\n    flex: 1;\r\n    display: flex;\r\n    flex-direction: column;\r\n    background: transparent;\r\n    position: relative;\r\n    margin-left: 280px;\r\n    transition: margin-left var(--transition-normal);\r\n}\r\n\r\n.app-container.sidebar-collapsed .main-content {\r\n    margin-left: 0;\r\n}\r\n\r\n.chat-header {\r\n    height: 60px;\r\n    padding: 0 var(--space-lg);\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    border-bottom: 1px solid var(--border);\r\n    background: rgba(15, 15, 15, 0.7);\r\n    backdrop-filter: blur(8px);\r\n    -webkit-backdrop-filter: blur(8px);\r\n}\r\n\r\n.header-left {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: var(--space-md);\r\n}\r\n\r\n.menu-toggle {\r\n    background: transparent;\r\n    border: none;\r\n    color: var(--text-muted);\r\n    cursor: pointer;\r\n    padding: var(--space-sm);\r\n    border-radius: var(--radius-md);\r\n    transition: all var(--transition-fast);\r\n}\r\n\r\n.menu-toggle:hover {\r\n    background: rgba(255, 255, 255, 0.08);\r\n    color: var(--text);\r\n}\r\n\r\n.chat-body {\r\n    flex: 1;\r\n    overflow-y: auto;\r\n    padding: var(--space-xl);\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: var(--space-lg);\r\n}\r\n\r\n.message {\r\n    display: flex;\r\n    gap: var(--space-md);\r\n    max-width: 850px;\r\n    margin: 0 auto;\r\n    width: 100%;\r\n}\r\n\r\n.message-avatar {\r\n    width: 36px;\r\n    height: 36px;\r\n    border-radius: var(--radius-md);\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    flex-shrink: 0;\r\n    background: rgba(255, 255, 255, 0.05);\r\n    border: 1px solid var(--border);\r\n}\r\n\r\n.user-message .message-avatar {\r\n    color: var(--text-muted);\r\n}\r\n\r\n.ai-message .message-avatar {\r\n    background: rgba(255, 255, 255, 0.08);\r\n    color: var(--text);\r\n}\r\n\r\n.message-avatar svg {\r\n    width: 18px;\r\n    height: 18px;\r\n}\r\n\r\n.message-content {\r\n    flex: 1;\r\n    position: relative;\r\n    min-width: 0;\r\n}\r\n\r\n.user-message .message-content {\r\n    background: rgba(255, 255, 255, 0.04);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-lg);\r\n    padding: var(--space-md);\r\n}\r\n\r\n.ai-message .message-content {\r\n    background: rgba(20, 20, 20, 0.6);\r\n    backdrop-filter: blur(8px);\r\n    -webkit-backdrop-filter: blur(8px);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-lg);\r\n    padding: var(--space-md);\r\n}\r\n\r\n.ai-message:hover .message-content {\r\n    border-color: var(--border-light);\r\n}\r\n\r\n.message-actions {\r\n    position: absolute;\r\n    bottom: -12px;\r\n    left: var(--space-md);\r\n    display: flex;\r\n    gap: 4px;\r\n    opacity: 0;\r\n    transform: translateY(4px);\r\n    transition: all var(--transition-fast);\r\n}\r\n\r\n.message:hover .message-actions {\r\n    opacity: 1;\r\n    transform: translateY(0);\r\n}\r\n\r\n.message-actions .btn {\r\n    background: rgba(20, 20, 20, 0.9);\r\n    border: 1px solid var(--border);\r\n    padding: 4px 8px;\r\n    font-size: 0.75rem;\r\n    color: var(--text-muted);\r\n    border-radius: var(--radius-sm);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n}\r\n\r\n.message-actions .btn:hover {\r\n    background: var(--surface-hover);\r\n    color: var(--text);\r\n    border-color: var(--border-light);\r\n}\r\n\r\n.chat-footer {\r\n    padding: var(--space-lg);\r\n    background: linear-gradient(to top, rgba(10, 10, 10, 0.9) 0%, transparent 100%);\r\n}\r\n\r\n.input-container {\r\n    max-width: 850px;\r\n    margin: 0 auto;\r\n    background: rgba(20, 20, 20, 0.8);\r\n    backdrop-filter: blur(12px);\r\n    -webkit-backdrop-filter: blur(12px);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-xl);\r\n    padding: 8px;\r\n    display: flex;\r\n    align-items: flex-end;\r\n    gap: var(--space-sm);\r\n    transition: all var(--transition-normal);\r\n}\r\n\r\n.input-container:focus-within {\r\n    border-color: var(--border-light);\r\n    box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);\r\n}\r\n\r\n.input-actions {\r\n    display: flex;\r\n    gap: 4px;\r\n    padding: 0px;\r\n}\r\n\r\n.chat-input {\r\n    flex: 1;\r\n    background: transparent;\r\n    border: none;\r\n    color: var(--text);\r\n    padding: var(--space-sm);\r\n    font-family: var(--font-sans);\r\n    font-size: 0.9rem;\r\n    resize: none;\r\n    outline: none;\r\n    min-height: 24px;\r\n    max-height: 200px;\r\n}\r\n\r\n.chat-input::placeholder {\r\n    color: var(--text-dim);\r\n}\r\n\r\n.send-btn {\r\n    background: var(--text);\r\n    color: var(--bg);\r\n    border: none;\r\n    border-radius: var(--radius-full);\r\n    width: 36px;\r\n    height: 36px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n    flex-shrink: 0;\r\n}\r\n\r\n.send-btn:hover:not(:disabled) {\r\n    opacity: 0.85;\r\n    transform: scale(1.02);\r\n}\r\n\r\n.send-btn:disabled {\r\n    opacity: 0.3;\r\n    cursor: not-allowed;\r\n}\r\n\r\n.mode-pill {\r\n    background: transparent;\r\n    border: 1px solid transparent;\r\n    color: var(--text-dim);\r\n    padding: 6px 12px;\r\n    border-radius: var(--radius-md);\r\n    font-size: 0.8rem;\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 6px;\r\n}\r\n\r\n.mode-pill:hover {\r\n    color: var(--text-muted);\r\n}\r\n\r\n.mode-pill.active {\r\n    background: rgba(255, 255, 255, 0.08);\r\n    color: var(--text);\r\n    border-color: var(--border);\r\n}\r\n\r\n.hero-section {\r\n    position: absolute;\r\n    top: 40%;\r\n    left: 50%;\r\n    transform: translate(-50%, -50%);\r\n    text-align: center;\r\n    pointer-events: none;\r\n}\r\n\r\n.hero-title {\r\n    font-size: 3rem;\r\n    margin-bottom: 12px;\r\n    letter-spacing: -1px;\r\n}\r\n\r\n.hero-subtitle {\r\n    font-size: 1rem;\r\n    color: var(--text-muted);\r\n}\r\n\r\n.message-text {\r\n    color: var(--text);\r\n    line-height: 1.6;\r\n    font-size: 0.9rem;\r\n}\r\n\r\n.message-text p {\r\n    margin-bottom: var(--space-sm);\r\n}\r\n\r\n.message-text p:last-child {\r\n    margin-bottom: 0;\r\n}\r\n\r\n.message-text h1,\r\n.message-text h2,\r\n.message-text h3,\r\n.message-text h4,\r\n.message-text h5,\r\n.message-text h6 {\r\n    color: var(--text);\r\n    margin: var(--space-md) 0 var(--space-sm);\r\n    font-weight: 600;\r\n}\r\n\r\n.message-text ul,\r\n.message-text ol {\r\n    margin: var(--space-sm) 0;\r\n    padding-left: var(--space-lg);\r\n}\r\n\r\n.message-text li {\r\n    margin-bottom: var(--space-xs);\r\n}\r\n\r\n.message-text pre {\r\n    background: rgba(0, 0, 0, 0.3);\r\n    padding: var(--space-md);\r\n    border-radius: var(--radius-md);\r\n    margin: var(--space-sm) 0;\r\n    border: 1px solid var(--border);\r\n    overflow-x: auto;\r\n}\r\n\r\n.message-text code {\r\n    font-family: var(--font-mono);\r\n    font-size: 0.85em;\r\n    color: #a5d6ff;\r\n    background: rgba(255, 255, 255, 0.06);\r\n    padding: 2px 6px;\r\n    border-radius: 4px;\r\n}\r\n\r\n.message-text pre code {\r\n    background: transparent;\r\n    padding: 0;\r\n    color: inherit;\r\n}\r\n\r\n.message-text a {\r\n    color: #58a6ff;\r\n    text-decoration: underline;\r\n    text-underline-offset: 2px;\r\n}\r\n\r\n.message-text blockquote {\r\n    border-left: 3px solid var(--border-light);\r\n    padding-left: var(--space-md);\r\n    margin: var(--space-sm) 0;\r\n    color: var(--text-muted);\r\n    font-style: italic;\r\n}\r\n\r\n.thinking-dots {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    gap: 4px;\r\n    color: var(--text-muted);\r\n}\r\n\r\n.thinking-dots::after {\r\n    content: '';\r\n    animation: dots 1.5s infinite;\r\n}\r\n\r\n@keyframes dots {\r\n\r\n    0%,\r\n    20% {\r\n        content: '.';\r\n    }\r\n\r\n    40% {\r\n        content: '..';\r\n    }\r\n\r\n    60%,\r\n    100% {\r\n        content: '...';\r\n    }\r\n}\r\n\r\n.image-prompt {\r\n    font-size: 0.8rem;\r\n    color: var(--text-dim);\r\n    margin-bottom: var(--space-sm);\r\n    font-style: italic;\r\n}\r\n\r\n.image-container {\r\n    position: relative;\r\n    max-width: 512px;\r\n    width: 100%;\r\n    aspect-ratio: 1/1;\r\n    background: rgba(255, 255, 255, 0.03);\r\n    border-radius: var(--radius-lg);\r\n    overflow: hidden;\r\n    border: 1px solid var(--border);\r\n}\r\n\r\n.generated-image {\r\n    width: 100%;\r\n    height: 100%;\r\n    object-fit: cover;\r\n    opacity: 0;\r\n    transition: opacity 0.5s ease;\r\n    cursor: pointer;\r\n}\r\n\r\n.generated-image.loaded {\r\n    opacity: 1;\r\n}\r\n\r\n.generated-image:hover {\r\n    filter: brightness(1.05);\r\n}\r\n\r\n.image-loader {\r\n    position: absolute;\r\n    inset: 0;\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    justify-content: center;\r\n    gap: var(--space-sm);\r\n    color: var(--text-muted);\r\n}\r\n\r\n.image-loader i {\r\n    font-size: 1.5rem;\r\n}\r\n\r\n.generated-image.loaded+.image-loader {\r\n    display: none;\r\n}\r\n\r\n@media (max-width: 768px) {\r\n    .sidebar {\r\n        position: fixed;\r\n        transform: translateX(-100%);\r\n        z-index: 100;\r\n    }\r\n\r\n    .sidebar.active {\r\n        transform: translateX(0);\r\n    }\r\n\r\n    .main-content {\r\n        margin-left: 0;\r\n    }\r\n\r\n    .sidebar-overlay {\r\n        position: fixed;\r\n        inset: 0;\r\n        background: rgba(0, 0, 0, 0.5);\r\n        opacity: 0;\r\n        visibility: hidden;\r\n        transition: all var(--transition-normal);\r\n        z-index: 99;\r\n    }\r\n\r\n    .sidebar-overlay.active {\r\n        opacity: 1;\r\n        visibility: visible;\r\n    }\r\n\r\n    .hero-title {\r\n        font-size: 2.5rem;\r\n    }\r\n\r\n    .mode-pill span {\r\n        display: none;\r\n    }\r\n}\r\n\r\n/* scroll */\r\n.chat-body::-webkit-scrollbar,\r\n.conversations::-webkit-scrollbar {\r\n    width: 6px;\r\n}\r\n\r\n.chat-body::-webkit-scrollbar-track,\r\n.conversations::-webkit-scrollbar-track {\r\n    background: transparent;\r\n}\r\n\r\n.chat-body::-webkit-scrollbar-thumb,\r\n.conversations::-webkit-scrollbar-thumb {\r\n    background: var(--border-light);\r\n    border-radius: 3px;\r\n}\r\n\r\n.chat-body::-webkit-scrollbar-thumb:hover,\r\n.conversations::-webkit-scrollbar-thumb:hover {\r\n    background: var(--text-muted);\r\n}\n</style>\r\n  <style>\n/**\r\n * PHANTOM - BACKGROUND STYLES\r\n */\r\n.phantom-background {\r\n    position: fixed;\r\n    inset: 0;\r\n    width: 100vw;\r\n    height: 100vh;\r\n    z-index: -1;\r\n    overflow: hidden;\r\n    background: transparent;\r\n    pointer-events: none;\r\n    opacity: 1;\r\n    transition: background-color 0.3s ease;\r\n}\r\n\r\n.phantom-background.active {\r\n    opacity: 1;\r\n}\r\n\r\n.phantom-background-overlay {\r\n    position: absolute;\r\n    inset: 0;\r\n    z-index: 2;\r\n    background: rgba(0, 0, 0, var(--bg-overlay, 0.4));\r\n    transition: background-color 0.3s ease;\r\n}\r\n\r\n.phantom-background-layer {\r\n    position: absolute;\r\n    inset: 0;\r\n    z-index: 1;\r\n    transition: opacity 0.3s ease-in-out;\r\n}\r\n\r\n.phantom-background-media {\r\n    width: 100%;\r\n    height: 100%;\r\n    object-fit: cover;\r\n    object-position: var(--bg-image-position, center);\r\n    display: block;\r\n    border: none;\r\n}\r\n\r\n/* Video and Iframe positioning for full background cover */\r\n.phantom-background-layer video.phantom-background-media,\r\n.phantom-background-layer iframe.phantom-background-media {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    transform: none;\r\n    pointer-events: none;\r\n    min-width: 100%;\r\n    min-height: 100%;\r\n    max-width: none;\r\n    max-height: none;\r\n    object-position: var(--bg-image-position, center);\r\n}\r\n\r\n/* Ensure iframes cover entire background */\r\n.phantom-background-layer iframe.phantom-background-media {\r\n    border: none;\r\n    object-fit: cover;\r\n}\r\n\r\n/* Ensure content on top remains readable */\r\nhtml {\r\n    background-color: var(--bg);\r\n}\r\n\r\nbody {\r\n    position: relative;\r\n    z-index: 0;\r\n    background: transparent !important;\r\n    /* Allow background to show through */\r\n}\r\n\r\n/* Specific adjustments for transparency if needed */\r\n.main-content,\r\n.home-page {\r\n    background: transparent !important;\r\n}\r\n\r\n/* Glassmorphism for containers when background is active */\r\n.phantom-background.active~.offline-banner,\r\n.phantom-background.active~.home-page .card,\r\n.phantom-background.active~.home-page .featured-card,\r\n.phantom-background.active~.home-page .search-bar,\r\n.phantom-background.active~.settings-panel {\r\n    backdrop-filter: blur(10px);\r\n    -webkit-backdrop-filter: blur(10px);\r\n    background: rgba(15, 15, 15, 0.7) !important;\r\n}\n</style>\r\n</head>\r\n\r\n<body>\r\n  <script>\n// site config\r\n\r\nwindow.SITE_CONFIG = {\r\n    name: \"Phantom\",\r\n    fullName: \"Phantom Unblocked\",\r\n    version: \"1.0.12\",\r\n\r\n    changelog: [\r\n        \"1.0.12: tiny fixxes and changes\",\r\n        \"some code consolidation and fixxes\",\r\n        \"suggest features in the discord server\"\r\n    ],\r\n\r\n    // quotes\r\n    quotes: [\r\n        \"lebron lebron lebronn james\",\r\n        \"so tuff\",\r\n        \"it is what it is\",\r\n        \"do ur work\",\r\n        \"this is what happens when u dont touch grass\",\r\n        \"FULL BOX\",\r\n        \"FULL PIECE\",\r\n        \"200!\",\r\n        \"press esc + refresh + power button for hacks\",\r\n        \"press ctrl+x to hide your screen\",\r\n        \"change the tab title and favicon in settings\",\r\n        \"TEACHERR!\",\r\n        \"1 pump\",\r\n        \"303 headshot\",\r\n        \"bros prolly a 60 ovr\",\r\n        \"take the L lil bro\",  \r\n        \"lebron is OUR goat\",\r\n        \"stop looking at my screen\",\r\n    ],\r\n\r\n    // todo\r\n    // *** for strikethrough\r\n    // ** for bold\r\n    todos: [\r\n        \"***fixxed aboutblank opening while securly is on (previously if popups were off it would load intab instead of clickto launch now it will use clicktolaunch unless popups are blocked)***\",\r\n        \"***fix the proxy***\",\r\n        \"***fix panic panickey, add quote talking about it***\",\r\n        \"***fix theatermode, make it hide buttons after a few seconds and ensure all content is being displayed and move the description to the bottom***\",\r\n        \"***change back player to use old styling, change the surface to use background colors for the bottom part where description is shown, looking just like the background***\",\r\n        \"***add image and video support for backgrounds***\",\r\n        \"***fix aichat, make the title use the same ai request as the users question unless its in image mode where it will use text mode and fix ai chat to remember modes better***\",\r\n        \"***add cloaking to quotes***\",\r\n        \"***add a default cloak and fix it so icons work in aboutblank for whatever reason they only work when you go to settings in aboutblank where it correctly applies***\",\r\n        \"***for search suggestions add highlighting for whatever will happen when you click enter, in search suggestions fix all games not sending you to the games page***\",\r\n        \"***fix games to make multi library the default, put it in config.js***\",\r\n        \"***rename movies shortcut in index2.html to primeshows, add shortcuts to main pages in the topbar and change the current shortcuts to more popular games***\",\r\n        \"***make announcements show even on first visit unlike changelog and allow disabling it via settings***\",\r\n        \"***fix leave comformation asking u to leave each time you click something***\",\r\n        \"***change the shortcuts on the main page to include pages***\",\r\n        \"***add movies to the search bar in main page***\",\r\n        \"***fix background not turning off soon***\",\r\n        \"***fix music page to hide youtube player unless toggled via 3 dot small button, and always shown on proxy mode, fix all the controls for video time, volume***\",\r\n        \"**add singlefile this is lowk so hard i dont really understand it**\",\r\n        \"**advertise phantom (too much work tbh)**\",\r\n        \"**add a watch page for youtube and twitch**\",\r\n        \"**add a miniplayer for music**\",\r\n        \"***shorten some page's code***\",\r\n        \"***fix paths in search autocomplete***\",\r\n        \"***fix markdown in ai not using correct text colors***\",\r\n        \"***make backgrounds show in the loading screen***\",\r\n        \"***fix icons for topbar in code.html***\",\r\n        \"**fix wisp server not notifying or autoswitiching when offline in proxy**\",\r\n        \"***fix code runner open not working at all***\",\r\n        \"***make backgrounds show in player.html***\",\r\n        \"***make backgrounds show in staticsjv2***\",\r\n        \"***make player.html player controls use theme colros not hardcoded***\",\r\n        \"***make ai chat and music sidebar go all the way down and up with borders***\",\r\n        \"**make the only song in music be lebron lebron lebron james**\",\r\n        \"**fix music controls**\",\r\n        \"***finish extra page into credits and make this todo be tucked away somewhere and not the main part of it***\"\r\n    ],\r\n    defaultWisp: \"wss://glseries.net/wisp/\",\r\n    wispServers: [\r\n        { name: \"GLSeries Wisp\", url: \"wss://glseries.net/wisp/\" },\r\n        { name: \"Rhw's Wisp\", url: \"wss://wisp.rhw.one/\" },\r\n    ],\r\n\r\n    discord: {\r\n        inviteUrl: \"https://discord.gg/tHWx9NXp5p\",\r\n        widgetServer: \"1447673724017971324\",\r\n        widgetChannel: \"1447673726228496617\",\r\n    },\r\n\r\n    firstVisitCloak: false, //fake error page\r\n    defaults: {\r\n        cloakMode: \"about:blank\",\r\n        tabTitle: \"You've already responded\",\r\n        tabFavicon: \"https://ssl.gstatic.com/docs/spreadsheets/forms/forms_icon_2023q4.ico\",\r\n        cloakRotation: false,\r\n        cloakInterval: 5000,\r\n        panicKey: \"x\",\r\n        panicModifiers: [\"ctrl\", \"shift\"],\r\n        panicUrl: \"https://classroom.google.com\",\r\n        maxMovieRating: \"R\",\r\n        gameLibrary: \"multi\",\r\n        discordWidget: true,\r\n        miniplayer: true,\r\n        leaveConfirmation: false,\r\n        showChangelogOnUpdate: true,\r\n        themeRotation: true,\r\n        lastThemeRotation: 0,\r\n        backgroundRotation: true,\r\n        lastBackgroundRotation: 0,\r\n        lastSeenFeatured: 'none',\r\n        background: { type: 'color', value: '#0a0a0a' },\r\n        customBackground: { id: 'none', type: 'none' },\r\n        accentColor: '#ffffff',\r\n        surfaceColor: '#0f0f0f',\r\n        secondaryColor: '#2e2e33',\r\n        textColor: '#e4e4e7',\r\n    },\r\n\r\n    themePresets: {\r\n        dark: { name: 'Dark (Default)', bg: { type: 'color', value: '#0a0a0a' }, surface: '#0f0f0f', surfaceHover: '#1a1a1a', surfaceActive: '#252525', secondary: '#2e2e33', border: '#2a2a2a', borderLight: '#2a2a2a', text: '#e4e4e7', textSec: '#71717a', textDim: '#52525b', accent: '#ffffff' },\r\n        midnight: { name: 'Midnight', bg: { type: 'color', value: '#000000' }, surface: '#050505', surfaceHover: '#111111', surfaceActive: '#1a1a1a', secondary: '#111111', border: '#1a1a1a', borderLight: '#111111', text: '#ededed', textSec: '#a3a3a3', textDim: '#737373', accent: '#d4d4d4' },\r\n        abyss: { name: 'Abyss', bg: { type: 'color', value: '#020617' }, surface: '#0f172a', surfaceHover: '#1e293b', surfaceActive: '#334155', secondary: '#1e293b', border: '#1e293b', borderLight: '#1e293b', text: '#f1f5f9', textSec: '#94a3b8', textDim: '#64748b', accent: '#38bdf8' },\r\n        phantom: { name: 'Phantom', bg: { type: 'color', value: '#0f0a14' }, surface: '#1a0f24', surfaceHover: '#2e1a40', surfaceActive: '#4c2a5c', secondary: '#2e1a40', border: '#2e1a40', borderLight: '#2e1a40', text: '#f3e8ff', textSec: '#d8b4fe', textDim: '#c084fc', accent: '#c084fc' },\r\n        rosepine: { name: 'Rose Pine', bg: { type: 'color', value: '#191724' }, surface: '#1f1d2e', surfaceHover: '#26233a', surfaceActive: '#524f67', secondary: '#26233a', border: '#26233a', borderLight: '#1f1d2e', text: '#e0def4', textSec: '#908caa', textDim: '#6e6a86', accent: '#ebbcba' },\r\n        ocean: { name: 'Oceanic', bg: { type: 'color', value: '#011627' }, surface: '#0b2942', surfaceHover: '#1d3b53', surfaceActive: '#2d4b63', secondary: '#0b2942', border: '#1d3b53', borderLight: '#0b2942', text: '#d6deeb', textSec: '#5f7e97', textDim: '#011627', accent: '#7fdbca' },\r\n        forest: { name: 'Forest', bg: { type: 'color', value: '#020d06' }, surface: '#051a0d', surfaceHover: '#0a2e17', surfaceActive: '#0f4221', secondary: '#051a0d', border: '#0a2e17', borderLight: '#051a0d', text: '#ecfdf5', textSec: '#6ee7b7', textDim: '#064e3b', accent: '#10b981' },\r\n        crimson: { name: 'Crimson', bg: { type: 'color', value: '#1a0505' }, surface: '#230a0a', surfaceHover: '#7b0a0aff', surfaceActive: '#7f1d1d', secondary: '#230a0a', border: '#480f0fff', borderLight: '#230a0a', text: '#fef2f2', textSec: '#fecaca', textDim: '#450a0a', accent: '#ef4444' },\r\n        flame: { name: 'Flame', bg: { type: 'color', value: '#0c0202' }, surface: '#1c0a0a', surfaceHover: '#451a03', surfaceActive: '#9a3412', secondary: '#1c0a0a', border: '#451a03', borderLight: '#9a3412', text: '#fff7ed', textSec: '#fdba74', textDim: '#ea580c', accent: '#f59e0b' }\r\n    },\r\n\r\n    backgroundPresets: [\r\n        { id: 'none', name: 'None (Theme Default)', type: 'none' },\r\n        { id: 'Night sky', name: 'Night sky', type: 'image', url: 'https://images.pexels.com/photos/5675745/pexels-photo-5675745.jpeg', overlay: 0.3 },\r\n        { id: 'winter-mountains', name: 'Winter mountains', type: 'image', url: 'https://images.pexels.com/photos/1287145/pexels-photo-1287145.jpeg', overlay: 0.3 },\r\n        { id: 'f1 car', name: 'F1 Car', type: 'image', url: 'https://images.pexels.com/photos/14401632/pexels-photo-14401632.jpeg', overlay: 0.3 },\r\n        { id: 'moon-landing', name: 'Moon Landing', type: 'image', url: 'https://images.pexels.com/photos/41162/moon-landing-apollo-11-nasa-buzz-aldrin-41162.jpeg', overlay: 0.3, objectPosition: 'top left', active: true },\r\n        { id: 'turtle', name: 'Turtle', type: 'image', url: 'https://images.unsplash.com/photo-1501791187590-9ef2612ba1eb?q=80&w=1932&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D', overlay: 0.3 },\r\n        { id: 'road', name: 'Road', type: 'image', url: 'https://images.unsplash.com/photo-1508233620467-f79f1e317a05', overlay: 0.3 },\r\n        { id: 'railroad', name: 'Railroad', type: 'image', url: 'https://images.unsplash.com/photo-1505832018823-50331d70d237', overlay: 0.3 },\r\n        { id: 'mountain', name: 'Mountain', type: 'image', url: 'https://raw.githubusercontent.com/evanhnry/brave-wallpapers/refs/heads/main/Brave/clay-banks-u27Rrbs9Dwc-unsplash.jpg', overlay: 0.3 },\r\n    ],\r\n\r\n    cloakPresets: [\r\n        { name: \"Phantom\", icon: \"/favicon.svg\", title: \"Phantom Unblocked\" },\r\n        { name: \"Edpuzzle\", icon: \"https://edpuzzle.imgix.net/favicons/favicon-32.png\", title: \"Edpuzzle\" },\r\n        { name: \"Google Docs\", icon: \"https://ssl.gstatic.com/docs/documents/images/kix-favicon7.ico\", title: \"Untitled document - Google Docs\" },\r\n        { name: \"Canvas\", icon: \"https://du11hjcvx0uqb.cloudfront.net/dist/images/favicon-e10d657a73.ico\", title: \"Dashboard\" },\r\n        { name: \"Desmos\", icon: \"https://www.desmos.com/favicon.ico\", title: \"Desmos | Graphing Calculator\" },\r\n        { name: \"Khan Academy\", icon: \"https://cdn.kastatic.org/images/favicon.ico\", title: \"Khan Academy\" },\r\n        { name: \"Wikipedia\", icon: \"https://en.wikipedia.org/favicon.ico\", title: \"World War II - Wikipedia\" },\r\n        { name: \"Classroom\", icon: \"https://ssl.gstatic.com/classroom/favicon.png\", title: \"Home - Classroom\" },\r\n        { name: \"Canva\", icon: \"https://static.canva.com/static/images/android-192x192-2.png\", title: \"Home - Canva\" },\r\n        { name: \"Quiz\", icon: \"https://ssl.gstatic.com/docs/spreadsheets/forms/forms_icon_2023q4.ico\", title: \"You've already responded\" },\r\n        { name: \"Blooket\", icon: \"https://play.blooket.com/favicon.ico\", title: \"Play Blooket | Blooket\" },\r\n        { name: \"Gmail\", icon: \"https://ssl.gstatic.com/ui/v1/icons/mail/rfr/gmail.ico\", title: \"Gmail\" },\r\n        { name: \"YouTube\", icon: \"https://www.youtube.com/favicon.ico\", title: \"YouTube\" },\r\n        { name: \"Powerschool\", icon: \"https://waverlyk12.powerschool.com/favicon.ico\", title: \"Grades and Attendance\" },\r\n        { name: \"nothing\", icon: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=\", title: \"\\u200B\" },\r\n    ]\r\n}\r\n\r\n\r\n\n</script>\r\n  <script>\n// settings handler\r\n(function () {\r\n    'use strict';\r\n\r\n    const STORAGE_KEY = 'void_settings';\r\n\r\n    const getDefaults = () => {\r\n        return window.SITE_CONFIG?.defaults || {\r\n            cloakMode: 'none',\r\n            cloakRotation: false,\r\n            cloakInterval: 5000,\r\n            panicKey: 'x',\r\n            panicModifiers: ['ctrl', 'shift'],\r\n            panicUrl: 'https://classroom.google.com',\r\n            maxMovieRating: 'R',\r\n            offlineGames: [],\r\n            gameLibrary: 'multi',\r\n            leaveConfirmation: false\r\n        };\r\n    };\r\n\r\n    const load = () => {\r\n        try {\r\n            const stored = localStorage.getItem(STORAGE_KEY);\r\n            if (stored) {\r\n                return { ...getDefaults(), ...JSON.parse(stored) };\r\n            }\r\n        } catch (e) {\r\n            console.warn('Failed to load settings:', e);\r\n        }\r\n        return getDefaults();\r\n    };\r\n\r\n    const save = (settings) => {\r\n        try {\r\n            localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n            window.dispatchEvent(new CustomEvent('settings-changed', { detail: settings }));\r\n            if (window.parent !== window) {\r\n                window.parent.postMessage({ type: 'settings-update' }, '*');\r\n            }\r\n        } catch (e) {\r\n            console.warn('Failed to save settings:', e);\r\n        }\r\n    };\r\n\r\n    let _settings = load();\r\n\r\n    window.Settings = {\r\n        get(key) { return _settings[key]; },\r\n\r\n        getAll() { return { ..._settings }; },\r\n\r\n        set(key, value) {\r\n            _settings[key] = value;\r\n            save(_settings);\r\n            this.apply();\r\n            return value;\r\n        },\r\n\r\n        update(partial) {\r\n            _settings = { ..._settings, ...partial };\r\n            save(_settings);\r\n            this.apply();\r\n        },\r\n\r\n        reset() {\r\n            _settings = getDefaults();\r\n            save(_settings);\r\n            this.apply();\r\n        },\r\n\r\n        apply() {\r\n            const root = document.documentElement;\r\n            const s = _settings;\r\n            const d = window.SITE_CONFIG?.defaults || {};\r\n\r\n            const vars = {\r\n                '--accent': s.accentColor || d.accentColor || '#ffffff',\r\n                '--surface': s.surfaceColor || d.surfaceColor || '#0f0f0f',\r\n                '--surface-hover': s.surfaceHoverColor || d.surfaceHoverColor || '#1a1a1a',\r\n                '--surface-active': s.surfaceActiveColor || d.surfaceActiveColor || '#252525',\r\n                '--secondary': s.secondaryColor || d.secondaryColor || '#2e2e33',\r\n                '--border': s.borderColor || d.borderColor || '#1f1f1f',\r\n                '--border-light': s.borderLightColor || d.borderLightColor || '#2a2a2a',\r\n                '--text': s.textColor || d.textColor || '#e4e4e7',\r\n                '--text-muted': s.textSecondaryColor || d.textSecondaryColor || '#71717a',\r\n                '--text-dim': s.textDimColor || d.textDimColor || '#52525b',\r\n                '--toggle': s.toggleColor || d.toggleColor,\r\n                '--toggle-knob': s.toggleKnobColor || d.toggleKnobColor\r\n            };\r\n\r\n            Object.entries(vars).forEach(([key, val]) => {\r\n                if (val) root.style.setProperty(key, val);\r\n            });\r\n\r\n            const themeBg = s.background || d.background || { type: 'color', value: '#0a0a0a' };\r\n            const customBg = s.customBackground;\r\n            const isCustomActive = customBg && customBg.type !== 'none';\r\n\r\n            if (themeBg.type === 'color') {\r\n                root.style.setProperty('--bg', themeBg.value);\r\n            }\r\n\r\n            if (isCustomActive && customBg.url) {\r\n                root.style.setProperty('--bg-image', `url(${customBg.url})`);\r\n\r\n                let position = customBg.objectPosition;\r\n                if (customBg.id && customBg.id !== 'custom') {\r\n                    const preset = window.SITE_CONFIG?.backgroundPresets?.find(b => b.id === customBg.id);\r\n                    if (preset?.objectPosition) position = preset.objectPosition;\r\n                }\r\n\r\n                root.style.setProperty('--bg-image-position', position || 'center');\r\n            } else if (themeBg.type === 'image' || themeBg.type === 'video') {\r\n                root.style.setProperty('--bg-image', `url(${themeBg.value || themeBg.url})`);\r\n                root.style.setProperty('--bg-image-position', themeBg.objectPosition || 'center');\r\n            } else if (themeBg.type === 'gradient') {\r\n                root.style.setProperty('--bg-image', themeBg.value || themeBg.url);\r\n                root.style.setProperty('--bg-image-position', 'center');\r\n            } else {\r\n                root.style.setProperty('--bg-image', 'none');\r\n            }\r\n        },\r\n\r\n        onChange(callback) {\r\n            window.addEventListener('settings-changed', (e) => callback(e.detail));\r\n        },\r\n\r\n        isRatingAllowed(rating) {\r\n            if (!rating || rating === 'NR' || rating === 'NC-17') return false;\r\n            const ratingOrder = ['G', 'PG', 'PG-13', 'R'];\r\n            const maxIndex = ratingOrder.indexOf(_settings.maxMovieRating);\r\n            const ratingIndex = ratingOrder.indexOf(rating);\r\n            return maxIndex !== -1 && ratingIndex !== -1 && ratingIndex <= maxIndex;\r\n        }\r\n    };\r\n\r\n    // panic button go brr\r\n    const handlePanic = (e) => {\r\n        const mods = _settings.panicModifiers || [];\r\n        const key = _settings.panicKey || 'x';\r\n\r\n        if (mods.includes('ctrl') !== e.ctrlKey) return;\r\n        if (mods.includes('shift') !== e.shiftKey) return;\r\n        if (mods.includes('alt') !== e.altKey) return;\r\n\r\n        if (e.key.toLowerCase() === key.toLowerCase()) {\r\n            e.preventDefault();\r\n            const overlayId = 'panic-overlay';\r\n            let overlay = window.parent?.document?.getElementById(overlayId) || document.getElementById(overlayId);\r\n\r\n            if (!overlay) {\r\n                overlay = document.createElement('div');\r\n                overlay.id = overlayId;\r\n                overlay.style.cssText = 'position:fixed;inset:0;background:white;z-index:99999;';\r\n                document.body.appendChild(overlay);\r\n            } else {\r\n                overlay.style.display = 'block';\r\n            }\r\n\r\n            window.location.replace(_settings.panicUrl || 'https://classroom.google.com');\r\n        }\r\n    };\r\n\r\n    const init = () => {\r\n        Settings.apply();\r\n\r\n        const featured = window.SITE_CONFIG?.featuredBackground;\r\n        const activePreset = window.SITE_CONFIG?.backgroundPresets?.find(p => p.active);\r\n\r\n        const target = activePreset || featured;\r\n\r\n        if (target?.id && target.id !== _settings.lastSeenFeatured) {\r\n            Settings.update({\r\n                customBackground: target,\r\n                lastSeenFeatured: target.id,\r\n                backgroundRotation: false\r\n            });\r\n        }\r\n\r\n        document.addEventListener('keydown', handlePanic, true);\r\n\r\n        window.addEventListener('storage', (e) => {\r\n            if (e.key === STORAGE_KEY) {\r\n                _settings = load();\r\n                Settings.apply();\r\n                window.dispatchEvent(new CustomEvent('settings-changed', { detail: _settings }));\r\n            }\r\n        });\r\n\r\n        window.addEventListener('message', (e) => {\r\n            if (e.data?.type === 'settings-update' || e.data === 'updateCloak') {\r\n                _settings = load();\r\n                Settings.apply();\r\n                window.dispatchEvent(new CustomEvent('settings-changed', { detail: _settings }));\r\n            }\r\n        });\r\n\r\n        window.addEventListener('beforeunload', (e) => {\r\n            if (document.getElementById('main-frame') && _settings.leaveConfirmation) {\r\n                e.preventDefault();\r\n                return e.returnValue = '';\r\n            }\r\n        });\r\n    };\r\n\r\n    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', init);\r\n    else init();\r\n})();\r\n\n</script>\r\n  <script>\n// background stuff\r\n(function () {\r\n    'use strict';\r\n\r\n    if (window.BackgroundManager) return;\r\n\r\n    const YOUTUBE_REGEX = /(?:youtube\\.com\\/watch\\?v=|youtu\\.be\\/|youtube\\.com\\/embed\\/)([a-zA-Z0-9_-]{11})/;\r\n\r\n    const BackgroundManager = {\r\n        container: null,\r\n        mediaLayer: null,\r\n        elements: { video: null, image: null, iframe: null },\r\n        current: { type: null, url: null },\r\n        cacheName: 'phantom-bg-cache-v2',\r\n\r\n        init() {\r\n            this.container = document.createElement('div');\r\n            this.container.className = 'phantom-background';\r\n            this.container.innerHTML = '<div class=\"phantom-background-overlay\"></div><div class=\"phantom-background-layer\"></div>';\r\n            this.mediaLayer = this.container.querySelector('.phantom-background-layer');\r\n            document.body.insertBefore(this.container, document.body.firstChild);\r\n\r\n            const apply = () => this.applyBackground();\r\n            window.addEventListener('settings-changed', apply);\r\n            window.addEventListener('storage', apply);\r\n            window.addEventListener('beforeunload', () => this.cleanup());\r\n            window.addEventListener('pagehide', () => this.cleanup());\r\n\r\n            document.addEventListener('visibilitychange', () => {\r\n                const video = this.elements.video;\r\n                if (!video) return;\r\n                if (document.hidden) video.pause();\r\n                else if (this.current.type === 'video') video.play().catch(() => { });\r\n            });\r\n\r\n            this.applyBackground();\r\n        },\r\n\r\n        applyBackground() {\r\n            if (!this.container) return; // Wait for init() to create the container\r\n\r\n            const s = window.Settings?.getAll() || {};\r\n            const custom = s.customBackground;\r\n            const theme = s.background || {};\r\n\r\n            let type = null, url = null, pos = null, overlay = 0.4;\r\n\r\n            if (custom && custom.type !== 'none') {\r\n                // Refresh from config if possible to get latest props like objectPosition\r\n                if (custom.id && custom.id !== 'custom') {\r\n                    const preset = window.SITE_CONFIG?.backgroundPresets?.find(b => b.id === custom.id);\r\n                    if (preset) Object.assign(custom, preset);\r\n                }\r\n                ({ type, url, objectPosition: pos, overlay = 0.4 } = custom);\r\n            } else if (theme.type === 'image' || theme.type === 'video' || theme.type === 'youtube') {\r\n                type = theme.type;\r\n                url = theme.value || theme.url;\r\n                pos = theme.objectPosition;\r\n                overlay = theme.overlay || 0.4;\r\n            }\r\n\r\n            document.documentElement.style.setProperty('--bg-overlay', overlay);\r\n\r\n            // Handle common positioning typos and normalize\r\n            if (pos && typeof pos === 'string') {\r\n                pos = pos.toLowerCase().trim()\r\n                    .replace(/\\s+/g, ' ') // Normalize multiple spaces\r\n                    .replace('topleft', 'top left')\r\n                    .replace('topright', 'top right')\r\n                    .replace('bottomleft', 'bottom left')\r\n                    .replace('bottomright', 'bottom right')\r\n                    .replace('centercenter', 'center')\r\n                    .replace('centerleft', 'center left')\r\n                    .replace('centerright', 'center right');\r\n            }\r\n\r\n            document.documentElement.style.setProperty('--bg-image-position', pos || 'center');\r\n\r\n            if (!type || !url) {\r\n                this.clear();\r\n                document.documentElement.style.backgroundColor = 'var(--bg)';\r\n                document.documentElement.style.setProperty('--bg-image-position', 'center');\r\n                return;\r\n            }\r\n            if (this.current.type === type && this.current.url === url) return;\r\n\r\n            this.current = { type, url };\r\n\r\n            if (type === 'video' || url.match(/\\.(mp4|webm|ogg|mov|m4v)$/i)) {\r\n                this.clearMedia();\r\n                this.createVideo(url, pos);\r\n                this.container.classList.add('active');\r\n                document.documentElement.classList.add('phantom-bg-active');\r\n                document.body.classList.add('phantom-bg-active');\r\n            } else if (type === 'youtube' || YOUTUBE_REGEX.test(url)) {\r\n                this.clearMedia();\r\n                this.createYouTube(url, pos);\r\n                this.container.classList.add('active');\r\n                document.documentElement.classList.add('phantom-bg-active');\r\n                document.body.classList.add('phantom-bg-active');\r\n            } else if (type === 'image') {\r\n                this.handleImageBackground(url, pos);\r\n            }\r\n        },\r\n\r\n        async getProxiedCachedUrl(url) {\r\n            // Local images don't need proxying\r\n            if (!url.startsWith('http') || url.includes(location.hostname)) return url;\r\n\r\n            // Try direct load first (faster)\r\n            try {\r\n                const directTest = await fetch(url, { method: 'HEAD', mode: 'cors' });\r\n                if (directTest.ok) return url;\r\n            } catch (e) {\r\n                // CORS blocked, need to proxy\r\n            }\r\n\r\n            // Wait for BareMux (max 500ms)\r\n            let retries = 0;\r\n            while (!window.BareMux && retries < 5) {\r\n                await new Promise(r => setTimeout(r, 100));\r\n                retries++;\r\n            }\r\n\r\n            if (!window.BareMux) {\r\n                console.warn(\"Background: BareMux not found, trying direct URL.\");\r\n                return url; // Try direct anyway\r\n            }\r\n\r\n            try {\r\n                const client = new window.BareMux.BareClient();\r\n                const response = await client.fetch(url);\r\n                if (!response.ok) throw new Error('Proxy fetch failed');\r\n\r\n                const blob = await response.blob();\r\n                return URL.createObjectURL(blob);\r\n            } catch (error) {\r\n                console.error(\"Background proxy failed:\", error);\r\n                return url; // Fallback to direct URL\r\n            }\r\n        },\r\n\r\n        async handleImageBackground(url, pos) {\r\n            // Pre-load the image (proxied/cached or direct)\r\n            const finalUrl = await this.getProxiedCachedUrl(url);\r\n\r\n            // Check if this is still the current background after async fetch\r\n            if (this.current.url !== url) {\r\n                if (finalUrl && finalUrl.startsWith('blob:')) URL.revokeObjectURL(finalUrl);\r\n                return;\r\n            }\r\n\r\n            this.clearMedia();\r\n            this.createImage(finalUrl, pos);\r\n        },\r\n\r\n        createVideo(url, pos) {\r\n            const el = Object.assign(document.createElement('video'), {\r\n                className: 'phantom-background-media', src: url, autoplay: true, loop: true, muted: true, playsInline: true, volume: 0\r\n            });\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n            el.onerror = () => (this.elements.video = null);\r\n            this.elements.video = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        createImage(url, pos) {\r\n            const el = Object.assign(document.createElement('img'), {\r\n                className: 'phantom-background-media',\r\n                src: url\r\n            });\r\n\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n\r\n            el.onload = () => {\r\n                if (this.current.url === url || url.startsWith('blob:')) {\r\n                    this.container.classList.add('active');\r\n                    document.documentElement.classList.add('phantom-bg-active');\r\n                    document.body.classList.add('phantom-bg-active');\r\n                }\r\n            };\r\n            el.onerror = () => {\r\n                console.warn(\"Background image failed to load:\", url);\r\n                if (this.elements.image === el) this.elements.image = null;\r\n            };\r\n\r\n            this.elements.image = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        // youtube logic\r\n        createYouTube(url, pos) {\r\n            const id = url.match(YOUTUBE_REGEX)?.[1];\r\n            if (!id) return;\r\n            const el = Object.assign(document.createElement('iframe'), {\r\n                className: 'phantom-background-media',\r\n                src: `https://www.youtube.com/embed/${id}?autoplay=1&loop=1&playlist=${id}&controls=0&modestbranding=1&rel=0&mute=1&enablejsapi=1`,\r\n                allow: 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture'\r\n            });\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n            this.elements.iframe = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        clearMedia() {\r\n            Object.entries(this.elements).forEach(([key, el]) => {\r\n                if (!el) return;\r\n                if (key === 'video') { el.pause(); el.src = ''; }\r\n                if (key === 'iframe') el.src = 'about:blank';\r\n                if (key === 'image' && el.src.startsWith('blob:')) {\r\n                    URL.revokeObjectURL(el.src);\r\n                }\r\n                el.remove();\r\n                this.elements[key] = null;\r\n            });\r\n        },\r\n\r\n        clear() {\r\n            this.clearMedia();\r\n            this.current = { type: null, url: null };\r\n            document.documentElement.classList.remove('phantom-bg-active');\r\n            document.body.classList.remove('phantom-bg-active');\r\n            document.documentElement.style.backgroundColor = '';\r\n            if (this.container) this.container.classList.remove('active');\r\n        },\r\n\r\n        cleanup() {\r\n            this.clearMedia();\r\n        }\r\n    };\r\n\r\n    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', () => BackgroundManager.init());\r\n    else BackgroundManager.init();\r\n\r\n    window.BackgroundManager = BackgroundManager;\r\n})();\r\n\n</script>\r\n  <script>\n(function () {\r\n    const style = document.createElement('style');\r\n    style.textContent = `\r\n        .notify-container { position: fixed; top: 16px; right: 16px; z-index: 99999; display: flex; flex-direction: column; gap: 8px; pointer-events: none; font-family: 'Inter', sans-serif; }\r\n        .notify-toast { display: flex; align-items: center; gap: 12px; padding: 12px 16px; background: rgba(15, 15, 15, 0.9); backdrop-filter: blur(10px); border: 1px solid var(--border, #1f1f1f); border-radius: 10px; color: #e4e4e7; font-size: 13px; min-width: 280px; max-width: 380px; box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4); pointer-events: auto; transform: translateX(120%); opacity: 0; transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1), opacity 0.3s ease; position: relative; overflow: hidden; }\r\n        .notify-toast.show { transform: translateX(0); opacity: 1; }\r\n        .notify-toast.hiding { transform: translateX(120%); opacity: 0; }\r\n        .notify-icon { width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }\r\n        .notify-icon svg { width: 18px; height: 18px; }\r\n        .notify-content { flex: 1; line-height: 1.4; }\r\n        .notify-title { font-weight: 600; margin-bottom: 2px; }\r\n        .notify-message { color: #a1a1aa; font-size: 12px; }\r\n        .notify-close { background: none; border: none; color: #52525b; cursor: pointer; padding: 4px; border-radius: 4px; display: flex; align-items: center; justify-content: center; }\r\n        .notify-close:hover { background: rgba(255,255,255,0.1); color: #fff; }\r\n        .notify-close svg { width: 14px; height: 14px; }\r\n        .notify-toast.success { border-left: 3px solid #22c55e; } .notify-toast.success .notify-icon { color: #22c55e; }\r\n        .notify-toast.error { border-left: 3px solid #ef4444; } .notify-toast.error .notify-icon { color: #ef4444; }\r\n        .notify-toast.warning { border-left: 3px solid #f59e0b; } .notify-toast.warning .notify-icon { color: #f59e0b; }\r\n        .notify-toast.info { border-left: 3px solid #3b82f6; } .notify-toast.info .notify-icon { color: #3b82f6; }\r\n        .notify-progress { position: absolute; bottom: 0; left: 0; height: 2px; background: rgba(255, 255, 255, 0.2); transition: width linear; }\r\n    `;\r\n    document.head.appendChild(style);\r\n\r\n    let container = null;\r\n    const getContainer = () => container || (container = document.body.appendChild(Object.assign(document.createElement('div'), { className: 'notify-container' })));\r\n\r\n    const icons = {\r\n        success: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"20 6 9 17 4 12\"></polyline></svg>`,\r\n        error: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"15\" y1=\"9\" x2=\"9\" y2=\"15\"></line><line x1=\"9\" y1=\"9\" x2=\"15\" y2=\"15\"></line></svg>`,\r\n        warning: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\"></path><line x1=\"12\" y1=\"9\" x2=\"12\" y2=\"13\"></line><line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\"></line></svg>`,\r\n        info: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"12\" y1=\"16\" x2=\"12\" y2=\"12\"></line><line x1=\"12\" y1=\"8\" x2=\"12.01\" y2=\"8\"></line></svg>`,\r\n        close: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line><line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line></svg>`\r\n    };\r\n\r\n    function notify(type, title, msg = '', dur = 4000) {\r\n        const t = document.createElement('div');\r\n        t.className = `notify-toast ${type}`;\r\n        t.innerHTML = `<div class=\"notify-icon\">${icons[type]}</div><div class=\"notify-content\"><div class=\"notify-title\">${title}</div><div class=\"notify-message\">${msg}</div></div><button class=\"notify-close\">${icons.close}</button><div class=\"notify-progress\"></div>`;\r\n        const p = t.querySelector('.notify-progress');\r\n        const dismiss = () => { t.classList.add('hiding'); setTimeout(() => t.remove(), 300); };\r\n        t.querySelector('.notify-close').onclick = dismiss;\r\n        p.style.width = '100%';\r\n        setTimeout(() => { p.style.transition = `width ${dur}ms linear`; p.style.width = '0%'; }, 50);\r\n        let timer = setTimeout(dismiss, dur);\r\n        t.onmouseenter = () => { clearTimeout(timer); p.style.transition = 'none'; };\r\n        t.onmouseleave = () => {\r\n            const rem = (parseFloat(getComputedStyle(p).width) / t.offsetWidth) * dur;\r\n            p.style.transition = `width ${rem}ms linear`; p.style.width = '0%';\r\n            timer = setTimeout(dismiss, rem);\r\n        };\r\n        getContainer().appendChild(t);\r\n        requestAnimationFrame(() => t.classList.add('show'));\r\n    }\r\n\r\n    window.Notify = {\r\n        success: (a, b, c) => notify('success', a, b, c),\r\n        error: (a, b, c) => notify('error', a, b, c),\r\n        warning: (a, b, c) => notify('warning', a, b, c),\r\n        info: (a, b, c) => notify('info', a, b, c)\r\n    };\r\n})();\r\n\n</script>\r\n\r\n  <div class=\"app-container\" id=\"chatApp\">\r\n    <div class=\"sidebar-overlay\" id=\"sidebarOverlay\"></div>\r\n    <aside class=\"sidebar\" id=\"chatSidebar\">\r\n      <div class=\"sidebar-header\">\r\n        <div class=\"brand-section\">\r\n          <i data-lucide=\"ghost\"></i>\r\n          <span>Phantom AI</span>\r\n        </div>\r\n      </div>\r\n\r\n      <button class=\"new-chat-btn\" id=\"newChatBtn\">\r\n        <i class=\"fas fa-plus\"></i>\r\n        <span>New Chat</span>\r\n      </button>\r\n\r\n      <div class=\"conversations\" id=\"conversationsList\">\r\n      </div>\r\n    </aside>\r\n\r\n    <main class=\"main-content\">\r\n      <header class=\"chat-header\">\r\n        <div class=\"header-left\">\r\n          <button class=\"menu-toggle\" id=\"menuToggle\" aria-label=\"Toggle sidebar\">\r\n            <i class=\"fas fa-bars\"></i>\r\n          </button>\r\n          <span class=\"chat-title\" id=\"chatTitle\">Phantom AI</span>\r\n        </div>\r\n        <div class=\"header-right\">\r\n          <select id=\"modelSelector\" class=\"select input\" aria-label=\"Select AI model\">\r\n            <option value=\"loading\">Loading...</option>\r\n          </select>\r\n        </div>\r\n      </header>\r\n\r\n      <div class=\"chat-body\" id=\"chatBody\">\r\n       \r\n      </div>\r\n\r\n      <div class=\"hero-section\" id=\"heroSection\">\r\n        <h1 class=\"hero-title\">Phantom AI</h1>\r\n        <p class=\"hero-subtitle\">Ethereal intelligence at your fingertips</p>\r\n      </div>\r\n\r\n      <div class=\"chat-footer\">\r\n        <div class=\"input-container\">\r\n\r\n          <div class=\"input-actions\">\r\n            <button class=\"mode-pill mode-btn active\" data-mode=\"text\" title=\"Text generation\">\r\n              <i class=\"fas fa-comment-alt\"></i>\r\n              <span>Text</span>\r\n            </button>\r\n            <button class=\"mode-pill mode-btn\" data-mode=\"image\" title=\"Image generation\">\r\n              <i class=\"fas fa-image\"></i>\r\n              <span>Image</span>\r\n            </button>\r\n          </div>\r\n\r\n    \r\n          <textarea id=\"chatInput\" class=\"chat-input\" placeholder=\"Message Phantom AI...\" rows=\"1\"\r\n            aria-label=\"Chat message input\"></textarea>\r\n\r\n   \r\n          <div class=\"input-actions\">\r\n            <button id=\"sendBtn\" class=\"send-btn\" disabled aria-label=\"Send message\">\r\n              <i class=\"fas fa-arrow-up\"></i>\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n    </main>\r\n  </div>\r\n\r\n  <!-- Libraries -->\r\n  <script src=\"https://cdn.jsdelivr.net/npm/marked/marked.min.js\"></script>\r\n  <script defer src=\"https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js\"></script>\r\n  <script defer src=\"https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js\"></script>\r\n  <script src=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js\"></script>\r\n  <script src=\"https://unpkg.com/lucide@latest/dist/umd/lucide.js\"></script>\r\n  \r\n  <script>\n// topbar\r\n(function () {\r\n    let rootPrefix = '';\r\n    const scriptName = 'components/topbar.js';\r\n    const scripts = document.getElementsByTagName('script');\r\n    for (let i = 0; i < scripts.length; i++) {\r\n        const src = scripts[i].getAttribute('src');\r\n        if (src && src.includes(scriptName)) {\r\n            rootPrefix = src.split(scriptName)[0];\r\n            break;\r\n        }\r\n    }\r\n\r\n    if (!window.lucide && !document.querySelector('script[src*=\"lucide\"]')) {\r\n        const script = document.createElement('script');\r\n        script.src = 'https://unpkg.com/lucide@latest';\r\n        script.onload = () => {\r\n            if (window.lucide) lucide.createIcons();\r\n        };\r\n        document.head.appendChild(script);\r\n    }\r\n\r\n    initTopbar();\r\n\r\n    function createTopbar() {\r\n        const topbarContainer = document.createElement('div');\r\n        topbarContainer.id = 'topbar-container';\r\n\r\n        const logoSection = document.createElement('a');\r\n        logoSection.className = 'logo-section';\r\n        logoSection.href = rootPrefix + 'index2.html';\r\n        logoSection.innerHTML = '<div class=\"logo-placeholder\"><i data-lucide=\"zap\"></i></div>';\r\n        topbarContainer.appendChild(logoSection);\r\n\r\n        const navButtons = document.createElement('div');\r\n        navButtons.className = 'nav-buttons';\r\n\r\n        const buttons = [\r\n            { name: 'Music', icon: 'music', link: 'pages/music.html', badge: 'BETA' },\r\n            { name: 'Movies', icon: 'film', link: 'pages/movies.html' },\r\n            { name: 'Games', icon: 'gamepad-2', link: 'pages/games.html' },\r\n            { name: 'Watch', icon: 'play', link: 'pages/watch.html' },\r\n            { name: 'Search', icon: 'search', link: 'staticsjv2/index.html' },\r\n            { name: 'AI Chat', icon: 'bot', link: 'pages/chat.html' },\r\n            { separator: true },\r\n            { name: 'Settings', icon: 'settings', link: 'pages/settings.html' }\r\n        ];\r\n\r\n        buttons.forEach(btn => {\r\n            if (btn.separator) {\r\n                const separator = document.createElement('div');\r\n                separator.className = 'nav-separator';\r\n                navButtons.appendChild(separator);\r\n                return;\r\n            }\r\n\r\n            const link = document.createElement('a');   \r\n            link.href = rootPrefix + btn.link;\r\n            link.className = 'nav-btn';\r\n\r\n            const icon = document.createElement('i');\r\n            icon.setAttribute('data-lucide', btn.icon);\r\n            link.appendChild(icon);\r\n\r\n            const span = document.createElement('span');\r\n            span.textContent = btn.name;\r\n            link.appendChild(span);\r\n\r\n            if (btn.badge) {\r\n                const badge = document.createElement('div');\r\n                badge.className = 'nav-badge-beta';\r\n                badge.textContent = btn.badge;\r\n                link.appendChild(badge);\r\n            }\r\n\r\n            navButtons.appendChild(link);\r\n        });\r\n\r\n        topbarContainer.appendChild(navButtons);\r\n        document.body.prepend(topbarContainer);\r\n\r\n        if (window.lucide) {\r\n            lucide.createIcons();\r\n        }\r\n    }\r\n\r\n    function initTopbar() {\r\n        if (document.readyState === 'loading') {\r\n            document.addEventListener('DOMContentLoaded', createTopbar);\r\n        } else {\r\n            createTopbar();\r\n        }\r\n    }\r\n})();\r\n\n</script>\r\n  <script>\n// footer\r\n(function () {\r\n    'use strict';\r\n\r\n    let rootPrefix = '';\r\n    const scriptName = 'components/footer.js';\r\n    const scripts = document.getElementsByTagName('script');\r\n    for (let i = 0; i < scripts.length; i++) {\r\n        const src = scripts[i].getAttribute('src');\r\n        if (src && src.includes(scriptName)) {\r\n            rootPrefix = src.split(scriptName)[0];\r\n            break;\r\n        }\r\n    }\r\n\r\n    const config = window.SITE_CONFIG || { name: 'Phantom', version: '1.0.0', discord: { inviteUrl: '#' }, changelog: [], cloakPresets: [] };\r\n    const STORAGE_KEY = 'void_settings';\r\n    let storedSettings = {};\r\n    try { storedSettings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n\r\n    // settings\r\n    let settings = { ...(config.defaults || {}), ...storedSettings };\r\n\r\n    const footer = document.createElement('footer');\r\n    footer.id = 'site-footer';\r\n    footer.innerHTML = `\r\n        <style>\r\n            #site-footer {\r\n                margin-top: 0px;\r\n                padding: 20px;\r\n                border-top: 1px solid var(--border, #1f1f1f);\r\n                text-align: center;\r\n                background: transparent;\r\n            }\r\n            #site-footer .footer-links {\r\n                display: flex;\r\n                gap: 16px;\r\n                justify-content: center;\r\n                margin-bottom: 8px;\r\n                flex-wrap: wrap;\r\n            }\r\n            #site-footer .footer-link {\r\n                font-size: 12px;\r\n                color: var(--text-muted, #71717a);\r\n                text-decoration: none;\r\n                transition: color 0.15s;\r\n                font-family: 'Inter', sans-serif;\r\n                cursor: pointer;\r\n            }\r\n            #site-footer .footer-link:hover {\r\n                color: var(--text, #e4e4e7);\r\n            }\r\n            #site-footer .footer-version {\r\n                font-size: 11px;\r\n                color: var(--text-dim, #52525b);\r\n                cursor: pointer;\r\n                font-family: 'Inter', sans-serif;\r\n            }\r\n            #site-footer .footer-version:hover {\r\n                color: var(--text-muted, #71717a);\r\n            }\r\n        </style>\r\n        <div class=\"footer-links\">\r\n            <a href=\"${rootPrefix}pages/settings.html\" class=\"footer-link\"><i class=\"fa-solid fa-gear\"></i> Settings</a>\r\n            <a id=\"footer-changelog\" class=\"footer-link\"><i class=\"fa-solid fa-clock-rotate-left\"></i> Changelog</a>\r\n            <a href=\"${config.discord?.inviteUrl || '#'}\" target=\"_blank\" class=\"footer-link\"><i class=\"fa-brands fa-discord\"></i> Discord</a>\r\n            <a href=\"${rootPrefix}pages/terms.html\" class=\"footer-link\">Terms</a>\r\n            <a href=\"${rootPrefix}pages/disclaimer.html\" class=\"footer-link\">Disclaimer</a>\r\n            <a href=\"${rootPrefix}pages/extra.html\" class=\"footer-link\">Credits</a>\r\n        </div>\r\n        <span class=\"footer-version\" id=\"footer-version\">${config.name || 'Phantom'} v${config.version || '1.0.0'}</span>\r\n    `;\r\n\r\n    document.body.appendChild(footer);\r\n\r\n\r\n\r\n    // gtm\r\n    // Inject GTM head script if not already present\r\n    if (!document.querySelector('script[src*=\"googletagmanager.com/gtm.js\"]')) {\r\n        window.dataLayer = window.dataLayer || [];\r\n        window.dataLayer.push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' });\r\n        const gtmScript = document.createElement('script');\r\n        gtmScript.async = true;\r\n        gtmScript.src = 'https://www.googletagmanager.com/gtm.js?id=GTM-5LMBC27Z';\r\n        document.head.insertBefore(gtmScript, document.head.firstChild);\r\n    }\r\n\r\n    // Add GTM noscript fallback (for pages that don't have it in HTML)\r\n    if (!document.querySelector('noscript iframe[src*=\"googletagmanager\"]')) {\r\n        const gtmNoscript = document.createElement('noscript');\r\n        gtmNoscript.innerHTML = '<iframe src=\"https://www.googletagmanager.com/ns.html?id=GTM-5LMBC27Z\" height=\"0\" width=\"0\" style=\"display:none;visibility:hidden\"></iframe>';\r\n        document.body.insertBefore(gtmNoscript, document.body.firstChild);\r\n    }\r\n\r\n    const openChangelog = (e, customTitle, customContent) => {\r\n        if (e && e.preventDefault) e.preventDefault();\r\n        const changes = customContent || config.changelog || ['No changes listed'];\r\n\r\n        // Use standard modal structure from main.css\r\n        const overlay = document.createElement('div');\r\n        overlay.className = 'modal-overlay';\r\n\r\n        overlay.innerHTML = `\r\n            <div class=\"modal\" style=\"width: 400px; max-width: 90vw;\">\r\n                <div class=\"modal-header\">\r\n                    <h3 class=\"modal-title\">${customTitle || 'What\\'s New in v' + config.version}</h3>\r\n                    <button class=\"modal-close\"><i class=\"fa-solid fa-xmark\"></i></button>\r\n                </div>\r\n                <div class=\"modal-body\">\r\n                    <ul style=\"margin: 0; padding-left: 20px; color: var(--text-muted); font-size: 0.875rem; line-height: 1.6;\">\r\n                        ${changes.map(c => '<li>' + c + '</li>').join('')}\r\n                    </ul>\r\n                </div>\r\n                <div class=\"modal-footer\">\r\n                    <a href=\"${config.discord?.inviteUrl || '#'}\" target=\"_blank\" style=\"color: #5865F2; text-decoration: none; font-size: 13px; display: inline-flex; align-items: center; gap: 6px;\">\r\n                        <i class=\"fa-brands fa-discord\"></i> Join Discord\r\n                    </a>\r\n                </div>\r\n            </div>\r\n        `;\r\n\r\n        document.body.appendChild(overlay);\r\n\r\n        // Trigger animation\r\n        requestAnimationFrame(() => overlay.classList.add('show'));\r\n\r\n        const close = () => {\r\n            overlay.classList.remove('show');\r\n            setTimeout(() => overlay.remove(), 200);\r\n        };\r\n\r\n        overlay.querySelector('.modal-close').onclick = close;\r\n        overlay.onclick = (e) => { if (e.target === overlay) close(); };\r\n    };\r\n\r\n    // Expose openChangelog globally\r\n    window.openChangelog = openChangelog;\r\n\r\n    const changelogBtn = document.getElementById('footer-changelog');\r\n    if (changelogBtn) changelogBtn.onclick = openChangelog;\r\n\r\n    const versionBtn = document.getElementById('footer-version');\r\n    if (versionBtn) versionBtn.onclick = openChangelog;\r\n\r\n    // sync\r\n    // syncRemoteChangelog removed - using local config\r\n\r\n\r\n    // Initialize Sync\r\n    // syncRemoteChangelog();\r\n\r\n    const currentVersion = config.version;\r\n    const lastVersion = settings.lastVersion;\r\n\r\n    if (settings.showChangelogOnUpdate && lastVersion && lastVersion !== currentVersion) {\r\n        setTimeout(() => {\r\n            openChangelog();\r\n            settings.lastVersion = currentVersion;\r\n            localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n        }, 1000);\r\n    } else if (!lastVersion) {\r\n        settings.lastVersion = currentVersion;\r\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n    }\r\n\r\n    // panic\r\n    if (settings.panicKey) {\r\n        document.addEventListener('keydown', (e) => {\r\n            const keys = settings.panicModifiers || ['ctrl', 'shift'];\r\n            const triggerKey = settings.panicKey.toLowerCase();\r\n            const pressedKey = e.key.toLowerCase();\r\n\r\n            // Check modifiers\r\n            const ctrlMatch = keys.includes('ctrl') === e.ctrlKey;\r\n            const shiftMatch = keys.includes('shift') === e.shiftKey;\r\n            const altMatch = keys.includes('alt') === e.altKey;\r\n\r\n            if (ctrlMatch && shiftMatch && altMatch && pressedKey === triggerKey) {\r\n                e.preventDefault();\r\n\r\n                // Show white screen instantly (if panic-overlay exists in parent)\r\n                const parentOverlay = window.parent?.document?.getElementById('panic-overlay');\r\n                if (parentOverlay) {\r\n                    parentOverlay.style.display = 'block';\r\n                } else {\r\n                    // Create overlay if it doesn't exist\r\n                    const overlay = document.createElement('div');\r\n                    overlay.id = 'panic-overlay';\r\n                    overlay.style.cssText = 'position:fixed;inset:0;background:white;z-index:99999;';\r\n                    document.body.appendChild(overlay);\r\n                }\r\n\r\n                // Redirect immediately\r\n                const url = settings.panicUrl || 'https://classroom.google.com';\r\n                try { window.top.location.href = url; } catch { window.location.href = url; }\r\n            }\r\n        }, true); // Use capture phase for faster response\r\n    }\r\n\r\n    // Cloaking logic has been moved to scripts/cloaking.js for better synchronization.\r\n    // If you need cloaking on a specific page, include that script.\r\n\r\n\r\n    window.addEventListener('beforeunload', (e) => {\r\n        // Reload settings to get latest value\r\n        try { settings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n\r\n        if (window.top === window.self && settings.leaveConfirmation) {\r\n            e.preventDefault();\r\n            e.returnValue = '';\r\n            return '';\r\n        }\r\n    });\r\n\r\n    // discord\r\n    let crateInstance = null;\r\n\r\n    function initDiscord() {\r\n        if (settings.discordWidget && config.discord && config.discord.widgetServer && config.discord.widgetChannel) {\r\n            // Check if already loaded\r\n            if (document.querySelector('script[src*=\"@widgetbot/crate\"]')) {\r\n                if (crateInstance) crateInstance.show();\r\n                return;\r\n            }\r\n\r\n            const crateScript = document.createElement('script');\r\n            crateScript.src = 'https://cdn.jsdelivr.net/npm/@widgetbot/crate@3';\r\n            crateScript.async = true;\r\n            crateScript.defer = true;\r\n            crateScript.onload = () => {\r\n                crateInstance = new Crate({\r\n                    server: config.discord.widgetServer,\r\n                    channel: config.discord.widgetChannel,\r\n                    glyph: ['https://cdn.discordapp.com/embed/avatars/0.png', '100%'],\r\n                    location: ['bottom', 'right']\r\n                });\r\n            };\r\n            document.body.appendChild(crateScript);\r\n        } else {\r\n            // Hide if disabled\r\n            if (crateInstance) crateInstance.hide();\r\n        }\r\n    }\r\n\r\n    // Initialize\r\n    initDiscord();\r\n\r\n    // Listen for settings change to toggle dynamically\r\n    window.addEventListener('storage', (e) => {\r\n        if (e.key === STORAGE_KEY) {\r\n            try { settings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n            initDiscord();\r\n        }\r\n    });\r\n\r\n    // Listen for internal event\r\n    window.addEventListener('settings-changed', (e) => {\r\n        settings = e.detail;\r\n        initDiscord();\r\n    });\r\n\r\n    // counters\r\n    // Only show on home page (index2.html) checking if main-content exists\r\n    const mainContent = document.querySelector('.main-content');\r\n    // Ensure we are on the home page view (search bar checks etc) or just check existence\r\n    if (mainContent && document.querySelector('.featured-section')) {\r\n        const counterContainer = document.createElement('div');\r\n        counterContainer.id = 'supercounters-wrapper';\r\n        counterContainer.style.marginTop = '24px';\r\n        counterContainer.style.textAlign = 'center';\r\n        counterContainer.style.opacity = '0.8';\r\n\r\n        // Use iframe to isolate document.write from the widget\r\n        const iframe = document.createElement('iframe');\r\n        iframe.style.border = 'none';\r\n        iframe.style.width = '150px';\r\n        iframe.style.height = '40px';\r\n        iframe.style.overflow = 'hidden';\r\n\r\n        // Widget code\r\n        const widgetCode = `\r\n            <html>\r\n            <body style=\"margin:0;display:flex;justify-content:center;align-items:center;background:transparent;\">\r\n                <script type=\"text/javascript\" src=\"//widget.supercounters.com/ssl/online_i.js\"><\\/script>\r\n                <script type=\"text/javascript\">sc_online_i(1726449,\"ffffff\",\"000000\");<\\/script>\r\n            </body>\r\n            </html>\r\n        `;\r\n\r\n        iframe.srcdoc = widgetCode;\r\n        counterContainer.appendChild(iframe);\r\n        mainContent.appendChild(counterContainer);\r\n    }\r\n})();\r\n\n</script>\r\n  <script>\n// talking to robots\r\nclass PhantomChat {\r\n    constructor() {\r\n        this.state = {\r\n            conversations: [],\r\n            currentId: null,\r\n            models: { text: [], image: [] },\r\n            config: {\r\n                textModel: 'openai',\r\n                imageModel: 'flux',\r\n                mode: 'text',\r\n                autoSave: true\r\n            }\r\n        };\r\n\r\n        this.placeholders = [\r\n            \"Ask me anything...\",\r\n            \"Explain quantum physics simply\",\r\n            \"Write a poem about the stars\",\r\n            \"Help me with my homework\"\r\n        ];\r\n\r\n        this.dom = {};\r\n        this.storageKey = 'phantom_ai_data';\r\n        this.apiKey = 'sk_j66iDfX2lPbTZ2Otb9MI7xje7kRZQUyE';\r\n        this.baseTextUrl = 'https://gen.pollinations.ai/v1/chat/completions';\r\n        this.baseImageUrl = 'https://gen.pollinations.ai/image/';\r\n\r\n        this.init();\r\n    }\r\n\r\n    init() {\r\n        this.cacheDOM();\r\n        this.loadState();\r\n        this.bindEvents();\r\n        this.fetchModels();\r\n        this.render();\r\n        this.startPlaceholderAnimation();\r\n\r\n        if (window.Notify) {\r\n            Notify.success('Ready', 'Phantom AI is loaded');\r\n        }\r\n    }\r\n\r\n    cacheDOM() {\r\n        this.dom = {\r\n            app: document.getElementById('chatApp'),\r\n            sidebar: document.getElementById('chatSidebar'),\r\n            sidebarOverlay: document.getElementById('sidebarOverlay'),\r\n            chatBody: document.getElementById('chatBody'),\r\n            input: document.getElementById('chatInput'),\r\n            sendBtn: document.getElementById('sendBtn'),\r\n            modelSelect: document.getElementById('modelSelector'),\r\n            hero: document.getElementById('heroSection'),\r\n            convList: document.getElementById('conversationsList'),\r\n            title: document.getElementById('chatTitle')\r\n        };\r\n    }\r\n\r\n    bindEvents() {\r\n        document.addEventListener('click', (e) => {\r\n            const target = e.target;\r\n\r\n            if (target.closest('#menuToggle') || target.closest('#sidebarToggle')) {\r\n                this.toggleSidebar();\r\n            }\r\n            if (target.closest('#newChatBtn')) {\r\n                this.createConversation();\r\n            }\r\n            if (target.closest('.mode-btn')) {\r\n                this.setMode(target.closest('.mode-btn').dataset.mode);\r\n            }\r\n            if (target.id === 'sidebarOverlay') {\r\n                this.toggleSidebar(false);\r\n            }\r\n        });\r\n\r\n        this.dom.input.addEventListener('keydown', (e) => {\r\n            if (e.key === 'Enter' && !e.shiftKey) {\r\n                e.preventDefault();\r\n                this.sendMessage();\r\n            }\r\n        });\r\n\r\n        this.dom.input.addEventListener('input', () => {\r\n            this.autoResizeInput();\r\n            this.dom.sendBtn.disabled = !this.dom.input.value.trim();\r\n        });\r\n\r\n        this.dom.modelSelect.addEventListener('change', (e) => {\r\n            const key = this.state.config.mode === 'text' ? 'textModel' : 'imageModel';\r\n            this.state.config[key] = e.target.value;\r\n            this.saveState();\r\n            if (window.Notify) Notify.success('Model Changed', e.target.value);\r\n        });\r\n\r\n        this.dom.sendBtn.addEventListener('click', () => this.sendMessage());\r\n    }\r\n\r\n    startPlaceholderAnimation() {\r\n        let idx = 0, charIdx = 0, deleting = false;\r\n\r\n        const animate = () => {\r\n            const text = this.placeholders[idx];\r\n\r\n            if (deleting) {\r\n                this.dom.input.placeholder = text.substring(0, charIdx--);\r\n                if (charIdx < 0) {\r\n                    deleting = false;\r\n                    idx = (idx + 1) % this.placeholders.length;\r\n                    setTimeout(animate, 400);\r\n                    return;\r\n                }\r\n            } else {\r\n                this.dom.input.placeholder = text.substring(0, charIdx++);\r\n                if (charIdx > text.length) {\r\n                    deleting = true;\r\n                    setTimeout(animate, 2500);\r\n                    return;\r\n                }\r\n            }\r\n            setTimeout(animate, deleting ? 30 : 60);\r\n        };\r\n        animate();\r\n    }\r\n\r\n    autoResizeInput() {\r\n        const el = this.dom.input;\r\n        el.style.height = 'auto';\r\n        el.style.height = Math.min(el.scrollHeight, 200) + 'px';\r\n    }\r\n\r\n    toggleSidebar(force) {\r\n        const isDesktop = window.innerWidth > 768;\r\n        const sidebar = this.dom.sidebar;\r\n\r\n        if (isDesktop) {\r\n            const isOpen = !sidebar.classList.contains('collapsed');\r\n            const newState = force !== undefined ? force : !isOpen;\r\n            sidebar.classList.toggle('collapsed', !newState);\r\n            this.dom.app.classList.toggle('sidebar-collapsed', !newState);\r\n        } else {\r\n            const isOpen = sidebar.classList.contains('active');\r\n            const newState = force !== undefined ? force : !isOpen;\r\n            sidebar.classList.toggle('active', newState);\r\n            this.dom.sidebarOverlay?.classList.toggle('active', newState);\r\n        }\r\n    }\r\n\r\n    scrollToBottom() {\r\n        requestAnimationFrame(() => {\r\n            this.dom.chatBody.scrollTop = this.dom.chatBody.scrollHeight;\r\n        });\r\n    }\r\n\r\n    async copyImage(imgElement) {\r\n        try {\r\n            if (!imgElement.complete) {\r\n                await new Promise(resolve => imgElement.onload = resolve);\r\n            }\r\n\r\n            const canvas = document.createElement('canvas');\r\n            canvas.width = imgElement.naturalWidth || imgElement.width;\r\n            canvas.height = imgElement.naturalHeight || imgElement.height;\r\n            const ctx = canvas.getContext('2d');\r\n            ctx.drawImage(imgElement, 0, 0);\r\n\r\n            const blob = await new Promise(resolve => canvas.toBlob(resolve, 'image/png'));\r\n            await navigator.clipboard.write([new ClipboardItem({ 'image/png': blob })]);\r\n\r\n            if (window.Notify) Notify.success('Copied', 'Image copied to clipboard');\r\n        } catch (err) {\r\n            console.error('Image copy failed:', err);\r\n            if (window.Notify) Notify.error('Failed', 'Could not copy image');\r\n        }\r\n    }\r\n\r\n\r\n    copyText(text) {\r\n        navigator.clipboard.writeText(text).then(() => {\r\n            if (window.Notify) Notify.success('Copied', 'Text copied to clipboard');\r\n        }).catch(() => {\r\n            if (window.Notify) Notify.error('Failed', 'Could not copy text');\r\n        });\r\n    }\r\n\r\n    async fetchModels() {\r\n        try {\r\n            const res = await fetch('https://gen.pollinations.ai/models', {\r\n                headers: { 'Authorization': `Bearer ${this.apiKey}` }\r\n            });\r\n            const data = await res.json();\r\n\r\n            if (Array.isArray(data) && data.length && typeof data[0] === 'object') {\r\n                this.state.models.text = data\r\n                    .filter(m => m.type === 'text' || m.output_modalities?.includes('text'))\r\n                    .map(m => m.name);\r\n                this.state.models.image = data\r\n                    .filter(m => m.type === 'image' || m.output_modalities?.includes('image'))\r\n                    .map(m => m.name);\r\n            }\r\n\r\n            if (!this.state.models.text.length) {\r\n                this.state.models.text = ['openai', 'mistral', 'llama'];\r\n            }\r\n            if (!this.state.models.image.length) {\r\n                this.state.models.image = ['flux', 'turbo'];\r\n            }\r\n\r\n            this.updateModelSelect();\r\n        } catch {\r\n            this.state.models.text = ['openai', 'mistral', 'llama'];\r\n            this.state.models.image = ['flux', 'turbo'];\r\n            this.updateModelSelect();\r\n        }\r\n    }\r\n\r\n    updateModelSelect() {\r\n        const models = this.state.models[this.state.config.mode];\r\n        const current = this.state.config.mode === 'text'\r\n            ? this.state.config.textModel\r\n            : this.state.config.imageModel;\r\n\r\n        this.dom.modelSelect.innerHTML = models.map(m =>\r\n            `<option value=\"${m}\" ${m === current ? 'selected' : ''}>${this.capitalize(m)}</option>`\r\n        ).join('');\r\n    }\r\n\r\n    setMode(mode) {\r\n        if (mode !== 'text' && mode !== 'image') return;\r\n\r\n        this.state.config.mode = mode;\r\n        document.querySelectorAll('.mode-btn').forEach(btn => {\r\n            btn.classList.toggle('active', btn.dataset.mode === mode);\r\n        });\r\n        this.updateModelSelect();\r\n        this.saveState();\r\n    }\r\n\r\n    capitalize(str) {\r\n        return str.charAt(0).toUpperCase() + str.slice(1);\r\n    }\r\n\r\n    loadState() {\r\n        try {\r\n            const saved = JSON.parse(localStorage.getItem(this.storageKey));\r\n            if (saved) {\r\n                this.state.conversations = saved.conversations || [];\r\n                this.state.currentId = saved.currentId;\r\n                Object.assign(this.state.config, saved.config);\r\n            }\r\n        } catch { }\r\n\r\n        if (!this.state.conversations.length) {\r\n            this.createConversation();\r\n        } else if (!this.state.currentId) {\r\n            this.state.currentId = this.state.conversations[0].id;\r\n        }\r\n    }\r\n\r\n    saveState() {\r\n        if (!this.state.config.autoSave) return;\r\n        localStorage.setItem(this.storageKey, JSON.stringify({\r\n            conversations: this.state.conversations,\r\n            currentId: this.state.currentId,\r\n            config: this.state.config\r\n        }));\r\n    }\r\n\r\n    createConversation() {\r\n        const conv = {\r\n            id: Date.now().toString(),\r\n            title: 'New Chat',\r\n            messages: [],\r\n            createdAt: Date.now()\r\n        };\r\n        this.state.conversations.unshift(conv);\r\n        this.state.currentId = conv.id;\r\n        this.setMode('text');\r\n        this.render();\r\n        this.dom.input.focus();\r\n        this.saveState();\r\n    }\r\n\r\n    deleteConversation(id) {\r\n        this.state.conversations = this.state.conversations.filter(c => c.id !== id);\r\n\r\n        if (this.state.currentId === id) {\r\n            this.state.currentId = this.state.conversations[0]?.id;\r\n            if (!this.state.currentId) this.createConversation();\r\n        }\r\n\r\n        this.render();\r\n        this.saveState();\r\n    }\r\n\r\n    get currentConversation() {\r\n        return this.state.conversations.find(c => c.id === this.state.currentId);\r\n    }\r\n\r\n    loadConversation(id) {\r\n        this.state.currentId = id;\r\n        this.render();\r\n        if (window.innerWidth <= 768) this.toggleSidebar(false);\r\n    }\r\n\r\n    async sendMessage() {\r\n        const text = this.dom.input.value.trim();\r\n        if (!text) return;\r\n\r\n        this.dom.input.value = '';\r\n        this.autoResizeInput();\r\n        this.dom.sendBtn.disabled = true;\r\n\r\n        const conv = this.currentConversation;\r\n        if (!conv) return;\r\n\r\n        conv.messages.push({ role: 'user', content: text, type: 'text' });\r\n        this.appendMessage({ role: 'user', content: text });\r\n\r\n        if (conv.messages.length === 1) {\r\n            conv.title = text.length > 35 ? text.substring(0, 35) + '...' : text;\r\n            this.dom.title.textContent = conv.title;\r\n            this.renderConversationList();\r\n        }\r\n\r\n        if (this.state.config.mode === 'image') {\r\n            await this.generateImage(text, conv);\r\n        } else {\r\n            await this.generateText(text, conv);\r\n        }\r\n\r\n        this.saveState();\r\n    }\r\n\r\n    async generateText(input, conv) {\r\n        const thinkingId = 'thinking-' + Date.now();\r\n        this.appendMessage({ role: 'ai', id: thinkingId, isThinking: true });\r\n\r\n        try {\r\n            const messages = [\r\n                { role: 'system', content: 'You are Phantom AI, a helpful and knowledgeable assistant. Use Markdown formatting. Be concise but thorough.' },\r\n                ...conv.messages.slice(-10).map(m => ({\r\n                    role: m.role === 'ai' ? 'assistant' : m.role,\r\n                    content: m.content\r\n                }))\r\n            ];\r\n\r\n            const res = await fetch(this.baseTextUrl, {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                    'Authorization': `Bearer ${this.apiKey}`\r\n                },\r\n                body: JSON.stringify({\r\n                    messages,\r\n                    model: this.state.config.textModel,\r\n                    seed: Math.floor(Math.random() * 1000000)\r\n                })\r\n            });\r\n\r\n            if (!res.ok) throw new Error(`API Error: ${res.status}`);\r\n\r\n            const data = await res.json();\r\n            const reply = data.choices[0].message.content;\r\n\r\n            document.getElementById(thinkingId)?.remove();\r\n\r\n            conv.messages.push({ role: 'ai', content: reply, type: 'text' });\r\n            this.appendMessage({ role: 'ai', content: reply, type: 'text' });\r\n\r\n        } catch (err) {\r\n            const el = document.getElementById(thinkingId);\r\n            if (el) {\r\n                el.querySelector('.message-text').innerHTML =\r\n                    `<span style=\"color: var(--error)\">Failed to get response: ${err.message}</span>`;\r\n            }\r\n        }\r\n    }\r\n\r\n    async generateImage(prompt, conv) {\r\n        const seed = Math.floor(Math.random() * 1000000);\r\n        const url = `${this.baseImageUrl}${encodeURIComponent(prompt)}?model=${this.state.config.imageModel}&nologo=true&seed=${seed}&key=${this.apiKey}`;\r\n\r\n        conv.messages.push({ role: 'ai', content: url, prompt, type: 'image' });\r\n        this.appendMessage({ role: 'ai', content: url, prompt, type: 'image' });\r\n    }\r\n\r\n    retryLast() {\r\n        const conv = this.currentConversation;\r\n        if (!conv || conv.messages.length < 2) return;\r\n\r\n        for (let i = conv.messages.length - 1; i >= 0; i--) {\r\n            if (conv.messages[i].role === 'user') {\r\n                const text = conv.messages[i].content;\r\n                conv.messages = conv.messages.slice(0, i + 1);\r\n                this.render();\r\n                this.dom.input.value = text;\r\n                this.sendMessage();\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    // draws stuff\r\n    render() {\r\n        const conv = this.currentConversation;\r\n        this.renderConversationList();\r\n        this.dom.chatBody.innerHTML = '';\r\n\r\n        if (!conv || !conv.messages.length) {\r\n            this.dom.hero.style.display = 'block';\r\n            this.dom.title.textContent = 'Phantom AI';\r\n        } else {\r\n            this.dom.hero.style.display = 'none';\r\n            this.dom.title.textContent = conv.title;\r\n            conv.messages.forEach(msg => this.appendMessage(msg));\r\n        }\r\n    }\r\n\r\n    renderConversationList() {\r\n        this.dom.convList.innerHTML = this.state.conversations.map(c => `\r\n            <div class=\"conversation-item ${c.id === this.state.currentId ? 'active' : ''}\" \r\n                 onclick=\"phantomChat.loadConversation('${c.id}')\">\r\n                <span class=\"conversation-title\">${this.escapeHtml(c.title)}</span>\r\n                <button class=\"delete-btn\" onclick=\"event.stopPropagation(); phantomChat.deleteConversation('${c.id}')\">\r\n                    <i class=\"fas fa-trash\"></i>\r\n                </button>\r\n            </div>\r\n        `).join('');\r\n    }\r\n\r\n    escapeHtml(text) {\r\n        const div = document.createElement('div');\r\n        div.textContent = text;\r\n        return div.innerHTML;\r\n    }\r\n\r\n    appendMessage({ role, content, type = 'text', prompt, id, isThinking }) {\r\n        this.dom.hero.style.display = 'none';\r\n\r\n        const div = document.createElement('div');\r\n        div.className = `message ${role}-message`;\r\n        if (id) div.id = id;\r\n\r\n        const icon = role === 'ai' ? 'ghost' : 'user';\r\n\r\n        let messageHtml = '';\r\n\r\n        if (isThinking) {\r\n            messageHtml = '<span class=\"thinking-dots\">Thinking</span>';\r\n        } else if (type === 'image') {\r\n            messageHtml = `\r\n                <p class=\"image-prompt\">${this.escapeHtml(prompt)}</p>\r\n                <div class=\"image-container\">\r\n                    <img src=\"${content}\" \r\n                         class=\"generated-image\" \r\n                         alt=\"${this.escapeHtml(prompt)}\"\r\n                         crossorigin=\"anonymous\"\r\n                         loading=\"lazy\"\r\n                         onclick=\"phantomChat.copyImage(this)\"\r\n                         onload=\"this.classList.add('loaded')\"\r\n                         onerror=\"this.parentElement.innerHTML='<div class=\\\\'image-loader\\\\'><i class=\\\\'fas fa-exclamation-triangle\\\\'></i><p>Failed to load</p></div>'\">\r\n                    <div class=\"image-loader\">\r\n                        <i class=\"fas fa-spinner fa-spin\"></i>\r\n                        <span>Generating...</span>\r\n                    </div>\r\n                </div>\r\n            `;\r\n        } else {\r\n            messageHtml = window.marked ? marked.parse(content) : this.escapeHtml(content);\r\n        }\r\n\r\n        const imgId = type === 'image' ? `img-${Date.now()}` : '';\r\n\r\n        div.innerHTML = `\r\n            <div class=\"message-avatar\">\r\n                <i data-lucide=\"${icon}\"></i>\r\n            </div>\r\n            <div class=\"message-content\">\r\n                <div class=\"message-text\">${messageHtml.replace('class=\"generated-image\"', `class=\"generated-image\" id=\"${imgId}\"`)}</div>\r\n                ${role === 'ai' && !isThinking ? `\r\n                    <div class=\"message-actions\">\r\n                        <button class=\"btn\" title=\"Copy\" onclick=\"${type === 'image' ? `phantomChat.copyImage(document.getElementById('${imgId}'))` : `phantomChat.copyText(\\`${content.replace(/`/g, '\\\\`').replace(/\\\\/g, '\\\\\\\\')}\\`)`}\">\r\n                            <i class=\"fas fa-copy\"></i>\r\n                        </button>\r\n                        <button class=\"btn\" title=\"Retry\" onclick=\"phantomChat.retryLast()\">\r\n                            <i class=\"fas fa-redo\"></i>\r\n                        </button>\r\n                    </div>\r\n                ` : ''}\r\n            </div>\r\n        `;\r\n\r\n        this.dom.chatBody.appendChild(div);\r\n\r\n        if (window.lucide) lucide.createIcons({ icons: { ghost: lucide.icons.ghost, user: lucide.icons.user }, nameAttr: 'data-lucide' });\r\n\r\n        if (!isThinking && type === 'text' && window.hljs) {\r\n            div.querySelectorAll('pre code').forEach(block => hljs.highlightElement(block));\r\n        }\r\n\r\n        if (!isThinking && type === 'text' && window.renderMathInElement) {\r\n            renderMathInElement(div, {\r\n                delimiters: [\r\n                    { left: '$', right: '$', display: true },\r\n                    { left: '
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phantom Unblocked</title>
    <link rel="icon" href="favicon.svg" type="image/svg+xml">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- Google Tag Manager -->
    <script>(function (w, d, s, l, i) {
            w[l] = w[l] || []; w[l].push({
                'gtm.start':
                    new Date().getTime(), event: 'gtm.js'
            }); var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
                    'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-5LMBC27Z');</script>
    <!-- End Google Tag Manager -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html,
        body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: var(--bg, #0a0a0a);
            font-family: 'Inter', -apple-system, sans-serif;
        }


        .loading-screen {
            position: fixed;
            inset: 0;
            background: rgba(10, 10, 10, 0.6);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }

        .loading-screen.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
            transition: opacity 0.5s ease-in-out, visibility 0.5s;
        }

        .loading-logo {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 24px;
            display: flex;
            align-items: center;
            gap: 14px;
        }

        .loading-logo i {
            color: var(--text-muted, #a1a1aa);
        }

        .loading-logo span {
            background: linear-gradient(90deg, var(--text, #e4e4e7) 0%, var(--text-muted, #a1a1aa) 40%, var(--text-dim, #52525b) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border, #1f1f1f);
            border-top-color: var(--text-muted, #71717a);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .loading-text {
            margin-top: 16px;
            color: var(--text-dim, #52525b);
            font-size: 0.875rem;
        }


        .launch-screen {
            position: fixed;
            inset: 0;
            background: rgba(10, 10, 10, 0.6);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .launch-screen.hidden {
            display: none;
        }

        .launch-button {
            background: var(--surface);
            color: var(--text-muted);
            border: none;
            padding: 24px 48px;
            border-radius: var(--radius-lg);
            font-size: 1.25rem;
            font-weight: 600;
            cursor: pointer;
            transition: opacity 0.2s;
            margin-top: 16px;
            width: 100%;
            max-width: 300px;
            opacity: 0.75;
        }

        .launch-button:hover {
            opacity: 0.5;
        }

        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        /* Panic white screen */
        #panic-overlay {
            position: fixed;
            inset: 0;
            background: white;
            z-index: 99999;
            display: none;
        }
    </style>
    <script>
// site config

window.SITE_CONFIG = {
    name: "Phantom",
    fullName: "Phantom Unblocked",
    version: "1.0.12",

    changelog: [
        "1.0.12: tiny fixxes and changes",
        "some code consolidation and fixxes",
        "suggest features in the discord server"
    ],

    // quotes
    quotes: [
        "lebron lebron lebronn james",
        "so tuff",
        "it is what it is",
        "do ur work",
        "this is what happens when u dont touch grass",
        "FULL BOX",
        "FULL PIECE",
        "200!",
        "press esc + refresh + power button for hacks",
        "press ctrl+x to hide your screen",
        "change the tab title and favicon in settings",
        "TEACHERR!",
        "1 pump",
        "303 headshot",
        "bros prolly a 60 ovr",
        "take the L lil bro",  
        "lebron is OUR goat",
        "stop looking at my screen",
    ],

    // todo
    // *** for strikethrough
    // ** for bold
    todos: [
        "***fixxed aboutblank opening while securly is on (previously if popups were off it would load intab instead of clickto launch now it will use clicktolaunch unless popups are blocked)***",
        "***fix the proxy***",
        "***fix panic panickey, add quote talking about it***",
        "***fix theatermode, make it hide buttons after a few seconds and ensure all content is being displayed and move the description to the bottom***",
        "***change back player to use old styling, change the surface to use background colors for the bottom part where description is shown, looking just like the background***",
        "***add image and video support for backgrounds***",
        "***fix aichat, make the title use the same ai request as the users question unless its in image mode where it will use text mode and fix ai chat to remember modes better***",
        "***add cloaking to quotes***",
        "***add a default cloak and fix it so icons work in aboutblank for whatever reason they only work when you go to settings in aboutblank where it correctly applies***",
        "***for search suggestions add highlighting for whatever will happen when you click enter, in search suggestions fix all games not sending you to the games page***",
        "***fix games to make multi library the default, put it in config.js***",
        "***rename movies shortcut in index2.html to primeshows, add shortcuts to main pages in the topbar and change the current shortcuts to more popular games***",
        "***make announcements show even on first visit unlike changelog and allow disabling it via settings***",
        "***fix leave comformation asking u to leave each time you click something***",
        "***change the shortcuts on the main page to include pages***",
        "***add movies to the search bar in main page***",
        "***fix background not turning off soon***",
        "***fix music page to hide youtube player unless toggled via 3 dot small button, and always shown on proxy mode, fix all the controls for video time, volume***",
        "**add singlefile this is lowk so hard i dont really understand it**",
        "**advertise phantom (too much work tbh)**",
        "**add a watch page for youtube and twitch**",
        "**add a miniplayer for music**",
        "***shorten some page's code***",
        "***fix paths in search autocomplete***",
        "***fix markdown in ai not using correct text colors***",
        "***make backgrounds show in the loading screen***",
        "***fix icons for topbar in code.html***",
        "**fix wisp server not notifying or autoswitiching when offline in proxy**",
        "***fix code runner open not working at all***",
        "***make backgrounds show in player.html***",
        "***make backgrounds show in staticsjv2***",
        "***make player.html player controls use theme colros not hardcoded***",
        "***make ai chat and music sidebar go all the way down and up with borders***",
        "**make the only song in music be lebron lebron lebron james**",
        "**fix music controls**",
        "***finish extra page into credits and make this todo be tucked away somewhere and not the main part of it***"
    ],
    defaultWisp: "wss://glseries.net/wisp/",
    wispServers: [
        { name: "GLSeries Wisp", url: "wss://glseries.net/wisp/" },
        { name: "Rhw's Wisp", url: "wss://wisp.rhw.one/" },
    ],

    discord: {
        inviteUrl: "https://discord.gg/tHWx9NXp5p",
        widgetServer: "1447673724017971324",
        widgetChannel: "1447673726228496617",
    },

    firstVisitCloak: false, //fake error page
    defaults: {
        cloakMode: "about:blank",
        tabTitle: "You've already responded",
        tabFavicon: "https://ssl.gstatic.com/docs/spreadsheets/forms/forms_icon_2023q4.ico",
        cloakRotation: false,
        cloakInterval: 5000,
        panicKey: "x",
        panicModifiers: ["ctrl", "shift"],
        panicUrl: "https://classroom.google.com",
        maxMovieRating: "R",
        gameLibrary: "multi",
        discordWidget: true,
        miniplayer: true,
        leaveConfirmation: false,
        showChangelogOnUpdate: true,
        themeRotation: true,
        lastThemeRotation: 0,
        backgroundRotation: true,
        lastBackgroundRotation: 0,
        lastSeenFeatured: 'none',
        background: { type: 'color', value: '#0a0a0a' },
        customBackground: { id: 'none', type: 'none' },
        accentColor: '#ffffff',
        surfaceColor: '#0f0f0f',
        secondaryColor: '#2e2e33',
        textColor: '#e4e4e7',
    },

    themePresets: {
        dark: { name: 'Dark (Default)', bg: { type: 'color', value: '#0a0a0a' }, surface: '#0f0f0f', surfaceHover: '#1a1a1a', surfaceActive: '#252525', secondary: '#2e2e33', border: '#2a2a2a', borderLight: '#2a2a2a', text: '#e4e4e7', textSec: '#71717a', textDim: '#52525b', accent: '#ffffff' },
        midnight: { name: 'Midnight', bg: { type: 'color', value: '#000000' }, surface: '#050505', surfaceHover: '#111111', surfaceActive: '#1a1a1a', secondary: '#111111', border: '#1a1a1a', borderLight: '#111111', text: '#ededed', textSec: '#a3a3a3', textDim: '#737373', accent: '#d4d4d4' },
        abyss: { name: 'Abyss', bg: { type: 'color', value: '#020617' }, surface: '#0f172a', surfaceHover: '#1e293b', surfaceActive: '#334155', secondary: '#1e293b', border: '#1e293b', borderLight: '#1e293b', text: '#f1f5f9', textSec: '#94a3b8', textDim: '#64748b', accent: '#38bdf8' },
        phantom: { name: 'Phantom', bg: { type: 'color', value: '#0f0a14' }, surface: '#1a0f24', surfaceHover: '#2e1a40', surfaceActive: '#4c2a5c', secondary: '#2e1a40', border: '#2e1a40', borderLight: '#2e1a40', text: '#f3e8ff', textSec: '#d8b4fe', textDim: '#c084fc', accent: '#c084fc' },
        rosepine: { name: 'Rose Pine', bg: { type: 'color', value: '#191724' }, surface: '#1f1d2e', surfaceHover: '#26233a', surfaceActive: '#524f67', secondary: '#26233a', border: '#26233a', borderLight: '#1f1d2e', text: '#e0def4', textSec: '#908caa', textDim: '#6e6a86', accent: '#ebbcba' },
        ocean: { name: 'Oceanic', bg: { type: 'color', value: '#011627' }, surface: '#0b2942', surfaceHover: '#1d3b53', surfaceActive: '#2d4b63', secondary: '#0b2942', border: '#1d3b53', borderLight: '#0b2942', text: '#d6deeb', textSec: '#5f7e97', textDim: '#011627', accent: '#7fdbca' },
        forest: { name: 'Forest', bg: { type: 'color', value: '#020d06' }, surface: '#051a0d', surfaceHover: '#0a2e17', surfaceActive: '#0f4221', secondary: '#051a0d', border: '#0a2e17', borderLight: '#051a0d', text: '#ecfdf5', textSec: '#6ee7b7', textDim: '#064e3b', accent: '#10b981' },
        crimson: { name: 'Crimson', bg: { type: 'color', value: '#1a0505' }, surface: '#230a0a', surfaceHover: '#7b0a0aff', surfaceActive: '#7f1d1d', secondary: '#230a0a', border: '#480f0fff', borderLight: '#230a0a', text: '#fef2f2', textSec: '#fecaca', textDim: '#450a0a', accent: '#ef4444' },
        flame: { name: 'Flame', bg: { type: 'color', value: '#0c0202' }, surface: '#1c0a0a', surfaceHover: '#451a03', surfaceActive: '#9a3412', secondary: '#1c0a0a', border: '#451a03', borderLight: '#9a3412', text: '#fff7ed', textSec: '#fdba74', textDim: '#ea580c', accent: '#f59e0b' }
    },

    backgroundPresets: [
        { id: 'none', name: 'None (Theme Default)', type: 'none' },
        { id: 'Night sky', name: 'Night sky', type: 'image', url: 'https://images.pexels.com/photos/5675745/pexels-photo-5675745.jpeg', overlay: 0.3 },
        { id: 'winter-mountains', name: 'Winter mountains', type: 'image', url: 'https://images.pexels.com/photos/1287145/pexels-photo-1287145.jpeg', overlay: 0.3 },
        { id: 'f1 car', name: 'F1 Car', type: 'image', url: 'https://images.pexels.com/photos/14401632/pexels-photo-14401632.jpeg', overlay: 0.3 },
        { id: 'moon-landing', name: 'Moon Landing', type: 'image', url: 'https://images.pexels.com/photos/41162/moon-landing-apollo-11-nasa-buzz-aldrin-41162.jpeg', overlay: 0.3, objectPosition: 'top left', active: true },
        { id: 'turtle', name: 'Turtle', type: 'image', url: 'https://images.unsplash.com/photo-1501791187590-9ef2612ba1eb?q=80&w=1932&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D', overlay: 0.3 },
        { id: 'road', name: 'Road', type: 'image', url: 'https://images.unsplash.com/photo-1508233620467-f79f1e317a05', overlay: 0.3 },
        { id: 'railroad', name: 'Railroad', type: 'image', url: 'https://images.unsplash.com/photo-1505832018823-50331d70d237', overlay: 0.3 },
        { id: 'mountain', name: 'Mountain', type: 'image', url: 'https://raw.githubusercontent.com/evanhnry/brave-wallpapers/refs/heads/main/Brave/clay-banks-u27Rrbs9Dwc-unsplash.jpg', overlay: 0.3 },
    ],

    cloakPresets: [
        { name: "Phantom", icon: "/favicon.svg", title: "Phantom Unblocked" },
        { name: "Edpuzzle", icon: "https://edpuzzle.imgix.net/favicons/favicon-32.png", title: "Edpuzzle" },
        { name: "Google Docs", icon: "https://ssl.gstatic.com/docs/documents/images/kix-favicon7.ico", title: "Untitled document - Google Docs" },
        { name: "Canvas", icon: "https://du11hjcvx0uqb.cloudfront.net/dist/images/favicon-e10d657a73.ico", title: "Dashboard" },
        { name: "Desmos", icon: "https://www.desmos.com/favicon.ico", title: "Desmos | Graphing Calculator" },
        { name: "Khan Academy", icon: "https://cdn.kastatic.org/images/favicon.ico", title: "Khan Academy" },
        { name: "Wikipedia", icon: "https://en.wikipedia.org/favicon.ico", title: "World War II - Wikipedia" },
        { name: "Classroom", icon: "https://ssl.gstatic.com/classroom/favicon.png", title: "Home - Classroom" },
        { name: "Canva", icon: "https://static.canva.com/static/images/android-192x192-2.png", title: "Home - Canva" },
        { name: "Quiz", icon: "https://ssl.gstatic.com/docs/spreadsheets/forms/forms_icon_2023q4.ico", title: "You've already responded" },
        { name: "Blooket", icon: "https://play.blooket.com/favicon.ico", title: "Play Blooket | Blooket" },
        { name: "Gmail", icon: "https://ssl.gstatic.com/ui/v1/icons/mail/rfr/gmail.ico", title: "Gmail" },
        { name: "YouTube", icon: "https://www.youtube.com/favicon.ico", title: "YouTube" },
        { name: "Powerschool", icon: "https://waverlyk12.powerschool.com/favicon.ico", title: "Grades and Attendance" },
        { name: "nothing", icon: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=", title: "\u200B" },
    ]
}



</script>
    <script>
// settings handler
(function () {
    'use strict';

    const STORAGE_KEY = 'void_settings';

    const getDefaults = () => {
        return window.SITE_CONFIG?.defaults || {
            cloakMode: 'none',
            cloakRotation: false,
            cloakInterval: 5000,
            panicKey: 'x',
            panicModifiers: ['ctrl', 'shift'],
            panicUrl: 'https://classroom.google.com',
            maxMovieRating: 'R',
            offlineGames: [],
            gameLibrary: 'multi',
            leaveConfirmation: false
        };
    };

    const load = () => {
        try {
            const stored = localStorage.getItem(STORAGE_KEY);
            if (stored) {
                return { ...getDefaults(), ...JSON.parse(stored) };
            }
        } catch (e) {
            console.warn('Failed to load settings:', e);
        }
        return getDefaults();
    };

    const save = (settings) => {
        try {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));
            window.dispatchEvent(new CustomEvent('settings-changed', { detail: settings }));
            if (window.parent !== window) {
                window.parent.postMessage({ type: 'settings-update' }, '*');
            }
        } catch (e) {
            console.warn('Failed to save settings:', e);
        }
    };

    let _settings = load();

    window.Settings = {
        get(key) { return _settings[key]; },

        getAll() { return { ..._settings }; },

        set(key, value) {
            _settings[key] = value;
            save(_settings);
            this.apply();
            return value;
        },

        update(partial) {
            _settings = { ..._settings, ...partial };
            save(_settings);
            this.apply();
        },

        reset() {
            _settings = getDefaults();
            save(_settings);
            this.apply();
        },

        apply() {
            const root = document.documentElement;
            const s = _settings;
            const d = window.SITE_CONFIG?.defaults || {};

            const vars = {
                '--accent': s.accentColor || d.accentColor || '#ffffff',
                '--surface': s.surfaceColor || d.surfaceColor || '#0f0f0f',
                '--surface-hover': s.surfaceHoverColor || d.surfaceHoverColor || '#1a1a1a',
                '--surface-active': s.surfaceActiveColor || d.surfaceActiveColor || '#252525',
                '--secondary': s.secondaryColor || d.secondaryColor || '#2e2e33',
                '--border': s.borderColor || d.borderColor || '#1f1f1f',
                '--border-light': s.borderLightColor || d.borderLightColor || '#2a2a2a',
                '--text': s.textColor || d.textColor || '#e4e4e7',
                '--text-muted': s.textSecondaryColor || d.textSecondaryColor || '#71717a',
                '--text-dim': s.textDimColor || d.textDimColor || '#52525b',
                '--toggle': s.toggleColor || d.toggleColor,
                '--toggle-knob': s.toggleKnobColor || d.toggleKnobColor
            };

            Object.entries(vars).forEach(([key, val]) => {
                if (val) root.style.setProperty(key, val);
            });

            const themeBg = s.background || d.background || { type: 'color', value: '#0a0a0a' };
            const customBg = s.customBackground;
            const isCustomActive = customBg && customBg.type !== 'none';

            if (themeBg.type === 'color') {
                root.style.setProperty('--bg', themeBg.value);
            }

            if (isCustomActive && customBg.url) {
                root.style.setProperty('--bg-image', `url(${customBg.url})`);

                let position = customBg.objectPosition;
                if (customBg.id && customBg.id !== 'custom') {
                    const preset = window.SITE_CONFIG?.backgroundPresets?.find(b => b.id === customBg.id);
                    if (preset?.objectPosition) position = preset.objectPosition;
                }

                root.style.setProperty('--bg-image-position', position || 'center');
            } else if (themeBg.type === 'image' || themeBg.type === 'video') {
                root.style.setProperty('--bg-image', `url(${themeBg.value || themeBg.url})`);
                root.style.setProperty('--bg-image-position', themeBg.objectPosition || 'center');
            } else if (themeBg.type === 'gradient') {
                root.style.setProperty('--bg-image', themeBg.value || themeBg.url);
                root.style.setProperty('--bg-image-position', 'center');
            } else {
                root.style.setProperty('--bg-image', 'none');
            }
        },

        onChange(callback) {
            window.addEventListener('settings-changed', (e) => callback(e.detail));
        },

        isRatingAllowed(rating) {
            if (!rating || rating === 'NR' || rating === 'NC-17') return false;
            const ratingOrder = ['G', 'PG', 'PG-13', 'R'];
            const maxIndex = ratingOrder.indexOf(_settings.maxMovieRating);
            const ratingIndex = ratingOrder.indexOf(rating);
            return maxIndex !== -1 && ratingIndex !== -1 && ratingIndex <= maxIndex;
        }
    };

    // panic button go brr
    const handlePanic = (e) => {
        const mods = _settings.panicModifiers || [];
        const key = _settings.panicKey || 'x';

        if (mods.includes('ctrl') !== e.ctrlKey) return;
        if (mods.includes('shift') !== e.shiftKey) return;
        if (mods.includes('alt') !== e.altKey) return;

        if (e.key.toLowerCase() === key.toLowerCase()) {
            e.preventDefault();
            const overlayId = 'panic-overlay';
            let overlay = window.parent?.document?.getElementById(overlayId) || document.getElementById(overlayId);

            if (!overlay) {
                overlay = document.createElement('div');
                overlay.id = overlayId;
                overlay.style.cssText = 'position:fixed;inset:0;background:white;z-index:99999;';
                document.body.appendChild(overlay);
            } else {
                overlay.style.display = 'block';
            }

            window.location.replace(_settings.panicUrl || 'https://classroom.google.com');
        }
    };

    const init = () => {
        Settings.apply();

        const featured = window.SITE_CONFIG?.featuredBackground;
        const activePreset = window.SITE_CONFIG?.backgroundPresets?.find(p => p.active);

        const target = activePreset || featured;

        if (target?.id && target.id !== _settings.lastSeenFeatured) {
            Settings.update({
                customBackground: target,
                lastSeenFeatured: target.id,
                backgroundRotation: false
            });
        }

        document.addEventListener('keydown', handlePanic, true);

        window.addEventListener('storage', (e) => {
            if (e.key === STORAGE_KEY) {
                _settings = load();
                Settings.apply();
                window.dispatchEvent(new CustomEvent('settings-changed', { detail: _settings }));
            }
        });

        window.addEventListener('message', (e) => {
            if (e.data?.type === 'settings-update' || e.data === 'updateCloak') {
                _settings = load();
                Settings.apply();
                window.dispatchEvent(new CustomEvent('settings-changed', { detail: _settings }));
            }
        });

        window.addEventListener('beforeunload', (e) => {
            if (document.getElementById('main-frame') && _settings.leaveConfirmation) {
                e.preventDefault();
                return e.returnValue = '';
            }
        });
    };

    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', init);
    else init();
})();

</script>
    <script>
// background stuff
(function () {
    'use strict';

    if (window.BackgroundManager) return;

    const YOUTUBE_REGEX = /(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([a-zA-Z0-9_-]{11})/;

    const BackgroundManager = {
        container: null,
        mediaLayer: null,
        elements: { video: null, image: null, iframe: null },
        current: { type: null, url: null },
        cacheName: 'phantom-bg-cache-v2',

        init() {
            this.container = document.createElement('div');
            this.container.className = 'phantom-background';
            this.container.innerHTML = '<div class="phantom-background-overlay"></div><div class="phantom-background-layer"></div>';
            this.mediaLayer = this.container.querySelector('.phantom-background-layer');
            document.body.insertBefore(this.container, document.body.firstChild);

            const apply = () => this.applyBackground();
            window.addEventListener('settings-changed', apply);
            window.addEventListener('storage', apply);
            window.addEventListener('beforeunload', () => this.cleanup());
            window.addEventListener('pagehide', () => this.cleanup());

            document.addEventListener('visibilitychange', () => {
                const video = this.elements.video;
                if (!video) return;
                if (document.hidden) video.pause();
                else if (this.current.type === 'video') video.play().catch(() => { });
            });

            this.applyBackground();
        },

        applyBackground() {
            if (!this.container) return; // Wait for init() to create the container

            const s = window.Settings?.getAll() || {};
            const custom = s.customBackground;
            const theme = s.background || {};

            let type = null, url = null, pos = null, overlay = 0.4;

            if (custom && custom.type !== 'none') {
                // Refresh from config if possible to get latest props like objectPosition
                if (custom.id && custom.id !== 'custom') {
                    const preset = window.SITE_CONFIG?.backgroundPresets?.find(b => b.id === custom.id);
                    if (preset) Object.assign(custom, preset);
                }
                ({ type, url, objectPosition: pos, overlay = 0.4 } = custom);
            } else if (theme.type === 'image' || theme.type === 'video' || theme.type === 'youtube') {
                type = theme.type;
                url = theme.value || theme.url;
                pos = theme.objectPosition;
                overlay = theme.overlay || 0.4;
            }

            document.documentElement.style.setProperty('--bg-overlay', overlay);

            // Handle common positioning typos and normalize
            if (pos && typeof pos === 'string') {
                pos = pos.toLowerCase().trim()
                    .replace(/\s+/g, ' ') // Normalize multiple spaces
                    .replace('topleft', 'top left')
                    .replace('topright', 'top right')
                    .replace('bottomleft', 'bottom left')
                    .replace('bottomright', 'bottom right')
                    .replace('centercenter', 'center')
                    .replace('centerleft', 'center left')
                    .replace('centerright', 'center right');
            }

            document.documentElement.style.setProperty('--bg-image-position', pos || 'center');

            if (!type || !url) {
                this.clear();
                document.documentElement.style.backgroundColor = 'var(--bg)';
                document.documentElement.style.setProperty('--bg-image-position', 'center');
                return;
            }
            if (this.current.type === type && this.current.url === url) return;

            this.current = { type, url };

            if (type === 'video' || url.match(/\.(mp4|webm|ogg|mov|m4v)$/i)) {
                this.clearMedia();
                this.createVideo(url, pos);
                this.container.classList.add('active');
                document.documentElement.classList.add('phantom-bg-active');
                document.body.classList.add('phantom-bg-active');
            } else if (type === 'youtube' || YOUTUBE_REGEX.test(url)) {
                this.clearMedia();
                this.createYouTube(url, pos);
                this.container.classList.add('active');
                document.documentElement.classList.add('phantom-bg-active');
                document.body.classList.add('phantom-bg-active');
            } else if (type === 'image') {
                this.handleImageBackground(url, pos);
            }
        },

        async getProxiedCachedUrl(url) {
            // Local images don't need proxying
            if (!url.startsWith('http') || url.includes(location.hostname)) return url;

            // Try direct load first (faster)
            try {
                const directTest = await fetch(url, { method: 'HEAD', mode: 'cors' });
                if (directTest.ok) return url;
            } catch (e) {
                // CORS blocked, need to proxy
            }

            // Wait for BareMux (max 500ms)
            let retries = 0;
            while (!window.BareMux && retries < 5) {
                await new Promise(r => setTimeout(r, 100));
                retries++;
            }

            if (!window.BareMux) {
                console.warn("Background: BareMux not found, trying direct URL.");
                return url; // Try direct anyway
            }

            try {
                const client = new window.BareMux.BareClient();
                const response = await client.fetch(url);
                if (!response.ok) throw new Error('Proxy fetch failed');

                const blob = await response.blob();
                return URL.createObjectURL(blob);
            } catch (error) {
                console.error("Background proxy failed:", error);
                return url; // Fallback to direct URL
            }
        },

        async handleImageBackground(url, pos) {
            // Pre-load the image (proxied/cached or direct)
            const finalUrl = await this.getProxiedCachedUrl(url);

            // Check if this is still the current background after async fetch
            if (this.current.url !== url) {
                if (finalUrl && finalUrl.startsWith('blob:')) URL.revokeObjectURL(finalUrl);
                return;
            }

            this.clearMedia();
            this.createImage(finalUrl, pos);
        },

        createVideo(url, pos) {
            const el = Object.assign(document.createElement('video'), {
                className: 'phantom-background-media', src: url, autoplay: true, loop: true, muted: true, playsInline: true, volume: 0
            });
            // Apply objectPosition from settings/preset
            if (pos) el.style.objectPosition = pos;
            el.onerror = () => (this.elements.video = null);
            this.elements.video = el;
            this.mediaLayer.appendChild(el);
        },

        createImage(url, pos) {
            const el = Object.assign(document.createElement('img'), {
                className: 'phantom-background-media',
                src: url
            });

            // Apply objectPosition from settings/preset
            if (pos) el.style.objectPosition = pos;

            el.onload = () => {
                if (this.current.url === url || url.startsWith('blob:')) {
                    this.container.classList.add('active');
                    document.documentElement.classList.add('phantom-bg-active');
                    document.body.classList.add('phantom-bg-active');
                }
            };
            el.onerror = () => {
                console.warn("Background image failed to load:", url);
                if (this.elements.image === el) this.elements.image = null;
            };

            this.elements.image = el;
            this.mediaLayer.appendChild(el);
        },

        // youtube logic
        createYouTube(url, pos) {
            const id = url.match(YOUTUBE_REGEX)?.[1];
            if (!id) return;
            const el = Object.assign(document.createElement('iframe'), {
                className: 'phantom-background-media',
                src: `https://www.youtube.com/embed/${id}?autoplay=1&loop=1&playlist=${id}&controls=0&modestbranding=1&rel=0&mute=1&enablejsapi=1`,
                allow: 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture'
            });
            // Apply objectPosition from settings/preset
            if (pos) el.style.objectPosition = pos;
            this.elements.iframe = el;
            this.mediaLayer.appendChild(el);
        },

        clearMedia() {
            Object.entries(this.elements).forEach(([key, el]) => {
                if (!el) return;
                if (key === 'video') { el.pause(); el.src = ''; }
                if (key === 'iframe') el.src = 'about:blank';
                if (key === 'image' && el.src.startsWith('blob:')) {
                    URL.revokeObjectURL(el.src);
                }
                el.remove();
                this.elements[key] = null;
            });
        },

        clear() {
            this.clearMedia();
            this.current = { type: null, url: null };
            document.documentElement.classList.remove('phantom-bg-active');
            document.body.classList.remove('phantom-bg-active');
            document.documentElement.style.backgroundColor = '';
            if (this.container) this.container.classList.remove('active');
        },

        cleanup() {
            this.clearMedia();
        }
    };

    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', () => BackgroundManager.init());
    else BackgroundManager.init();

    window.BackgroundManager = BackgroundManager;
})();

</script>
    <script>
// stealth mode
(function () {
    'use strict';

    let rotationInterval = null;
    let currentPresetIndex = 0;
    const original = { title: document.title, favicon: document.querySelector('link[rel="icon"]')?.href };

    const getPresets = () => [...(window.SITE_CONFIG?.cloakPresets || []), ...(window.Settings?.get('customCloaks') || [])];

    const setTitle = (title) => {
        if (!title) return;
        document.title = title;
        try { if (window.top !== window.self) window.top.document.title = title; } catch { }
    };

    const setFavicon = (href) => {
        if (!href) return;
        [document, window.top?.document].filter(d => { try { return d; } catch { return false; } }).forEach(doc => {
            doc.querySelectorAll('link[rel*="icon"]').forEach(l => l.remove());
            const link = doc.createElement('link');
            link.rel = 'icon';
            link.href = href;
            doc.head.appendChild(link);
        });
    };

    const apply = (p) => {
        if (p) {
            setTitle(p.title);
            setFavicon(p.icon || p.favicon);
        } else {
            const s = window.Settings?.getAll() || {};
            setTitle(s.tabTitle || window.SITE_CONFIG?.defaults?.tabTitle);
            setFavicon(s.tabFavicon || window.SITE_CONFIG?.defaults?.tabFavicon);
        }
    };

    const startRotation = (ms) => {
        stopRotation();
        const presets = getPresets();
        if (presets.length < 2) return apply(presets[0]);
        rotationInterval = setInterval(() => {
            currentPresetIndex = (currentPresetIndex + 1) % presets.length;
            apply(presets[currentPresetIndex]);
        }, ms);
    };

    const stopRotation = () => { if (rotationInterval) { clearInterval(rotationInterval); rotationInterval = null; } };

    const redirectOriginal = () => {
        const targets = ["https://classroom.google.com", "https://drive.google.com", "https://google.com", "https://kahoot.it", "https://edpuzzle.com"];
        window.location.replace(targets[Math.floor(Math.random() * targets.length)]);
    };

    const getPopupContent = (url) => {
        const s = window.Settings?.getAll() || {};
        const title = s.tabTitle || window.SITE_CONFIG?.defaults?.tabTitle || 'Google';
        const icon = s.tabFavicon || window.SITE_CONFIG?.defaults?.tabFavicon || 'https://www.google.com/favicon.ico';
        return `<!DOCTYPE html><html><head><title>${title}</title><link rel="icon" href="${icon}"><style>* {margin:0;padding:0;height:100%;overflow:hidden;} iframe{width:100%;height:100%;border:none;}</style></head><body><iframe src="${url}"></iframe></body></html>`;
    };

    // Try to open popup and monitor if it survives for 500ms
    // Returns: { success: true } if popup works and stays open
    // Returns: { success: false, reason: 'blocked' } if window.open returned null
    // Returns: { success: false, reason: 'killed' } if popup was closed by extension (like Securly)
    const tryPopup = (url) => {
        return new Promise((resolve) => {
            const win = window.open('about:blank', '_blank');

            // Popup completely blocked by browser
            if (!win) {
                resolve({ success: false, reason: 'blocked' });
                return;
            }

            // Write the actual content to popup
            try {
                win.document.write(getPopupContent(url));
                win.document.close();
            } catch (e) {
                try { win.close(); } catch { }
                resolve({ success: false, reason: 'killed' });
                return;
            }

            // Use a single timeout to avoid background throttling (which causes a 5s delay).
            // When the original tab loses focus, browsers throttle timers to ~1s minimum.
            // If the timer runs, we check once and redirect immediately.
            const timeoutMs = 200;

            setTimeout(() => {
                if (win.closed) {
                    resolve({ success: false, reason: 'killed' });
                } else {
                    resolve({ success: true });
                    redirectOriginal(); // Instant redirect
                }
            }, timeoutMs);
        });
    };

    // Load content in-tab (fallback)
    const loadInTab = () => {
        const iframe = document.getElementById('main-frame');
        if (iframe && !iframe.src) iframe.src = 'index2.html';
        apply();
    };

    // Show launch screen with callback for when button is clicked
    const showLaunchScreen = (onLaunch) => {
        const ls = document.getElementById('launch-screen');
        if (ls) {
            ls.classList.remove('hidden');
            document.getElementById('launch-button').onclick = onLaunch;
        }
    };

    // Attempt popup with fallback:
    // 1. Try real popup -> if works (survives 500ms), redirect original tab
    // 2. If blocked (null) -> show click-to-launch (user gesture might help)
    // 3. If killed (closed by Securly) -> load in-tab directly
    // 4. If click-to-launch popup also fails -> load in-tab
    const attemptCloakedLaunch = async (url, hideOverlay = null) => {
        const result = await tryPopup(url);

        if (result.success) {
            // Popup worked and is still open! redirectOriginal() was already called
            return true;
        }

        if (result.reason === 'blocked') {
            // Popup was blocked (window.open returned null)
            // Show click-to-launch - user gesture might bypass popup blocker
            if (hideOverlay) hideOverlay();

            showLaunchScreen(async () => {
                document.getElementById('launch-screen').classList.add('hidden');

                // Try popup again with user gesture
                const retryResult = await tryPopup(url);
                if (!retryResult.success) {
                    // Even with user click, popup failed - load in-tab
                    loadInTab();
                }
                // If success, redirectOriginal() was called inside tryPopup
            });
            return true; // Handled (showing launch screen)
        }

        // reason === 'killed' - Securly/extension killed the popup, go straight to in-tab
        if (hideOverlay) hideOverlay();
        loadInTab();
        return false;
    };

    const init = async () => {
        const s = window.Settings?.getAll() || {};
        const fvKey = 'phantom_fv';
        const urlParams = new URLSearchParams(window.location.search);

        // Handle fake mode (legacy)
        if (urlParams.has('fake')) {
            showLaunchScreen(async () => {
                document.getElementById('launch-screen').classList.add('hidden');
                if (s.cloakMode === 'about:blank') {
                    const result = await tryPopup(window.location.href.split('?')[0]);
                    if (result.success) return; // redirectOriginal was called
                }
                loadInTab();
            });
            return;
        }

        // Handle first visit cloak (fake error page)
        if (window.SITE_CONFIG?.firstVisitCloak && !localStorage.getItem(fvKey)) {
            const overlay = document.getElementById('fv-cloak');
            if (overlay) {
                overlay.style.display = 'block';
                document.title = window.location.hostname;
                document.querySelectorAll("link[rel*='icon']").forEach(l => l.remove());
                const link = document.createElement('link');
                link.rel = 'icon';
                link.href = 'data:,';
                document.head.appendChild(link);

                const onKey = async (e) => {
                    if (e.key.toLowerCase() === 'c') {
                        localStorage.setItem(fvKey, '1');
                        document.removeEventListener('keydown', onKey);

                        if (s.cloakMode === 'about:blank') {
                            await attemptCloakedLaunch(window.location.href, () => {
                                overlay.style.display = 'none';
                            });
                        } else {
                            overlay.style.display = 'none';
                            apply();
                            loadInTab();
                        }
                    }
                };
                document.addEventListener('keydown', onKey);
            }
            return;
        }

        // Normal visit - not first time, no fake mode
        if (window.top === window.self && s.cloakMode === 'about:blank') {
            await attemptCloakedLaunch(window.location.href);
            return;
        }

        loadInTab();
        if (s.rotateCloaks) startRotation((s.rotateInterval || 5) * 1000);
    };

    window.Cloaking = { init, apply, startRotation, stopRotation, tryPopup, loadInTab };

    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', () => setTimeout(init, 100));
    else setTimeout(init, 100);

    window.addEventListener('settings-changed', (e) => {
        apply();
        if (e.detail.rotateCloaks) startRotation((e.detail.rotateInterval || 5) * 1000);
        else stopRotation();
    });
})();

</script>
    <script>
window.Quotes = {
    // Use data from config, fallback to empty array if not found
    getData() {
        return (window.SITE_CONFIG && window.SITE_CONFIG.quotes) || [];
    },

    getRandom() {
        const data = this.getData();
        if (!data.length) return null; // Return null if no quotes
        return data[Math.floor(Math.random() * data.length)];
    },
    init(force = false) {
        const quote = this.getRandom();
        if (!quote) return; // Do nothing if no quotes

        const targets = [
            '#quote',
            '#quote-display',
            '#subtitle',
            '.page-subtitle',
            '.extra-hero p',
            '.loading-text'
        ];

        targets.forEach(selector => {
            document.querySelectorAll(selector).forEach(el => {
                // Only update if force is true, or it's empty, or has placeholder text
                const text = el.textContent.trim();
                if (force || !text || text === 'Loading...' || text.includes('Stream movies') || text.includes('Customize your')) {
                    el.textContent = quote;
                }
            });
        });
    }
};

window.QUOTES = window.Quotes.getData();

// Run automatically on load
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => window.Quotes.init());
} else {
    window.Quotes.init();
}

</script>
    <script>Settings.apply();</script>
    <style>
/* Base styles and variables derived from erorr.html */
:root {
    --background-color: #fff;
    --error-code-color: #5f6368;
    --google-blue-100: rgb(210, 227, 252);
    --google-blue-300: rgb(138, 180, 248);
    --google-blue-600: rgb(26, 115, 232);
    --google-blue-700: rgb(25, 103, 210);
    --google-gray-100: rgb(241, 243, 244);
    --google-gray-300: rgb(218, 220, 224);
    --google-gray-500: rgb(154, 160, 166);
    --google-gray-50: rgb(248, 249, 250);
    --google-gray-600: rgb(128, 134, 139);
    --google-gray-700: rgb(95, 99, 104);
    --google-gray-800: rgb(60, 64, 67);
    --google-gray-900: rgb(32, 33, 36);
    --heading-color: var(--google-gray-900);
    --link-color: rgb(88, 88, 88);
    --primary-button-fill-color-active: var(--google-blue-700);
    --primary-button-fill-color: var(--google-blue-600);
    --primary-button-text-color: #fff;
    --quiet-background-color: rgb(247, 247, 247);
    --secondary-button-border-color: var(--google-gray-500);
    --secondary-button-fill-color: #fff;
    --secondary-button-hover-border-color: var(--google-gray-600);
    --secondary-button-hover-fill-color: var(--google-gray-50);
    --secondary-button-text-color: var(--google-gray-700);
    --small-link-color: var(--google-gray-700);
    --text-color: var(--google-gray-700);
}

.neterror {
    background: var(--background-color);
    color: var(--text-color);
    word-wrap: break-word;
    font-family: 'Segoe UI', Tahoma, sans-serif;
    margin: 0;
    font-size: 100%;
}

@media (prefers-color-scheme: dark) {

    :root,
    .neterror {
        --background-color: var(--google-gray-900);
        --error-code-color: var(--google-gray-500);
        --heading-color: var(--google-gray-500);
        --link-color: var(--google-blue-300);
        --primary-button-fill-color-active: rgb(129, 162, 208);
        --primary-button-fill-color: var(--google-blue-300);
        --primary-button-text-color: var(--google-gray-900);
        --quiet-background-color: var(--background-color);
        --secondary-button-border-color: var(--google-gray-700);
        --secondary-button-fill-color: var(--google-gray-900);
        --secondary-button-hover-fill-color: rgb(48, 51, 57);
        --secondary-button-text-color: var(--google-blue-300);
        --small-link-color: var(--google-blue-300);
        --text-color: var(--google-gray-500);
    }
}

#fv-cloak.neterror {
    position: fixed;
    inset: 0;
    z-index: 2147483647;
    display: none;
}

/* Layout & Typography */
.neterror .interstitial-wrapper {
    box-sizing: border-box;
    font-size: 1.0em;
    line-height: 1.6em;
    margin: 14vh auto 0;
    max-width: 650px;
    width: 100%;
    padding: 0 24px;
}

.neterror h1 {
    color: var(--heading-color);
    font-size: 1.6em;
    font-weight: normal;
    line-height: 1.25em;
    margin-bottom: 16px;
    margin-top: 0;
    word-wrap: break-word;
}

.neterror h1 span {
    font-weight: 500;
}

.neterror p {
    margin: 0;
}

.neterror a {
    color: var(--link-color);
    text-decoration: none;
}

.neterror .icon {
    height: 72px;
    margin: 0 0 40px;
    width: 72px;
    background-repeat: no-repeat;
    background-size: 100%;
    display: inline-block;
}

.neterror .icon-generic {
    content: image-set(url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJAAAACQAQMAAADdiHD7AAAABlBMVEUAAABTU1OoaSf/AAAAAXRSTlMAQObYZgAAAFJJREFUeF7t0cENgDAMQ9FwYgxG6WjpaIzCCAxQxVggFuDiCvlLOeRdHR9yzjncHVoq3npu+wQUrUuJHylSTmBaespJyJQoObUeyxDQb3bEm5Au81c0pSCD8HYAAAAASUVORK5CYII=) 2x);
}

@media (prefers-color-scheme: dark) {
    .neterror .icon {
        filter: invert(1);
    }
}

.neterror .error-code {
    color: var(--error-code-color);
    font-size: .8em;
    margin-top: 12px;
    text-transform: uppercase;
}

/* Navigation / Buttons */
.neterror .nav-wrapper {
    margin-top: 51px;
}

.neterror .nav-wrapper::after {
    clear: both;
    content: '';
    display: table;
    width: 100%;
}

.neterror button {
    appearance: auto;
    background-color: rgb(193, 196, 255);
    border: none;
    border-radius: 20px;
    box-sizing: border-box;
    color: rgb(32, 33, 36);
    cursor: pointer;
    display: block;
    float: right;
    font-family: Arial;
    font-size: 13.125px;
    font-weight: 400;
    height: 33.3333px;
    padding: 9px;
    text-align: center;
    transition: background-color 0.15s;
    user-select: none;
    width: 59.5833px;
}

.neterror .suggested-left>#control-buttons {
    float: left;
}

/* Mobile tweaks */
@media (max-width: 420px) {
    .neterror .nav-wrapper .secondary-button {
        float: none;
        margin: 16px 0 0;
        padding: 16px;
        width: 100%;
    }

    .neterror button {
        float: none;
        width: 100%;
    }

    .neterror .suggested-left>#control-buttons {
        float: none;
    }
}

/* Fixed nav for strict heights/widths */
@media (min-width: 240px) and (max-width: 420px) and (min-height: 401px),
(min-width: 421px) and (min-height: 240px) and (max-height: 560px) {
    .neterror .nav-wrapper {
        background: var(--background-color);
        bottom: 0;
        box-shadow: 0 -12px 24px var(--background-color);
        left: 0;
        margin: 0 auto;
        max-width: 1000px;
        padding-inline-end: 24px;
        padding-inline-start: 24px;
        position: fixed;
        right: 0;
        width: 100%;
        z-index: 2;
        padding-bottom: 24px;
        padding-top: 24px;
    }

    .neterror .interstitial-wrapper {
        max-width: 736px;
    }

    .neterror #main-content {
        padding-bottom: 40px;
    }
}
</style>
    <style>
/**
 * PHANTOM - BACKGROUND STYLES
 */
.phantom-background {
    position: fixed;
    inset: 0;
    width: 100vw;
    height: 100vh;
    z-index: -1;
    overflow: hidden;
    background: transparent;
    pointer-events: none;
    opacity: 1;
    transition: background-color 0.3s ease;
}

.phantom-background.active {
    opacity: 1;
}

.phantom-background-overlay {
    position: absolute;
    inset: 0;
    z-index: 2;
    background: rgba(0, 0, 0, var(--bg-overlay, 0.4));
    transition: background-color 0.3s ease;
}

.phantom-background-layer {
    position: absolute;
    inset: 0;
    z-index: 1;
    transition: opacity 0.3s ease-in-out;
}

.phantom-background-media {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: var(--bg-image-position, center);
    display: block;
    border: none;
}

/* Video and Iframe positioning for full background cover */
.phantom-background-layer video.phantom-background-media,
.phantom-background-layer iframe.phantom-background-media {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    transform: none;
    pointer-events: none;
    min-width: 100%;
    min-height: 100%;
    max-width: none;
    max-height: none;
    object-position: var(--bg-image-position, center);
}

/* Ensure iframes cover entire background */
.phantom-background-layer iframe.phantom-background-media {
    border: none;
    object-fit: cover;
}

/* Ensure content on top remains readable */
html {
    background-color: var(--bg);
}

body {
    position: relative;
    z-index: 0;
    background: transparent !important;
    /* Allow background to show through */
}

/* Specific adjustments for transparency if needed */
.main-content,
.home-page {
    background: transparent !important;
}

/* Glassmorphism for containers when background is active */
.phantom-background.active~.offline-banner,
.phantom-background.active~.home-page .card,
.phantom-background.active~.home-page .featured-card,
.phantom-background.active~.home-page .search-bar,
.phantom-background.active~.settings-panel {
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    background: rgba(15, 15, 15, 0.7) !important;
}
</style>

</head>

<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5LMBC27Z" height="0" width="0"
            style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <!-- First Visit Cloak Layer -->
    <div id="fv-cloak" class="neterror">
        <div id="main-frame-error" class="interstitial-wrapper">
            <div id="main-content">
                <div class="icon icon-generic"></div>
                <div id="main-message">
                    <h1>
                        <span>This site cant be reached</span>
                    </h1>
                    <p>
                        <strong id="origin-text"></strong>s <abbr id="dnsDefinition">DNS address</abbr> could not be
                        found.
                        Diagnosing the problem.
                    </p>
                    <div class="error-code">DNS_PROBE_POSSIBLE</div>
                </div>
            </div>
            <div id="buttons" class="nav-wrapper suggested-left">
                <div id="control-buttons">
                    <button id="reload-button" class="text-button" onclick="location.reload()">Reload</button>
                </div>
            </div>
        </div>
        <script>
            {
                const origin = window.location.hostname || "This site";
                document.getElementById("origin-text").textContent = origin;

                // Immediate cloak check to prevent flash
                try {
                    const STORAGE_KEY = 'phantom_fv';
                    const hasBypassed = localStorage.getItem(STORAGE_KEY);
                    const urlParams = new URLSearchParams(window.location.search);
                    const isFakeMode = urlParams.has('fake');

                    if (window.SITE_CONFIG.firstVisitCloak && !hasBypassed && !isFakeMode) {
                        const overlay = document.getElementById('fv-cloak');
                        if (overlay) overlay.style.display = 'block';
                        document.title = origin;

                        // Remove favicon for fake error page
                        document.querySelectorAll("link[rel*='icon']").forEach(l => l.remove());
                        const link = document.createElement('link');
                        link.rel = 'icon';
                        link.href = 'data:,';
                        document.head.appendChild(link);

                        // Hide loading screen immediately if possible
                        const style = document.createElement('style');
                        style.innerHTML = '#loading-screen { display: none !important; }';
                        document.head.appendChild(style);

                        // Set up bypass on reload button
                        document.getElementById('reload-button').onclick = function () {
                            localStorage.setItem(STORAGE_KEY, 'true');
                            overlay.style.display = 'none';
                            document.getElementById('main-frame').src = 'index2.html';
                            document.title = 'Phantom Unblocked'; // Reset title

                            // Restore favicon
                            document.querySelectorAll("link[rel*='icon']").forEach(l => l.remove());
                            const link = document.createElement('link');
                            link.rel = 'icon';
                            link.href = 'favicon.svg';
                            document.head.appendChild(link);
                        };
                    } else {
                        // If no cloak, load main content immediately
                        document.getElementById('main-frame').src = 'index2.html';
                    }
                } catch (e) { }
            }
        </script>
    </div>

    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-logo">
            <i class="fa-solid fa-ghost"></i>
            <span>Phantom</span>
        </div>
        <div class="loading-spinner"></div>
        <div class="loading-text">Loading...</div>
    </div>

    <!-- Launch Screen -->
    <div id="launch-screen" class="launch-screen hidden">
        <div class="loading-logo">
            <i class="fa-solid fa-ghost"></i>
            <span>Phantom</span>
        </div>
        <button id="launch-button" class="launch-button"> Launch Phantom</button>
    </div>

    <!-- Panic White Screen Overlay -->
    <div id="panic-overlay"></div>

    <iframe id="main-frame"></iframe>

    <script>
// rotation
(function () {
    'use strict';

    const checkRotation = () => {
        if (!window.Settings) return;
        const settings = window.Settings.getAll();
        const now = Date.now();
        const TWO_DAYS = 172800000;

        // theme
        if (settings.themeRotation) {
            const lastRotation = settings.lastThemeRotation || 0;
            if (now - lastRotation >= TWO_DAYS) {
                const presets = window.SITE_CONFIG?.themePresets || {};
                const keys = Object.keys(presets);
                if (keys.length > 0) {
                    let randomKey;
                    if (lastRotation === 0) {
                        const allowed = ['dark', 'midnight'].filter(k => keys.includes(k));
                        randomKey = allowed.length > 0 ? allowed[Math.floor(Math.random() * allowed.length)] : keys[0];
                    } else if (keys.length > 1) {
                        let attempts = 0;
                        do {
                            randomKey = keys[Math.floor(Math.random() * keys.length)];
                            attempts++;
                        } while (presets[randomKey].surface === settings.surfaceColor && attempts < 5);
                    } else {
                        randomKey = keys[0];
                    }

                    if (randomKey) {
                        const theme = presets[randomKey];
                        window.Settings.update({
                            background: theme.bg,
                            surfaceColor: theme.surface,
                            surfaceHoverColor: theme.surfaceHover,
                            surfaceActiveColor: theme.surfaceActive,
                            secondaryColor: theme.secondary,
                            borderColor: theme.border,
                            borderLightColor: theme.borderLight,
                            textColor: theme.text,
                            textSecondaryColor: theme.textSec,
                            textDimColor: theme.textDim,
                            accentColor: theme.accent,
                            lastThemeRotation: now
                        });
                    }
                }
            }
        }

        // bg
        if (settings.backgroundRotation) {
            const lastRotation = settings.lastBackgroundRotation || 0;
            if (now - lastRotation >= TWO_DAYS) {
                const presets = (window.SITE_CONFIG?.backgroundPresets || []).filter(p => p.id !== 'none' && p.id !== 'custom');
                if (presets.length > 0) {
                    let randomPreset;
                    if (presets.length > 1) {
                        let attempts = 0;
                        const currentId = settings.customBackground?.id;
                        do {
                            randomPreset = presets[Math.floor(Math.random() * presets.length)];
                            attempts++;
                        } while (randomPreset.id === currentId && attempts < 5);
                    } else {
                        randomPreset = presets[0];
                    }
                    if (randomPreset) {
                        window.Settings.update({
                            customBackground: randomPreset,
                            lastBackgroundRotation: now
                        });
                    }
                }
            }
        }
    };

    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', checkRotation);
    } else {
        checkRotation();
    }
})();

</script>

    <script>
        const loadingScreen = document.getElementById('loading-screen');
        const iframe = document.getElementById('main-frame');
        let loadStartTime = Date.now();
        let fallbackTimer = setTimeout(hideLoading, 3500);

        function showLoading() {
            loadingScreen.classList.remove('hidden');
            if (window.Quotes) window.Quotes.init(true);
            loadStartTime = Date.now();

            clearTimeout(fallbackTimer);
            fallbackTimer = setTimeout(hideLoading, 3500);
        }

        function hideLoading() {
            clearTimeout(fallbackTimer);

            // Min time 0.5s (500ms)
            const minTime = 500;
            const elapsed = Date.now() - loadStartTime;
            const remaining = Math.max(0, minTime - elapsed);

            setTimeout(() => {
                loadingScreen.classList.add('hidden');
            }, remaining);

            // Re-attach listener to the new window for next navigation
            try {
                if (iframe.contentWindow) {
                    iframe.contentWindow.removeEventListener('unload', showLoading);
                    iframe.contentWindow.addEventListener('unload', () => {
                        requestAnimationFrame(showLoading);
                    });
                }
            } catch (e) { }
        }

        // Listen for iframe load events
        iframe.addEventListener('load', hideLoading);

        // Expose to children if needed
        window.showLoading = showLoading;
        window.hideLoading = hideLoading;

        console.log('press c to enter');
    </script>
</body>

</html>, right: '
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phantom Unblocked</title>
    <link rel="icon" href="favicon.svg" type="image/svg+xml">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- Google Tag Manager -->
    <script>(function (w, d, s, l, i) {
            w[l] = w[l] || []; w[l].push({
                'gtm.start':
                    new Date().getTime(), event: 'gtm.js'
            }); var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
                    'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-5LMBC27Z');</script>
    <!-- End Google Tag Manager -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html,
        body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: var(--bg, #0a0a0a);
            font-family: 'Inter', -apple-system, sans-serif;
        }


        .loading-screen {
            position: fixed;
            inset: 0;
            background: rgba(10, 10, 10, 0.6);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }

        .loading-screen.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
            transition: opacity 0.5s ease-in-out, visibility 0.5s;
        }

        .loading-logo {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 24px;
            display: flex;
            align-items: center;
            gap: 14px;
        }

        .loading-logo i {
            color: var(--text-muted, #a1a1aa);
        }

        .loading-logo span {
            background: linear-gradient(90deg, var(--text, #e4e4e7) 0%, var(--text-muted, #a1a1aa) 40%, var(--text-dim, #52525b) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border, #1f1f1f);
            border-top-color: var(--text-muted, #71717a);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .loading-text {
            margin-top: 16px;
            color: var(--text-dim, #52525b);
            font-size: 0.875rem;
        }


        .launch-screen {
            position: fixed;
            inset: 0;
            background: rgba(10, 10, 10, 0.6);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .launch-screen.hidden {
            display: none;
        }

        .launch-button {
            background: var(--surface);
            color: var(--text-muted);
            border: none;
            padding: 24px 48px;
            border-radius: var(--radius-lg);
            font-size: 1.25rem;
            font-weight: 600;
            cursor: pointer;
            transition: opacity 0.2s;
            margin-top: 16px;
            width: 100%;
            max-width: 300px;
            opacity: 0.75;
        }

        .launch-button:hover {
            opacity: 0.5;
        }

        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        /* Panic white screen */
        #panic-overlay {
            position: fixed;
            inset: 0;
            background: white;
            z-index: 99999;
            display: none;
        }
    </style>
    <script>
// site config

window.SITE_CONFIG = {
    name: "Phantom",
    fullName: "Phantom Unblocked",
    version: "1.0.12",

    changelog: [
        "1.0.12: tiny fixxes and changes",
        "some code consolidation and fixxes",
        "suggest features in the discord server"
    ],

    // quotes
    quotes: [
        "lebron lebron lebronn james",
        "so tuff",
        "it is what it is",
        "do ur work",
        "this is what happens when u dont touch grass",
        "FULL BOX",
        "FULL PIECE",
        "200!",
        "press esc + refresh + power button for hacks",
        "press ctrl+x to hide your screen",
        "change the tab title and favicon in settings",
        "TEACHERR!",
        "1 pump",
        "303 headshot",
        "bros prolly a 60 ovr",
        "take the L lil bro",  
        "lebron is OUR goat",
        "stop looking at my screen",
    ],

    // todo
    // *** for strikethrough
    // ** for bold
    todos: [
        "***fixxed aboutblank opening while securly is on (previously if popups were off it would load intab instead of clickto launch now it will use clicktolaunch unless popups are blocked)***",
        "***fix the proxy***",
        "***fix panic panickey, add quote talking about it***",
        "***fix theatermode, make it hide buttons after a few seconds and ensure all content is being displayed and move the description to the bottom***",
        "***change back player to use old styling, change the surface to use background colors for the bottom part where description is shown, looking just like the background***",
        "***add image and video support for backgrounds***",
        "***fix aichat, make the title use the same ai request as the users question unless its in image mode where it will use text mode and fix ai chat to remember modes better***",
        "***add cloaking to quotes***",
        "***add a default cloak and fix it so icons work in aboutblank for whatever reason they only work when you go to settings in aboutblank where it correctly applies***",
        "***for search suggestions add highlighting for whatever will happen when you click enter, in search suggestions fix all games not sending you to the games page***",
        "***fix games to make multi library the default, put it in config.js***",
        "***rename movies shortcut in index2.html to primeshows, add shortcuts to main pages in the topbar and change the current shortcuts to more popular games***",
        "***make announcements show even on first visit unlike changelog and allow disabling it via settings***",
        "***fix leave comformation asking u to leave each time you click something***",
        "***change the shortcuts on the main page to include pages***",
        "***add movies to the search bar in main page***",
        "***fix background not turning off soon***",
        "***fix music page to hide youtube player unless toggled via 3 dot small button, and always shown on proxy mode, fix all the controls for video time, volume***",
        "**add singlefile this is lowk so hard i dont really understand it**",
        "**advertise phantom (too much work tbh)**",
        "**add a watch page for youtube and twitch**",
        "**add a miniplayer for music**",
        "***shorten some page's code***",
        "***fix paths in search autocomplete***",
        "***fix markdown in ai not using correct text colors***",
        "***make backgrounds show in the loading screen***",
        "***fix icons for topbar in code.html***",
        "**fix wisp server not notifying or autoswitiching when offline in proxy**",
        "***fix code runner open not working at all***",
        "***make backgrounds show in player.html***",
        "***make backgrounds show in staticsjv2***",
        "***make player.html player controls use theme colros not hardcoded***",
        "***make ai chat and music sidebar go all the way down and up with borders***",
        "**make the only song in music be lebron lebron lebron james**",
        "**fix music controls**",
        "***finish extra page into credits and make this todo be tucked away somewhere and not the main part of it***"
    ],
    defaultWisp: "wss://glseries.net/wisp/",
    wispServers: [
        { name: "GLSeries Wisp", url: "wss://glseries.net/wisp/" },
        { name: "Rhw's Wisp", url: "wss://wisp.rhw.one/" },
    ],

    discord: {
        inviteUrl: "https://discord.gg/tHWx9NXp5p",
        widgetServer: "1447673724017971324",
        widgetChannel: "1447673726228496617",
    },

    firstVisitCloak: false, //fake error page
    defaults: {
        cloakMode: "about:blank",
        tabTitle: "You've already responded",
        tabFavicon: "https://ssl.gstatic.com/docs/spreadsheets/forms/forms_icon_2023q4.ico",
        cloakRotation: false,
        cloakInterval: 5000,
        panicKey: "x",
        panicModifiers: ["ctrl", "shift"],
        panicUrl: "https://classroom.google.com",
        maxMovieRating: "R",
        gameLibrary: "multi",
        discordWidget: true,
        miniplayer: true,
        leaveConfirmation: false,
        showChangelogOnUpdate: true,
        themeRotation: true,
        lastThemeRotation: 0,
        backgroundRotation: true,
        lastBackgroundRotation: 0,
        lastSeenFeatured: 'none',
        background: { type: 'color', value: '#0a0a0a' },
        customBackground: { id: 'none', type: 'none' },
        accentColor: '#ffffff',
        surfaceColor: '#0f0f0f',
        secondaryColor: '#2e2e33',
        textColor: '#e4e4e7',
    },

    themePresets: {
        dark: { name: 'Dark (Default)', bg: { type: 'color', value: '#0a0a0a' }, surface: '#0f0f0f', surfaceHover: '#1a1a1a', surfaceActive: '#252525', secondary: '#2e2e33', border: '#2a2a2a', borderLight: '#2a2a2a', text: '#e4e4e7', textSec: '#71717a', textDim: '#52525b', accent: '#ffffff' },
        midnight: { name: 'Midnight', bg: { type: 'color', value: '#000000' }, surface: '#050505', surfaceHover: '#111111', surfaceActive: '#1a1a1a', secondary: '#111111', border: '#1a1a1a', borderLight: '#111111', text: '#ededed', textSec: '#a3a3a3', textDim: '#737373', accent: '#d4d4d4' },
        abyss: { name: 'Abyss', bg: { type: 'color', value: '#020617' }, surface: '#0f172a', surfaceHover: '#1e293b', surfaceActive: '#334155', secondary: '#1e293b', border: '#1e293b', borderLight: '#1e293b', text: '#f1f5f9', textSec: '#94a3b8', textDim: '#64748b', accent: '#38bdf8' },
        phantom: { name: 'Phantom', bg: { type: 'color', value: '#0f0a14' }, surface: '#1a0f24', surfaceHover: '#2e1a40', surfaceActive: '#4c2a5c', secondary: '#2e1a40', border: '#2e1a40', borderLight: '#2e1a40', text: '#f3e8ff', textSec: '#d8b4fe', textDim: '#c084fc', accent: '#c084fc' },
        rosepine: { name: 'Rose Pine', bg: { type: 'color', value: '#191724' }, surface: '#1f1d2e', surfaceHover: '#26233a', surfaceActive: '#524f67', secondary: '#26233a', border: '#26233a', borderLight: '#1f1d2e', text: '#e0def4', textSec: '#908caa', textDim: '#6e6a86', accent: '#ebbcba' },
        ocean: { name: 'Oceanic', bg: { type: 'color', value: '#011627' }, surface: '#0b2942', surfaceHover: '#1d3b53', surfaceActive: '#2d4b63', secondary: '#0b2942', border: '#1d3b53', borderLight: '#0b2942', text: '#d6deeb', textSec: '#5f7e97', textDim: '#011627', accent: '#7fdbca' },
        forest: { name: 'Forest', bg: { type: 'color', value: '#020d06' }, surface: '#051a0d', surfaceHover: '#0a2e17', surfaceActive: '#0f4221', secondary: '#051a0d', border: '#0a2e17', borderLight: '#051a0d', text: '#ecfdf5', textSec: '#6ee7b7', textDim: '#064e3b', accent: '#10b981' },
        crimson: { name: 'Crimson', bg: { type: 'color', value: '#1a0505' }, surface: '#230a0a', surfaceHover: '#7b0a0aff', surfaceActive: '#7f1d1d', secondary: '#230a0a', border: '#480f0fff', borderLight: '#230a0a', text: '#fef2f2', textSec: '#fecaca', textDim: '#450a0a', accent: '#ef4444' },
        flame: { name: 'Flame', bg: { type: 'color', value: '#0c0202' }, surface: '#1c0a0a', surfaceHover: '#451a03', surfaceActive: '#9a3412', secondary: '#1c0a0a', border: '#451a03', borderLight: '#9a3412', text: '#fff7ed', textSec: '#fdba74', textDim: '#ea580c', accent: '#f59e0b' }
    },

    backgroundPresets: [
        { id: 'none', name: 'None (Theme Default)', type: 'none' },
        { id: 'Night sky', name: 'Night sky', type: 'image', url: 'https://images.pexels.com/photos/5675745/pexels-photo-5675745.jpeg', overlay: 0.3 },
        { id: 'winter-mountains', name: 'Winter mountains', type: 'image', url: 'https://images.pexels.com/photos/1287145/pexels-photo-1287145.jpeg', overlay: 0.3 },
        { id: 'f1 car', name: 'F1 Car', type: 'image', url: 'https://images.pexels.com/photos/14401632/pexels-photo-14401632.jpeg', overlay: 0.3 },
        { id: 'moon-landing', name: 'Moon Landing', type: 'image', url: 'https://images.pexels.com/photos/41162/moon-landing-apollo-11-nasa-buzz-aldrin-41162.jpeg', overlay: 0.3, objectPosition: 'top left', active: true },
        { id: 'turtle', name: 'Turtle', type: 'image', url: 'https://images.unsplash.com/photo-1501791187590-9ef2612ba1eb?q=80&w=1932&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D', overlay: 0.3 },
        { id: 'road', name: 'Road', type: 'image', url: 'https://images.unsplash.com/photo-1508233620467-f79f1e317a05', overlay: 0.3 },
        { id: 'railroad', name: 'Railroad', type: 'image', url: 'https://images.unsplash.com/photo-1505832018823-50331d70d237', overlay: 0.3 },
        { id: 'mountain', name: 'Mountain', type: 'image', url: 'https://raw.githubusercontent.com/evanhnry/brave-wallpapers/refs/heads/main/Brave/clay-banks-u27Rrbs9Dwc-unsplash.jpg', overlay: 0.3 },
    ],

    cloakPresets: [
        { name: "Phantom", icon: "/favicon.svg", title: "Phantom Unblocked" },
        { name: "Edpuzzle", icon: "https://edpuzzle.imgix.net/favicons/favicon-32.png", title: "Edpuzzle" },
        { name: "Google Docs", icon: "https://ssl.gstatic.com/docs/documents/images/kix-favicon7.ico", title: "Untitled document - Google Docs" },
        { name: "Canvas", icon: "https://du11hjcvx0uqb.cloudfront.net/dist/images/favicon-e10d657a73.ico", title: "Dashboard" },
        { name: "Desmos", icon: "https://www.desmos.com/favicon.ico", title: "Desmos | Graphing Calculator" },
        { name: "Khan Academy", icon: "https://cdn.kastatic.org/images/favicon.ico", title: "Khan Academy" },
        { name: "Wikipedia", icon: "https://en.wikipedia.org/favicon.ico", title: "World War II - Wikipedia" },
        { name: "Classroom", icon: "https://ssl.gstatic.com/classroom/favicon.png", title: "Home - Classroom" },
        { name: "Canva", icon: "https://static.canva.com/static/images/android-192x192-2.png", title: "Home - Canva" },
        { name: "Quiz", icon: "https://ssl.gstatic.com/docs/spreadsheets/forms/forms_icon_2023q4.ico", title: "You've already responded" },
        { name: "Blooket", icon: "https://play.blooket.com/favicon.ico", title: "Play Blooket | Blooket" },
        { name: "Gmail", icon: "https://ssl.gstatic.com/ui/v1/icons/mail/rfr/gmail.ico", title: "Gmail" },
        { name: "YouTube", icon: "https://www.youtube.com/favicon.ico", title: "YouTube" },
        { name: "Powerschool", icon: "https://waverlyk12.powerschool.com/favicon.ico", title: "Grades and Attendance" },
        { name: "nothing", icon: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=", title: "\u200B" },
    ]
}



</script>
    <script>
// settings handler
(function () {
    'use strict';

    const STORAGE_KEY = 'void_settings';

    const getDefaults = () => {
        return window.SITE_CONFIG?.defaults || {
            cloakMode: 'none',
            cloakRotation: false,
            cloakInterval: 5000,
            panicKey: 'x',
            panicModifiers: ['ctrl', 'shift'],
            panicUrl: 'https://classroom.google.com',
            maxMovieRating: 'R',
            offlineGames: [],
            gameLibrary: 'multi',
            leaveConfirmation: false
        };
    };

    const load = () => {
        try {
            const stored = localStorage.getItem(STORAGE_KEY);
            if (stored) {
                return { ...getDefaults(), ...JSON.parse(stored) };
            }
        } catch (e) {
            console.warn('Failed to load settings:', e);
        }
        return getDefaults();
    };

    const save = (settings) => {
        try {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));
            window.dispatchEvent(new CustomEvent('settings-changed', { detail: settings }));
            if (window.parent !== window) {
                window.parent.postMessage({ type: 'settings-update' }, '*');
            }
        } catch (e) {
            console.warn('Failed to save settings:', e);
        }
    };

    let _settings = load();

    window.Settings = {
        get(key) { return _settings[key]; },

        getAll() { return { ..._settings }; },

        set(key, value) {
            _settings[key] = value;
            save(_settings);
            this.apply();
            return value;
        },

        update(partial) {
            _settings = { ..._settings, ...partial };
            save(_settings);
            this.apply();
        },

        reset() {
            _settings = getDefaults();
            save(_settings);
            this.apply();
        },

        apply() {
            const root = document.documentElement;
            const s = _settings;
            const d = window.SITE_CONFIG?.defaults || {};

            const vars = {
                '--accent': s.accentColor || d.accentColor || '#ffffff',
                '--surface': s.surfaceColor || d.surfaceColor || '#0f0f0f',
                '--surface-hover': s.surfaceHoverColor || d.surfaceHoverColor || '#1a1a1a',
                '--surface-active': s.surfaceActiveColor || d.surfaceActiveColor || '#252525',
                '--secondary': s.secondaryColor || d.secondaryColor || '#2e2e33',
                '--border': s.borderColor || d.borderColor || '#1f1f1f',
                '--border-light': s.borderLightColor || d.borderLightColor || '#2a2a2a',
                '--text': s.textColor || d.textColor || '#e4e4e7',
                '--text-muted': s.textSecondaryColor || d.textSecondaryColor || '#71717a',
                '--text-dim': s.textDimColor || d.textDimColor || '#52525b',
                '--toggle': s.toggleColor || d.toggleColor,
                '--toggle-knob': s.toggleKnobColor || d.toggleKnobColor
            };

            Object.entries(vars).forEach(([key, val]) => {
                if (val) root.style.setProperty(key, val);
            });

            const themeBg = s.background || d.background || { type: 'color', value: '#0a0a0a' };
            const customBg = s.customBackground;
            const isCustomActive = customBg && customBg.type !== 'none';

            if (themeBg.type === 'color') {
                root.style.setProperty('--bg', themeBg.value);
            }

            if (isCustomActive && customBg.url) {
                root.style.setProperty('--bg-image', `url(${customBg.url})`);

                let position = customBg.objectPosition;
                if (customBg.id && customBg.id !== 'custom') {
                    const preset = window.SITE_CONFIG?.backgroundPresets?.find(b => b.id === customBg.id);
                    if (preset?.objectPosition) position = preset.objectPosition;
                }

                root.style.setProperty('--bg-image-position', position || 'center');
            } else if (themeBg.type === 'image' || themeBg.type === 'video') {
                root.style.setProperty('--bg-image', `url(${themeBg.value || themeBg.url})`);
                root.style.setProperty('--bg-image-position', themeBg.objectPosition || 'center');
            } else if (themeBg.type === 'gradient') {
                root.style.setProperty('--bg-image', themeBg.value || themeBg.url);
                root.style.setProperty('--bg-image-position', 'center');
            } else {
                root.style.setProperty('--bg-image', 'none');
            }
        },

        onChange(callback) {
            window.addEventListener('settings-changed', (e) => callback(e.detail));
        },

        isRatingAllowed(rating) {
            if (!rating || rating === 'NR' || rating === 'NC-17') return false;
            const ratingOrder = ['G', 'PG', 'PG-13', 'R'];
            const maxIndex = ratingOrder.indexOf(_settings.maxMovieRating);
            const ratingIndex = ratingOrder.indexOf(rating);
            return maxIndex !== -1 && ratingIndex !== -1 && ratingIndex <= maxIndex;
        }
    };

    // panic button go brr
    const handlePanic = (e) => {
        const mods = _settings.panicModifiers || [];
        const key = _settings.panicKey || 'x';

        if (mods.includes('ctrl') !== e.ctrlKey) return;
        if (mods.includes('shift') !== e.shiftKey) return;
        if (mods.includes('alt') !== e.altKey) return;

        if (e.key.toLowerCase() === key.toLowerCase()) {
            e.preventDefault();
            const overlayId = 'panic-overlay';
            let overlay = window.parent?.document?.getElementById(overlayId) || document.getElementById(overlayId);

            if (!overlay) {
                overlay = document.createElement('div');
                overlay.id = overlayId;
                overlay.style.cssText = 'position:fixed;inset:0;background:white;z-index:99999;';
                document.body.appendChild(overlay);
            } else {
                overlay.style.display = 'block';
            }

            window.location.replace(_settings.panicUrl || 'https://classroom.google.com');
        }
    };

    const init = () => {
        Settings.apply();

        const featured = window.SITE_CONFIG?.featuredBackground;
        const activePreset = window.SITE_CONFIG?.backgroundPresets?.find(p => p.active);

        const target = activePreset || featured;

        if (target?.id && target.id !== _settings.lastSeenFeatured) {
            Settings.update({
                customBackground: target,
                lastSeenFeatured: target.id,
                backgroundRotation: false
            });
        }

        document.addEventListener('keydown', handlePanic, true);

        window.addEventListener('storage', (e) => {
            if (e.key === STORAGE_KEY) {
                _settings = load();
                Settings.apply();
                window.dispatchEvent(new CustomEvent('settings-changed', { detail: _settings }));
            }
        });

        window.addEventListener('message', (e) => {
            if (e.data?.type === 'settings-update' || e.data === 'updateCloak') {
                _settings = load();
                Settings.apply();
                window.dispatchEvent(new CustomEvent('settings-changed', { detail: _settings }));
            }
        });

        window.addEventListener('beforeunload', (e) => {
            if (document.getElementById('main-frame') && _settings.leaveConfirmation) {
                e.preventDefault();
                return e.returnValue = '';
            }
        });
    };

    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', init);
    else init();
})();

</script>
    <script>
// background stuff
(function () {
    'use strict';

    if (window.BackgroundManager) return;

    const YOUTUBE_REGEX = /(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([a-zA-Z0-9_-]{11})/;

    const BackgroundManager = {
        container: null,
        mediaLayer: null,
        elements: { video: null, image: null, iframe: null },
        current: { type: null, url: null },
        cacheName: 'phantom-bg-cache-v2',

        init() {
            this.container = document.createElement('div');
            this.container.className = 'phantom-background';
            this.container.innerHTML = '<div class="phantom-background-overlay"></div><div class="phantom-background-layer"></div>';
            this.mediaLayer = this.container.querySelector('.phantom-background-layer');
            document.body.insertBefore(this.container, document.body.firstChild);

            const apply = () => this.applyBackground();
            window.addEventListener('settings-changed', apply);
            window.addEventListener('storage', apply);
            window.addEventListener('beforeunload', () => this.cleanup());
            window.addEventListener('pagehide', () => this.cleanup());

            document.addEventListener('visibilitychange', () => {
                const video = this.elements.video;
                if (!video) return;
                if (document.hidden) video.pause();
                else if (this.current.type === 'video') video.play().catch(() => { });
            });

            this.applyBackground();
        },

        applyBackground() {
            if (!this.container) return; // Wait for init() to create the container

            const s = window.Settings?.getAll() || {};
            const custom = s.customBackground;
            const theme = s.background || {};

            let type = null, url = null, pos = null, overlay = 0.4;

            if (custom && custom.type !== 'none') {
                // Refresh from config if possible to get latest props like objectPosition
                if (custom.id && custom.id !== 'custom') {
                    const preset = window.SITE_CONFIG?.backgroundPresets?.find(b => b.id === custom.id);
                    if (preset) Object.assign(custom, preset);
                }
                ({ type, url, objectPosition: pos, overlay = 0.4 } = custom);
            } else if (theme.type === 'image' || theme.type === 'video' || theme.type === 'youtube') {
                type = theme.type;
                url = theme.value || theme.url;
                pos = theme.objectPosition;
                overlay = theme.overlay || 0.4;
            }

            document.documentElement.style.setProperty('--bg-overlay', overlay);

            // Handle common positioning typos and normalize
            if (pos && typeof pos === 'string') {
                pos = pos.toLowerCase().trim()
                    .replace(/\s+/g, ' ') // Normalize multiple spaces
                    .replace('topleft', 'top left')
                    .replace('topright', 'top right')
                    .replace('bottomleft', 'bottom left')
                    .replace('bottomright', 'bottom right')
                    .replace('centercenter', 'center')
                    .replace('centerleft', 'center left')
                    .replace('centerright', 'center right');
            }

            document.documentElement.style.setProperty('--bg-image-position', pos || 'center');

            if (!type || !url) {
                this.clear();
                document.documentElement.style.backgroundColor = 'var(--bg)';
                document.documentElement.style.setProperty('--bg-image-position', 'center');
                return;
            }
            if (this.current.type === type && this.current.url === url) return;

            this.current = { type, url };

            if (type === 'video' || url.match(/\.(mp4|webm|ogg|mov|m4v)$/i)) {
                this.clearMedia();
                this.createVideo(url, pos);
                this.container.classList.add('active');
                document.documentElement.classList.add('phantom-bg-active');
                document.body.classList.add('phantom-bg-active');
            } else if (type === 'youtube' || YOUTUBE_REGEX.test(url)) {
                this.clearMedia();
                this.createYouTube(url, pos);
                this.container.classList.add('active');
                document.documentElement.classList.add('phantom-bg-active');
                document.body.classList.add('phantom-bg-active');
            } else if (type === 'image') {
                this.handleImageBackground(url, pos);
            }
        },

        async getProxiedCachedUrl(url) {
            // Local images don't need proxying
            if (!url.startsWith('http') || url.includes(location.hostname)) return url;

            // Try direct load first (faster)
            try {
                const directTest = await fetch(url, { method: 'HEAD', mode: 'cors' });
                if (directTest.ok) return url;
            } catch (e) {
                // CORS blocked, need to proxy
            }

            // Wait for BareMux (max 500ms)
            let retries = 0;
            while (!window.BareMux && retries < 5) {
                await new Promise(r => setTimeout(r, 100));
                retries++;
            }

            if (!window.BareMux) {
                console.warn("Background: BareMux not found, trying direct URL.");
                return url; // Try direct anyway
            }

            try {
                const client = new window.BareMux.BareClient();
                const response = await client.fetch(url);
                if (!response.ok) throw new Error('Proxy fetch failed');

                const blob = await response.blob();
                return URL.createObjectURL(blob);
            } catch (error) {
                console.error("Background proxy failed:", error);
                return url; // Fallback to direct URL
            }
        },

        async handleImageBackground(url, pos) {
            // Pre-load the image (proxied/cached or direct)
            const finalUrl = await this.getProxiedCachedUrl(url);

            // Check if this is still the current background after async fetch
            if (this.current.url !== url) {
                if (finalUrl && finalUrl.startsWith('blob:')) URL.revokeObjectURL(finalUrl);
                return;
            }

            this.clearMedia();
            this.createImage(finalUrl, pos);
        },

        createVideo(url, pos) {
            const el = Object.assign(document.createElement('video'), {
                className: 'phantom-background-media', src: url, autoplay: true, loop: true, muted: true, playsInline: true, volume: 0
            });
            // Apply objectPosition from settings/preset
            if (pos) el.style.objectPosition = pos;
            el.onerror = () => (this.elements.video = null);
            this.elements.video = el;
            this.mediaLayer.appendChild(el);
        },

        createImage(url, pos) {
            const el = Object.assign(document.createElement('img'), {
                className: 'phantom-background-media',
                src: url
            });

            // Apply objectPosition from settings/preset
            if (pos) el.style.objectPosition = pos;

            el.onload = () => {
                if (this.current.url === url || url.startsWith('blob:')) {
                    this.container.classList.add('active');
                    document.documentElement.classList.add('phantom-bg-active');
                    document.body.classList.add('phantom-bg-active');
                }
            };
            el.onerror = () => {
                console.warn("Background image failed to load:", url);
                if (this.elements.image === el) this.elements.image = null;
            };

            this.elements.image = el;
            this.mediaLayer.appendChild(el);
        },

        // youtube logic
        createYouTube(url, pos) {
            const id = url.match(YOUTUBE_REGEX)?.[1];
            if (!id) return;
            const el = Object.assign(document.createElement('iframe'), {
                className: 'phantom-background-media',
                src: `https://www.youtube.com/embed/${id}?autoplay=1&loop=1&playlist=${id}&controls=0&modestbranding=1&rel=0&mute=1&enablejsapi=1`,
                allow: 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture'
            });
            // Apply objectPosition from settings/preset
            if (pos) el.style.objectPosition = pos;
            this.elements.iframe = el;
            this.mediaLayer.appendChild(el);
        },

        clearMedia() {
            Object.entries(this.elements).forEach(([key, el]) => {
                if (!el) return;
                if (key === 'video') { el.pause(); el.src = ''; }
                if (key === 'iframe') el.src = 'about:blank';
                if (key === 'image' && el.src.startsWith('blob:')) {
                    URL.revokeObjectURL(el.src);
                }
                el.remove();
                this.elements[key] = null;
            });
        },

        clear() {
            this.clearMedia();
            this.current = { type: null, url: null };
            document.documentElement.classList.remove('phantom-bg-active');
            document.body.classList.remove('phantom-bg-active');
            document.documentElement.style.backgroundColor = '';
            if (this.container) this.container.classList.remove('active');
        },

        cleanup() {
            this.clearMedia();
        }
    };

    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', () => BackgroundManager.init());
    else BackgroundManager.init();

    window.BackgroundManager = BackgroundManager;
})();

</script>
    <script>
// stealth mode
(function () {
    'use strict';

    let rotationInterval = null;
    let currentPresetIndex = 0;
    const original = { title: document.title, favicon: document.querySelector('link[rel="icon"]')?.href };

    const getPresets = () => [...(window.SITE_CONFIG?.cloakPresets || []), ...(window.Settings?.get('customCloaks') || [])];

    const setTitle = (title) => {
        if (!title) return;
        document.title = title;
        try { if (window.top !== window.self) window.top.document.title = title; } catch { }
    };

    const setFavicon = (href) => {
        if (!href) return;
        [document, window.top?.document].filter(d => { try { return d; } catch { return false; } }).forEach(doc => {
            doc.querySelectorAll('link[rel*="icon"]').forEach(l => l.remove());
            const link = doc.createElement('link');
            link.rel = 'icon';
            link.href = href;
            doc.head.appendChild(link);
        });
    };

    const apply = (p) => {
        if (p) {
            setTitle(p.title);
            setFavicon(p.icon || p.favicon);
        } else {
            const s = window.Settings?.getAll() || {};
            setTitle(s.tabTitle || window.SITE_CONFIG?.defaults?.tabTitle);
            setFavicon(s.tabFavicon || window.SITE_CONFIG?.defaults?.tabFavicon);
        }
    };

    const startRotation = (ms) => {
        stopRotation();
        const presets = getPresets();
        if (presets.length < 2) return apply(presets[0]);
        rotationInterval = setInterval(() => {
            currentPresetIndex = (currentPresetIndex + 1) % presets.length;
            apply(presets[currentPresetIndex]);
        }, ms);
    };

    const stopRotation = () => { if (rotationInterval) { clearInterval(rotationInterval); rotationInterval = null; } };

    const redirectOriginal = () => {
        const targets = ["https://classroom.google.com", "https://drive.google.com", "https://google.com", "https://kahoot.it", "https://edpuzzle.com"];
        window.location.replace(targets[Math.floor(Math.random() * targets.length)]);
    };

    const getPopupContent = (url) => {
        const s = window.Settings?.getAll() || {};
        const title = s.tabTitle || window.SITE_CONFIG?.defaults?.tabTitle || 'Google';
        const icon = s.tabFavicon || window.SITE_CONFIG?.defaults?.tabFavicon || 'https://www.google.com/favicon.ico';
        return `<!DOCTYPE html><html><head><title>${title}</title><link rel="icon" href="${icon}"><style>* {margin:0;padding:0;height:100%;overflow:hidden;} iframe{width:100%;height:100%;border:none;}</style></head><body><iframe src="${url}"></iframe></body></html>`;
    };

    // Try to open popup and monitor if it survives for 500ms
    // Returns: { success: true } if popup works and stays open
    // Returns: { success: false, reason: 'blocked' } if window.open returned null
    // Returns: { success: false, reason: 'killed' } if popup was closed by extension (like Securly)
    const tryPopup = (url) => {
        return new Promise((resolve) => {
            const win = window.open('about:blank', '_blank');

            // Popup completely blocked by browser
            if (!win) {
                resolve({ success: false, reason: 'blocked' });
                return;
            }

            // Write the actual content to popup
            try {
                win.document.write(getPopupContent(url));
                win.document.close();
            } catch (e) {
                try { win.close(); } catch { }
                resolve({ success: false, reason: 'killed' });
                return;
            }

            // Use a single timeout to avoid background throttling (which causes a 5s delay).
            // When the original tab loses focus, browsers throttle timers to ~1s minimum.
            // If the timer runs, we check once and redirect immediately.
            const timeoutMs = 200;

            setTimeout(() => {
                if (win.closed) {
                    resolve({ success: false, reason: 'killed' });
                } else {
                    resolve({ success: true });
                    redirectOriginal(); // Instant redirect
                }
            }, timeoutMs);
        });
    };

    // Load content in-tab (fallback)
    const loadInTab = () => {
        const iframe = document.getElementById('main-frame');
        if (iframe && !iframe.src) iframe.src = 'index2.html';
        apply();
    };

    // Show launch screen with callback for when button is clicked
    const showLaunchScreen = (onLaunch) => {
        const ls = document.getElementById('launch-screen');
        if (ls) {
            ls.classList.remove('hidden');
            document.getElementById('launch-button').onclick = onLaunch;
        }
    };

    // Attempt popup with fallback:
    // 1. Try real popup -> if works (survives 500ms), redirect original tab
    // 2. If blocked (null) -> show click-to-launch (user gesture might help)
    // 3. If killed (closed by Securly) -> load in-tab directly
    // 4. If click-to-launch popup also fails -> load in-tab
    const attemptCloakedLaunch = async (url, hideOverlay = null) => {
        const result = await tryPopup(url);

        if (result.success) {
            // Popup worked and is still open! redirectOriginal() was already called
            return true;
        }

        if (result.reason === 'blocked') {
            // Popup was blocked (window.open returned null)
            // Show click-to-launch - user gesture might bypass popup blocker
            if (hideOverlay) hideOverlay();

            showLaunchScreen(async () => {
                document.getElementById('launch-screen').classList.add('hidden');

                // Try popup again with user gesture
                const retryResult = await tryPopup(url);
                if (!retryResult.success) {
                    // Even with user click, popup failed - load in-tab
                    loadInTab();
                }
                // If success, redirectOriginal() was called inside tryPopup
            });
            return true; // Handled (showing launch screen)
        }

        // reason === 'killed' - Securly/extension killed the popup, go straight to in-tab
        if (hideOverlay) hideOverlay();
        loadInTab();
        return false;
    };

    const init = async () => {
        const s = window.Settings?.getAll() || {};
        const fvKey = 'phantom_fv';
        const urlParams = new URLSearchParams(window.location.search);

        // Handle fake mode (legacy)
        if (urlParams.has('fake')) {
            showLaunchScreen(async () => {
                document.getElementById('launch-screen').classList.add('hidden');
                if (s.cloakMode === 'about:blank') {
                    const result = await tryPopup(window.location.href.split('?')[0]);
                    if (result.success) return; // redirectOriginal was called
                }
                loadInTab();
            });
            return;
        }

        // Handle first visit cloak (fake error page)
        if (window.SITE_CONFIG?.firstVisitCloak && !localStorage.getItem(fvKey)) {
            const overlay = document.getElementById('fv-cloak');
            if (overlay) {
                overlay.style.display = 'block';
                document.title = window.location.hostname;
                document.querySelectorAll("link[rel*='icon']").forEach(l => l.remove());
                const link = document.createElement('link');
                link.rel = 'icon';
                link.href = 'data:,';
                document.head.appendChild(link);

                const onKey = async (e) => {
                    if (e.key.toLowerCase() === 'c') {
                        localStorage.setItem(fvKey, '1');
                        document.removeEventListener('keydown', onKey);

                        if (s.cloakMode === 'about:blank') {
                            await attemptCloakedLaunch(window.location.href, () => {
                                overlay.style.display = 'none';
                            });
                        } else {
                            overlay.style.display = 'none';
                            apply();
                            loadInTab();
                        }
                    }
                };
                document.addEventListener('keydown', onKey);
            }
            return;
        }

        // Normal visit - not first time, no fake mode
        if (window.top === window.self && s.cloakMode === 'about:blank') {
            await attemptCloakedLaunch(window.location.href);
            return;
        }

        loadInTab();
        if (s.rotateCloaks) startRotation((s.rotateInterval || 5) * 1000);
    };

    window.Cloaking = { init, apply, startRotation, stopRotation, tryPopup, loadInTab };

    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', () => setTimeout(init, 100));
    else setTimeout(init, 100);

    window.addEventListener('settings-changed', (e) => {
        apply();
        if (e.detail.rotateCloaks) startRotation((e.detail.rotateInterval || 5) * 1000);
        else stopRotation();
    });
})();

</script>
    <script>
window.Quotes = {
    // Use data from config, fallback to empty array if not found
    getData() {
        return (window.SITE_CONFIG && window.SITE_CONFIG.quotes) || [];
    },

    getRandom() {
        const data = this.getData();
        if (!data.length) return null; // Return null if no quotes
        return data[Math.floor(Math.random() * data.length)];
    },
    init(force = false) {
        const quote = this.getRandom();
        if (!quote) return; // Do nothing if no quotes

        const targets = [
            '#quote',
            '#quote-display',
            '#subtitle',
            '.page-subtitle',
            '.extra-hero p',
            '.loading-text'
        ];

        targets.forEach(selector => {
            document.querySelectorAll(selector).forEach(el => {
                // Only update if force is true, or it's empty, or has placeholder text
                const text = el.textContent.trim();
                if (force || !text || text === 'Loading...' || text.includes('Stream movies') || text.includes('Customize your')) {
                    el.textContent = quote;
                }
            });
        });
    }
};

window.QUOTES = window.Quotes.getData();

// Run automatically on load
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => window.Quotes.init());
} else {
    window.Quotes.init();
}

</script>
    <script>Settings.apply();</script>
    <style>
/* Base styles and variables derived from erorr.html */
:root {
    --background-color: #fff;
    --error-code-color: #5f6368;
    --google-blue-100: rgb(210, 227, 252);
    --google-blue-300: rgb(138, 180, 248);
    --google-blue-600: rgb(26, 115, 232);
    --google-blue-700: rgb(25, 103, 210);
    --google-gray-100: rgb(241, 243, 244);
    --google-gray-300: rgb(218, 220, 224);
    --google-gray-500: rgb(154, 160, 166);
    --google-gray-50: rgb(248, 249, 250);
    --google-gray-600: rgb(128, 134, 139);
    --google-gray-700: rgb(95, 99, 104);
    --google-gray-800: rgb(60, 64, 67);
    --google-gray-900: rgb(32, 33, 36);
    --heading-color: var(--google-gray-900);
    --link-color: rgb(88, 88, 88);
    --primary-button-fill-color-active: var(--google-blue-700);
    --primary-button-fill-color: var(--google-blue-600);
    --primary-button-text-color: #fff;
    --quiet-background-color: rgb(247, 247, 247);
    --secondary-button-border-color: var(--google-gray-500);
    --secondary-button-fill-color: #fff;
    --secondary-button-hover-border-color: var(--google-gray-600);
    --secondary-button-hover-fill-color: var(--google-gray-50);
    --secondary-button-text-color: var(--google-gray-700);
    --small-link-color: var(--google-gray-700);
    --text-color: var(--google-gray-700);
}

.neterror {
    background: var(--background-color);
    color: var(--text-color);
    word-wrap: break-word;
    font-family: 'Segoe UI', Tahoma, sans-serif;
    margin: 0;
    font-size: 100%;
}

@media (prefers-color-scheme: dark) {

    :root,
    .neterror {
        --background-color: var(--google-gray-900);
        --error-code-color: var(--google-gray-500);
        --heading-color: var(--google-gray-500);
        --link-color: var(--google-blue-300);
        --primary-button-fill-color-active: rgb(129, 162, 208);
        --primary-button-fill-color: var(--google-blue-300);
        --primary-button-text-color: var(--google-gray-900);
        --quiet-background-color: var(--background-color);
        --secondary-button-border-color: var(--google-gray-700);
        --secondary-button-fill-color: var(--google-gray-900);
        --secondary-button-hover-fill-color: rgb(48, 51, 57);
        --secondary-button-text-color: var(--google-blue-300);
        --small-link-color: var(--google-blue-300);
        --text-color: var(--google-gray-500);
    }
}

#fv-cloak.neterror {
    position: fixed;
    inset: 0;
    z-index: 2147483647;
    display: none;
}

/* Layout & Typography */
.neterror .interstitial-wrapper {
    box-sizing: border-box;
    font-size: 1.0em;
    line-height: 1.6em;
    margin: 14vh auto 0;
    max-width: 650px;
    width: 100%;
    padding: 0 24px;
}

.neterror h1 {
    color: var(--heading-color);
    font-size: 1.6em;
    font-weight: normal;
    line-height: 1.25em;
    margin-bottom: 16px;
    margin-top: 0;
    word-wrap: break-word;
}

.neterror h1 span {
    font-weight: 500;
}

.neterror p {
    margin: 0;
}

.neterror a {
    color: var(--link-color);
    text-decoration: none;
}

.neterror .icon {
    height: 72px;
    margin: 0 0 40px;
    width: 72px;
    background-repeat: no-repeat;
    background-size: 100%;
    display: inline-block;
}

.neterror .icon-generic {
    content: image-set(url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJAAAACQAQMAAADdiHD7AAAABlBMVEUAAABTU1OoaSf/AAAAAXRSTlMAQObYZgAAAFJJREFUeF7t0cENgDAMQ9FwYgxG6WjpaIzCCAxQxVggFuDiCvlLOeRdHR9yzjncHVoq3npu+wQUrUuJHylSTmBaespJyJQoObUeyxDQb3bEm5Au81c0pSCD8HYAAAAASUVORK5CYII=) 2x);
}

@media (prefers-color-scheme: dark) {
    .neterror .icon {
        filter: invert(1);
    }
}

.neterror .error-code {
    color: var(--error-code-color);
    font-size: .8em;
    margin-top: 12px;
    text-transform: uppercase;
}

/* Navigation / Buttons */
.neterror .nav-wrapper {
    margin-top: 51px;
}

.neterror .nav-wrapper::after {
    clear: both;
    content: '';
    display: table;
    width: 100%;
}

.neterror button {
    appearance: auto;
    background-color: rgb(193, 196, 255);
    border: none;
    border-radius: 20px;
    box-sizing: border-box;
    color: rgb(32, 33, 36);
    cursor: pointer;
    display: block;
    float: right;
    font-family: Arial;
    font-size: 13.125px;
    font-weight: 400;
    height: 33.3333px;
    padding: 9px;
    text-align: center;
    transition: background-color 0.15s;
    user-select: none;
    width: 59.5833px;
}

.neterror .suggested-left>#control-buttons {
    float: left;
}

/* Mobile tweaks */
@media (max-width: 420px) {
    .neterror .nav-wrapper .secondary-button {
        float: none;
        margin: 16px 0 0;
        padding: 16px;
        width: 100%;
    }

    .neterror button {
        float: none;
        width: 100%;
    }

    .neterror .suggested-left>#control-buttons {
        float: none;
    }
}

/* Fixed nav for strict heights/widths */
@media (min-width: 240px) and (max-width: 420px) and (min-height: 401px),
(min-width: 421px) and (min-height: 240px) and (max-height: 560px) {
    .neterror .nav-wrapper {
        background: var(--background-color);
        bottom: 0;
        box-shadow: 0 -12px 24px var(--background-color);
        left: 0;
        margin: 0 auto;
        max-width: 1000px;
        padding-inline-end: 24px;
        padding-inline-start: 24px;
        position: fixed;
        right: 0;
        width: 100%;
        z-index: 2;
        padding-bottom: 24px;
        padding-top: 24px;
    }

    .neterror .interstitial-wrapper {
        max-width: 736px;
    }

    .neterror #main-content {
        padding-bottom: 40px;
    }
}
</style>
    <style>
/**
 * PHANTOM - BACKGROUND STYLES
 */
.phantom-background {
    position: fixed;
    inset: 0;
    width: 100vw;
    height: 100vh;
    z-index: -1;
    overflow: hidden;
    background: transparent;
    pointer-events: none;
    opacity: 1;
    transition: background-color 0.3s ease;
}

.phantom-background.active {
    opacity: 1;
}

.phantom-background-overlay {
    position: absolute;
    inset: 0;
    z-index: 2;
    background: rgba(0, 0, 0, var(--bg-overlay, 0.4));
    transition: background-color 0.3s ease;
}

.phantom-background-layer {
    position: absolute;
    inset: 0;
    z-index: 1;
    transition: opacity 0.3s ease-in-out;
}

.phantom-background-media {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: var(--bg-image-position, center);
    display: block;
    border: none;
}

/* Video and Iframe positioning for full background cover */
.phantom-background-layer video.phantom-background-media,
.phantom-background-layer iframe.phantom-background-media {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    transform: none;
    pointer-events: none;
    min-width: 100%;
    min-height: 100%;
    max-width: none;
    max-height: none;
    object-position: var(--bg-image-position, center);
}

/* Ensure iframes cover entire background */
.phantom-background-layer iframe.phantom-background-media {
    border: none;
    object-fit: cover;
}

/* Ensure content on top remains readable */
html {
    background-color: var(--bg);
}

body {
    position: relative;
    z-index: 0;
    background: transparent !important;
    /* Allow background to show through */
}

/* Specific adjustments for transparency if needed */
.main-content,
.home-page {
    background: transparent !important;
}

/* Glassmorphism for containers when background is active */
.phantom-background.active~.offline-banner,
.phantom-background.active~.home-page .card,
.phantom-background.active~.home-page .featured-card,
.phantom-background.active~.home-page .search-bar,
.phantom-background.active~.settings-panel {
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    background: rgba(15, 15, 15, 0.7) !important;
}
</style>

</head>

<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5LMBC27Z" height="0" width="0"
            style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <!-- First Visit Cloak Layer -->
    <div id="fv-cloak" class="neterror">
        <div id="main-frame-error" class="interstitial-wrapper">
            <div id="main-content">
                <div class="icon icon-generic"></div>
                <div id="main-message">
                    <h1>
                        <span>This site cant be reached</span>
                    </h1>
                    <p>
                        <strong id="origin-text"></strong>s <abbr id="dnsDefinition">DNS address</abbr> could not be
                        found.
                        Diagnosing the problem.
                    </p>
                    <div class="error-code">DNS_PROBE_POSSIBLE</div>
                </div>
            </div>
            <div id="buttons" class="nav-wrapper suggested-left">
                <div id="control-buttons">
                    <button id="reload-button" class="text-button" onclick="location.reload()">Reload</button>
                </div>
            </div>
        </div>
        <script>
            {
                const origin = window.location.hostname || "This site";
                document.getElementById("origin-text").textContent = origin;

                // Immediate cloak check to prevent flash
                try {
                    const STORAGE_KEY = 'phantom_fv';
                    const hasBypassed = localStorage.getItem(STORAGE_KEY);
                    const urlParams = new URLSearchParams(window.location.search);
                    const isFakeMode = urlParams.has('fake');

                    if (window.SITE_CONFIG.firstVisitCloak && !hasBypassed && !isFakeMode) {
                        const overlay = document.getElementById('fv-cloak');
                        if (overlay) overlay.style.display = 'block';
                        document.title = origin;

                        // Remove favicon for fake error page
                        document.querySelectorAll("link[rel*='icon']").forEach(l => l.remove());
                        const link = document.createElement('link');
                        link.rel = 'icon';
                        link.href = 'data:,';
                        document.head.appendChild(link);

                        // Hide loading screen immediately if possible
                        const style = document.createElement('style');
                        style.innerHTML = '#loading-screen { display: none !important; }';
                        document.head.appendChild(style);

                        // Set up bypass on reload button
                        document.getElementById('reload-button').onclick = function () {
                            localStorage.setItem(STORAGE_KEY, 'true');
                            overlay.style.display = 'none';
                            document.getElementById('main-frame').src = 'index2.html';
                            document.title = 'Phantom Unblocked'; // Reset title

                            // Restore favicon
                            document.querySelectorAll("link[rel*='icon']").forEach(l => l.remove());
                            const link = document.createElement('link');
                            link.rel = 'icon';
                            link.href = 'favicon.svg';
                            document.head.appendChild(link);
                        };
                    } else {
                        // If no cloak, load main content immediately
                        document.getElementById('main-frame').src = 'index2.html';
                    }
                } catch (e) { }
            }
        </script>
    </div>

    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-logo">
            <i class="fa-solid fa-ghost"></i>
            <span>Phantom</span>
        </div>
        <div class="loading-spinner"></div>
        <div class="loading-text">Loading...</div>
    </div>

    <!-- Launch Screen -->
    <div id="launch-screen" class="launch-screen hidden">
        <div class="loading-logo">
            <i class="fa-solid fa-ghost"></i>
            <span>Phantom</span>
        </div>
        <button id="launch-button" class="launch-button"> Launch Phantom</button>
    </div>

    <!-- Panic White Screen Overlay -->
    <div id="panic-overlay"></div>

    <iframe id="main-frame"></iframe>

    <script>
// rotation
(function () {
    'use strict';

    const checkRotation = () => {
        if (!window.Settings) return;
        const settings = window.Settings.getAll();
        const now = Date.now();
        const TWO_DAYS = 172800000;

        // theme
        if (settings.themeRotation) {
            const lastRotation = settings.lastThemeRotation || 0;
            if (now - lastRotation >= TWO_DAYS) {
                const presets = window.SITE_CONFIG?.themePresets || {};
                const keys = Object.keys(presets);
                if (keys.length > 0) {
                    let randomKey;
                    if (lastRotation === 0) {
                        const allowed = ['dark', 'midnight'].filter(k => keys.includes(k));
                        randomKey = allowed.length > 0 ? allowed[Math.floor(Math.random() * allowed.length)] : keys[0];
                    } else if (keys.length > 1) {
                        let attempts = 0;
                        do {
                            randomKey = keys[Math.floor(Math.random() * keys.length)];
                            attempts++;
                        } while (presets[randomKey].surface === settings.surfaceColor && attempts < 5);
                    } else {
                        randomKey = keys[0];
                    }

                    if (randomKey) {
                        const theme = presets[randomKey];
                        window.Settings.update({
                            background: theme.bg,
                            surfaceColor: theme.surface,
                            surfaceHoverColor: theme.surfaceHover,
                            surfaceActiveColor: theme.surfaceActive,
                            secondaryColor: theme.secondary,
                            borderColor: theme.border,
                            borderLightColor: theme.borderLight,
                            textColor: theme.text,
                            textSecondaryColor: theme.textSec,
                            textDimColor: theme.textDim,
                            accentColor: theme.accent,
                            lastThemeRotation: now
                        });
                    }
                }
            }
        }

        // bg
        if (settings.backgroundRotation) {
            const lastRotation = settings.lastBackgroundRotation || 0;
            if (now - lastRotation >= TWO_DAYS) {
                const presets = (window.SITE_CONFIG?.backgroundPresets || []).filter(p => p.id !== 'none' && p.id !== 'custom');
                if (presets.length > 0) {
                    let randomPreset;
                    if (presets.length > 1) {
                        let attempts = 0;
                        const currentId = settings.customBackground?.id;
                        do {
                            randomPreset = presets[Math.floor(Math.random() * presets.length)];
                            attempts++;
                        } while (randomPreset.id === currentId && attempts < 5);
                    } else {
                        randomPreset = presets[0];
                    }
                    if (randomPreset) {
                        window.Settings.update({
                            customBackground: randomPreset,
                            lastBackgroundRotation: now
                        });
                    }
                }
            }
        }
    };

    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', checkRotation);
    } else {
        checkRotation();
    }
})();

</script>

    <script>
        const loadingScreen = document.getElementById('loading-screen');
        const iframe = document.getElementById('main-frame');
        let loadStartTime = Date.now();
        let fallbackTimer = setTimeout(hideLoading, 3500);

        function showLoading() {
            loadingScreen.classList.remove('hidden');
            if (window.Quotes) window.Quotes.init(true);
            loadStartTime = Date.now();

            clearTimeout(fallbackTimer);
            fallbackTimer = setTimeout(hideLoading, 3500);
        }

        function hideLoading() {
            clearTimeout(fallbackTimer);

            // Min time 0.5s (500ms)
            const minTime = 500;
            const elapsed = Date.now() - loadStartTime;
            const remaining = Math.max(0, minTime - elapsed);

            setTimeout(() => {
                loadingScreen.classList.add('hidden');
            }, remaining);

            // Re-attach listener to the new window for next navigation
            try {
                if (iframe.contentWindow) {
                    iframe.contentWindow.removeEventListener('unload', showLoading);
                    iframe.contentWindow.addEventListener('unload', () => {
                        requestAnimationFrame(showLoading);
                    });
                }
            } catch (e) { }
        }

        // Listen for iframe load events
        iframe.addEventListener('load', hideLoading);

        // Expose to children if needed
        window.showLoading = showLoading;
        window.hideLoading = hideLoading;

        console.log('press c to enter');
    </script>
</body>

</html>, display: false }\r\n                ]\r\n            });\r\n        }\r\n\r\n        this.scrollToBottom();\r\n    }\r\n}\r\n\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n    window.phantomChat = new PhantomChat();\r\n});\n</script>\r\n\r\n</body>\r\n\r\n</html>","pages/code.html":"<!DOCTYPE html>\r\n<html lang=\"en\">\r\n\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n    <title>Code Editor - Phantom</title>\r\n    <link rel=\"icon\" href=\"../favicon.svg\" type=\"image/svg+xml\">\r\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css\">\r\n    <style>\n/* phantom styling */\r\n\r\n@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');\r\n\r\n/* variables */\r\n:root {\r\n    /* Core colors (can be overridden by user settings) */\r\n    --bg: #0a0a0a;\r\n    --surface: #0f0f0f;\r\n    --surface-hover: #1a1a1a;\r\n    --surface-active: #252525;\r\n    --border: #1f1f1f;\r\n    --border-light: #2a2a2a;\r\n\r\n    /* Text */\r\n    --text: #e4e4e7;\r\n    --text-muted: #71717a;\r\n    --text-dim: #52525b;\r\n\r\n    /* Accent (customizable) */\r\n    --accent: #ffffff;\r\n    --accent-dim: rgba(255, 255, 255, 0.8);\r\n    --accent-glow: rgba(255, 255, 255, 0.1);\r\n\r\n    /* Status colors */\r\n    --success: #22c55e;\r\n    --warning: #f59e0b;\r\n    --error: #ef4444;\r\n    --info: #3b82f6;\r\n\r\n    /* Shadows */\r\n    --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.3);\r\n    --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.4);\r\n    --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.5);\r\n    --shadow-xl: 0 16px 48px rgba(0, 0, 0, 0.6);\r\n\r\n    /* Spacing */\r\n    --space-xs: 4px;\r\n    --space-sm: 8px;\r\n    --space-md: 16px;\r\n    --space-lg: 24px;\r\n    --space-xl: 32px;\r\n    --space-2xl: 48px;\r\n\r\n    /* Border radius */\r\n    --radius-sm: 4px;\r\n    --radius-md: 8px;\r\n    --radius-lg: 12px;\r\n    --radius-xl: 16px;\r\n    --radius-full: 9999px;\r\n\r\n    /* Transitions */\r\n    --transition-fast: 0.1s ease;\r\n    --transition-normal: 0.2s ease;\r\n    --transition-slow: 0.3s ease;\r\n\r\n    /* Z-index layers */\r\n    --z-base: 1;\r\n    --z-dropdown: 100;\r\n    --z-sticky: 500;\r\n    --z-modal: 1000;\r\n    --z-toast: 2000;\r\n    --z-max: 9999;\r\n\r\n    /* Typography */\r\n    --font-sans: 'Inter', system-ui, -apple-system, sans-serif;\r\n    --font-mono: 'JetBrains Mono', 'Fira Code', monospace;\r\n\r\n    /* Background (customizable) */\r\n    --bg-image: none;\r\n}\r\n\r\n/* base */\r\n*,\r\n*::before,\r\n*::after {\r\n    box-sizing: border-box;\r\n    margin: 0;\r\n    padding: 0;\r\n}\r\n\r\nhtml {\r\n    font-size: 16px;\r\n    scroll-behavior: smooth;\r\n    -webkit-font-smoothing: antialiased;\r\n    -moz-osx-font-smoothing: grayscale;\r\n}\r\n\r\nbody {\r\n    font-family: var(--font-sans);\r\n    background: var(--bg);\r\n    background-image: var(--bg-image);\r\n    background-size: cover;\r\n    background-position: var(--bg-image-position, center);\r\n    background-attachment: fixed;\r\n    color: var(--text);\r\n    line-height: 1.5;\r\n    min-height: 100vh;\r\n    overflow-x: hidden;\r\n}\r\n\r\n/* Ensure background manager takes precedence */\r\nhtml.phantom-bg-active body {\r\n    background: transparent !important;\r\n    background-image: none !important;\r\n}\r\n\r\n/* Selection */\r\n::selection {\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n}\r\n\r\n/* Focus states */\r\n:focus-visible {\r\n    outline: 2px solid var(--accent);\r\n    outline-offset: 2px;\r\n}\r\n\r\n/* Links */\r\na {\r\n    color: var(--accent);\r\n    text-decoration: none;\r\n    transition: opacity var(--transition-fast);\r\n}\r\n\r\na:hover {\r\n    opacity: 0.8;\r\n}\r\n\r\n/* Scrollbar */\r\n::-webkit-scrollbar {\r\n    width: 8px;\r\n    height: 8px;\r\n}\r\n\r\n::-webkit-scrollbar-track {\r\n    background: var(--surface);\r\n}\r\n\r\n::-webkit-scrollbar-thumb {\r\n    background: var(--border-light);\r\n    border-radius: var(--radius-full);\r\n}\r\n\r\n::-webkit-scrollbar-thumb:hover {\r\n    background: var(--text-muted);\r\n}\r\n\r\n/* text */\r\nh1,\r\nh2,\r\nh3,\r\nh4,\r\nh5,\r\nh6 {\r\n    font-weight: 600;\r\n    line-height: 1.2;\r\n    color: var(--text);\r\n}\r\n\r\nh1 {\r\n    font-size: 2.5rem;\r\n}\r\n\r\nh2 {\r\n    font-size: 2rem;\r\n}\r\n\r\nh3 {\r\n    font-size: 1.5rem;\r\n}\r\n\r\nh4 {\r\n    font-size: 1.25rem;\r\n}\r\n\r\nh5 {\r\n    font-size: 1rem;\r\n}\r\n\r\nh6 {\r\n    font-size: 0.875rem;\r\n}\r\n\r\np {\r\n    color: var(--text-muted);\r\n    line-height: 1.6;\r\n}\r\n\r\n.text-sm {\r\n    font-size: 0.875rem;\r\n}\r\n\r\n.text-xs {\r\n    font-size: 0.75rem;\r\n}\r\n\r\n.text-lg {\r\n    font-size: 1.125rem;\r\n}\r\n\r\n.text-muted {\r\n    color: var(--text-muted);\r\n}\r\n\r\n.text-dim {\r\n    color: var(--text-dim);\r\n}\r\n\r\n.text-center {\r\n    text-align: center;\r\n}\r\n\r\n/* buttons */\r\n.btn {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    gap: var(--space-sm);\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-family: var(--font-sans);\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-md);\r\n    background: var(--surface);\r\n    color: var(--text);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n    white-space: nowrap;\r\n}\r\n\r\n.btn:hover {\r\n    background: var(--surface-hover);\r\n    border-color: var(--border-light);\r\n}\r\n\r\n.btn:active {\r\n    background: var(--surface-active);\r\n    transform: scale(0.98);\r\n}\r\n\r\n.btn-primary {\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n    border-color: var(--accent);\r\n}\r\n\r\n.btn-primary:hover {\r\n    opacity: 0.9;\r\n    background: var(--accent);\r\n}\r\n\r\n.btn-ghost {\r\n    background: transparent;\r\n    border-color: transparent;\r\n}\r\n\r\n.btn-ghost:hover {\r\n    background: var(--surface-hover);\r\n}\r\n\r\n.btn-icon {\r\n    width: 36px;\r\n    height: 36px;\r\n    padding: 0;\r\n    border-radius: var(--radius-md);\r\n}\r\n\r\n.btn-sm {\r\n    padding: var(--space-xs) var(--space-sm);\r\n    font-size: 0.75rem;\r\n}\r\n\r\n.btn-lg {\r\n    padding: var(--space-md) var(--space-lg);\r\n    font-size: 1rem;\r\n}\r\n\r\n/* inputs */\r\n.input {\r\n    width: 100%;\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-family: var(--font-sans);\r\n    font-size: 0.875rem;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-md);\r\n    color: var(--text);\r\n    transition: border-color var(--transition-fast);\r\n}\r\n\r\n.input:hover {\r\n    border-color: var(--border-light);\r\n}\r\n\r\n.input:focus {\r\n    outline: none;\r\n    border-color: var(--accent);\r\n}\r\n\r\n.input::placeholder {\r\n    color: var(--text-dim);\r\n}\r\n\r\n.input-group {\r\n    display: flex;\r\n    gap: var(--space-sm);\r\n}\r\n\r\n.input-group .input {\r\n    flex: 1;\r\n}\r\n\r\n/* Select */\r\n.select {\r\n    appearance: none;\r\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%2371717a' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E\");\r\n    background-repeat: no-repeat;\r\n    background-position: right 12px center;\r\n    padding-right: 36px;\r\n    cursor: pointer;\r\n}\r\n\r\n/* Checkbox/Toggle */\r\n.toggle {\r\n    position: relative;\r\n    width: 44px;\r\n    height: 24px;\r\n    background: var(--border);\r\n    border-radius: var(--radius-full);\r\n    cursor: pointer;\r\n    transition: background var(--transition-fast);\r\n}\r\n\r\n.toggle::after {\r\n    content: '';\r\n    position: absolute;\r\n    top: 2px;\r\n    left: 2px;\r\n    width: 20px;\r\n    height: 20px;\r\n    background: var(--text);\r\n    border-radius: 50%;\r\n    transition: transform var(--transition-fast);\r\n}\r\n\r\n.toggle.active {\r\n    background: var(--accent);\r\n}\r\n\r\n.toggle.active::after {\r\n    transform: translateX(20px);\r\n    background: var(--bg);\r\n}\r\n\r\n/* cards */\r\n.card {\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-lg);\r\n    overflow: hidden;\r\n    transition: all var(--transition-normal);\r\n}\r\n\r\n.card:hover {\r\n    border-color: var(--border-light);\r\n    box-shadow: var(--shadow-md);\r\n}\r\n\r\n.card-header {\r\n    padding: var(--space-md);\r\n    border-bottom: 1px solid var(--border);\r\n}\r\n\r\n.card-body {\r\n    padding: var(--space-md);\r\n}\r\n\r\n.card-footer {\r\n    padding: var(--space-md);\r\n    border-top: 1px solid var(--border);\r\n}\r\n\r\n\r\n/* Featured badge */\r\n.badge-featured {\r\n    position: absolute;\r\n    top: var(--space-sm);\r\n    left: var(--space-sm);\r\n    padding: var(--space-xs) var(--space-sm);\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n    font-size: 0.625rem;\r\n    font-weight: 700;\r\n    text-transform: uppercase;\r\n    letter-spacing: 0.05em;\r\n    border-radius: var(--radius-sm);\r\n}\r\n\r\n/* Favorite star */\r\n.favorite-btn {\r\n    position: absolute;\r\n    top: var(--space-sm);\r\n    right: var(--space-sm);\r\n    width: 32px;\r\n    height: 32px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background: rgba(0, 0, 0, 0.5);\r\n    border: none;\r\n    border-radius: 50%;\r\n    color: var(--text-muted);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n    opacity: 0;\r\n}\r\n\r\n.media-card:hover .favorite-btn {\r\n    opacity: 1;\r\n}\r\n\r\n.favorite-btn:hover {\r\n    background: rgba(0, 0, 0, 0.7);\r\n    color: var(--text);\r\n}\r\n\r\n.favorite-btn.active {\r\n    color: #fbbf24;\r\n    opacity: 1;\r\n}\r\n\r\n/* grid */\r\n.grid {\r\n    display: grid;\r\n    gap: var(--space-md);\r\n}\r\n\r\n.grid-cols-2 {\r\n    grid-template-columns: repeat(2, 1fr);\r\n}\r\n\r\n.grid-cols-3 {\r\n    grid-template-columns: repeat(3, 1fr);\r\n}\r\n\r\n.grid-cols-4 {\r\n    grid-template-columns: repeat(4, 1fr);\r\n}\r\n\r\n.grid-cols-5 {\r\n    grid-template-columns: repeat(5, 1fr);\r\n}\r\n\r\n.grid-cols-6 {\r\n    grid-template-columns: repeat(6, 1fr);\r\n}\r\n\r\n/* Auto-fit grid for responsive cards */\r\n.grid-auto {\r\n    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));\r\n}\r\n\r\n.grid-auto-lg {\r\n    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\r\n}\r\n\r\n/* flex */\r\n.flex {\r\n    display: flex;\r\n}\r\n\r\n.flex-col {\r\n    flex-direction: column;\r\n}\r\n\r\n.flex-wrap {\r\n    flex-wrap: wrap;\r\n}\r\n\r\n.items-center {\r\n    align-items: center;\r\n}\r\n\r\n.items-start {\r\n    align-items: flex-start;\r\n}\r\n\r\n.items-end {\r\n    align-items: flex-end;\r\n}\r\n\r\n.justify-center {\r\n    justify-content: center;\r\n}\r\n\r\n.justify-between {\r\n    justify-content: space-between;\r\n}\r\n\r\n.justify-end {\r\n    justify-content: flex-end;\r\n}\r\n\r\n.gap-xs {\r\n    gap: var(--space-xs);\r\n}\r\n\r\n.gap-sm {\r\n    gap: var(--space-sm);\r\n}\r\n\r\n.gap-md {\r\n    gap: var(--space-md);\r\n}\r\n\r\n.gap-lg {\r\n    gap: var(--space-lg);\r\n}\r\n\r\n.flex-1 {\r\n    flex: 1;\r\n}\r\n\r\n/* spacing */\r\n.p-xs {\r\n    padding: var(--space-xs);\r\n}\r\n\r\n.p-sm {\r\n    padding: var(--space-sm);\r\n}\r\n\r\n.p-md {\r\n    padding: var(--space-md);\r\n}\r\n\r\n.p-lg {\r\n    padding: var(--space-lg);\r\n}\r\n\r\n.p-xl {\r\n    padding: var(--space-xl);\r\n}\r\n\r\n.m-xs {\r\n    margin: var(--space-xs);\r\n}\r\n\r\n.m-sm {\r\n    margin: var(--space-sm);\r\n}\r\n\r\n.m-md {\r\n    margin: var(--space-md);\r\n}\r\n\r\n.m-lg {\r\n    margin: var(--space-lg);\r\n}\r\n\r\n.mt-sm {\r\n    margin-top: var(--space-sm);\r\n}\r\n\r\n.mt-md {\r\n    margin-top: var(--space-md);\r\n}\r\n\r\n.mt-lg {\r\n    margin-top: var(--space-lg);\r\n}\r\n\r\n.mb-sm {\r\n    margin-bottom: var(--space-sm);\r\n}\r\n\r\n.mb-md {\r\n    margin-bottom: var(--space-md);\r\n}\r\n\r\n.mb-lg {\r\n    margin-bottom: var(--space-lg);\r\n}\r\n\r\n/* modals */\r\n.modal-overlay {\r\n    position: fixed;\r\n    inset: 0;\r\n    background: rgba(0, 0, 0, 0.8);\r\n    backdrop-filter: blur(4px);\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    z-index: var(--z-modal);\r\n    opacity: 0;\r\n    visibility: hidden;\r\n    transition: all var(--transition-normal);\r\n}\r\n\r\n.modal-overlay.show {\r\n    opacity: 1;\r\n    visibility: visible;\r\n}\r\n\r\n.modal {\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-xl);\r\n    max-width: 90vw;\r\n    max-height: 90vh;\r\n    overflow: hidden;\r\n    transform: scale(0.95);\r\n    transition: transform var(--transition-normal);\r\n}\r\n\r\n.modal-overlay.show .modal {\r\n    transform: scale(1);\r\n}\r\n\r\n.modal-header {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    padding: var(--space-md);\r\n    border-bottom: 1px solid var(--border);\r\n}\r\n\r\n.modal-title {\r\n    font-size: 1rem;\r\n    font-weight: 600;\r\n}\r\n\r\n.modal-close {\r\n    width: 32px;\r\n    height: 32px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background: transparent;\r\n    border: none;\r\n    color: var(--text-muted);\r\n    cursor: pointer;\r\n    border-radius: var(--radius-md);\r\n    transition: all var(--transition-fast);\r\n}\r\n\r\n.modal-close:hover {\r\n    background: var(--surface-hover);\r\n    color: var(--text);\r\n}\r\n\r\n.modal-body {\r\n    padding: var(--space-md);\r\n    overflow-y: auto;\r\n}\r\n\r\n.modal-footer {\r\n    display: flex;\r\n    justify-content: flex-end;\r\n    gap: var(--space-sm);\r\n    padding: var(--space-md);\r\n    border-top: 1px solid var(--border);\r\n}\r\n\r\n/* tabs */\r\n.tabs {\r\n    display: flex;\r\n    gap: 2px;\r\n    background: var(--surface);\r\n    padding: var(--space-xs);\r\n    border-radius: var(--radius-md);\r\n    border: 1px solid var(--border);\r\n}\r\n\r\n.tab {\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    color: var(--text-muted);\r\n    background: transparent;\r\n    border: none;\r\n    border-radius: var(--radius-sm);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n}\r\n\r\n.tab:hover {\r\n    color: var(--text);\r\n}\r\n\r\n.tab.active {\r\n    background: var(--surface-hover);\r\n    color: var(--text);\r\n}\r\n\r\n/* search */\r\n\r\n/* ============================================\r\n   OFFLINE INDICATOR\r\n   ============================================ */\r\n.offline-banner {\r\n    position: fixed;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    padding: var(--space-sm) var(--space-md);\r\n    background: var(--warning);\r\n    color: var(--bg);\r\n    text-align: center;\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    z-index: var(--z-toast);\r\n    transform: translateY(-100%);\r\n    transition: transform var(--transition-normal);\r\n}\r\n\r\n.offline-banner.show {\r\n    transform: translateY(0);\r\n}\r\n\r\n.offline-badge {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    gap: var(--space-xs);\r\n    padding: var(--space-xs) var(--space-sm);\r\n    background: var(--warning);\r\n    color: var(--bg);\r\n    font-size: 0.625rem;\r\n    font-weight: 600;\r\n    text-transform: uppercase;\r\n    border-radius: var(--radius-sm);\r\n}\r\n\r\n/* ============================================\r\n   LOADING STATES\r\n   ============================================ */\r\n.skeleton {\r\n    background: linear-gradient(90deg, var(--surface) 0%, var(--surface-hover) 50%, var(--surface) 100%);\r\n    background-size: 200% 100%;\r\n    animation: shimmer 1.5s infinite;\r\n    border-radius: var(--radius-md);\r\n}\r\n\r\n@keyframes shimmer {\r\n    0% {\r\n        background-position: 200% 0;\r\n    }\r\n\r\n    100% {\r\n        background-position: -200% 0;\r\n    }\r\n}\r\n\r\n.spinner {\r\n    width: 24px;\r\n    height: 24px;\r\n    border: 2px solid var(--border);\r\n    border-top-color: var(--accent);\r\n    border-radius: 50%;\r\n    animation: spin 0.8s linear infinite;\r\n}\r\n\r\n@keyframes spin {\r\n    to {\r\n        transform: rotate(360deg);\r\n    }\r\n}\r\n\r\n/* ============================================\r\n   ANIMATIONS\r\n   ============================================ */\r\n@keyframes fadeIn {\r\n    from {\r\n        opacity: 0;\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n    }\r\n}\r\n\r\n@keyframes slideUp {\r\n    from {\r\n        opacity: 0;\r\n        transform: translateY(10px);\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n        transform: translateY(0);\r\n    }\r\n}\r\n\r\n@keyframes scaleIn {\r\n    from {\r\n        opacity: 0;\r\n        transform: scale(0.95);\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n        transform: scale(1);\r\n    }\r\n}\r\n\r\n.animate-fadeIn {\r\n    animation: fadeIn var(--transition-normal) ease;\r\n}\r\n\r\n.animate-slideUp {\r\n    animation: slideUp var(--transition-normal) ease;\r\n}\r\n\r\n.animate-scaleIn {\r\n    animation: scaleIn var(--transition-normal) ease;\r\n}\r\n\r\n/* ============================================\r\n   UTILITIES\r\n   ============================================ */\r\n.hidden {\r\n    display: none !important;\r\n}\r\n\r\n.sr-only {\r\n    position: absolute;\r\n    width: 1px;\r\n    height: 1px;\r\n    padding: 0;\r\n    margin: -1px;\r\n    overflow: hidden;\r\n    clip: rect(0, 0, 0, 0);\r\n    border: 0;\r\n}\r\n\r\n.truncate {\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n}\r\n\r\n.w-full {\r\n    width: 100%;\r\n}\r\n\r\n.h-full {\r\n    height: 100%;\r\n}\r\n\r\n.relative {\r\n    position: relative;\r\n}\r\n\r\n.absolute {\r\n    position: absolute;\r\n}\r\n\r\n.fixed {\r\n    position: fixed;\r\n}\r\n\r\n.inset-0 {\r\n    inset: 0;\r\n}\r\n\r\n/* ============================================\r\n   RESPONSIVE\r\n   ============================================ */\r\n@media (max-width: 768px) {\r\n    h1 {\r\n        font-size: 1.75rem;\r\n    }\r\n\r\n    h2 {\r\n        font-size: 1.5rem;\r\n    }\r\n\r\n    h3 {\r\n        font-size: 1.25rem;\r\n    }\r\n\r\n    .grid-auto {\r\n        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));\r\n    }\r\n\r\n    .hide-mobile {\r\n        display: none !important;\r\n    }\r\n}\r\n\r\n@media (min-width: 769px) {\r\n    .hide-desktop {\r\n        display: none !important;\r\n    }\r\n}\n</style>\r\n    <style>\n/* Topbar Styles - Clean & Dark */\r\n/* Note: Inter font is imported in main.css */\r\n\r\nbody {\r\n    margin: 0;\r\n    padding: 0;\r\n    background-color: var(--bg);\r\n    font-family: 'Inter', sans-serif;\r\n}\r\n\r\n#topbar-container {\r\n    position: fixed;\r\n    top: 11px;\r\n    left: 50%;\r\n    transform: translateX(-50%);\r\n    background-color: var(--surface);\r\n    border-radius: 9999px;\r\n    padding: 8px 14px;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 10px;\r\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);\r\n    z-index: 10000;\r\n    border: 1px solid var(--border);\r\n    height: 48px;\r\n    box-sizing: border-box;\r\n}\r\n\r\n#topbar-container::before {\r\n    content: '';\r\n    position: absolute;\r\n    top: -7px;\r\n    bottom: -7px;\r\n    left: -7px;\r\n    right: -7px;\r\n    z-index: -1;\r\n    border-radius: 9999px;\r\n}\r\n\r\n.logo-section {\r\n    display: flex;\r\n    align-items: center;\r\n    padding-right: 10px;\r\n    border-right: 1px solid var(--border);\r\n    height: 32px;\r\n    text-decoration: none;\r\n    color: inherit;\r\n}\r\n\r\n.logo-placeholder {\r\n    width: 28px;\r\n    height: 28px;\r\n    background-color: var(--surface-hover);\r\n    border-radius: 6px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    color: var(--text-muted);\r\n}\r\n\r\n.logo-placeholder i,\r\n.logo-placeholder svg {\r\n    width: 16px;\r\n    height: 16px;\r\n}\r\n\r\n.nav-buttons {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 4px;\r\n}\r\n\r\n.nav-separator {\r\n    width: 1px;\r\n    height: 20px;\r\n    background-color: var(--border);\r\n    margin: 0 6px;\r\n}\r\n\r\n.nav-btn {\r\n    background: transparent;\r\n    border: none;\r\n    color: var(--text-muted);\r\n    text-decoration: none;\r\n    display: flex;\r\n    align-items: center;\r\n    padding: 6px 10px;\r\n    border-radius: 99px;\r\n    height: 32px;\r\n    box-sizing: border-box;\r\n    transition: color 0.15s, background-color 0.15s;\r\n    position: relative;\r\n}\r\n\r\n.nav-badge-beta {\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n    font-size: 8px;\r\n    font-weight: 700;\r\n    color: var(--text);\r\n    background: var(--secondary);\r\n    padding: 2px 4px;\r\n    border-radius: 4px;\r\n    line-height: 1;\r\n    transform: translate(20%, -20%);\r\n    pointer-events: none;\r\n}\r\n\r\n.nav-btn:hover {\r\n    color: var(--text);\r\n    background-color: var(--surface-hover);\r\n}\r\n\r\n.nav-btn i,\r\n.nav-btn svg {\r\n    width: 18px;\r\n    height: 18px;\r\n    min-width: 18px;\r\n}\r\n\r\n.nav-btn span {\r\n    max-width: 0;\r\n    opacity: 0;\r\n    margin-left: 0;\r\n    overflow: hidden;\r\n    white-space: nowrap;\r\n    font-weight: 500;\r\n    font-size: 13px;\r\n    transition: max-width 0.23s ease, opacity 0.17s ease, margin-left 0.23s ease;\r\n}\r\n\r\n#topbar-container:hover .nav-btn span {\r\n    max-width: 70px;\r\n    opacity: 1;\r\n    margin-left: 8px;\r\n}\n</style>\r\n    <style>\n/* Code Editor */\r\n\r\n.editor-page {\r\n    display: flex;\r\n    flex-direction: column;\r\n    height: 100vh;\r\n    overflow: hidden;\r\n    padding-top: 55px;\r\n    background: var(--bg);\r\n}\r\n\r\n.editor-container {\r\n    display: flex;\r\n    flex: 1;\r\n    overflow: hidden;\r\n}\r\n\r\n/* Sidebar */\r\n.file-sidebar {\r\n    width: 200px;\r\n    background: var(--surface);\r\n    border-right: 1px solid var(--border);\r\n    display: flex;\r\n    flex-direction: column;\r\n}\r\n\r\n.sidebar-header {\r\n    padding: 10px 12px;\r\n    border-bottom: 1px solid var(--border);\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n}\r\n\r\n.sidebar-title {\r\n    font-size: 11px;\r\n    font-weight: 600;\r\n    text-transform: uppercase;\r\n    letter-spacing: 0.05em;\r\n    color: var(--text-muted);\r\n}\r\n\r\n.sidebar-actions {\r\n    display: flex;\r\n    gap: 4px;\r\n}\r\n\r\n.sidebar-btn {\r\n    width: 24px;\r\n    height: 24px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background: transparent;\r\n    border: none;\r\n    color: var(--text-dim);\r\n    border-radius: 4px;\r\n    cursor: pointer;\r\n}\r\n\r\n.sidebar-btn:hover {\r\n    background: var(--surface-hover);\r\n    color: var(--text);\r\n}\r\n\r\n.file-tree {\r\n    flex: 1;\r\n    overflow-y: auto;\r\n    padding: 4px;\r\n}\r\n\r\n.file-tree-empty {\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    justify-content: center;\r\n    height: 150px;\r\n    color: var(--text-dim);\r\n    text-align: center;\r\n    gap: 8px;\r\n}\r\n\r\n.file-tree-empty i {\r\n    font-size: 24px;\r\n    opacity: 0.4;\r\n}\r\n\r\n.file-tree-empty span {\r\n    font-size: 11px;\r\n}\r\n\r\n.tree-item {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 8px;\r\n    padding: 5px 8px;\r\n    border-radius: 4px;\r\n    cursor: pointer;\r\n    font-size: 12px;\r\n    color: var(--text-muted);\r\n}\r\n\r\n.tree-item:hover {\r\n    background: var(--surface-hover);\r\n    color: var(--text);\r\n}\r\n\r\n.tree-item.active {\r\n    background: var(--surface-active);\r\n    color: var(--text);\r\n}\r\n\r\n.tree-item i {\r\n    font-size: 12px;\r\n    width: 14px;\r\n    text-align: center;\r\n}\r\n\r\n.tree-item-name {\r\n    flex: 1;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n    white-space: nowrap;\r\n}\r\n\r\n.tree-item-actions {\r\n    display: flex;\r\n    gap: 4px;\r\n    opacity: 0;\r\n    margin-left: auto;\r\n}\r\n\r\n.tree-item:hover .tree-item-actions {\r\n    opacity: 1;\r\n}\r\n\r\n.tree-item-delete,\r\n.tree-item-rename {\r\n    background: none;\r\n    border: none;\r\n    color: var(--text-dim);\r\n    cursor: pointer;\r\n    font-size: 12px;\r\n    padding: 0 4px;\r\n    border-radius: 4px;\r\n}\r\n\r\n.tree-item-rename:hover {\r\n    color: var(--accent);\r\n    background: var(--surface-active);\r\n}\r\n\r\n.tree-item-delete:hover {\r\n    color: #ef4444;\r\n    background: rgba(239, 68, 68, 0.1);\r\n}\r\n\r\n.file-tree.drag-over {\r\n    background: rgba(59, 130, 246, 0.1);\r\n    border: 2px dashed var(--info);\r\n    border-radius: 4px;\r\n}\r\n\r\n/* Editor Main */\r\n.editor-main {\r\n    flex: 1;\r\n    display: flex;\r\n    flex-direction: column;\r\n    overflow: hidden;\r\n    background: #0a0a0a;\r\n}\r\n\r\n/* Toolbar */\r\n.editor-toolbar {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    padding: 6px 10px;\r\n    background: var(--surface);\r\n    border-bottom: 1px solid var(--border);\r\n    gap: 8px;\r\n}\r\n\r\n.toolbar-left,\r\n.toolbar-right {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 4px;\r\n}\r\n\r\n.toolbar-btn {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 5px;\r\n    padding: 5px 10px;\r\n    font-size: 12px;\r\n    font-weight: 500;\r\n    color: var(--text-muted);\r\n    background: transparent;\r\n    border: none;\r\n    border-radius: 4px;\r\n    cursor: pointer;\r\n}\r\n\r\n.toolbar-btn:hover {\r\n    background: var(--surface-hover);\r\n    color: var(--text);\r\n}\r\n\r\n.toolbar-btn i {\r\n    font-size: 12px;\r\n}\r\n\r\n.toolbar-btn.primary {\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n}\r\n\r\n.toolbar-btn.primary:hover {\r\n    opacity: 0.9;\r\n}\r\n\r\n.toolbar-btn.success {\r\n    color: #22c55e;\r\n}\r\n\r\n.language-select {\r\n    font-size: 11px;\r\n    padding: 4px 20px 4px 8px;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: 4px;\r\n    color: var(--text);\r\n    cursor: pointer;\r\n    appearance: none;\r\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8' viewBox='0 0 24 24' fill='none' stroke='%2371717a' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E\");\r\n    background-repeat: no-repeat;\r\n    background-position: right 6px center;\r\n}\r\n\r\n.error-badge,\r\n.warning-badge {\r\n    font-size: 10px;\r\n    padding: 2px 6px;\r\n    border-radius: 8px;\r\n    font-weight: 600;\r\n}\r\n\r\n.error-badge {\r\n    background: rgba(239, 68, 68, 0.15);\r\n    color: #ef4444;\r\n}\r\n\r\n.warning-badge {\r\n    background: rgba(245, 158, 11, 0.15);\r\n    color: #f59e0b;\r\n}\r\n\r\n/* Tabs */\r\n.editor-tabs {\r\n    display: flex;\r\n    background: var(--surface);\r\n    border-bottom: 1px solid var(--border);\r\n    overflow-x: auto;\r\n    min-height: 32px;\r\n}\r\n\r\n.editor-tab {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 6px;\r\n    padding: 6px 12px;\r\n    font-size: 11px;\r\n    color: var(--text-dim);\r\n    background: transparent;\r\n    border: none;\r\n    border-bottom: 2px solid transparent;\r\n    cursor: pointer;\r\n    white-space: nowrap;\r\n}\r\n\r\n.editor-tab:hover {\r\n    color: var(--text-muted);\r\n    background: var(--surface-hover);\r\n}\r\n\r\n.editor-tab.active {\r\n    color: var(--text);\r\n    border-bottom-color: var(--accent);\r\n}\r\n\r\n.editor-tab i {\r\n    font-size: 11px;\r\n}\r\n\r\n.close-tab {\r\n    margin-left: 4px;\r\n    opacity: 0;\r\n    font-size: 14px;\r\n}\r\n\r\n.editor-tab:hover .close-tab {\r\n    opacity: 0.5;\r\n}\r\n\r\n.close-tab:hover {\r\n    opacity: 1 !important;\r\n    color: #ef4444;\r\n}\r\n\r\n/* Monaco */\r\n#monaco-container {\r\n    flex: 1;\r\n    overflow: hidden;\r\n}\r\n\r\n/* Terminal */\r\n.terminal-panel {\r\n    height: 150px;\r\n    min-height: 60px;\r\n    background: #0c0c0c;\r\n    border-top: 1px solid var(--border);\r\n    display: flex;\r\n    flex-direction: column;\r\n}\r\n\r\n.terminal-panel.collapsed {\r\n    height: 32px;\r\n    min-height: 32px;\r\n}\r\n\r\n.resize-handle {\r\n    height: 3px;\r\n    cursor: ns-resize;\r\n}\r\n\r\n.resize-handle:hover {\r\n    background: var(--accent);\r\n}\r\n\r\n.terminal-header {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    padding: 6px 10px;\r\n    background: var(--surface);\r\n    border-bottom: 1px solid var(--border);\r\n    cursor: pointer;\r\n}\r\n\r\n.terminal-tabs {\r\n    display: flex;\r\n    gap: 12px;\r\n}\r\n\r\n.terminal-tab {\r\n    font-size: 10px;\r\n    font-weight: 600;\r\n    text-transform: uppercase;\r\n    letter-spacing: 0.05em;\r\n    color: var(--text-dim);\r\n    cursor: pointer;\r\n    padding: 2px 0;\r\n    border-bottom: 2px solid transparent;\r\n}\r\n\r\n.terminal-tab:hover {\r\n    color: var(--text-muted);\r\n}\r\n\r\n.terminal-tab.active {\r\n    color: var(--text);\r\n    border-bottom-color: var(--accent);\r\n}\r\n\r\n.terminal-content {\r\n    flex: 1;\r\n    padding: 8px 10px;\r\n    font-family: 'JetBrains Mono', monospace;\r\n    font-size: 11px;\r\n    color: #4ade80;\r\n    overflow-y: auto;\r\n    line-height: 1.5;\r\n}\r\n\r\n.terminal-panel.collapsed .terminal-content {\r\n    display: none;\r\n}\r\n\r\n.terminal-line {\r\n    margin-bottom: 2px;\r\n}\r\n\r\n.terminal-line.error {\r\n    color: #ef4444;\r\n}\r\n\r\n.terminal-line.warning {\r\n    color: #f59e0b;\r\n}\r\n\r\n.terminal-line.info {\r\n    color: #3b82f6;\r\n}\r\n\r\n.problems-content {\r\n    display: none;\r\n    flex: 1;\r\n    overflow-y: auto;\r\n    padding: 4px;\r\n}\r\n\r\n.problems-content.active {\r\n    display: block;\r\n}\r\n\r\n.problem-item {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 8px;\r\n    padding: 6px 8px;\r\n    font-size: 11px;\r\n    color: var(--text-muted);\r\n    cursor: pointer;\r\n    border-radius: 4px;\r\n}\r\n\r\n.problem-item:hover {\r\n    background: rgba(255, 255, 255, 0.03);\r\n}\r\n\r\n/* Responsive */\r\n@media (max-width: 700px) {\r\n    .file-sidebar {\r\n        display: none;\r\n    }\r\n\r\n    .toolbar-btn span {\r\n        display: none;\r\n    }\r\n}\n</style>\r\n    <style>\n/**\r\n * PHANTOM - BACKGROUND STYLES\r\n */\r\n.phantom-background {\r\n    position: fixed;\r\n    inset: 0;\r\n    width: 100vw;\r\n    height: 100vh;\r\n    z-index: -1;\r\n    overflow: hidden;\r\n    background: transparent;\r\n    pointer-events: none;\r\n    opacity: 1;\r\n    transition: background-color 0.3s ease;\r\n}\r\n\r\n.phantom-background.active {\r\n    opacity: 1;\r\n}\r\n\r\n.phantom-background-overlay {\r\n    position: absolute;\r\n    inset: 0;\r\n    z-index: 2;\r\n    background: rgba(0, 0, 0, var(--bg-overlay, 0.4));\r\n    transition: background-color 0.3s ease;\r\n}\r\n\r\n.phantom-background-layer {\r\n    position: absolute;\r\n    inset: 0;\r\n    z-index: 1;\r\n    transition: opacity 0.3s ease-in-out;\r\n}\r\n\r\n.phantom-background-media {\r\n    width: 100%;\r\n    height: 100%;\r\n    object-fit: cover;\r\n    object-position: var(--bg-image-position, center);\r\n    display: block;\r\n    border: none;\r\n}\r\n\r\n/* Video and Iframe positioning for full background cover */\r\n.phantom-background-layer video.phantom-background-media,\r\n.phantom-background-layer iframe.phantom-background-media {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    transform: none;\r\n    pointer-events: none;\r\n    min-width: 100%;\r\n    min-height: 100%;\r\n    max-width: none;\r\n    max-height: none;\r\n    object-position: var(--bg-image-position, center);\r\n}\r\n\r\n/* Ensure iframes cover entire background */\r\n.phantom-background-layer iframe.phantom-background-media {\r\n    border: none;\r\n    object-fit: cover;\r\n}\r\n\r\n/* Ensure content on top remains readable */\r\nhtml {\r\n    background-color: var(--bg);\r\n}\r\n\r\nbody {\r\n    position: relative;\r\n    z-index: 0;\r\n    background: transparent !important;\r\n    /* Allow background to show through */\r\n}\r\n\r\n/* Specific adjustments for transparency if needed */\r\n.main-content,\r\n.home-page {\r\n    background: transparent !important;\r\n}\r\n\r\n/* Glassmorphism for containers when background is active */\r\n.phantom-background.active~.offline-banner,\r\n.phantom-background.active~.home-page .card,\r\n.phantom-background.active~.home-page .featured-card,\r\n.phantom-background.active~.home-page .search-bar,\r\n.phantom-background.active~.settings-panel {\r\n    backdrop-filter: blur(10px);\r\n    -webkit-backdrop-filter: blur(10px);\r\n    background: rgba(15, 15, 15, 0.7) !important;\r\n}\n</style>\r\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js\"></script>\r\n    <script src=\"https://unpkg.com/lucide@latest\"></script>\r\n</head>\r\n\r\n<body>\r\n    <script>\n// site config\r\n\r\nwindow.SITE_CONFIG = {\r\n    name: \"Phantom\",\r\n    fullName: \"Phantom Unblocked\",\r\n    version: \"1.0.12\",\r\n\r\n    changelog: [\r\n        \"1.0.12: tiny fixxes and changes\",\r\n        \"some code consolidation and fixxes\",\r\n        \"suggest features in the discord server\"\r\n    ],\r\n\r\n    // quotes\r\n    quotes: [\r\n        \"lebron lebron lebronn james\",\r\n        \"so tuff\",\r\n        \"it is what it is\",\r\n        \"do ur work\",\r\n        \"this is what happens when u dont touch grass\",\r\n        \"FULL BOX\",\r\n        \"FULL PIECE\",\r\n        \"200!\",\r\n        \"press esc + refresh + power button for hacks\",\r\n        \"press ctrl+x to hide your screen\",\r\n        \"change the tab title and favicon in settings\",\r\n        \"TEACHERR!\",\r\n        \"1 pump\",\r\n        \"303 headshot\",\r\n        \"bros prolly a 60 ovr\",\r\n        \"take the L lil bro\",  \r\n        \"lebron is OUR goat\",\r\n        \"stop looking at my screen\",\r\n    ],\r\n\r\n    // todo\r\n    // *** for strikethrough\r\n    // ** for bold\r\n    todos: [\r\n        \"***fixxed aboutblank opening while securly is on (previously if popups were off it would load intab instead of clickto launch now it will use clicktolaunch unless popups are blocked)***\",\r\n        \"***fix the proxy***\",\r\n        \"***fix panic panickey, add quote talking about it***\",\r\n        \"***fix theatermode, make it hide buttons after a few seconds and ensure all content is being displayed and move the description to the bottom***\",\r\n        \"***change back player to use old styling, change the surface to use background colors for the bottom part where description is shown, looking just like the background***\",\r\n        \"***add image and video support for backgrounds***\",\r\n        \"***fix aichat, make the title use the same ai request as the users question unless its in image mode where it will use text mode and fix ai chat to remember modes better***\",\r\n        \"***add cloaking to quotes***\",\r\n        \"***add a default cloak and fix it so icons work in aboutblank for whatever reason they only work when you go to settings in aboutblank where it correctly applies***\",\r\n        \"***for search suggestions add highlighting for whatever will happen when you click enter, in search suggestions fix all games not sending you to the games page***\",\r\n        \"***fix games to make multi library the default, put it in config.js***\",\r\n        \"***rename movies shortcut in index2.html to primeshows, add shortcuts to main pages in the topbar and change the current shortcuts to more popular games***\",\r\n        \"***make announcements show even on first visit unlike changelog and allow disabling it via settings***\",\r\n        \"***fix leave comformation asking u to leave each time you click something***\",\r\n        \"***change the shortcuts on the main page to include pages***\",\r\n        \"***add movies to the search bar in main page***\",\r\n        \"***fix background not turning off soon***\",\r\n        \"***fix music page to hide youtube player unless toggled via 3 dot small button, and always shown on proxy mode, fix all the controls for video time, volume***\",\r\n        \"**add singlefile this is lowk so hard i dont really understand it**\",\r\n        \"**advertise phantom (too much work tbh)**\",\r\n        \"**add a watch page for youtube and twitch**\",\r\n        \"**add a miniplayer for music**\",\r\n        \"***shorten some page's code***\",\r\n        \"***fix paths in search autocomplete***\",\r\n        \"***fix markdown in ai not using correct text colors***\",\r\n        \"***make backgrounds show in the loading screen***\",\r\n        \"***fix icons for topbar in code.html***\",\r\n        \"**fix wisp server not notifying or autoswitiching when offline in proxy**\",\r\n        \"***fix code runner open not working at all***\",\r\n        \"***make backgrounds show in player.html***\",\r\n        \"***make backgrounds show in staticsjv2***\",\r\n        \"***make player.html player controls use theme colros not hardcoded***\",\r\n        \"***make ai chat and music sidebar go all the way down and up with borders***\",\r\n        \"**make the only song in music be lebron lebron lebron james**\",\r\n        \"**fix music controls**\",\r\n        \"***finish extra page into credits and make this todo be tucked away somewhere and not the main part of it***\"\r\n    ],\r\n    defaultWisp: \"wss://glseries.net/wisp/\",\r\n    wispServers: [\r\n        { name: \"GLSeries Wisp\", url: \"wss://glseries.net/wisp/\" },\r\n        { name: \"Rhw's Wisp\", url: \"wss://wisp.rhw.one/\" },\r\n    ],\r\n\r\n    discord: {\r\n        inviteUrl: \"https://discord.gg/tHWx9NXp5p\",\r\n        widgetServer: \"1447673724017971324\",\r\n        widgetChannel: \"1447673726228496617\",\r\n    },\r\n\r\n    firstVisitCloak: false, //fake error page\r\n    defaults: {\r\n        cloakMode: \"about:blank\",\r\n        tabTitle: \"You've already responded\",\r\n        tabFavicon: \"https://ssl.gstatic.com/docs/spreadsheets/forms/forms_icon_2023q4.ico\",\r\n        cloakRotation: false,\r\n        cloakInterval: 5000,\r\n        panicKey: \"x\",\r\n        panicModifiers: [\"ctrl\", \"shift\"],\r\n        panicUrl: \"https://classroom.google.com\",\r\n        maxMovieRating: \"R\",\r\n        gameLibrary: \"multi\",\r\n        discordWidget: true,\r\n        miniplayer: true,\r\n        leaveConfirmation: false,\r\n        showChangelogOnUpdate: true,\r\n        themeRotation: true,\r\n        lastThemeRotation: 0,\r\n        backgroundRotation: true,\r\n        lastBackgroundRotation: 0,\r\n        lastSeenFeatured: 'none',\r\n        background: { type: 'color', value: '#0a0a0a' },\r\n        customBackground: { id: 'none', type: 'none' },\r\n        accentColor: '#ffffff',\r\n        surfaceColor: '#0f0f0f',\r\n        secondaryColor: '#2e2e33',\r\n        textColor: '#e4e4e7',\r\n    },\r\n\r\n    themePresets: {\r\n        dark: { name: 'Dark (Default)', bg: { type: 'color', value: '#0a0a0a' }, surface: '#0f0f0f', surfaceHover: '#1a1a1a', surfaceActive: '#252525', secondary: '#2e2e33', border: '#2a2a2a', borderLight: '#2a2a2a', text: '#e4e4e7', textSec: '#71717a', textDim: '#52525b', accent: '#ffffff' },\r\n        midnight: { name: 'Midnight', bg: { type: 'color', value: '#000000' }, surface: '#050505', surfaceHover: '#111111', surfaceActive: '#1a1a1a', secondary: '#111111', border: '#1a1a1a', borderLight: '#111111', text: '#ededed', textSec: '#a3a3a3', textDim: '#737373', accent: '#d4d4d4' },\r\n        abyss: { name: 'Abyss', bg: { type: 'color', value: '#020617' }, surface: '#0f172a', surfaceHover: '#1e293b', surfaceActive: '#334155', secondary: '#1e293b', border: '#1e293b', borderLight: '#1e293b', text: '#f1f5f9', textSec: '#94a3b8', textDim: '#64748b', accent: '#38bdf8' },\r\n        phantom: { name: 'Phantom', bg: { type: 'color', value: '#0f0a14' }, surface: '#1a0f24', surfaceHover: '#2e1a40', surfaceActive: '#4c2a5c', secondary: '#2e1a40', border: '#2e1a40', borderLight: '#2e1a40', text: '#f3e8ff', textSec: '#d8b4fe', textDim: '#c084fc', accent: '#c084fc' },\r\n        rosepine: { name: 'Rose Pine', bg: { type: 'color', value: '#191724' }, surface: '#1f1d2e', surfaceHover: '#26233a', surfaceActive: '#524f67', secondary: '#26233a', border: '#26233a', borderLight: '#1f1d2e', text: '#e0def4', textSec: '#908caa', textDim: '#6e6a86', accent: '#ebbcba' },\r\n        ocean: { name: 'Oceanic', bg: { type: 'color', value: '#011627' }, surface: '#0b2942', surfaceHover: '#1d3b53', surfaceActive: '#2d4b63', secondary: '#0b2942', border: '#1d3b53', borderLight: '#0b2942', text: '#d6deeb', textSec: '#5f7e97', textDim: '#011627', accent: '#7fdbca' },\r\n        forest: { name: 'Forest', bg: { type: 'color', value: '#020d06' }, surface: '#051a0d', surfaceHover: '#0a2e17', surfaceActive: '#0f4221', secondary: '#051a0d', border: '#0a2e17', borderLight: '#051a0d', text: '#ecfdf5', textSec: '#6ee7b7', textDim: '#064e3b', accent: '#10b981' },\r\n        crimson: { name: 'Crimson', bg: { type: 'color', value: '#1a0505' }, surface: '#230a0a', surfaceHover: '#7b0a0aff', surfaceActive: '#7f1d1d', secondary: '#230a0a', border: '#480f0fff', borderLight: '#230a0a', text: '#fef2f2', textSec: '#fecaca', textDim: '#450a0a', accent: '#ef4444' },\r\n        flame: { name: 'Flame', bg: { type: 'color', value: '#0c0202' }, surface: '#1c0a0a', surfaceHover: '#451a03', surfaceActive: '#9a3412', secondary: '#1c0a0a', border: '#451a03', borderLight: '#9a3412', text: '#fff7ed', textSec: '#fdba74', textDim: '#ea580c', accent: '#f59e0b' }\r\n    },\r\n\r\n    backgroundPresets: [\r\n        { id: 'none', name: 'None (Theme Default)', type: 'none' },\r\n        { id: 'Night sky', name: 'Night sky', type: 'image', url: 'https://images.pexels.com/photos/5675745/pexels-photo-5675745.jpeg', overlay: 0.3 },\r\n        { id: 'winter-mountains', name: 'Winter mountains', type: 'image', url: 'https://images.pexels.com/photos/1287145/pexels-photo-1287145.jpeg', overlay: 0.3 },\r\n        { id: 'f1 car', name: 'F1 Car', type: 'image', url: 'https://images.pexels.com/photos/14401632/pexels-photo-14401632.jpeg', overlay: 0.3 },\r\n        { id: 'moon-landing', name: 'Moon Landing', type: 'image', url: 'https://images.pexels.com/photos/41162/moon-landing-apollo-11-nasa-buzz-aldrin-41162.jpeg', overlay: 0.3, objectPosition: 'top left', active: true },\r\n        { id: 'turtle', name: 'Turtle', type: 'image', url: 'https://images.unsplash.com/photo-1501791187590-9ef2612ba1eb?q=80&w=1932&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D', overlay: 0.3 },\r\n        { id: 'road', name: 'Road', type: 'image', url: 'https://images.unsplash.com/photo-1508233620467-f79f1e317a05', overlay: 0.3 },\r\n        { id: 'railroad', name: 'Railroad', type: 'image', url: 'https://images.unsplash.com/photo-1505832018823-50331d70d237', overlay: 0.3 },\r\n        { id: 'mountain', name: 'Mountain', type: 'image', url: 'https://raw.githubusercontent.com/evanhnry/brave-wallpapers/refs/heads/main/Brave/clay-banks-u27Rrbs9Dwc-unsplash.jpg', overlay: 0.3 },\r\n    ],\r\n\r\n    cloakPresets: [\r\n        { name: \"Phantom\", icon: \"/favicon.svg\", title: \"Phantom Unblocked\" },\r\n        { name: \"Edpuzzle\", icon: \"https://edpuzzle.imgix.net/favicons/favicon-32.png\", title: \"Edpuzzle\" },\r\n        { name: \"Google Docs\", icon: \"https://ssl.gstatic.com/docs/documents/images/kix-favicon7.ico\", title: \"Untitled document - Google Docs\" },\r\n        { name: \"Canvas\", icon: \"https://du11hjcvx0uqb.cloudfront.net/dist/images/favicon-e10d657a73.ico\", title: \"Dashboard\" },\r\n        { name: \"Desmos\", icon: \"https://www.desmos.com/favicon.ico\", title: \"Desmos | Graphing Calculator\" },\r\n        { name: \"Khan Academy\", icon: \"https://cdn.kastatic.org/images/favicon.ico\", title: \"Khan Academy\" },\r\n        { name: \"Wikipedia\", icon: \"https://en.wikipedia.org/favicon.ico\", title: \"World War II - Wikipedia\" },\r\n        { name: \"Classroom\", icon: \"https://ssl.gstatic.com/classroom/favicon.png\", title: \"Home - Classroom\" },\r\n        { name: \"Canva\", icon: \"https://static.canva.com/static/images/android-192x192-2.png\", title: \"Home - Canva\" },\r\n        { name: \"Quiz\", icon: \"https://ssl.gstatic.com/docs/spreadsheets/forms/forms_icon_2023q4.ico\", title: \"You've already responded\" },\r\n        { name: \"Blooket\", icon: \"https://play.blooket.com/favicon.ico\", title: \"Play Blooket | Blooket\" },\r\n        { name: \"Gmail\", icon: \"https://ssl.gstatic.com/ui/v1/icons/mail/rfr/gmail.ico\", title: \"Gmail\" },\r\n        { name: \"YouTube\", icon: \"https://www.youtube.com/favicon.ico\", title: \"YouTube\" },\r\n        { name: \"Powerschool\", icon: \"https://waverlyk12.powerschool.com/favicon.ico\", title: \"Grades and Attendance\" },\r\n        { name: \"nothing\", icon: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=\", title: \"\\u200B\" },\r\n    ]\r\n}\r\n\r\n\r\n\n</script>\r\n    <script>\n// settings handler\r\n(function () {\r\n    'use strict';\r\n\r\n    const STORAGE_KEY = 'void_settings';\r\n\r\n    const getDefaults = () => {\r\n        return window.SITE_CONFIG?.defaults || {\r\n            cloakMode: 'none',\r\n            cloakRotation: false,\r\n            cloakInterval: 5000,\r\n            panicKey: 'x',\r\n            panicModifiers: ['ctrl', 'shift'],\r\n            panicUrl: 'https://classroom.google.com',\r\n            maxMovieRating: 'R',\r\n            offlineGames: [],\r\n            gameLibrary: 'multi',\r\n            leaveConfirmation: false\r\n        };\r\n    };\r\n\r\n    const load = () => {\r\n        try {\r\n            const stored = localStorage.getItem(STORAGE_KEY);\r\n            if (stored) {\r\n                return { ...getDefaults(), ...JSON.parse(stored) };\r\n            }\r\n        } catch (e) {\r\n            console.warn('Failed to load settings:', e);\r\n        }\r\n        return getDefaults();\r\n    };\r\n\r\n    const save = (settings) => {\r\n        try {\r\n            localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n            window.dispatchEvent(new CustomEvent('settings-changed', { detail: settings }));\r\n            if (window.parent !== window) {\r\n                window.parent.postMessage({ type: 'settings-update' }, '*');\r\n            }\r\n        } catch (e) {\r\n            console.warn('Failed to save settings:', e);\r\n        }\r\n    };\r\n\r\n    let _settings = load();\r\n\r\n    window.Settings = {\r\n        get(key) { return _settings[key]; },\r\n\r\n        getAll() { return { ..._settings }; },\r\n\r\n        set(key, value) {\r\n            _settings[key] = value;\r\n            save(_settings);\r\n            this.apply();\r\n            return value;\r\n        },\r\n\r\n        update(partial) {\r\n            _settings = { ..._settings, ...partial };\r\n            save(_settings);\r\n            this.apply();\r\n        },\r\n\r\n        reset() {\r\n            _settings = getDefaults();\r\n            save(_settings);\r\n            this.apply();\r\n        },\r\n\r\n        apply() {\r\n            const root = document.documentElement;\r\n            const s = _settings;\r\n            const d = window.SITE_CONFIG?.defaults || {};\r\n\r\n            const vars = {\r\n                '--accent': s.accentColor || d.accentColor || '#ffffff',\r\n                '--surface': s.surfaceColor || d.surfaceColor || '#0f0f0f',\r\n                '--surface-hover': s.surfaceHoverColor || d.surfaceHoverColor || '#1a1a1a',\r\n                '--surface-active': s.surfaceActiveColor || d.surfaceActiveColor || '#252525',\r\n                '--secondary': s.secondaryColor || d.secondaryColor || '#2e2e33',\r\n                '--border': s.borderColor || d.borderColor || '#1f1f1f',\r\n                '--border-light': s.borderLightColor || d.borderLightColor || '#2a2a2a',\r\n                '--text': s.textColor || d.textColor || '#e4e4e7',\r\n                '--text-muted': s.textSecondaryColor || d.textSecondaryColor || '#71717a',\r\n                '--text-dim': s.textDimColor || d.textDimColor || '#52525b',\r\n                '--toggle': s.toggleColor || d.toggleColor,\r\n                '--toggle-knob': s.toggleKnobColor || d.toggleKnobColor\r\n            };\r\n\r\n            Object.entries(vars).forEach(([key, val]) => {\r\n                if (val) root.style.setProperty(key, val);\r\n            });\r\n\r\n            const themeBg = s.background || d.background || { type: 'color', value: '#0a0a0a' };\r\n            const customBg = s.customBackground;\r\n            const isCustomActive = customBg && customBg.type !== 'none';\r\n\r\n            if (themeBg.type === 'color') {\r\n                root.style.setProperty('--bg', themeBg.value);\r\n            }\r\n\r\n            if (isCustomActive && customBg.url) {\r\n                root.style.setProperty('--bg-image', `url(${customBg.url})`);\r\n\r\n                let position = customBg.objectPosition;\r\n                if (customBg.id && customBg.id !== 'custom') {\r\n                    const preset = window.SITE_CONFIG?.backgroundPresets?.find(b => b.id === customBg.id);\r\n                    if (preset?.objectPosition) position = preset.objectPosition;\r\n                }\r\n\r\n                root.style.setProperty('--bg-image-position', position || 'center');\r\n            } else if (themeBg.type === 'image' || themeBg.type === 'video') {\r\n                root.style.setProperty('--bg-image', `url(${themeBg.value || themeBg.url})`);\r\n                root.style.setProperty('--bg-image-position', themeBg.objectPosition || 'center');\r\n            } else if (themeBg.type === 'gradient') {\r\n                root.style.setProperty('--bg-image', themeBg.value || themeBg.url);\r\n                root.style.setProperty('--bg-image-position', 'center');\r\n            } else {\r\n                root.style.setProperty('--bg-image', 'none');\r\n            }\r\n        },\r\n\r\n        onChange(callback) {\r\n            window.addEventListener('settings-changed', (e) => callback(e.detail));\r\n        },\r\n\r\n        isRatingAllowed(rating) {\r\n            if (!rating || rating === 'NR' || rating === 'NC-17') return false;\r\n            const ratingOrder = ['G', 'PG', 'PG-13', 'R'];\r\n            const maxIndex = ratingOrder.indexOf(_settings.maxMovieRating);\r\n            const ratingIndex = ratingOrder.indexOf(rating);\r\n            return maxIndex !== -1 && ratingIndex !== -1 && ratingIndex <= maxIndex;\r\n        }\r\n    };\r\n\r\n    // panic button go brr\r\n    const handlePanic = (e) => {\r\n        const mods = _settings.panicModifiers || [];\r\n        const key = _settings.panicKey || 'x';\r\n\r\n        if (mods.includes('ctrl') !== e.ctrlKey) return;\r\n        if (mods.includes('shift') !== e.shiftKey) return;\r\n        if (mods.includes('alt') !== e.altKey) return;\r\n\r\n        if (e.key.toLowerCase() === key.toLowerCase()) {\r\n            e.preventDefault();\r\n            const overlayId = 'panic-overlay';\r\n            let overlay = window.parent?.document?.getElementById(overlayId) || document.getElementById(overlayId);\r\n\r\n            if (!overlay) {\r\n                overlay = document.createElement('div');\r\n                overlay.id = overlayId;\r\n                overlay.style.cssText = 'position:fixed;inset:0;background:white;z-index:99999;';\r\n                document.body.appendChild(overlay);\r\n            } else {\r\n                overlay.style.display = 'block';\r\n            }\r\n\r\n            window.location.replace(_settings.panicUrl || 'https://classroom.google.com');\r\n        }\r\n    };\r\n\r\n    const init = () => {\r\n        Settings.apply();\r\n\r\n        const featured = window.SITE_CONFIG?.featuredBackground;\r\n        const activePreset = window.SITE_CONFIG?.backgroundPresets?.find(p => p.active);\r\n\r\n        const target = activePreset || featured;\r\n\r\n        if (target?.id && target.id !== _settings.lastSeenFeatured) {\r\n            Settings.update({\r\n                customBackground: target,\r\n                lastSeenFeatured: target.id,\r\n                backgroundRotation: false\r\n            });\r\n        }\r\n\r\n        document.addEventListener('keydown', handlePanic, true);\r\n\r\n        window.addEventListener('storage', (e) => {\r\n            if (e.key === STORAGE_KEY) {\r\n                _settings = load();\r\n                Settings.apply();\r\n                window.dispatchEvent(new CustomEvent('settings-changed', { detail: _settings }));\r\n            }\r\n        });\r\n\r\n        window.addEventListener('message', (e) => {\r\n            if (e.data?.type === 'settings-update' || e.data === 'updateCloak') {\r\n                _settings = load();\r\n                Settings.apply();\r\n                window.dispatchEvent(new CustomEvent('settings-changed', { detail: _settings }));\r\n            }\r\n        });\r\n\r\n        window.addEventListener('beforeunload', (e) => {\r\n            if (document.getElementById('main-frame') && _settings.leaveConfirmation) {\r\n                e.preventDefault();\r\n                return e.returnValue = '';\r\n            }\r\n        });\r\n    };\r\n\r\n    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', init);\r\n    else init();\r\n})();\r\n\n</script>\r\n    <script>\n// background stuff\r\n(function () {\r\n    'use strict';\r\n\r\n    if (window.BackgroundManager) return;\r\n\r\n    const YOUTUBE_REGEX = /(?:youtube\\.com\\/watch\\?v=|youtu\\.be\\/|youtube\\.com\\/embed\\/)([a-zA-Z0-9_-]{11})/;\r\n\r\n    const BackgroundManager = {\r\n        container: null,\r\n        mediaLayer: null,\r\n        elements: { video: null, image: null, iframe: null },\r\n        current: { type: null, url: null },\r\n        cacheName: 'phantom-bg-cache-v2',\r\n\r\n        init() {\r\n            this.container = document.createElement('div');\r\n            this.container.className = 'phantom-background';\r\n            this.container.innerHTML = '<div class=\"phantom-background-overlay\"></div><div class=\"phantom-background-layer\"></div>';\r\n            this.mediaLayer = this.container.querySelector('.phantom-background-layer');\r\n            document.body.insertBefore(this.container, document.body.firstChild);\r\n\r\n            const apply = () => this.applyBackground();\r\n            window.addEventListener('settings-changed', apply);\r\n            window.addEventListener('storage', apply);\r\n            window.addEventListener('beforeunload', () => this.cleanup());\r\n            window.addEventListener('pagehide', () => this.cleanup());\r\n\r\n            document.addEventListener('visibilitychange', () => {\r\n                const video = this.elements.video;\r\n                if (!video) return;\r\n                if (document.hidden) video.pause();\r\n                else if (this.current.type === 'video') video.play().catch(() => { });\r\n            });\r\n\r\n            this.applyBackground();\r\n        },\r\n\r\n        applyBackground() {\r\n            if (!this.container) return; // Wait for init() to create the container\r\n\r\n            const s = window.Settings?.getAll() || {};\r\n            const custom = s.customBackground;\r\n            const theme = s.background || {};\r\n\r\n            let type = null, url = null, pos = null, overlay = 0.4;\r\n\r\n            if (custom && custom.type !== 'none') {\r\n                // Refresh from config if possible to get latest props like objectPosition\r\n                if (custom.id && custom.id !== 'custom') {\r\n                    const preset = window.SITE_CONFIG?.backgroundPresets?.find(b => b.id === custom.id);\r\n                    if (preset) Object.assign(custom, preset);\r\n                }\r\n                ({ type, url, objectPosition: pos, overlay = 0.4 } = custom);\r\n            } else if (theme.type === 'image' || theme.type === 'video' || theme.type === 'youtube') {\r\n                type = theme.type;\r\n                url = theme.value || theme.url;\r\n                pos = theme.objectPosition;\r\n                overlay = theme.overlay || 0.4;\r\n            }\r\n\r\n            document.documentElement.style.setProperty('--bg-overlay', overlay);\r\n\r\n            // Handle common positioning typos and normalize\r\n            if (pos && typeof pos === 'string') {\r\n                pos = pos.toLowerCase().trim()\r\n                    .replace(/\\s+/g, ' ') // Normalize multiple spaces\r\n                    .replace('topleft', 'top left')\r\n                    .replace('topright', 'top right')\r\n                    .replace('bottomleft', 'bottom left')\r\n                    .replace('bottomright', 'bottom right')\r\n                    .replace('centercenter', 'center')\r\n                    .replace('centerleft', 'center left')\r\n                    .replace('centerright', 'center right');\r\n            }\r\n\r\n            document.documentElement.style.setProperty('--bg-image-position', pos || 'center');\r\n\r\n            if (!type || !url) {\r\n                this.clear();\r\n                document.documentElement.style.backgroundColor = 'var(--bg)';\r\n                document.documentElement.style.setProperty('--bg-image-position', 'center');\r\n                return;\r\n            }\r\n            if (this.current.type === type && this.current.url === url) return;\r\n\r\n            this.current = { type, url };\r\n\r\n            if (type === 'video' || url.match(/\\.(mp4|webm|ogg|mov|m4v)$/i)) {\r\n                this.clearMedia();\r\n                this.createVideo(url, pos);\r\n                this.container.classList.add('active');\r\n                document.documentElement.classList.add('phantom-bg-active');\r\n                document.body.classList.add('phantom-bg-active');\r\n            } else if (type === 'youtube' || YOUTUBE_REGEX.test(url)) {\r\n                this.clearMedia();\r\n                this.createYouTube(url, pos);\r\n                this.container.classList.add('active');\r\n                document.documentElement.classList.add('phantom-bg-active');\r\n                document.body.classList.add('phantom-bg-active');\r\n            } else if (type === 'image') {\r\n                this.handleImageBackground(url, pos);\r\n            }\r\n        },\r\n\r\n        async getProxiedCachedUrl(url) {\r\n            // Local images don't need proxying\r\n            if (!url.startsWith('http') || url.includes(location.hostname)) return url;\r\n\r\n            // Try direct load first (faster)\r\n            try {\r\n                const directTest = await fetch(url, { method: 'HEAD', mode: 'cors' });\r\n                if (directTest.ok) return url;\r\n            } catch (e) {\r\n                // CORS blocked, need to proxy\r\n            }\r\n\r\n            // Wait for BareMux (max 500ms)\r\n            let retries = 0;\r\n            while (!window.BareMux && retries < 5) {\r\n                await new Promise(r => setTimeout(r, 100));\r\n                retries++;\r\n            }\r\n\r\n            if (!window.BareMux) {\r\n                console.warn(\"Background: BareMux not found, trying direct URL.\");\r\n                return url; // Try direct anyway\r\n            }\r\n\r\n            try {\r\n                const client = new window.BareMux.BareClient();\r\n                const response = await client.fetch(url);\r\n                if (!response.ok) throw new Error('Proxy fetch failed');\r\n\r\n                const blob = await response.blob();\r\n                return URL.createObjectURL(blob);\r\n            } catch (error) {\r\n                console.error(\"Background proxy failed:\", error);\r\n                return url; // Fallback to direct URL\r\n            }\r\n        },\r\n\r\n        async handleImageBackground(url, pos) {\r\n            // Pre-load the image (proxied/cached or direct)\r\n            const finalUrl = await this.getProxiedCachedUrl(url);\r\n\r\n            // Check if this is still the current background after async fetch\r\n            if (this.current.url !== url) {\r\n                if (finalUrl && finalUrl.startsWith('blob:')) URL.revokeObjectURL(finalUrl);\r\n                return;\r\n            }\r\n\r\n            this.clearMedia();\r\n            this.createImage(finalUrl, pos);\r\n        },\r\n\r\n        createVideo(url, pos) {\r\n            const el = Object.assign(document.createElement('video'), {\r\n                className: 'phantom-background-media', src: url, autoplay: true, loop: true, muted: true, playsInline: true, volume: 0\r\n            });\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n            el.onerror = () => (this.elements.video = null);\r\n            this.elements.video = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        createImage(url, pos) {\r\n            const el = Object.assign(document.createElement('img'), {\r\n                className: 'phantom-background-media',\r\n                src: url\r\n            });\r\n\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n\r\n            el.onload = () => {\r\n                if (this.current.url === url || url.startsWith('blob:')) {\r\n                    this.container.classList.add('active');\r\n                    document.documentElement.classList.add('phantom-bg-active');\r\n                    document.body.classList.add('phantom-bg-active');\r\n                }\r\n            };\r\n            el.onerror = () => {\r\n                console.warn(\"Background image failed to load:\", url);\r\n                if (this.elements.image === el) this.elements.image = null;\r\n            };\r\n\r\n            this.elements.image = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        // youtube logic\r\n        createYouTube(url, pos) {\r\n            const id = url.match(YOUTUBE_REGEX)?.[1];\r\n            if (!id) return;\r\n            const el = Object.assign(document.createElement('iframe'), {\r\n                className: 'phantom-background-media',\r\n                src: `https://www.youtube.com/embed/${id}?autoplay=1&loop=1&playlist=${id}&controls=0&modestbranding=1&rel=0&mute=1&enablejsapi=1`,\r\n                allow: 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture'\r\n            });\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n            this.elements.iframe = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        clearMedia() {\r\n            Object.entries(this.elements).forEach(([key, el]) => {\r\n                if (!el) return;\r\n                if (key === 'video') { el.pause(); el.src = ''; }\r\n                if (key === 'iframe') el.src = 'about:blank';\r\n                if (key === 'image' && el.src.startsWith('blob:')) {\r\n                    URL.revokeObjectURL(el.src);\r\n                }\r\n                el.remove();\r\n                this.elements[key] = null;\r\n            });\r\n        },\r\n\r\n        clear() {\r\n            this.clearMedia();\r\n            this.current = { type: null, url: null };\r\n            document.documentElement.classList.remove('phantom-bg-active');\r\n            document.body.classList.remove('phantom-bg-active');\r\n            document.documentElement.style.backgroundColor = '';\r\n            if (this.container) this.container.classList.remove('active');\r\n        },\r\n\r\n        cleanup() {\r\n            this.clearMedia();\r\n        }\r\n    };\r\n\r\n    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', () => BackgroundManager.init());\r\n    else BackgroundManager.init();\r\n\r\n    window.BackgroundManager = BackgroundManager;\r\n})();\r\n\n</script>\r\n    <script>\n(function () {\r\n    const style = document.createElement('style');\r\n    style.textContent = `\r\n        .notify-container { position: fixed; top: 16px; right: 16px; z-index: 99999; display: flex; flex-direction: column; gap: 8px; pointer-events: none; font-family: 'Inter', sans-serif; }\r\n        .notify-toast { display: flex; align-items: center; gap: 12px; padding: 12px 16px; background: rgba(15, 15, 15, 0.9); backdrop-filter: blur(10px); border: 1px solid var(--border, #1f1f1f); border-radius: 10px; color: #e4e4e7; font-size: 13px; min-width: 280px; max-width: 380px; box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4); pointer-events: auto; transform: translateX(120%); opacity: 0; transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1), opacity 0.3s ease; position: relative; overflow: hidden; }\r\n        .notify-toast.show { transform: translateX(0); opacity: 1; }\r\n        .notify-toast.hiding { transform: translateX(120%); opacity: 0; }\r\n        .notify-icon { width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }\r\n        .notify-icon svg { width: 18px; height: 18px; }\r\n        .notify-content { flex: 1; line-height: 1.4; }\r\n        .notify-title { font-weight: 600; margin-bottom: 2px; }\r\n        .notify-message { color: #a1a1aa; font-size: 12px; }\r\n        .notify-close { background: none; border: none; color: #52525b; cursor: pointer; padding: 4px; border-radius: 4px; display: flex; align-items: center; justify-content: center; }\r\n        .notify-close:hover { background: rgba(255,255,255,0.1); color: #fff; }\r\n        .notify-close svg { width: 14px; height: 14px; }\r\n        .notify-toast.success { border-left: 3px solid #22c55e; } .notify-toast.success .notify-icon { color: #22c55e; }\r\n        .notify-toast.error { border-left: 3px solid #ef4444; } .notify-toast.error .notify-icon { color: #ef4444; }\r\n        .notify-toast.warning { border-left: 3px solid #f59e0b; } .notify-toast.warning .notify-icon { color: #f59e0b; }\r\n        .notify-toast.info { border-left: 3px solid #3b82f6; } .notify-toast.info .notify-icon { color: #3b82f6; }\r\n        .notify-progress { position: absolute; bottom: 0; left: 0; height: 2px; background: rgba(255, 255, 255, 0.2); transition: width linear; }\r\n    `;\r\n    document.head.appendChild(style);\r\n\r\n    let container = null;\r\n    const getContainer = () => container || (container = document.body.appendChild(Object.assign(document.createElement('div'), { className: 'notify-container' })));\r\n\r\n    const icons = {\r\n        success: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"20 6 9 17 4 12\"></polyline></svg>`,\r\n        error: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"15\" y1=\"9\" x2=\"9\" y2=\"15\"></line><line x1=\"9\" y1=\"9\" x2=\"15\" y2=\"15\"></line></svg>`,\r\n        warning: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\"></path><line x1=\"12\" y1=\"9\" x2=\"12\" y2=\"13\"></line><line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\"></line></svg>`,\r\n        info: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"12\" y1=\"16\" x2=\"12\" y2=\"12\"></line><line x1=\"12\" y1=\"8\" x2=\"12.01\" y2=\"8\"></line></svg>`,\r\n        close: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line><line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line></svg>`\r\n    };\r\n\r\n    function notify(type, title, msg = '', dur = 4000) {\r\n        const t = document.createElement('div');\r\n        t.className = `notify-toast ${type}`;\r\n        t.innerHTML = `<div class=\"notify-icon\">${icons[type]}</div><div class=\"notify-content\"><div class=\"notify-title\">${title}</div><div class=\"notify-message\">${msg}</div></div><button class=\"notify-close\">${icons.close}</button><div class=\"notify-progress\"></div>`;\r\n        const p = t.querySelector('.notify-progress');\r\n        const dismiss = () => { t.classList.add('hiding'); setTimeout(() => t.remove(), 300); };\r\n        t.querySelector('.notify-close').onclick = dismiss;\r\n        p.style.width = '100%';\r\n        setTimeout(() => { p.style.transition = `width ${dur}ms linear`; p.style.width = '0%'; }, 50);\r\n        let timer = setTimeout(dismiss, dur);\r\n        t.onmouseenter = () => { clearTimeout(timer); p.style.transition = 'none'; };\r\n        t.onmouseleave = () => {\r\n            const rem = (parseFloat(getComputedStyle(p).width) / t.offsetWidth) * dur;\r\n            p.style.transition = `width ${rem}ms linear`; p.style.width = '0%';\r\n            timer = setTimeout(dismiss, rem);\r\n        };\r\n        getContainer().appendChild(t);\r\n        requestAnimationFrame(() => t.classList.add('show'));\r\n    }\r\n\r\n    window.Notify = {\r\n        success: (a, b, c) => notify('success', a, b, c),\r\n        error: (a, b, c) => notify('error', a, b, c),\r\n        warning: (a, b, c) => notify('warning', a, b, c),\r\n        info: (a, b, c) => notify('info', a, b, c)\r\n    };\r\n})();\r\n\n</script>\r\n    <script>\n// topbar\r\n(function () {\r\n    let rootPrefix = '';\r\n    const scriptName = 'components/topbar.js';\r\n    const scripts = document.getElementsByTagName('script');\r\n    for (let i = 0; i < scripts.length; i++) {\r\n        const src = scripts[i].getAttribute('src');\r\n        if (src && src.includes(scriptName)) {\r\n            rootPrefix = src.split(scriptName)[0];\r\n            break;\r\n        }\r\n    }\r\n\r\n    if (!window.lucide && !document.querySelector('script[src*=\"lucide\"]')) {\r\n        const script = document.createElement('script');\r\n        script.src = 'https://unpkg.com/lucide@latest';\r\n        script.onload = () => {\r\n            if (window.lucide) lucide.createIcons();\r\n        };\r\n        document.head.appendChild(script);\r\n    }\r\n\r\n    initTopbar();\r\n\r\n    function createTopbar() {\r\n        const topbarContainer = document.createElement('div');\r\n        topbarContainer.id = 'topbar-container';\r\n\r\n        const logoSection = document.createElement('a');\r\n        logoSection.className = 'logo-section';\r\n        logoSection.href = rootPrefix + 'index2.html';\r\n        logoSection.innerHTML = '<div class=\"logo-placeholder\"><i data-lucide=\"zap\"></i></div>';\r\n        topbarContainer.appendChild(logoSection);\r\n\r\n        const navButtons = document.createElement('div');\r\n        navButtons.className = 'nav-buttons';\r\n\r\n        const buttons = [\r\n            { name: 'Music', icon: 'music', link: 'pages/music.html', badge: 'BETA' },\r\n            { name: 'Movies', icon: 'film', link: 'pages/movies.html' },\r\n            { name: 'Games', icon: 'gamepad-2', link: 'pages/games.html' },\r\n            { name: 'Watch', icon: 'play', link: 'pages/watch.html' },\r\n            { name: 'Search', icon: 'search', link: 'staticsjv2/index.html' },\r\n            { name: 'AI Chat', icon: 'bot', link: 'pages/chat.html' },\r\n            { separator: true },\r\n            { name: 'Settings', icon: 'settings', link: 'pages/settings.html' }\r\n        ];\r\n\r\n        buttons.forEach(btn => {\r\n            if (btn.separator) {\r\n                const separator = document.createElement('div');\r\n                separator.className = 'nav-separator';\r\n                navButtons.appendChild(separator);\r\n                return;\r\n            }\r\n\r\n            const link = document.createElement('a');   \r\n            link.href = rootPrefix + btn.link;\r\n            link.className = 'nav-btn';\r\n\r\n            const icon = document.createElement('i');\r\n            icon.setAttribute('data-lucide', btn.icon);\r\n            link.appendChild(icon);\r\n\r\n            const span = document.createElement('span');\r\n            span.textContent = btn.name;\r\n            link.appendChild(span);\r\n\r\n            if (btn.badge) {\r\n                const badge = document.createElement('div');\r\n                badge.className = 'nav-badge-beta';\r\n                badge.textContent = btn.badge;\r\n                link.appendChild(badge);\r\n            }\r\n\r\n            navButtons.appendChild(link);\r\n        });\r\n\r\n        topbarContainer.appendChild(navButtons);\r\n        document.body.prepend(topbarContainer);\r\n\r\n        if (window.lucide) {\r\n            lucide.createIcons();\r\n        }\r\n    }\r\n\r\n    function initTopbar() {\r\n        if (document.readyState === 'loading') {\r\n            document.addEventListener('DOMContentLoaded', createTopbar);\r\n        } else {\r\n            createTopbar();\r\n        }\r\n    }\r\n})();\r\n\n</script>\r\n\r\n    <div class=\"editor-page\">\r\n        <div class=\"editor-container\">\r\n            <div class=\"file-sidebar\">\r\n                <div class=\"sidebar-header\">\r\n                    <span class=\"sidebar-title\">Files</span>\r\n                    <div class=\"sidebar-actions\">\r\n                        <button class=\"sidebar-btn\" id=\"new-file-btn\" title=\"New File\">\r\n                            <i class=\"fa-solid fa-plus\"></i>\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n                <div class=\"file-tree\" id=\"file-tree\"></div>\r\n            </div>\r\n\r\n            <div class=\"editor-main\">\r\n                <div class=\"editor-toolbar\">\r\n                    <div class=\"toolbar-left\">\r\n                        <button class=\"toolbar-btn success\" id=\"fix-code-btn\" title=\"Auto-fix issues\">\r\n                            <i class=\"fa-solid fa-wand-magic-sparkles\"></i>\r\n                            <span>Fix</span>\r\n                        </button>\r\n                        <select class=\"language-select\" id=\"language-select\">\r\n                            <option value=\"javascript\">JavaScript</option>\r\n                            <option value=\"typescript\">TypeScript</option>\r\n                            <option value=\"html\">HTML</option>\r\n                            <option value=\"css\">CSS</option>\r\n                            <option value=\"json\">JSON</option>\r\n                            <option value=\"python\">Python</option>\r\n                            <option value=\"markdown\">Markdown</option>\r\n                            <option value=\"plaintext\">Plain Text</option>\r\n                        </select>\r\n                        <span class=\"error-badge\" id=\"error-count\" style=\"display:none\">0</span>\r\n                        <span class=\"warning-badge\" id=\"warning-count\" style=\"display:none\">0</span>\r\n                    </div>\r\n                    <div class=\"toolbar-right\">\r\n                        <button class=\"toolbar-btn\" id=\"open-tab-btn\" title=\"Open in cloaked tab\">\r\n                            <i class=\"fa-solid fa-up-right-from-square\"></i>\r\n                            <span>Open</span>\r\n                        </button>\r\n                        <button class=\"toolbar-btn\" id=\"save-btn\" title=\"Download file\">\r\n                            <i class=\"fa-solid fa-download\"></i>\r\n                            <span>Save</span>\r\n                        </button>\r\n                        <button class=\"toolbar-btn primary\" id=\"export-btn\" title=\"Export as ZIP\">\r\n                            <i class=\"fa-solid fa-file-zipper\"></i>\r\n                            <span>Export</span>\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class=\"editor-tabs\" id=\"editor-tabs\"></div>\r\n\r\n                <div id=\"monaco-container\"></div>\r\n\r\n                <div class=\"terminal-panel\" id=\"terminal-panel\">\r\n                    <div class=\"resize-handle\" id=\"terminal-resize\"></div>\r\n                    <div class=\"terminal-header\" id=\"terminal-header\">\r\n                        <div class=\"terminal-tabs\">\r\n                            <span class=\"terminal-tab active\" data-panel=\"terminal\">Terminal</span>\r\n                            <span class=\"terminal-tab\" data-panel=\"problems\">Problems</span>\r\n                        </div>\r\n                        <button class=\"sidebar-btn\" id=\"terminal-toggle\">\r\n                            <i class=\"fa-solid fa-chevron-down\"></i>\r\n                        </button>\r\n                    </div>\r\n                    <div class=\"terminal-content\" id=\"terminal-content\">\r\n                        <div class=\"terminal-line info\">> Phantom Code Editor</div>\r\n                    </div>\r\n                    <div class=\"problems-content\" id=\"problems-content\"></div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <script src=\"https://cdn.jsdelivr.net/npm/monaco-editor@0.45.0/min/vs/loader.js\"></script>\r\n    <script>\n// code editor\r\n\r\nconst state = {\r\n    files: new Map(),\r\n    activeFile: 'index.html',\r\n    editor: null,\r\n    activePanel: 'terminal'\r\n};\r\n\r\nstate.files.set('index.html', {\r\n    content: `<!DOCTYPE html>\r\n<html>\r\n<head>\r\n  <title>My Page</title>\r\n  <style>\r\n      body {\r\n          font-family: Arial, sans-serif;\r\n          text-align: center;\r\n          background-color: #f0f0f0;\r\n      }\r\n      h1 {\r\n          color: #333;\r\n      }\r\n  </style>\r\n</head>\r\n<body>\r\n  <h1>Welcome to My Page</h1>\r\n  <p>This is a simple HTML example.</p>\r\n</body>\r\n</html>`,\r\n    language: 'html'\r\n});\r\n\r\nif (typeof JSZip === 'undefined') {\r\n    const script = document.createElement('script');\r\n    script.src = 'https://unpkg.com/jszip@3.10.1/dist/jszip.min.js';\r\n    document.head.appendChild(script);\r\n}\r\n\r\n// linting\r\nfunction lintCode(code, language) {\r\n    const problems = [];\r\n    if (language !== 'javascript' && language !== 'typescript') return problems;\r\n\r\n    const lines = code.split('\\n');\r\n    lines.forEach((line, i) => {\r\n        const num = i + 1;\r\n\r\n        // Syntax issues\r\n        if (/\\bvar\\s+/.test(line)) {\r\n            problems.push({ type: 'warning', line: num, col: line.indexOf('var') + 1, msg: 'Use let/const instead of var' });\r\n        }\r\n        if (/[^=!]==[^=]/.test(line)) {\r\n            problems.push({ type: 'warning', line: num, col: line.indexOf('==') + 1, msg: 'Use === instead of ==' });\r\n        }\r\n        if (/debugger/.test(line)) {\r\n            problems.push({ type: 'error', line: num, col: line.indexOf('debugger') + 1, msg: 'Remove debugger' });\r\n        }\r\n        if (/catch\\s*\\([^)]*\\)\\s*\\{\\s*\\}/.test(line)) {\r\n            problems.push({ type: 'error', line: num, col: 1, msg: 'Empty catch block' });\r\n        }\r\n\r\n        // Check for common mistakes\r\n        if (/\\bconsole\\.log\\b/.test(line) && !/\\/\\//.test(line.split('console.log')[0])) {\r\n            problems.push({ type: 'info', line: num, col: line.indexOf('console.log') + 1, msg: 'Consider removing console.log' });\r\n        }\r\n    });\r\n\r\n    return problems;\r\n}\r\n\r\nfunction showProblems(problems) {\r\n    const el = document.getElementById('problems-content');\r\n    const errBadge = document.getElementById('error-count');\r\n    const warnBadge = document.getElementById('warning-count');\r\n\r\n    const errors = problems.filter(p => p.type === 'error').length;\r\n    const warnings = problems.filter(p => p.type === 'warning').length;\r\n\r\n    errBadge.textContent = errors + ' error' + (errors !== 1 ? 's' : '');\r\n    errBadge.style.display = errors > 0 ? 'inline' : 'none';\r\n    warnBadge.textContent = warnings + ' warning' + (warnings !== 1 ? 's' : '');\r\n    warnBadge.style.display = warnings > 0 ? 'inline' : 'none';\r\n\r\n    if (problems.length === 0) {\r\n        el.innerHTML = '<div style=\"text-align:center;padding:20px;color:var(--text-muted)\"> No problems</div>';\r\n    } else {\r\n        el.innerHTML = problems.map(p => `\r\n            <div class=\"problem-item ${p.type}\" onclick=\"jumpToLine(${p.line})\">\r\n                <span style=\"color:${p.type === 'error' ? '#ef4444' : p.type === 'warning' ? '#f59e0b' : '#3b82f6'}\"></span>\r\n                <span>${p.msg}</span>\r\n                <span style=\"color:var(--text-dim);margin-left:auto\">Ln ${p.line}</span>\r\n            </div>\r\n        `).join('');\r\n    }\r\n\r\n    // Set Monaco markers\r\n    if (state.editor && window.monaco) {\r\n        const markers = problems.map(p => ({\r\n            severity: p.type === 'error' ? monaco.MarkerSeverity.Error : monaco.MarkerSeverity.Warning,\r\n            startLineNumber: p.line,\r\n            startColumn: p.col,\r\n            endLineNumber: p.line,\r\n            endColumn: p.col + 10,\r\n            message: p.msg\r\n        }));\r\n        monaco.editor.setModelMarkers(state.editor.getModel(), 'lint', markers);\r\n    }\r\n}\r\n\r\nwindow.jumpToLine = (line) => {\r\n    if (state.editor) {\r\n        state.editor.revealLineInCenter(line);\r\n        state.editor.setPosition({ lineNumber: line, column: 1 });\r\n        state.editor.focus();\r\n    }\r\n};\r\n\r\n// monaco\r\nrequire.config({ paths: { vs: 'https://cdn.jsdelivr.net/npm/monaco-editor@0.45.0/min/vs' } });\r\n\r\nrequire(['vs/editor/editor.main'], function () {\r\n    monaco.editor.defineTheme('phantom', {\r\n        base: 'vs-dark',\r\n        inherit: true,\r\n        rules: [\r\n            { token: 'comment', foreground: '6a737d', fontStyle: 'italic' },\r\n            { token: 'keyword', foreground: 'c084fc' },\r\n            { token: 'string', foreground: '22c55e' },\r\n            { token: 'number', foreground: 'f59e0b' }\r\n        ],\r\n        colors: {\r\n            'editor.background': '#0a0a0a',\r\n            'editor.foreground': '#e4e4e7',\r\n            'editor.lineHighlightBackground': '#151515',\r\n            'editor.selectionBackground': '#3b82f640',\r\n            'editorLineNumber.foreground': '#52525b'\r\n        }\r\n    });\r\n\r\n    state.editor = monaco.editor.create(document.getElementById('monaco-container'), {\r\n        value: state.files.get('index.html').content,\r\n        language: 'html',\r\n        theme: 'phantom',\r\n        fontSize: 14,\r\n        fontFamily: \"'JetBrains Mono', 'Fira Code', monospace\",\r\n        minimap: { enabled: false },\r\n        scrollBeyondLastLine: false,\r\n        automaticLayout: true,\r\n        tabSize: 2,\r\n        wordWrap: 'on',\r\n        lineNumbers: 'on',\r\n        bracketPairColorization: { enabled: true }\r\n    });\r\n\r\n    state.editor.onDidChangeModelContent(() => {\r\n        if (state.activeFile && state.files.has(state.activeFile)) {\r\n            state.files.get(state.activeFile).content = state.editor.getValue();\r\n        }\r\n    });\r\n\r\n    log('Editor ready', 'info');\r\n});\r\n\r\n// files\r\nconst fileTree = document.getElementById('file-tree');\r\nconst editorTabs = document.getElementById('editor-tabs');\r\n\r\nfunction getFileIcon(name) {\r\n    const ext = name.split('.').pop().toLowerCase();\r\n    const icons = {\r\n        js: 'fa-brands fa-js', ts: 'fa-brands fa-js',\r\n        html: 'fa-solid fa-code', css: 'fa-brands fa-css3-alt',\r\n        json: 'fa-solid fa-brackets-curly', md: 'fa-solid fa-file-lines'\r\n    };\r\n    return icons[ext] || 'fa-solid fa-file';\r\n}\r\n\r\nfunction getLanguage(name) {\r\n    const ext = name.split('.').pop().toLowerCase();\r\n    const langs = { js: 'javascript', ts: 'typescript', html: 'html', css: 'css', json: 'json', md: 'markdown', py: 'python' };\r\n    return langs[ext] || 'plaintext';\r\n}\r\n\r\nfunction renderFiles() {\r\n    if (state.files.size === 0) {\r\n        fileTree.innerHTML = '<div class=\"file-tree-empty\"><i class=\"fa-solid fa-folder-open\"></i><span>Drop files here</span></div>';\r\n        return;\r\n    }\r\n\r\n    let html = '';\r\n    state.files.forEach((data, name) => {\r\n        const active = name === state.activeFile ? 'active' : '';\r\n        html += `\r\n            <div class=\"tree-item ${active}\" data-file=\"${name}\">\r\n                <i class=\"${getFileIcon(name)}\"></i>\r\n                <span class=\"tree-item-name\">${name}</span>\r\n                <div class=\"tree-item-actions\">\r\n                    <button class=\"tree-item-rename\" data-rename=\"${name}\" title=\"Rename file\"><i class=\"fa-solid fa-pen\"></i></button>\r\n                    <button class=\"tree-item-delete\" data-delete=\"${name}\" title=\"Delete file\"></button>\r\n                </div>\r\n            </div>\r\n        `;\r\n    });\r\n    fileTree.innerHTML = html;\r\n\r\n    fileTree.querySelectorAll('.tree-item').forEach(el => {\r\n        el.onclick = (e) => {\r\n            if (e.target.closest('.tree-item-delete')) {\r\n                deleteFile(e.target.closest('.tree-item-delete').dataset.delete);\r\n            } else if (e.target.closest('.tree-item-rename')) {\r\n                renameFile(e.target.closest('.tree-item-rename').dataset.rename);\r\n            } else {\r\n                openFile(el.dataset.file);\r\n            }\r\n        };\r\n    });\r\n}\r\n\r\nfunction renderTabs() {\r\n    let html = '';\r\n    state.files.forEach((data, name) => {\r\n        const active = name === state.activeFile ? 'active' : '';\r\n        html += `\r\n            <button class=\"editor-tab ${active}\" data-file=\"${name}\">\r\n                <i class=\"${getFileIcon(name)}\"></i>\r\n                ${name}\r\n                <span class=\"close-tab\" data-close=\"${name}\"></span>\r\n            </button>\r\n        `;\r\n    });\r\n    editorTabs.innerHTML = html;\r\n\r\n    editorTabs.querySelectorAll('.editor-tab').forEach(tab => {\r\n        tab.onclick = (e) => {\r\n            if (e.target.classList.contains('close-tab')) {\r\n                deleteFile(e.target.dataset.close);\r\n            } else {\r\n                openFile(tab.dataset.file);\r\n            }\r\n        };\r\n    });\r\n}\r\n\r\nfunction openFile(name) {\r\n    if (!state.files.has(name)) return;\r\n    state.activeFile = name;\r\n    const data = state.files.get(name);\r\n\r\n    if (state.editor && window.monaco) {\r\n        monaco.editor.setModelLanguage(state.editor.getModel(), data.language);\r\n        state.editor.setValue(data.content);\r\n    }\r\n\r\n    document.getElementById('language-select').value = data.language;\r\n    renderFiles();\r\n    renderTabs();\r\n}\r\n\r\nfunction deleteFile(name) {\r\n    if (state.files.size <= 1) {\r\n        if (window.Notify) Notify.warning('Cannot delete', 'Keep at least one file');\r\n        return;\r\n    }\r\n\r\n    state.files.delete(name);\r\n    log('Deleted: ' + name, 'warning');\r\n\r\n    if (state.activeFile === name) {\r\n        state.activeFile = state.files.keys().next().value;\r\n        openFile(state.activeFile);\r\n    } else {\r\n        renderFiles();\r\n        renderTabs();\r\n    }\r\n}\r\n\r\nfunction addFile(name, content = '') {\r\n    state.files.set(name, { content, language: getLanguage(name) });\r\n    openFile(name);\r\n    log('Added: ' + name, 'info');\r\n}\r\n\r\nfunction renameFile(oldName) {\r\n    const newName = prompt('New name:', oldName);\r\n    if (!newName || newName === oldName) return;\r\n\r\n    if (state.files.has(newName)) {\r\n        if (window.Notify) Notify.error('Error', 'File already exists');\r\n        return;\r\n    }\r\n\r\n    const fileData = state.files.get(oldName);\r\n    state.files.delete(oldName);\r\n    state.files.set(newName, {\r\n        ...fileData,\r\n        language: getLanguage(newName)\r\n    });\r\n\r\n    if (state.activeFile === oldName) {\r\n        state.activeFile = newName;\r\n    }\r\n\r\n    log(`Renamed ${oldName} to ${newName}`, 'info');\r\n    renderFiles();\r\n    renderTabs();\r\n}\r\n\r\n// drag n drop\r\nfileTree.addEventListener('dragover', e => { e.preventDefault(); fileTree.classList.add('drag-over'); });\r\nfileTree.addEventListener('dragleave', () => fileTree.classList.remove('drag-over'));\r\nfileTree.addEventListener('drop', async e => {\r\n    e.preventDefault();\r\n    fileTree.classList.remove('drag-over');\r\n\r\n    for (const item of e.dataTransfer.items) {\r\n        if (item.kind === 'file') {\r\n            const entry = item.webkitGetAsEntry?.();\r\n            if (entry) await processEntry(entry);\r\n            else {\r\n                const file = item.getAsFile();\r\n                if (file) addFile(file.name, await file.text());\r\n            }\r\n        }\r\n    }\r\n});\r\n\r\nasync function processEntry(entry, path = '') {\r\n    if (entry.isFile) {\r\n        entry.file(async file => {\r\n            const name = path ? path + '/' + file.name : file.name;\r\n            addFile(name, await file.text());\r\n        });\r\n    } else if (entry.isDirectory) {\r\n        const reader = entry.createReader();\r\n        const entries = await new Promise(r => reader.readEntries(r));\r\n        for (const e of entries) {\r\n            await processEntry(e, path ? path + '/' + entry.name : entry.name);\r\n        }\r\n    }\r\n}\r\n\r\n// terminal\r\nconst terminalPanel = document.getElementById('terminal-panel');\r\nconst terminalContent = document.getElementById('terminal-content');\r\n\r\nfunction log(msg, type = '') {\r\n    const line = document.createElement('div');\r\n    line.className = 'terminal-line ' + type;\r\n    line.textContent = '> ' + msg;\r\n    terminalContent.appendChild(line);\r\n    terminalContent.scrollTop = terminalContent.scrollHeight;\r\n}\r\n\r\ndocument.getElementById('terminal-header').onclick = (e) => {\r\n    if (e.target.closest('.terminal-tab')) return;\r\n    terminalPanel.classList.toggle('collapsed');\r\n};\r\n\r\ndocument.querySelectorAll('.terminal-tab').forEach(tab => {\r\n    tab.onclick = (e) => {\r\n        e.stopPropagation();\r\n        document.querySelectorAll('.terminal-tab').forEach(t => t.classList.remove('active'));\r\n        tab.classList.add('active');\r\n\r\n        const panel = tab.dataset.panel;\r\n        document.getElementById('terminal-content').style.display = panel === 'terminal' ? 'block' : 'none';\r\n        document.getElementById('problems-content').style.display = panel === 'problems' ? 'block' : 'none';\r\n    };\r\n});\r\n\r\n// Terminal resize\r\nlet resizing = false;\r\ndocument.getElementById('terminal-resize').addEventListener('mousedown', () => { resizing = true; });\r\ndocument.addEventListener('mousemove', e => {\r\n    if (!resizing) return;\r\n    const h = document.querySelector('.editor-main').getBoundingClientRect().bottom - e.clientY;\r\n    if (h >= 80 && h <= 400) terminalPanel.style.height = h + 'px';\r\n});\r\ndocument.addEventListener('mouseup', () => { resizing = false; });\r\n\r\n// toolbar\r\n\r\ndocument.getElementById('new-file-btn').onclick = () => {\r\n    const name = prompt('File name:', 'new.js');\r\n    if (name) addFile(name.trim());\r\n};\r\n\r\ndocument.getElementById('language-select').onchange = e => {\r\n    if (state.editor && state.activeFile) {\r\n        const lang = e.target.value;\r\n        state.files.get(state.activeFile).language = lang;\r\n        monaco.editor.setModelLanguage(state.editor.getModel(), lang);\r\n    }\r\n};\r\n\r\ndocument.getElementById('fix-code-btn').onclick = async () => {\r\n    if (!state.editor) return;\r\n\r\n    const btn = document.getElementById('fix-code-btn');\r\n    const original = btn.innerHTML;\r\n    btn.innerHTML = '<i class=\"fa-solid fa-spinner fa-spin\"></i> Fixing...';\r\n    btn.disabled = true;\r\n\r\n    try {\r\n        await state.editor.getAction('editor.action.formatDocument').run();\r\n\r\n        const lang = state.files.get(state.activeFile)?.language || 'javascript';\r\n        let code = state.editor.getValue();\r\n        let fixCount = 0;\r\n\r\n        if (lang === 'javascript' || lang === 'typescript' || lang === 'html') {\r\n            const originalCode = code;\r\n\r\n            if (lang !== 'html') {\r\n                // Better var -> const logic (default to const, then let if reassigned? No, just use let for simplicity or const for objects)\r\n                const varRegex = /\\bvar\\s+([a-zA-Z0-9_$]+)\\s*=\\s*/g;\r\n                let match;\r\n                while ((match = varRegex.exec(code)) !== null) {\r\n                    fixCount++;\r\n                }\r\n                code = code.replace(varRegex, 'let $1 = ');\r\n\r\n                // Fix equality\r\n                const eqRegex = /([^=!])={2}([^=])/g;\r\n                while ((match = eqRegex.exec(code)) !== null) fixCount++;\r\n                code = code.replace(eqRegex, '$1===$2');\r\n\r\n                const neqRegex = /([^!])!={1}([^=])/g;\r\n                while ((match = neqRegex.exec(code)) !== null) fixCount++;\r\n                code = code.replace(neqRegex, '$1!==$2');\r\n\r\n                // Improved console.log removal (handles nested calls safely)\r\n                const logRegex = /console\\.log\\s*\\(\\s*(?:[^()]|\\([^()]*\\))*\\s*\\);?\\s*\\n?/g;\r\n                while ((match = logRegex.exec(code)) !== null) fixCount++;\r\n                code = code.replace(logRegex, '');\r\n\r\n                // Add missing semicolons (basic check)\r\n                const missingSemi = code.split('\\n').map(l => {\r\n                    const t = l.trim();\r\n                    if (t.length > 3 && !t.endsWith(';') && !t.endsWith('{') && !t.endsWith('}') && !t.endsWith(',') && !t.includes('//')) {\r\n                        fixCount++;\r\n                        return l + ';';\r\n                    }\r\n                    return l;\r\n                }).join('\\n');\r\n                code = missingSemi;\r\n            }\r\n\r\n            // Trim every line\r\n            code = code.split('\\n').map(l => l.trimEnd()).join('\\n');\r\n\r\n            // Ensure final newline\r\n            if (code.length > 0 && !code.endsWith('\\n')) {\r\n                code += '\\n';\r\n                fixCount++;\r\n            }\r\n\r\n            // Important: Use executeEdits to preserve Undo/Redo stack (Ctrl+Z)\r\n            if (code !== state.editor.getValue()) {\r\n                const model = state.editor.getModel();\r\n                state.editor.executeEdits('fix-code', [{\r\n                    range: model.getFullModelRange(),\r\n                    text: code,\r\n                    forceMoveMarkers: true\r\n                }]);\r\n\r\n                // Format again to clean up any messes we made\r\n                await state.editor.getAction('editor.action.formatDocument').run();\r\n            }\r\n        }\r\n\r\n        log('Applied ' + fixCount + ' smart fixes (Press Ctrl+Z to undo)', 'info');\r\n        if (window.Notify) Notify.success('Code Optimized', `${fixCount} improvements applied`);\r\n\r\n    } catch (err) {\r\n        log('Fix failed: ' + err.message, 'error');\r\n    } finally {\r\n        btn.innerHTML = original;\r\n        btn.disabled = false;\r\n        // Auto-refresh problems\r\n        showProblems(lintCode(state.editor.getValue(), state.files.get(state.activeFile)?.language));\r\n    }\r\n};\r\n\r\n\r\n// run it\r\ndocument.getElementById('open-tab-btn').onclick = async () => {\r\n    if (!state.activeFile || !state.files.has(state.activeFile)) return;\r\n\r\n    const btn = document.getElementById('open-tab-btn');\r\n    const original = btn.innerHTML;\r\n    btn.innerHTML = '<i class=\"fa-solid fa-spinner fa-spin\"></i> Running...';\r\n\r\n    try {\r\n        const data = state.files.get(state.activeFile);\r\n        let content = data.content;\r\n        const lang = data.language;\r\n\r\n        const escapeRegExp = (string) => string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\<head>');\r\n\r\n        if (lang === 'html') {\r\n            state.files.forEach((otherData, otherName) => {\r\n                const ext = otherName.split('.').pop().toLowerCase();\r\n                const escapedName = escapeRegExp(otherName);\r\n\r\n                // Match both \"name.js\" and \"./name.js\"\r\n                const patterns = [escapedName, `./${escapedName}`];\r\n\r\n                patterns.forEach(p => {\r\n                    const escapedP = escapeRegExp(p);\r\n                    if (ext === 'css') {\r\n                        const regex = new RegExp(`<link[^>]*href\\\\s*=\\\\s*([\"']?)${escapedP}\\\\1[^>]*>`, 'gi');\r\n                        content = content.replace(regex, `<style data-source=\"${otherName}\">\\n${otherData.content}\\n</style>`);\r\n                    } else if (ext === 'js') {\r\n                        const regex = new RegExp(`<script[^>]*src\\\\s*=\\\\s*([\"']?)${escapedP}\\\\1[^>]*><\\\\/script>`, 'gi');\r\n                        content = content.replace(regex, `<script data-source=\"${otherName}\">\\n${otherData.content.replace(/<\\/script>/g, '<\\\\/script>')}\\n<\\/script>`);\r\n                    }\r\n                });\r\n            });\r\n        } else if (lang === 'javascript') {\r\n            const safeCode = content.replace(/<\\/script>/g, '<\\\\/script>');\r\n            content = `<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n    <title>Preview: ${state.activeFile}</title>\r\n    <style>\r\n        body { background: #000; color: #fff; margin: 0; min-height: 100vh; font-family: system-ui, -apple-system, sans-serif; }\r\n        #phantom-runtime-error { background: #1a0505; border: 1px solid #450a0a; color: #ef4444; padding: 20px; margin: 20px; border-radius: 8px; font-family: monospace; white-space: pre-wrap; }\r\n    </style>\r\n</head>\r\n<body>\r\n    <div id=\"root\"></div>\r\n    <script>\r\n        window.onerror = function(msg, url, line, col, error) {\r\n            const el = document.createElement('div');\r\n            el.id = 'phantom-runtime-error';\r\n            el.innerHTML = '<strong>Runtime Error:</strong>\\\\n' + (error?.stack || msg);\r\n            document.body.appendChild(el);\r\n            return false;\r\n        };\r\n        try {\r\n            ${safeCode}\r\n        } catch (err) {\r\n            window.onerror(err.message, '', 0, 0, err);\r\n        }\r\n    <\\/script>\r\n</body>\r\n</html>`;\r\n        } else if (lang === 'css') {\r\n            content = `<!DOCTYPE html><html><head><style>${content}</style></head><body style=\"background:#0a0a0a;color:#e4e4e7;font-family:sans-serif;padding:40px;text-align:center;\">\r\n                <h1 style=\"color:var(--accent, #c084fc)\">CSS Live Preview</h1>\r\n                <p style=\"color:#71717a\">Reviewing: ${state.activeFile}</p>\r\n                <div style=\"margin-top:40px;padding:30px;border:1px solid #333;border-radius:12px;background:#111;max-width:600px;margin-inline:auto;\">\r\n                    <h2>Sample Header</h2>\r\n                    <p>This is a sample paragraph to see how your fonts and colors look.</p>\r\n                    <button style=\"padding:10px 20px;border-radius:6px;background:#c084fc;color:white;border:none;cursor:pointer;margin-top:10px;\">Sample Button</button>\r\n                    <div style=\"margin-top:20px;display:flex;gap:10px;justify-content:center;\">\r\n                        <div style=\"width:40px;height:40px;background:#3b82f6;border-radius:4px;\"></div>\r\n                        <div style=\"width:40px;height:40px;background:#10b981;border-radius:4px;\"></div>\r\n                        <div style=\"width:40px;height:40px;background:#f59e0b;border-radius:4px;\"></div>\r\n                    </div>\r\n                </div>\r\n            </body></html>`;\r\n        } else {\r\n            content = `<!DOCTYPE html><html><head><title>${state.activeFile}</title><style>body{background:#0a0a0a;color:#e4e4e7;font-family:monospace;padding:24px;line-height:1.5;white-space:pre-wrap;}</style></head><body>${content.replace(/</g, '&lt;').replace(/>/g, '&gt;')}</body></html>`;\r\n        }\r\n\r\n        // Use Blob URL for the most reliable preview across all browsers/configs\r\n        const blob = new Blob([content], { type: 'text/html' });\r\n        const url = URL.createObjectURL(blob);\r\n        const win = window.open(url, '_blank');\r\n\r\n        if (!win) {\r\n            throw new Error('Popup blocked! Please allow popups to see the preview.');\r\n        }\r\n\r\n        log('Project preview successfully launched', 'info');\r\n        if (window.Notify) Notify.success('Success', 'Preview opened in new tab');\r\n    } catch (err) {\r\n        log('Run failed: ' + err.message, 'error');\r\n        if (window.Notify) Notify.error('Preview Failed', err.message);\r\n    } finally {\r\n        btn.innerHTML = original;\r\n    }\r\n};\r\n\r\ndocument.getElementById('save-btn').onclick = () => {\r\n    if (!state.activeFile) return;\r\n\r\n    const content = state.files.get(state.activeFile).content;\r\n    const blob = new Blob([content], { type: 'text/plain' });\r\n    const a = document.createElement('a');\r\n    a.href = URL.createObjectURL(blob);\r\n    a.download = state.activeFile;\r\n    a.click();\r\n\r\n    log('Downloaded: ' + state.activeFile, 'info');\r\n    if (window.Notify) Notify.success('Saved', state.activeFile + ' downloaded');\r\n};\r\n\r\ndocument.getElementById('export-btn').onclick = async () => {\r\n    if (typeof JSZip === 'undefined') {\r\n        if (window.Notify) Notify.error('Error', 'JSZip not loaded');\r\n        return;\r\n    }\r\n\r\n    const zip = new JSZip();\r\n    state.files.forEach((data, name) => zip.file(name, data.content));\r\n\r\n    try {\r\n        const blob = await zip.generateAsync({ type: 'blob' });\r\n        const a = document.createElement('a');\r\n        a.href = URL.createObjectURL(blob);\r\n        a.download = 'project.zip';\r\n        a.click();\r\n        log('Exported project.zip', 'info');\r\n        if (window.Notify) Notify.success('Exported', 'Project downloaded');\r\n    } catch (err) {\r\n        log('Export failed: ' + err.message, 'error');\r\n    }\r\n};\r\n\r\n// keys\r\ndocument.addEventListener('keydown', e => {\r\n    if (e.ctrlKey && e.key === 's') {\r\n        e.preventDefault();\r\n        document.getElementById('save-btn').click();\r\n    }\r\n    if (e.ctrlKey && e.shiftKey && e.key === 'F') {\r\n        e.preventDefault();\r\n        document.getElementById('fix-code-btn').click();\r\n    }\r\n});\r\n\r\nrenderFiles();\r\nrenderTabs();\r\nif (window.Settings) Settings.apply();\r\n\n</script>\r\n    <script>\n// footer\r\n(function () {\r\n    'use strict';\r\n\r\n    let rootPrefix = '';\r\n    const scriptName = 'components/footer.js';\r\n    const scripts = document.getElementsByTagName('script');\r\n    for (let i = 0; i < scripts.length; i++) {\r\n        const src = scripts[i].getAttribute('src');\r\n        if (src && src.includes(scriptName)) {\r\n            rootPrefix = src.split(scriptName)[0];\r\n            break;\r\n        }\r\n    }\r\n\r\n    const config = window.SITE_CONFIG || { name: 'Phantom', version: '1.0.0', discord: { inviteUrl: '#' }, changelog: [], cloakPresets: [] };\r\n    const STORAGE_KEY = 'void_settings';\r\n    let storedSettings = {};\r\n    try { storedSettings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n\r\n    // settings\r\n    let settings = { ...(config.defaults || {}), ...storedSettings };\r\n\r\n    const footer = document.createElement('footer');\r\n    footer.id = 'site-footer';\r\n    footer.innerHTML = `\r\n        <style>\r\n            #site-footer {\r\n                margin-top: 0px;\r\n                padding: 20px;\r\n                border-top: 1px solid var(--border, #1f1f1f);\r\n                text-align: center;\r\n                background: transparent;\r\n            }\r\n            #site-footer .footer-links {\r\n                display: flex;\r\n                gap: 16px;\r\n                justify-content: center;\r\n                margin-bottom: 8px;\r\n                flex-wrap: wrap;\r\n            }\r\n            #site-footer .footer-link {\r\n                font-size: 12px;\r\n                color: var(--text-muted, #71717a);\r\n                text-decoration: none;\r\n                transition: color 0.15s;\r\n                font-family: 'Inter', sans-serif;\r\n                cursor: pointer;\r\n            }\r\n            #site-footer .footer-link:hover {\r\n                color: var(--text, #e4e4e7);\r\n            }\r\n            #site-footer .footer-version {\r\n                font-size: 11px;\r\n                color: var(--text-dim, #52525b);\r\n                cursor: pointer;\r\n                font-family: 'Inter', sans-serif;\r\n            }\r\n            #site-footer .footer-version:hover {\r\n                color: var(--text-muted, #71717a);\r\n            }\r\n        </style>\r\n        <div class=\"footer-links\">\r\n            <a href=\"${rootPrefix}pages/settings.html\" class=\"footer-link\"><i class=\"fa-solid fa-gear\"></i> Settings</a>\r\n            <a id=\"footer-changelog\" class=\"footer-link\"><i class=\"fa-solid fa-clock-rotate-left\"></i> Changelog</a>\r\n            <a href=\"${config.discord?.inviteUrl || '#'}\" target=\"_blank\" class=\"footer-link\"><i class=\"fa-brands fa-discord\"></i> Discord</a>\r\n            <a href=\"${rootPrefix}pages/terms.html\" class=\"footer-link\">Terms</a>\r\n            <a href=\"${rootPrefix}pages/disclaimer.html\" class=\"footer-link\">Disclaimer</a>\r\n            <a href=\"${rootPrefix}pages/extra.html\" class=\"footer-link\">Credits</a>\r\n        </div>\r\n        <span class=\"footer-version\" id=\"footer-version\">${config.name || 'Phantom'} v${config.version || '1.0.0'}</span>\r\n    `;\r\n\r\n    document.body.appendChild(footer);\r\n\r\n\r\n\r\n    // gtm\r\n    // Inject GTM head script if not already present\r\n    if (!document.querySelector('script[src*=\"googletagmanager.com/gtm.js\"]')) {\r\n        window.dataLayer = window.dataLayer || [];\r\n        window.dataLayer.push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' });\r\n        const gtmScript = document.createElement('script');\r\n        gtmScript.async = true;\r\n        gtmScript.src = 'https://www.googletagmanager.com/gtm.js?id=GTM-5LMBC27Z';\r\n        document.head.insertBefore(gtmScript, document.head.firstChild);\r\n    }\r\n\r\n    // Add GTM noscript fallback (for pages that don't have it in HTML)\r\n    if (!document.querySelector('noscript iframe[src*=\"googletagmanager\"]')) {\r\n        const gtmNoscript = document.createElement('noscript');\r\n        gtmNoscript.innerHTML = '<iframe src=\"https://www.googletagmanager.com/ns.html?id=GTM-5LMBC27Z\" height=\"0\" width=\"0\" style=\"display:none;visibility:hidden\"></iframe>';\r\n        document.body.insertBefore(gtmNoscript, document.body.firstChild);\r\n    }\r\n\r\n    const openChangelog = (e, customTitle, customContent) => {\r\n        if (e && e.preventDefault) e.preventDefault();\r\n        const changes = customContent || config.changelog || ['No changes listed'];\r\n\r\n        // Use standard modal structure from main.css\r\n        const overlay = document.createElement('div');\r\n        overlay.className = 'modal-overlay';\r\n\r\n        overlay.innerHTML = `\r\n            <div class=\"modal\" style=\"width: 400px; max-width: 90vw;\">\r\n                <div class=\"modal-header\">\r\n                    <h3 class=\"modal-title\">${customTitle || 'What\\'s New in v' + config.version}</h3>\r\n                    <button class=\"modal-close\"><i class=\"fa-solid fa-xmark\"></i></button>\r\n                </div>\r\n                <div class=\"modal-body\">\r\n                    <ul style=\"margin: 0; padding-left: 20px; color: var(--text-muted); font-size: 0.875rem; line-height: 1.6;\">\r\n                        ${changes.map(c => '<li>' + c + '</li>').join('')}\r\n                    </ul>\r\n                </div>\r\n                <div class=\"modal-footer\">\r\n                    <a href=\"${config.discord?.inviteUrl || '#'}\" target=\"_blank\" style=\"color: #5865F2; text-decoration: none; font-size: 13px; display: inline-flex; align-items: center; gap: 6px;\">\r\n                        <i class=\"fa-brands fa-discord\"></i> Join Discord\r\n                    </a>\r\n                </div>\r\n            </div>\r\n        `;\r\n\r\n        document.body.appendChild(overlay);\r\n\r\n        // Trigger animation\r\n        requestAnimationFrame(() => overlay.classList.add('show'));\r\n\r\n        const close = () => {\r\n            overlay.classList.remove('show');\r\n            setTimeout(() => overlay.remove(), 200);\r\n        };\r\n\r\n        overlay.querySelector('.modal-close').onclick = close;\r\n        overlay.onclick = (e) => { if (e.target === overlay) close(); };\r\n    };\r\n\r\n    // Expose openChangelog globally\r\n    window.openChangelog = openChangelog;\r\n\r\n    const changelogBtn = document.getElementById('footer-changelog');\r\n    if (changelogBtn) changelogBtn.onclick = openChangelog;\r\n\r\n    const versionBtn = document.getElementById('footer-version');\r\n    if (versionBtn) versionBtn.onclick = openChangelog;\r\n\r\n    // sync\r\n    // syncRemoteChangelog removed - using local config\r\n\r\n\r\n    // Initialize Sync\r\n    // syncRemoteChangelog();\r\n\r\n    const currentVersion = config.version;\r\n    const lastVersion = settings.lastVersion;\r\n\r\n    if (settings.showChangelogOnUpdate && lastVersion && lastVersion !== currentVersion) {\r\n        setTimeout(() => {\r\n            openChangelog();\r\n            settings.lastVersion = currentVersion;\r\n            localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n        }, 1000);\r\n    } else if (!lastVersion) {\r\n        settings.lastVersion = currentVersion;\r\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n    }\r\n\r\n    // panic\r\n    if (settings.panicKey) {\r\n        document.addEventListener('keydown', (e) => {\r\n            const keys = settings.panicModifiers || ['ctrl', 'shift'];\r\n            const triggerKey = settings.panicKey.toLowerCase();\r\n            const pressedKey = e.key.toLowerCase();\r\n\r\n            // Check modifiers\r\n            const ctrlMatch = keys.includes('ctrl') === e.ctrlKey;\r\n            const shiftMatch = keys.includes('shift') === e.shiftKey;\r\n            const altMatch = keys.includes('alt') === e.altKey;\r\n\r\n            if (ctrlMatch && shiftMatch && altMatch && pressedKey === triggerKey) {\r\n                e.preventDefault();\r\n\r\n                // Show white screen instantly (if panic-overlay exists in parent)\r\n                const parentOverlay = window.parent?.document?.getElementById('panic-overlay');\r\n                if (parentOverlay) {\r\n                    parentOverlay.style.display = 'block';\r\n                } else {\r\n                    // Create overlay if it doesn't exist\r\n                    const overlay = document.createElement('div');\r\n                    overlay.id = 'panic-overlay';\r\n                    overlay.style.cssText = 'position:fixed;inset:0;background:white;z-index:99999;';\r\n                    document.body.appendChild(overlay);\r\n                }\r\n\r\n                // Redirect immediately\r\n                const url = settings.panicUrl || 'https://classroom.google.com';\r\n                try { window.top.location.href = url; } catch { window.location.href = url; }\r\n            }\r\n        }, true); // Use capture phase for faster response\r\n    }\r\n\r\n    // Cloaking logic has been moved to scripts/cloaking.js for better synchronization.\r\n    // If you need cloaking on a specific page, include that script.\r\n\r\n\r\n    window.addEventListener('beforeunload', (e) => {\r\n        // Reload settings to get latest value\r\n        try { settings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n\r\n        if (window.top === window.self && settings.leaveConfirmation) {\r\n            e.preventDefault();\r\n            e.returnValue = '';\r\n            return '';\r\n        }\r\n    });\r\n\r\n    // discord\r\n    let crateInstance = null;\r\n\r\n    function initDiscord() {\r\n        if (settings.discordWidget && config.discord && config.discord.widgetServer && config.discord.widgetChannel) {\r\n            // Check if already loaded\r\n            if (document.querySelector('script[src*=\"@widgetbot/crate\"]')) {\r\n                if (crateInstance) crateInstance.show();\r\n                return;\r\n            }\r\n\r\n            const crateScript = document.createElement('script');\r\n            crateScript.src = 'https://cdn.jsdelivr.net/npm/@widgetbot/crate@3';\r\n            crateScript.async = true;\r\n            crateScript.defer = true;\r\n            crateScript.onload = () => {\r\n                crateInstance = new Crate({\r\n                    server: config.discord.widgetServer,\r\n                    channel: config.discord.widgetChannel,\r\n                    glyph: ['https://cdn.discordapp.com/embed/avatars/0.png', '100%'],\r\n                    location: ['bottom', 'right']\r\n                });\r\n            };\r\n            document.body.appendChild(crateScript);\r\n        } else {\r\n            // Hide if disabled\r\n            if (crateInstance) crateInstance.hide();\r\n        }\r\n    }\r\n\r\n    // Initialize\r\n    initDiscord();\r\n\r\n    // Listen for settings change to toggle dynamically\r\n    window.addEventListener('storage', (e) => {\r\n        if (e.key === STORAGE_KEY) {\r\n            try { settings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n            initDiscord();\r\n        }\r\n    });\r\n\r\n    // Listen for internal event\r\n    window.addEventListener('settings-changed', (e) => {\r\n        settings = e.detail;\r\n        initDiscord();\r\n    });\r\n\r\n    // counters\r\n    // Only show on home page (index2.html) checking if main-content exists\r\n    const mainContent = document.querySelector('.main-content');\r\n    // Ensure we are on the home page view (search bar checks etc) or just check existence\r\n    if (mainContent && document.querySelector('.featured-section')) {\r\n        const counterContainer = document.createElement('div');\r\n        counterContainer.id = 'supercounters-wrapper';\r\n        counterContainer.style.marginTop = '24px';\r\n        counterContainer.style.textAlign = 'center';\r\n        counterContainer.style.opacity = '0.8';\r\n\r\n        // Use iframe to isolate document.write from the widget\r\n        const iframe = document.createElement('iframe');\r\n        iframe.style.border = 'none';\r\n        iframe.style.width = '150px';\r\n        iframe.style.height = '40px';\r\n        iframe.style.overflow = 'hidden';\r\n\r\n        // Widget code\r\n        const widgetCode = `\r\n            <html>\r\n            <body style=\"margin:0;display:flex;justify-content:center;align-items:center;background:transparent;\">\r\n                <script type=\"text/javascript\" src=\"//widget.supercounters.com/ssl/online_i.js\"><\\/script>\r\n                <script type=\"text/javascript\">sc_online_i(1726449,\"ffffff\",\"000000\");<\\/script>\r\n            </body>\r\n            </html>\r\n        `;\r\n\r\n        iframe.srcdoc = widgetCode;\r\n        counterContainer.appendChild(iframe);\r\n        mainContent.appendChild(counterContainer);\r\n    }\r\n})();\r\n\n</script>\r\n</body>\r\n\r\n</html>","pages/disclaimer.html":"<!DOCTYPE html>\r\n<html lang=\"en\">\r\n\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n    <title>Disclaimer - Phantom</title>\r\n    <link rel=\"icon\" href=\"../favicon.svg\" type=\"image/svg+xml\">\r\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css\">\r\n    <style>\n/* phantom styling */\r\n\r\n@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');\r\n\r\n/* variables */\r\n:root {\r\n    /* Core colors (can be overridden by user settings) */\r\n    --bg: #0a0a0a;\r\n    --surface: #0f0f0f;\r\n    --surface-hover: #1a1a1a;\r\n    --surface-active: #252525;\r\n    --border: #1f1f1f;\r\n    --border-light: #2a2a2a;\r\n\r\n    /* Text */\r\n    --text: #e4e4e7;\r\n    --text-muted: #71717a;\r\n    --text-dim: #52525b;\r\n\r\n    /* Accent (customizable) */\r\n    --accent: #ffffff;\r\n    --accent-dim: rgba(255, 255, 255, 0.8);\r\n    --accent-glow: rgba(255, 255, 255, 0.1);\r\n\r\n    /* Status colors */\r\n    --success: #22c55e;\r\n    --warning: #f59e0b;\r\n    --error: #ef4444;\r\n    --info: #3b82f6;\r\n\r\n    /* Shadows */\r\n    --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.3);\r\n    --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.4);\r\n    --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.5);\r\n    --shadow-xl: 0 16px 48px rgba(0, 0, 0, 0.6);\r\n\r\n    /* Spacing */\r\n    --space-xs: 4px;\r\n    --space-sm: 8px;\r\n    --space-md: 16px;\r\n    --space-lg: 24px;\r\n    --space-xl: 32px;\r\n    --space-2xl: 48px;\r\n\r\n    /* Border radius */\r\n    --radius-sm: 4px;\r\n    --radius-md: 8px;\r\n    --radius-lg: 12px;\r\n    --radius-xl: 16px;\r\n    --radius-full: 9999px;\r\n\r\n    /* Transitions */\r\n    --transition-fast: 0.1s ease;\r\n    --transition-normal: 0.2s ease;\r\n    --transition-slow: 0.3s ease;\r\n\r\n    /* Z-index layers */\r\n    --z-base: 1;\r\n    --z-dropdown: 100;\r\n    --z-sticky: 500;\r\n    --z-modal: 1000;\r\n    --z-toast: 2000;\r\n    --z-max: 9999;\r\n\r\n    /* Typography */\r\n    --font-sans: 'Inter', system-ui, -apple-system, sans-serif;\r\n    --font-mono: 'JetBrains Mono', 'Fira Code', monospace;\r\n\r\n    /* Background (customizable) */\r\n    --bg-image: none;\r\n}\r\n\r\n/* base */\r\n*,\r\n*::before,\r\n*::after {\r\n    box-sizing: border-box;\r\n    margin: 0;\r\n    padding: 0;\r\n}\r\n\r\nhtml {\r\n    font-size: 16px;\r\n    scroll-behavior: smooth;\r\n    -webkit-font-smoothing: antialiased;\r\n    -moz-osx-font-smoothing: grayscale;\r\n}\r\n\r\nbody {\r\n    font-family: var(--font-sans);\r\n    background: var(--bg);\r\n    background-image: var(--bg-image);\r\n    background-size: cover;\r\n    background-position: var(--bg-image-position, center);\r\n    background-attachment: fixed;\r\n    color: var(--text);\r\n    line-height: 1.5;\r\n    min-height: 100vh;\r\n    overflow-x: hidden;\r\n}\r\n\r\n/* Ensure background manager takes precedence */\r\nhtml.phantom-bg-active body {\r\n    background: transparent !important;\r\n    background-image: none !important;\r\n}\r\n\r\n/* Selection */\r\n::selection {\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n}\r\n\r\n/* Focus states */\r\n:focus-visible {\r\n    outline: 2px solid var(--accent);\r\n    outline-offset: 2px;\r\n}\r\n\r\n/* Links */\r\na {\r\n    color: var(--accent);\r\n    text-decoration: none;\r\n    transition: opacity var(--transition-fast);\r\n}\r\n\r\na:hover {\r\n    opacity: 0.8;\r\n}\r\n\r\n/* Scrollbar */\r\n::-webkit-scrollbar {\r\n    width: 8px;\r\n    height: 8px;\r\n}\r\n\r\n::-webkit-scrollbar-track {\r\n    background: var(--surface);\r\n}\r\n\r\n::-webkit-scrollbar-thumb {\r\n    background: var(--border-light);\r\n    border-radius: var(--radius-full);\r\n}\r\n\r\n::-webkit-scrollbar-thumb:hover {\r\n    background: var(--text-muted);\r\n}\r\n\r\n/* text */\r\nh1,\r\nh2,\r\nh3,\r\nh4,\r\nh5,\r\nh6 {\r\n    font-weight: 600;\r\n    line-height: 1.2;\r\n    color: var(--text);\r\n}\r\n\r\nh1 {\r\n    font-size: 2.5rem;\r\n}\r\n\r\nh2 {\r\n    font-size: 2rem;\r\n}\r\n\r\nh3 {\r\n    font-size: 1.5rem;\r\n}\r\n\r\nh4 {\r\n    font-size: 1.25rem;\r\n}\r\n\r\nh5 {\r\n    font-size: 1rem;\r\n}\r\n\r\nh6 {\r\n    font-size: 0.875rem;\r\n}\r\n\r\np {\r\n    color: var(--text-muted);\r\n    line-height: 1.6;\r\n}\r\n\r\n.text-sm {\r\n    font-size: 0.875rem;\r\n}\r\n\r\n.text-xs {\r\n    font-size: 0.75rem;\r\n}\r\n\r\n.text-lg {\r\n    font-size: 1.125rem;\r\n}\r\n\r\n.text-muted {\r\n    color: var(--text-muted);\r\n}\r\n\r\n.text-dim {\r\n    color: var(--text-dim);\r\n}\r\n\r\n.text-center {\r\n    text-align: center;\r\n}\r\n\r\n/* buttons */\r\n.btn {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    gap: var(--space-sm);\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-family: var(--font-sans);\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-md);\r\n    background: var(--surface);\r\n    color: var(--text);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n    white-space: nowrap;\r\n}\r\n\r\n.btn:hover {\r\n    background: var(--surface-hover);\r\n    border-color: var(--border-light);\r\n}\r\n\r\n.btn:active {\r\n    background: var(--surface-active);\r\n    transform: scale(0.98);\r\n}\r\n\r\n.btn-primary {\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n    border-color: var(--accent);\r\n}\r\n\r\n.btn-primary:hover {\r\n    opacity: 0.9;\r\n    background: var(--accent);\r\n}\r\n\r\n.btn-ghost {\r\n    background: transparent;\r\n    border-color: transparent;\r\n}\r\n\r\n.btn-ghost:hover {\r\n    background: var(--surface-hover);\r\n}\r\n\r\n.btn-icon {\r\n    width: 36px;\r\n    height: 36px;\r\n    padding: 0;\r\n    border-radius: var(--radius-md);\r\n}\r\n\r\n.btn-sm {\r\n    padding: var(--space-xs) var(--space-sm);\r\n    font-size: 0.75rem;\r\n}\r\n\r\n.btn-lg {\r\n    padding: var(--space-md) var(--space-lg);\r\n    font-size: 1rem;\r\n}\r\n\r\n/* inputs */\r\n.input {\r\n    width: 100%;\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-family: var(--font-sans);\r\n    font-size: 0.875rem;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-md);\r\n    color: var(--text);\r\n    transition: border-color var(--transition-fast);\r\n}\r\n\r\n.input:hover {\r\n    border-color: var(--border-light);\r\n}\r\n\r\n.input:focus {\r\n    outline: none;\r\n    border-color: var(--accent);\r\n}\r\n\r\n.input::placeholder {\r\n    color: var(--text-dim);\r\n}\r\n\r\n.input-group {\r\n    display: flex;\r\n    gap: var(--space-sm);\r\n}\r\n\r\n.input-group .input {\r\n    flex: 1;\r\n}\r\n\r\n/* Select */\r\n.select {\r\n    appearance: none;\r\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%2371717a' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E\");\r\n    background-repeat: no-repeat;\r\n    background-position: right 12px center;\r\n    padding-right: 36px;\r\n    cursor: pointer;\r\n}\r\n\r\n/* Checkbox/Toggle */\r\n.toggle {\r\n    position: relative;\r\n    width: 44px;\r\n    height: 24px;\r\n    background: var(--border);\r\n    border-radius: var(--radius-full);\r\n    cursor: pointer;\r\n    transition: background var(--transition-fast);\r\n}\r\n\r\n.toggle::after {\r\n    content: '';\r\n    position: absolute;\r\n    top: 2px;\r\n    left: 2px;\r\n    width: 20px;\r\n    height: 20px;\r\n    background: var(--text);\r\n    border-radius: 50%;\r\n    transition: transform var(--transition-fast);\r\n}\r\n\r\n.toggle.active {\r\n    background: var(--accent);\r\n}\r\n\r\n.toggle.active::after {\r\n    transform: translateX(20px);\r\n    background: var(--bg);\r\n}\r\n\r\n/* cards */\r\n.card {\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-lg);\r\n    overflow: hidden;\r\n    transition: all var(--transition-normal);\r\n}\r\n\r\n.card:hover {\r\n    border-color: var(--border-light);\r\n    box-shadow: var(--shadow-md);\r\n}\r\n\r\n.card-header {\r\n    padding: var(--space-md);\r\n    border-bottom: 1px solid var(--border);\r\n}\r\n\r\n.card-body {\r\n    padding: var(--space-md);\r\n}\r\n\r\n.card-footer {\r\n    padding: var(--space-md);\r\n    border-top: 1px solid var(--border);\r\n}\r\n\r\n\r\n/* Featured badge */\r\n.badge-featured {\r\n    position: absolute;\r\n    top: var(--space-sm);\r\n    left: var(--space-sm);\r\n    padding: var(--space-xs) var(--space-sm);\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n    font-size: 0.625rem;\r\n    font-weight: 700;\r\n    text-transform: uppercase;\r\n    letter-spacing: 0.05em;\r\n    border-radius: var(--radius-sm);\r\n}\r\n\r\n/* Favorite star */\r\n.favorite-btn {\r\n    position: absolute;\r\n    top: var(--space-sm);\r\n    right: var(--space-sm);\r\n    width: 32px;\r\n    height: 32px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background: rgba(0, 0, 0, 0.5);\r\n    border: none;\r\n    border-radius: 50%;\r\n    color: var(--text-muted);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n    opacity: 0;\r\n}\r\n\r\n.media-card:hover .favorite-btn {\r\n    opacity: 1;\r\n}\r\n\r\n.favorite-btn:hover {\r\n    background: rgba(0, 0, 0, 0.7);\r\n    color: var(--text);\r\n}\r\n\r\n.favorite-btn.active {\r\n    color: #fbbf24;\r\n    opacity: 1;\r\n}\r\n\r\n/* grid */\r\n.grid {\r\n    display: grid;\r\n    gap: var(--space-md);\r\n}\r\n\r\n.grid-cols-2 {\r\n    grid-template-columns: repeat(2, 1fr);\r\n}\r\n\r\n.grid-cols-3 {\r\n    grid-template-columns: repeat(3, 1fr);\r\n}\r\n\r\n.grid-cols-4 {\r\n    grid-template-columns: repeat(4, 1fr);\r\n}\r\n\r\n.grid-cols-5 {\r\n    grid-template-columns: repeat(5, 1fr);\r\n}\r\n\r\n.grid-cols-6 {\r\n    grid-template-columns: repeat(6, 1fr);\r\n}\r\n\r\n/* Auto-fit grid for responsive cards */\r\n.grid-auto {\r\n    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));\r\n}\r\n\r\n.grid-auto-lg {\r\n    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\r\n}\r\n\r\n/* flex */\r\n.flex {\r\n    display: flex;\r\n}\r\n\r\n.flex-col {\r\n    flex-direction: column;\r\n}\r\n\r\n.flex-wrap {\r\n    flex-wrap: wrap;\r\n}\r\n\r\n.items-center {\r\n    align-items: center;\r\n}\r\n\r\n.items-start {\r\n    align-items: flex-start;\r\n}\r\n\r\n.items-end {\r\n    align-items: flex-end;\r\n}\r\n\r\n.justify-center {\r\n    justify-content: center;\r\n}\r\n\r\n.justify-between {\r\n    justify-content: space-between;\r\n}\r\n\r\n.justify-end {\r\n    justify-content: flex-end;\r\n}\r\n\r\n.gap-xs {\r\n    gap: var(--space-xs);\r\n}\r\n\r\n.gap-sm {\r\n    gap: var(--space-sm);\r\n}\r\n\r\n.gap-md {\r\n    gap: var(--space-md);\r\n}\r\n\r\n.gap-lg {\r\n    gap: var(--space-lg);\r\n}\r\n\r\n.flex-1 {\r\n    flex: 1;\r\n}\r\n\r\n/* spacing */\r\n.p-xs {\r\n    padding: var(--space-xs);\r\n}\r\n\r\n.p-sm {\r\n    padding: var(--space-sm);\r\n}\r\n\r\n.p-md {\r\n    padding: var(--space-md);\r\n}\r\n\r\n.p-lg {\r\n    padding: var(--space-lg);\r\n}\r\n\r\n.p-xl {\r\n    padding: var(--space-xl);\r\n}\r\n\r\n.m-xs {\r\n    margin: var(--space-xs);\r\n}\r\n\r\n.m-sm {\r\n    margin: var(--space-sm);\r\n}\r\n\r\n.m-md {\r\n    margin: var(--space-md);\r\n}\r\n\r\n.m-lg {\r\n    margin: var(--space-lg);\r\n}\r\n\r\n.mt-sm {\r\n    margin-top: var(--space-sm);\r\n}\r\n\r\n.mt-md {\r\n    margin-top: var(--space-md);\r\n}\r\n\r\n.mt-lg {\r\n    margin-top: var(--space-lg);\r\n}\r\n\r\n.mb-sm {\r\n    margin-bottom: var(--space-sm);\r\n}\r\n\r\n.mb-md {\r\n    margin-bottom: var(--space-md);\r\n}\r\n\r\n.mb-lg {\r\n    margin-bottom: var(--space-lg);\r\n}\r\n\r\n/* modals */\r\n.modal-overlay {\r\n    position: fixed;\r\n    inset: 0;\r\n    background: rgba(0, 0, 0, 0.8);\r\n    backdrop-filter: blur(4px);\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    z-index: var(--z-modal);\r\n    opacity: 0;\r\n    visibility: hidden;\r\n    transition: all var(--transition-normal);\r\n}\r\n\r\n.modal-overlay.show {\r\n    opacity: 1;\r\n    visibility: visible;\r\n}\r\n\r\n.modal {\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-xl);\r\n    max-width: 90vw;\r\n    max-height: 90vh;\r\n    overflow: hidden;\r\n    transform: scale(0.95);\r\n    transition: transform var(--transition-normal);\r\n}\r\n\r\n.modal-overlay.show .modal {\r\n    transform: scale(1);\r\n}\r\n\r\n.modal-header {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    padding: var(--space-md);\r\n    border-bottom: 1px solid var(--border);\r\n}\r\n\r\n.modal-title {\r\n    font-size: 1rem;\r\n    font-weight: 600;\r\n}\r\n\r\n.modal-close {\r\n    width: 32px;\r\n    height: 32px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background: transparent;\r\n    border: none;\r\n    color: var(--text-muted);\r\n    cursor: pointer;\r\n    border-radius: var(--radius-md);\r\n    transition: all var(--transition-fast);\r\n}\r\n\r\n.modal-close:hover {\r\n    background: var(--surface-hover);\r\n    color: var(--text);\r\n}\r\n\r\n.modal-body {\r\n    padding: var(--space-md);\r\n    overflow-y: auto;\r\n}\r\n\r\n.modal-footer {\r\n    display: flex;\r\n    justify-content: flex-end;\r\n    gap: var(--space-sm);\r\n    padding: var(--space-md);\r\n    border-top: 1px solid var(--border);\r\n}\r\n\r\n/* tabs */\r\n.tabs {\r\n    display: flex;\r\n    gap: 2px;\r\n    background: var(--surface);\r\n    padding: var(--space-xs);\r\n    border-radius: var(--radius-md);\r\n    border: 1px solid var(--border);\r\n}\r\n\r\n.tab {\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    color: var(--text-muted);\r\n    background: transparent;\r\n    border: none;\r\n    border-radius: var(--radius-sm);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n}\r\n\r\n.tab:hover {\r\n    color: var(--text);\r\n}\r\n\r\n.tab.active {\r\n    background: var(--surface-hover);\r\n    color: var(--text);\r\n}\r\n\r\n/* search */\r\n\r\n/* ============================================\r\n   OFFLINE INDICATOR\r\n   ============================================ */\r\n.offline-banner {\r\n    position: fixed;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    padding: var(--space-sm) var(--space-md);\r\n    background: var(--warning);\r\n    color: var(--bg);\r\n    text-align: center;\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    z-index: var(--z-toast);\r\n    transform: translateY(-100%);\r\n    transition: transform var(--transition-normal);\r\n}\r\n\r\n.offline-banner.show {\r\n    transform: translateY(0);\r\n}\r\n\r\n.offline-badge {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    gap: var(--space-xs);\r\n    padding: var(--space-xs) var(--space-sm);\r\n    background: var(--warning);\r\n    color: var(--bg);\r\n    font-size: 0.625rem;\r\n    font-weight: 600;\r\n    text-transform: uppercase;\r\n    border-radius: var(--radius-sm);\r\n}\r\n\r\n/* ============================================\r\n   LOADING STATES\r\n   ============================================ */\r\n.skeleton {\r\n    background: linear-gradient(90deg, var(--surface) 0%, var(--surface-hover) 50%, var(--surface) 100%);\r\n    background-size: 200% 100%;\r\n    animation: shimmer 1.5s infinite;\r\n    border-radius: var(--radius-md);\r\n}\r\n\r\n@keyframes shimmer {\r\n    0% {\r\n        background-position: 200% 0;\r\n    }\r\n\r\n    100% {\r\n        background-position: -200% 0;\r\n    }\r\n}\r\n\r\n.spinner {\r\n    width: 24px;\r\n    height: 24px;\r\n    border: 2px solid var(--border);\r\n    border-top-color: var(--accent);\r\n    border-radius: 50%;\r\n    animation: spin 0.8s linear infinite;\r\n}\r\n\r\n@keyframes spin {\r\n    to {\r\n        transform: rotate(360deg);\r\n    }\r\n}\r\n\r\n/* ============================================\r\n   ANIMATIONS\r\n   ============================================ */\r\n@keyframes fadeIn {\r\n    from {\r\n        opacity: 0;\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n    }\r\n}\r\n\r\n@keyframes slideUp {\r\n    from {\r\n        opacity: 0;\r\n        transform: translateY(10px);\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n        transform: translateY(0);\r\n    }\r\n}\r\n\r\n@keyframes scaleIn {\r\n    from {\r\n        opacity: 0;\r\n        transform: scale(0.95);\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n        transform: scale(1);\r\n    }\r\n}\r\n\r\n.animate-fadeIn {\r\n    animation: fadeIn var(--transition-normal) ease;\r\n}\r\n\r\n.animate-slideUp {\r\n    animation: slideUp var(--transition-normal) ease;\r\n}\r\n\r\n.animate-scaleIn {\r\n    animation: scaleIn var(--transition-normal) ease;\r\n}\r\n\r\n/* ============================================\r\n   UTILITIES\r\n   ============================================ */\r\n.hidden {\r\n    display: none !important;\r\n}\r\n\r\n.sr-only {\r\n    position: absolute;\r\n    width: 1px;\r\n    height: 1px;\r\n    padding: 0;\r\n    margin: -1px;\r\n    overflow: hidden;\r\n    clip: rect(0, 0, 0, 0);\r\n    border: 0;\r\n}\r\n\r\n.truncate {\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n}\r\n\r\n.w-full {\r\n    width: 100%;\r\n}\r\n\r\n.h-full {\r\n    height: 100%;\r\n}\r\n\r\n.relative {\r\n    position: relative;\r\n}\r\n\r\n.absolute {\r\n    position: absolute;\r\n}\r\n\r\n.fixed {\r\n    position: fixed;\r\n}\r\n\r\n.inset-0 {\r\n    inset: 0;\r\n}\r\n\r\n/* ============================================\r\n   RESPONSIVE\r\n   ============================================ */\r\n@media (max-width: 768px) {\r\n    h1 {\r\n        font-size: 1.75rem;\r\n    }\r\n\r\n    h2 {\r\n        font-size: 1.5rem;\r\n    }\r\n\r\n    h3 {\r\n        font-size: 1.25rem;\r\n    }\r\n\r\n    .grid-auto {\r\n        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));\r\n    }\r\n\r\n    .hide-mobile {\r\n        display: none !important;\r\n    }\r\n}\r\n\r\n@media (min-width: 769px) {\r\n    .hide-desktop {\r\n        display: none !important;\r\n    }\r\n}\n</style>\r\n    <style>\n/* Topbar Styles - Clean & Dark */\r\n/* Note: Inter font is imported in main.css */\r\n\r\nbody {\r\n    margin: 0;\r\n    padding: 0;\r\n    background-color: var(--bg);\r\n    font-family: 'Inter', sans-serif;\r\n}\r\n\r\n#topbar-container {\r\n    position: fixed;\r\n    top: 11px;\r\n    left: 50%;\r\n    transform: translateX(-50%);\r\n    background-color: var(--surface);\r\n    border-radius: 9999px;\r\n    padding: 8px 14px;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 10px;\r\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);\r\n    z-index: 10000;\r\n    border: 1px solid var(--border);\r\n    height: 48px;\r\n    box-sizing: border-box;\r\n}\r\n\r\n#topbar-container::before {\r\n    content: '';\r\n    position: absolute;\r\n    top: -7px;\r\n    bottom: -7px;\r\n    left: -7px;\r\n    right: -7px;\r\n    z-index: -1;\r\n    border-radius: 9999px;\r\n}\r\n\r\n.logo-section {\r\n    display: flex;\r\n    align-items: center;\r\n    padding-right: 10px;\r\n    border-right: 1px solid var(--border);\r\n    height: 32px;\r\n    text-decoration: none;\r\n    color: inherit;\r\n}\r\n\r\n.logo-placeholder {\r\n    width: 28px;\r\n    height: 28px;\r\n    background-color: var(--surface-hover);\r\n    border-radius: 6px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    color: var(--text-muted);\r\n}\r\n\r\n.logo-placeholder i,\r\n.logo-placeholder svg {\r\n    width: 16px;\r\n    height: 16px;\r\n}\r\n\r\n.nav-buttons {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 4px;\r\n}\r\n\r\n.nav-separator {\r\n    width: 1px;\r\n    height: 20px;\r\n    background-color: var(--border);\r\n    margin: 0 6px;\r\n}\r\n\r\n.nav-btn {\r\n    background: transparent;\r\n    border: none;\r\n    color: var(--text-muted);\r\n    text-decoration: none;\r\n    display: flex;\r\n    align-items: center;\r\n    padding: 6px 10px;\r\n    border-radius: 99px;\r\n    height: 32px;\r\n    box-sizing: border-box;\r\n    transition: color 0.15s, background-color 0.15s;\r\n    position: relative;\r\n}\r\n\r\n.nav-badge-beta {\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n    font-size: 8px;\r\n    font-weight: 700;\r\n    color: var(--text);\r\n    background: var(--secondary);\r\n    padding: 2px 4px;\r\n    border-radius: 4px;\r\n    line-height: 1;\r\n    transform: translate(20%, -20%);\r\n    pointer-events: none;\r\n}\r\n\r\n.nav-btn:hover {\r\n    color: var(--text);\r\n    background-color: var(--surface-hover);\r\n}\r\n\r\n.nav-btn i,\r\n.nav-btn svg {\r\n    width: 18px;\r\n    height: 18px;\r\n    min-width: 18px;\r\n}\r\n\r\n.nav-btn span {\r\n    max-width: 0;\r\n    opacity: 0;\r\n    margin-left: 0;\r\n    overflow: hidden;\r\n    white-space: nowrap;\r\n    font-weight: 500;\r\n    font-size: 13px;\r\n    transition: max-width 0.23s ease, opacity 0.17s ease, margin-left 0.23s ease;\r\n}\r\n\r\n#topbar-container:hover .nav-btn span {\r\n    max-width: 70px;\r\n    opacity: 1;\r\n    margin-left: 8px;\r\n}\n</style>\r\n    <style>\n/**\r\n * PHANTOM - BACKGROUND STYLES\r\n */\r\n.phantom-background {\r\n    position: fixed;\r\n    inset: 0;\r\n    width: 100vw;\r\n    height: 100vh;\r\n    z-index: -1;\r\n    overflow: hidden;\r\n    background: transparent;\r\n    pointer-events: none;\r\n    opacity: 1;\r\n    transition: background-color 0.3s ease;\r\n}\r\n\r\n.phantom-background.active {\r\n    opacity: 1;\r\n}\r\n\r\n.phantom-background-overlay {\r\n    position: absolute;\r\n    inset: 0;\r\n    z-index: 2;\r\n    background: rgba(0, 0, 0, var(--bg-overlay, 0.4));\r\n    transition: background-color 0.3s ease;\r\n}\r\n\r\n.phantom-background-layer {\r\n    position: absolute;\r\n    inset: 0;\r\n    z-index: 1;\r\n    transition: opacity 0.3s ease-in-out;\r\n}\r\n\r\n.phantom-background-media {\r\n    width: 100%;\r\n    height: 100%;\r\n    object-fit: cover;\r\n    object-position: var(--bg-image-position, center);\r\n    display: block;\r\n    border: none;\r\n}\r\n\r\n/* Video and Iframe positioning for full background cover */\r\n.phantom-background-layer video.phantom-background-media,\r\n.phantom-background-layer iframe.phantom-background-media {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    transform: none;\r\n    pointer-events: none;\r\n    min-width: 100%;\r\n    min-height: 100%;\r\n    max-width: none;\r\n    max-height: none;\r\n    object-position: var(--bg-image-position, center);\r\n}\r\n\r\n/* Ensure iframes cover entire background */\r\n.phantom-background-layer iframe.phantom-background-media {\r\n    border: none;\r\n    object-fit: cover;\r\n}\r\n\r\n/* Ensure content on top remains readable */\r\nhtml {\r\n    background-color: var(--bg);\r\n}\r\n\r\nbody {\r\n    position: relative;\r\n    z-index: 0;\r\n    background: transparent !important;\r\n    /* Allow background to show through */\r\n}\r\n\r\n/* Specific adjustments for transparency if needed */\r\n.main-content,\r\n.home-page {\r\n    background: transparent !important;\r\n}\r\n\r\n/* Glassmorphism for containers when background is active */\r\n.phantom-background.active~.offline-banner,\r\n.phantom-background.active~.home-page .card,\r\n.phantom-background.active~.home-page .featured-card,\r\n.phantom-background.active~.home-page .search-bar,\r\n.phantom-background.active~.settings-panel {\r\n    backdrop-filter: blur(10px);\r\n    -webkit-backdrop-filter: blur(10px);\r\n    background: rgba(15, 15, 15, 0.7) !important;\r\n}\n</style>\r\n</head>\r\n\r\n<body>\r\n    <script>\n// site config\r\n\r\nwindow.SITE_CONFIG = {\r\n    name: \"Phantom\",\r\n    fullName: \"Phantom Unblocked\",\r\n    version: \"1.0.12\",\r\n\r\n    changelog: [\r\n        \"1.0.12: tiny fixxes and changes\",\r\n        \"some code consolidation and fixxes\",\r\n        \"suggest features in the discord server\"\r\n    ],\r\n\r\n    // quotes\r\n    quotes: [\r\n        \"lebron lebron lebronn james\",\r\n        \"so tuff\",\r\n        \"it is what it is\",\r\n        \"do ur work\",\r\n        \"this is what happens when u dont touch grass\",\r\n        \"FULL BOX\",\r\n        \"FULL PIECE\",\r\n        \"200!\",\r\n        \"press esc + refresh + power button for hacks\",\r\n        \"press ctrl+x to hide your screen\",\r\n        \"change the tab title and favicon in settings\",\r\n        \"TEACHERR!\",\r\n        \"1 pump\",\r\n        \"303 headshot\",\r\n        \"bros prolly a 60 ovr\",\r\n        \"take the L lil bro\",  \r\n        \"lebron is OUR goat\",\r\n        \"stop looking at my screen\",\r\n    ],\r\n\r\n    // todo\r\n    // *** for strikethrough\r\n    // ** for bold\r\n    todos: [\r\n        \"***fixxed aboutblank opening while securly is on (previously if popups were off it would load intab instead of clickto launch now it will use clicktolaunch unless popups are blocked)***\",\r\n        \"***fix the proxy***\",\r\n        \"***fix panic panickey, add quote talking about it***\",\r\n        \"***fix theatermode, make it hide buttons after a few seconds and ensure all content is being displayed and move the description to the bottom***\",\r\n        \"***change back player to use old styling, change the surface to use background colors for the bottom part where description is shown, looking just like the background***\",\r\n        \"***add image and video support for backgrounds***\",\r\n        \"***fix aichat, make the title use the same ai request as the users question unless its in image mode where it will use text mode and fix ai chat to remember modes better***\",\r\n        \"***add cloaking to quotes***\",\r\n        \"***add a default cloak and fix it so icons work in aboutblank for whatever reason they only work when you go to settings in aboutblank where it correctly applies***\",\r\n        \"***for search suggestions add highlighting for whatever will happen when you click enter, in search suggestions fix all games not sending you to the games page***\",\r\n        \"***fix games to make multi library the default, put it in config.js***\",\r\n        \"***rename movies shortcut in index2.html to primeshows, add shortcuts to main pages in the topbar and change the current shortcuts to more popular games***\",\r\n        \"***make announcements show even on first visit unlike changelog and allow disabling it via settings***\",\r\n        \"***fix leave comformation asking u to leave each time you click something***\",\r\n        \"***change the shortcuts on the main page to include pages***\",\r\n        \"***add movies to the search bar in main page***\",\r\n        \"***fix background not turning off soon***\",\r\n        \"***fix music page to hide youtube player unless toggled via 3 dot small button, and always shown on proxy mode, fix all the controls for video time, volume***\",\r\n        \"**add singlefile this is lowk so hard i dont really understand it**\",\r\n        \"**advertise phantom (too much work tbh)**\",\r\n        \"**add a watch page for youtube and twitch**\",\r\n        \"**add a miniplayer for music**\",\r\n        \"***shorten some page's code***\",\r\n        \"***fix paths in search autocomplete***\",\r\n        \"***fix markdown in ai not using correct text colors***\",\r\n        \"***make backgrounds show in the loading screen***\",\r\n        \"***fix icons for topbar in code.html***\",\r\n        \"**fix wisp server not notifying or autoswitiching when offline in proxy**\",\r\n        \"***fix code runner open not working at all***\",\r\n        \"***make backgrounds show in player.html***\",\r\n        \"***make backgrounds show in staticsjv2***\",\r\n        \"***make player.html player controls use theme colros not hardcoded***\",\r\n        \"***make ai chat and music sidebar go all the way down and up with borders***\",\r\n        \"**make the only song in music be lebron lebron lebron james**\",\r\n        \"**fix music controls**\",\r\n        \"***finish extra page into credits and make this todo be tucked away somewhere and not the main part of it***\"\r\n    ],\r\n    defaultWisp: \"wss://glseries.net/wisp/\",\r\n    wispServers: [\r\n        { name: \"GLSeries Wisp\", url: \"wss://glseries.net/wisp/\" },\r\n        { name: \"Rhw's Wisp\", url: \"wss://wisp.rhw.one/\" },\r\n    ],\r\n\r\n    discord: {\r\n        inviteUrl: \"https://discord.gg/tHWx9NXp5p\",\r\n        widgetServer: \"1447673724017971324\",\r\n        widgetChannel: \"1447673726228496617\",\r\n    },\r\n\r\n    firstVisitCloak: false, //fake error page\r\n    defaults: {\r\n        cloakMode: \"about:blank\",\r\n        tabTitle: \"You've already responded\",\r\n        tabFavicon: \"https://ssl.gstatic.com/docs/spreadsheets/forms/forms_icon_2023q4.ico\",\r\n        cloakRotation: false,\r\n        cloakInterval: 5000,\r\n        panicKey: \"x\",\r\n        panicModifiers: [\"ctrl\", \"shift\"],\r\n        panicUrl: \"https://classroom.google.com\",\r\n        maxMovieRating: \"R\",\r\n        gameLibrary: \"multi\",\r\n        discordWidget: true,\r\n        miniplayer: true,\r\n        leaveConfirmation: false,\r\n        showChangelogOnUpdate: true,\r\n        themeRotation: true,\r\n        lastThemeRotation: 0,\r\n        backgroundRotation: true,\r\n        lastBackgroundRotation: 0,\r\n        lastSeenFeatured: 'none',\r\n        background: { type: 'color', value: '#0a0a0a' },\r\n        customBackground: { id: 'none', type: 'none' },\r\n        accentColor: '#ffffff',\r\n        surfaceColor: '#0f0f0f',\r\n        secondaryColor: '#2e2e33',\r\n        textColor: '#e4e4e7',\r\n    },\r\n\r\n    themePresets: {\r\n        dark: { name: 'Dark (Default)', bg: { type: 'color', value: '#0a0a0a' }, surface: '#0f0f0f', surfaceHover: '#1a1a1a', surfaceActive: '#252525', secondary: '#2e2e33', border: '#2a2a2a', borderLight: '#2a2a2a', text: '#e4e4e7', textSec: '#71717a', textDim: '#52525b', accent: '#ffffff' },\r\n        midnight: { name: 'Midnight', bg: { type: 'color', value: '#000000' }, surface: '#050505', surfaceHover: '#111111', surfaceActive: '#1a1a1a', secondary: '#111111', border: '#1a1a1a', borderLight: '#111111', text: '#ededed', textSec: '#a3a3a3', textDim: '#737373', accent: '#d4d4d4' },\r\n        abyss: { name: 'Abyss', bg: { type: 'color', value: '#020617' }, surface: '#0f172a', surfaceHover: '#1e293b', surfaceActive: '#334155', secondary: '#1e293b', border: '#1e293b', borderLight: '#1e293b', text: '#f1f5f9', textSec: '#94a3b8', textDim: '#64748b', accent: '#38bdf8' },\r\n        phantom: { name: 'Phantom', bg: { type: 'color', value: '#0f0a14' }, surface: '#1a0f24', surfaceHover: '#2e1a40', surfaceActive: '#4c2a5c', secondary: '#2e1a40', border: '#2e1a40', borderLight: '#2e1a40', text: '#f3e8ff', textSec: '#d8b4fe', textDim: '#c084fc', accent: '#c084fc' },\r\n        rosepine: { name: 'Rose Pine', bg: { type: 'color', value: '#191724' }, surface: '#1f1d2e', surfaceHover: '#26233a', surfaceActive: '#524f67', secondary: '#26233a', border: '#26233a', borderLight: '#1f1d2e', text: '#e0def4', textSec: '#908caa', textDim: '#6e6a86', accent: '#ebbcba' },\r\n        ocean: { name: 'Oceanic', bg: { type: 'color', value: '#011627' }, surface: '#0b2942', surfaceHover: '#1d3b53', surfaceActive: '#2d4b63', secondary: '#0b2942', border: '#1d3b53', borderLight: '#0b2942', text: '#d6deeb', textSec: '#5f7e97', textDim: '#011627', accent: '#7fdbca' },\r\n        forest: { name: 'Forest', bg: { type: 'color', value: '#020d06' }, surface: '#051a0d', surfaceHover: '#0a2e17', surfaceActive: '#0f4221', secondary: '#051a0d', border: '#0a2e17', borderLight: '#051a0d', text: '#ecfdf5', textSec: '#6ee7b7', textDim: '#064e3b', accent: '#10b981' },\r\n        crimson: { name: 'Crimson', bg: { type: 'color', value: '#1a0505' }, surface: '#230a0a', surfaceHover: '#7b0a0aff', surfaceActive: '#7f1d1d', secondary: '#230a0a', border: '#480f0fff', borderLight: '#230a0a', text: '#fef2f2', textSec: '#fecaca', textDim: '#450a0a', accent: '#ef4444' },\r\n        flame: { name: 'Flame', bg: { type: 'color', value: '#0c0202' }, surface: '#1c0a0a', surfaceHover: '#451a03', surfaceActive: '#9a3412', secondary: '#1c0a0a', border: '#451a03', borderLight: '#9a3412', text: '#fff7ed', textSec: '#fdba74', textDim: '#ea580c', accent: '#f59e0b' }\r\n    },\r\n\r\n    backgroundPresets: [\r\n        { id: 'none', name: 'None (Theme Default)', type: 'none' },\r\n        { id: 'Night sky', name: 'Night sky', type: 'image', url: 'https://images.pexels.com/photos/5675745/pexels-photo-5675745.jpeg', overlay: 0.3 },\r\n        { id: 'winter-mountains', name: 'Winter mountains', type: 'image', url: 'https://images.pexels.com/photos/1287145/pexels-photo-1287145.jpeg', overlay: 0.3 },\r\n        { id: 'f1 car', name: 'F1 Car', type: 'image', url: 'https://images.pexels.com/photos/14401632/pexels-photo-14401632.jpeg', overlay: 0.3 },\r\n        { id: 'moon-landing', name: 'Moon Landing', type: 'image', url: 'https://images.pexels.com/photos/41162/moon-landing-apollo-11-nasa-buzz-aldrin-41162.jpeg', overlay: 0.3, objectPosition: 'top left', active: true },\r\n        { id: 'turtle', name: 'Turtle', type: 'image', url: 'https://images.unsplash.com/photo-1501791187590-9ef2612ba1eb?q=80&w=1932&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D', overlay: 0.3 },\r\n        { id: 'road', name: 'Road', type: 'image', url: 'https://images.unsplash.com/photo-1508233620467-f79f1e317a05', overlay: 0.3 },\r\n        { id: 'railroad', name: 'Railroad', type: 'image', url: 'https://images.unsplash.com/photo-1505832018823-50331d70d237', overlay: 0.3 },\r\n        { id: 'mountain', name: 'Mountain', type: 'image', url: 'https://raw.githubusercontent.com/evanhnry/brave-wallpapers/refs/heads/main/Brave/clay-banks-u27Rrbs9Dwc-unsplash.jpg', overlay: 0.3 },\r\n    ],\r\n\r\n    cloakPresets: [\r\n        { name: \"Phantom\", icon: \"/favicon.svg\", title: \"Phantom Unblocked\" },\r\n        { name: \"Edpuzzle\", icon: \"https://edpuzzle.imgix.net/favicons/favicon-32.png\", title: \"Edpuzzle\" },\r\n        { name: \"Google Docs\", icon: \"https://ssl.gstatic.com/docs/documents/images/kix-favicon7.ico\", title: \"Untitled document - Google Docs\" },\r\n        { name: \"Canvas\", icon: \"https://du11hjcvx0uqb.cloudfront.net/dist/images/favicon-e10d657a73.ico\", title: \"Dashboard\" },\r\n        { name: \"Desmos\", icon: \"https://www.desmos.com/favicon.ico\", title: \"Desmos | Graphing Calculator\" },\r\n        { name: \"Khan Academy\", icon: \"https://cdn.kastatic.org/images/favicon.ico\", title: \"Khan Academy\" },\r\n        { name: \"Wikipedia\", icon: \"https://en.wikipedia.org/favicon.ico\", title: \"World War II - Wikipedia\" },\r\n        { name: \"Classroom\", icon: \"https://ssl.gstatic.com/classroom/favicon.png\", title: \"Home - Classroom\" },\r\n        { name: \"Canva\", icon: \"https://static.canva.com/static/images/android-192x192-2.png\", title: \"Home - Canva\" },\r\n        { name: \"Quiz\", icon: \"https://ssl.gstatic.com/docs/spreadsheets/forms/forms_icon_2023q4.ico\", title: \"You've already responded\" },\r\n        { name: \"Blooket\", icon: \"https://play.blooket.com/favicon.ico\", title: \"Play Blooket | Blooket\" },\r\n        { name: \"Gmail\", icon: \"https://ssl.gstatic.com/ui/v1/icons/mail/rfr/gmail.ico\", title: \"Gmail\" },\r\n        { name: \"YouTube\", icon: \"https://www.youtube.com/favicon.ico\", title: \"YouTube\" },\r\n        { name: \"Powerschool\", icon: \"https://waverlyk12.powerschool.com/favicon.ico\", title: \"Grades and Attendance\" },\r\n        { name: \"nothing\", icon: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=\", title: \"\\u200B\" },\r\n    ]\r\n}\r\n\r\n\r\n\n</script>\r\n    <script>\n// settings handler\r\n(function () {\r\n    'use strict';\r\n\r\n    const STORAGE_KEY = 'void_settings';\r\n\r\n    const getDefaults = () => {\r\n        return window.SITE_CONFIG?.defaults || {\r\n            cloakMode: 'none',\r\n            cloakRotation: false,\r\n            cloakInterval: 5000,\r\n            panicKey: 'x',\r\n            panicModifiers: ['ctrl', 'shift'],\r\n            panicUrl: 'https://classroom.google.com',\r\n            maxMovieRating: 'R',\r\n            offlineGames: [],\r\n            gameLibrary: 'multi',\r\n            leaveConfirmation: false\r\n        };\r\n    };\r\n\r\n    const load = () => {\r\n        try {\r\n            const stored = localStorage.getItem(STORAGE_KEY);\r\n            if (stored) {\r\n                return { ...getDefaults(), ...JSON.parse(stored) };\r\n            }\r\n        } catch (e) {\r\n            console.warn('Failed to load settings:', e);\r\n        }\r\n        return getDefaults();\r\n    };\r\n\r\n    const save = (settings) => {\r\n        try {\r\n            localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n            window.dispatchEvent(new CustomEvent('settings-changed', { detail: settings }));\r\n            if (window.parent !== window) {\r\n                window.parent.postMessage({ type: 'settings-update' }, '*');\r\n            }\r\n        } catch (e) {\r\n            console.warn('Failed to save settings:', e);\r\n        }\r\n    };\r\n\r\n    let _settings = load();\r\n\r\n    window.Settings = {\r\n        get(key) { return _settings[key]; },\r\n\r\n        getAll() { return { ..._settings }; },\r\n\r\n        set(key, value) {\r\n            _settings[key] = value;\r\n            save(_settings);\r\n            this.apply();\r\n            return value;\r\n        },\r\n\r\n        update(partial) {\r\n            _settings = { ..._settings, ...partial };\r\n            save(_settings);\r\n            this.apply();\r\n        },\r\n\r\n        reset() {\r\n            _settings = getDefaults();\r\n            save(_settings);\r\n            this.apply();\r\n        },\r\n\r\n        apply() {\r\n            const root = document.documentElement;\r\n            const s = _settings;\r\n            const d = window.SITE_CONFIG?.defaults || {};\r\n\r\n            const vars = {\r\n                '--accent': s.accentColor || d.accentColor || '#ffffff',\r\n                '--surface': s.surfaceColor || d.surfaceColor || '#0f0f0f',\r\n                '--surface-hover': s.surfaceHoverColor || d.surfaceHoverColor || '#1a1a1a',\r\n                '--surface-active': s.surfaceActiveColor || d.surfaceActiveColor || '#252525',\r\n                '--secondary': s.secondaryColor || d.secondaryColor || '#2e2e33',\r\n                '--border': s.borderColor || d.borderColor || '#1f1f1f',\r\n                '--border-light': s.borderLightColor || d.borderLightColor || '#2a2a2a',\r\n                '--text': s.textColor || d.textColor || '#e4e4e7',\r\n                '--text-muted': s.textSecondaryColor || d.textSecondaryColor || '#71717a',\r\n                '--text-dim': s.textDimColor || d.textDimColor || '#52525b',\r\n                '--toggle': s.toggleColor || d.toggleColor,\r\n                '--toggle-knob': s.toggleKnobColor || d.toggleKnobColor\r\n            };\r\n\r\n            Object.entries(vars).forEach(([key, val]) => {\r\n                if (val) root.style.setProperty(key, val);\r\n            });\r\n\r\n            const themeBg = s.background || d.background || { type: 'color', value: '#0a0a0a' };\r\n            const customBg = s.customBackground;\r\n            const isCustomActive = customBg && customBg.type !== 'none';\r\n\r\n            if (themeBg.type === 'color') {\r\n                root.style.setProperty('--bg', themeBg.value);\r\n            }\r\n\r\n            if (isCustomActive && customBg.url) {\r\n                root.style.setProperty('--bg-image', `url(${customBg.url})`);\r\n\r\n                let position = customBg.objectPosition;\r\n                if (customBg.id && customBg.id !== 'custom') {\r\n                    const preset = window.SITE_CONFIG?.backgroundPresets?.find(b => b.id === customBg.id);\r\n                    if (preset?.objectPosition) position = preset.objectPosition;\r\n                }\r\n\r\n                root.style.setProperty('--bg-image-position', position || 'center');\r\n            } else if (themeBg.type === 'image' || themeBg.type === 'video') {\r\n                root.style.setProperty('--bg-image', `url(${themeBg.value || themeBg.url})`);\r\n                root.style.setProperty('--bg-image-position', themeBg.objectPosition || 'center');\r\n            } else if (themeBg.type === 'gradient') {\r\n                root.style.setProperty('--bg-image', themeBg.value || themeBg.url);\r\n                root.style.setProperty('--bg-image-position', 'center');\r\n            } else {\r\n                root.style.setProperty('--bg-image', 'none');\r\n            }\r\n        },\r\n\r\n        onChange(callback) {\r\n            window.addEventListener('settings-changed', (e) => callback(e.detail));\r\n        },\r\n\r\n        isRatingAllowed(rating) {\r\n            if (!rating || rating === 'NR' || rating === 'NC-17') return false;\r\n            const ratingOrder = ['G', 'PG', 'PG-13', 'R'];\r\n            const maxIndex = ratingOrder.indexOf(_settings.maxMovieRating);\r\n            const ratingIndex = ratingOrder.indexOf(rating);\r\n            return maxIndex !== -1 && ratingIndex !== -1 && ratingIndex <= maxIndex;\r\n        }\r\n    };\r\n\r\n    // panic button go brr\r\n    const handlePanic = (e) => {\r\n        const mods = _settings.panicModifiers || [];\r\n        const key = _settings.panicKey || 'x';\r\n\r\n        if (mods.includes('ctrl') !== e.ctrlKey) return;\r\n        if (mods.includes('shift') !== e.shiftKey) return;\r\n        if (mods.includes('alt') !== e.altKey) return;\r\n\r\n        if (e.key.toLowerCase() === key.toLowerCase()) {\r\n            e.preventDefault();\r\n            const overlayId = 'panic-overlay';\r\n            let overlay = window.parent?.document?.getElementById(overlayId) || document.getElementById(overlayId);\r\n\r\n            if (!overlay) {\r\n                overlay = document.createElement('div');\r\n                overlay.id = overlayId;\r\n                overlay.style.cssText = 'position:fixed;inset:0;background:white;z-index:99999;';\r\n                document.body.appendChild(overlay);\r\n            } else {\r\n                overlay.style.display = 'block';\r\n            }\r\n\r\n            window.location.replace(_settings.panicUrl || 'https://classroom.google.com');\r\n        }\r\n    };\r\n\r\n    const init = () => {\r\n        Settings.apply();\r\n\r\n        const featured = window.SITE_CONFIG?.featuredBackground;\r\n        const activePreset = window.SITE_CONFIG?.backgroundPresets?.find(p => p.active);\r\n\r\n        const target = activePreset || featured;\r\n\r\n        if (target?.id && target.id !== _settings.lastSeenFeatured) {\r\n            Settings.update({\r\n                customBackground: target,\r\n                lastSeenFeatured: target.id,\r\n                backgroundRotation: false\r\n            });\r\n        }\r\n\r\n        document.addEventListener('keydown', handlePanic, true);\r\n\r\n        window.addEventListener('storage', (e) => {\r\n            if (e.key === STORAGE_KEY) {\r\n                _settings = load();\r\n                Settings.apply();\r\n                window.dispatchEvent(new CustomEvent('settings-changed', { detail: _settings }));\r\n            }\r\n        });\r\n\r\n        window.addEventListener('message', (e) => {\r\n            if (e.data?.type === 'settings-update' || e.data === 'updateCloak') {\r\n                _settings = load();\r\n                Settings.apply();\r\n                window.dispatchEvent(new CustomEvent('settings-changed', { detail: _settings }));\r\n            }\r\n        });\r\n\r\n        window.addEventListener('beforeunload', (e) => {\r\n            if (document.getElementById('main-frame') && _settings.leaveConfirmation) {\r\n                e.preventDefault();\r\n                return e.returnValue = '';\r\n            }\r\n        });\r\n    };\r\n\r\n    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', init);\r\n    else init();\r\n})();\r\n\n</script>\r\n    <script>\n// background stuff\r\n(function () {\r\n    'use strict';\r\n\r\n    if (window.BackgroundManager) return;\r\n\r\n    const YOUTUBE_REGEX = /(?:youtube\\.com\\/watch\\?v=|youtu\\.be\\/|youtube\\.com\\/embed\\/)([a-zA-Z0-9_-]{11})/;\r\n\r\n    const BackgroundManager = {\r\n        container: null,\r\n        mediaLayer: null,\r\n        elements: { video: null, image: null, iframe: null },\r\n        current: { type: null, url: null },\r\n        cacheName: 'phantom-bg-cache-v2',\r\n\r\n        init() {\r\n            this.container = document.createElement('div');\r\n            this.container.className = 'phantom-background';\r\n            this.container.innerHTML = '<div class=\"phantom-background-overlay\"></div><div class=\"phantom-background-layer\"></div>';\r\n            this.mediaLayer = this.container.querySelector('.phantom-background-layer');\r\n            document.body.insertBefore(this.container, document.body.firstChild);\r\n\r\n            const apply = () => this.applyBackground();\r\n            window.addEventListener('settings-changed', apply);\r\n            window.addEventListener('storage', apply);\r\n            window.addEventListener('beforeunload', () => this.cleanup());\r\n            window.addEventListener('pagehide', () => this.cleanup());\r\n\r\n            document.addEventListener('visibilitychange', () => {\r\n                const video = this.elements.video;\r\n                if (!video) return;\r\n                if (document.hidden) video.pause();\r\n                else if (this.current.type === 'video') video.play().catch(() => { });\r\n            });\r\n\r\n            this.applyBackground();\r\n        },\r\n\r\n        applyBackground() {\r\n            if (!this.container) return; // Wait for init() to create the container\r\n\r\n            const s = window.Settings?.getAll() || {};\r\n            const custom = s.customBackground;\r\n            const theme = s.background || {};\r\n\r\n            let type = null, url = null, pos = null, overlay = 0.4;\r\n\r\n            if (custom && custom.type !== 'none') {\r\n                // Refresh from config if possible to get latest props like objectPosition\r\n                if (custom.id && custom.id !== 'custom') {\r\n                    const preset = window.SITE_CONFIG?.backgroundPresets?.find(b => b.id === custom.id);\r\n                    if (preset) Object.assign(custom, preset);\r\n                }\r\n                ({ type, url, objectPosition: pos, overlay = 0.4 } = custom);\r\n            } else if (theme.type === 'image' || theme.type === 'video' || theme.type === 'youtube') {\r\n                type = theme.type;\r\n                url = theme.value || theme.url;\r\n                pos = theme.objectPosition;\r\n                overlay = theme.overlay || 0.4;\r\n            }\r\n\r\n            document.documentElement.style.setProperty('--bg-overlay', overlay);\r\n\r\n            // Handle common positioning typos and normalize\r\n            if (pos && typeof pos === 'string') {\r\n                pos = pos.toLowerCase().trim()\r\n                    .replace(/\\s+/g, ' ') // Normalize multiple spaces\r\n                    .replace('topleft', 'top left')\r\n                    .replace('topright', 'top right')\r\n                    .replace('bottomleft', 'bottom left')\r\n                    .replace('bottomright', 'bottom right')\r\n                    .replace('centercenter', 'center')\r\n                    .replace('centerleft', 'center left')\r\n                    .replace('centerright', 'center right');\r\n            }\r\n\r\n            document.documentElement.style.setProperty('--bg-image-position', pos || 'center');\r\n\r\n            if (!type || !url) {\r\n                this.clear();\r\n                document.documentElement.style.backgroundColor = 'var(--bg)';\r\n                document.documentElement.style.setProperty('--bg-image-position', 'center');\r\n                return;\r\n            }\r\n            if (this.current.type === type && this.current.url === url) return;\r\n\r\n            this.current = { type, url };\r\n\r\n            if (type === 'video' || url.match(/\\.(mp4|webm|ogg|mov|m4v)$/i)) {\r\n                this.clearMedia();\r\n                this.createVideo(url, pos);\r\n                this.container.classList.add('active');\r\n                document.documentElement.classList.add('phantom-bg-active');\r\n                document.body.classList.add('phantom-bg-active');\r\n            } else if (type === 'youtube' || YOUTUBE_REGEX.test(url)) {\r\n                this.clearMedia();\r\n                this.createYouTube(url, pos);\r\n                this.container.classList.add('active');\r\n                document.documentElement.classList.add('phantom-bg-active');\r\n                document.body.classList.add('phantom-bg-active');\r\n            } else if (type === 'image') {\r\n                this.handleImageBackground(url, pos);\r\n            }\r\n        },\r\n\r\n        async getProxiedCachedUrl(url) {\r\n            // Local images don't need proxying\r\n            if (!url.startsWith('http') || url.includes(location.hostname)) return url;\r\n\r\n            // Try direct load first (faster)\r\n            try {\r\n                const directTest = await fetch(url, { method: 'HEAD', mode: 'cors' });\r\n                if (directTest.ok) return url;\r\n            } catch (e) {\r\n                // CORS blocked, need to proxy\r\n            }\r\n\r\n            // Wait for BareMux (max 500ms)\r\n            let retries = 0;\r\n            while (!window.BareMux && retries < 5) {\r\n                await new Promise(r => setTimeout(r, 100));\r\n                retries++;\r\n            }\r\n\r\n            if (!window.BareMux) {\r\n                console.warn(\"Background: BareMux not found, trying direct URL.\");\r\n                return url; // Try direct anyway\r\n            }\r\n\r\n            try {\r\n                const client = new window.BareMux.BareClient();\r\n                const response = await client.fetch(url);\r\n                if (!response.ok) throw new Error('Proxy fetch failed');\r\n\r\n                const blob = await response.blob();\r\n                return URL.createObjectURL(blob);\r\n            } catch (error) {\r\n                console.error(\"Background proxy failed:\", error);\r\n                return url; // Fallback to direct URL\r\n            }\r\n        },\r\n\r\n        async handleImageBackground(url, pos) {\r\n            // Pre-load the image (proxied/cached or direct)\r\n            const finalUrl = await this.getProxiedCachedUrl(url);\r\n\r\n            // Check if this is still the current background after async fetch\r\n            if (this.current.url !== url) {\r\n                if (finalUrl && finalUrl.startsWith('blob:')) URL.revokeObjectURL(finalUrl);\r\n                return;\r\n            }\r\n\r\n            this.clearMedia();\r\n            this.createImage(finalUrl, pos);\r\n        },\r\n\r\n        createVideo(url, pos) {\r\n            const el = Object.assign(document.createElement('video'), {\r\n                className: 'phantom-background-media', src: url, autoplay: true, loop: true, muted: true, playsInline: true, volume: 0\r\n            });\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n            el.onerror = () => (this.elements.video = null);\r\n            this.elements.video = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        createImage(url, pos) {\r\n            const el = Object.assign(document.createElement('img'), {\r\n                className: 'phantom-background-media',\r\n                src: url\r\n            });\r\n\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n\r\n            el.onload = () => {\r\n                if (this.current.url === url || url.startsWith('blob:')) {\r\n                    this.container.classList.add('active');\r\n                    document.documentElement.classList.add('phantom-bg-active');\r\n                    document.body.classList.add('phantom-bg-active');\r\n                }\r\n            };\r\n            el.onerror = () => {\r\n                console.warn(\"Background image failed to load:\", url);\r\n                if (this.elements.image === el) this.elements.image = null;\r\n            };\r\n\r\n            this.elements.image = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        // youtube logic\r\n        createYouTube(url, pos) {\r\n            const id = url.match(YOUTUBE_REGEX)?.[1];\r\n            if (!id) return;\r\n            const el = Object.assign(document.createElement('iframe'), {\r\n                className: 'phantom-background-media',\r\n                src: `https://www.youtube.com/embed/${id}?autoplay=1&loop=1&playlist=${id}&controls=0&modestbranding=1&rel=0&mute=1&enablejsapi=1`,\r\n                allow: 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture'\r\n            });\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n            this.elements.iframe = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        clearMedia() {\r\n            Object.entries(this.elements).forEach(([key, el]) => {\r\n                if (!el) return;\r\n                if (key === 'video') { el.pause(); el.src = ''; }\r\n                if (key === 'iframe') el.src = 'about:blank';\r\n                if (key === 'image' && el.src.startsWith('blob:')) {\r\n                    URL.revokeObjectURL(el.src);\r\n                }\r\n                el.remove();\r\n                this.elements[key] = null;\r\n            });\r\n        },\r\n\r\n        clear() {\r\n            this.clearMedia();\r\n            this.current = { type: null, url: null };\r\n            document.documentElement.classList.remove('phantom-bg-active');\r\n            document.body.classList.remove('phantom-bg-active');\r\n            document.documentElement.style.backgroundColor = '';\r\n            if (this.container) this.container.classList.remove('active');\r\n        },\r\n\r\n        cleanup() {\r\n            this.clearMedia();\r\n        }\r\n    };\r\n\r\n    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', () => BackgroundManager.init());\r\n    else BackgroundManager.init();\r\n\r\n    window.BackgroundManager = BackgroundManager;\r\n})();\r\n\n</script>\r\n    <script>\n// topbar\r\n(function () {\r\n    let rootPrefix = '';\r\n    const scriptName = 'components/topbar.js';\r\n    const scripts = document.getElementsByTagName('script');\r\n    for (let i = 0; i < scripts.length; i++) {\r\n        const src = scripts[i].getAttribute('src');\r\n        if (src && src.includes(scriptName)) {\r\n            rootPrefix = src.split(scriptName)[0];\r\n            break;\r\n        }\r\n    }\r\n\r\n    if (!window.lucide && !document.querySelector('script[src*=\"lucide\"]')) {\r\n        const script = document.createElement('script');\r\n        script.src = 'https://unpkg.com/lucide@latest';\r\n        script.onload = () => {\r\n            if (window.lucide) lucide.createIcons();\r\n        };\r\n        document.head.appendChild(script);\r\n    }\r\n\r\n    initTopbar();\r\n\r\n    function createTopbar() {\r\n        const topbarContainer = document.createElement('div');\r\n        topbarContainer.id = 'topbar-container';\r\n\r\n        const logoSection = document.createElement('a');\r\n        logoSection.className = 'logo-section';\r\n        logoSection.href = rootPrefix + 'index2.html';\r\n        logoSection.innerHTML = '<div class=\"logo-placeholder\"><i data-lucide=\"zap\"></i></div>';\r\n        topbarContainer.appendChild(logoSection);\r\n\r\n        const navButtons = document.createElement('div');\r\n        navButtons.className = 'nav-buttons';\r\n\r\n        const buttons = [\r\n            { name: 'Music', icon: 'music', link: 'pages/music.html', badge: 'BETA' },\r\n            { name: 'Movies', icon: 'film', link: 'pages/movies.html' },\r\n            { name: 'Games', icon: 'gamepad-2', link: 'pages/games.html' },\r\n            { name: 'Watch', icon: 'play', link: 'pages/watch.html' },\r\n            { name: 'Search', icon: 'search', link: 'staticsjv2/index.html' },\r\n            { name: 'AI Chat', icon: 'bot', link: 'pages/chat.html' },\r\n            { separator: true },\r\n            { name: 'Settings', icon: 'settings', link: 'pages/settings.html' }\r\n        ];\r\n\r\n        buttons.forEach(btn => {\r\n            if (btn.separator) {\r\n                const separator = document.createElement('div');\r\n                separator.className = 'nav-separator';\r\n                navButtons.appendChild(separator);\r\n                return;\r\n            }\r\n\r\n            const link = document.createElement('a');   \r\n            link.href = rootPrefix + btn.link;\r\n            link.className = 'nav-btn';\r\n\r\n            const icon = document.createElement('i');\r\n            icon.setAttribute('data-lucide', btn.icon);\r\n            link.appendChild(icon);\r\n\r\n            const span = document.createElement('span');\r\n            span.textContent = btn.name;\r\n            link.appendChild(span);\r\n\r\n            if (btn.badge) {\r\n                const badge = document.createElement('div');\r\n                badge.className = 'nav-badge-beta';\r\n                badge.textContent = btn.badge;\r\n                link.appendChild(badge);\r\n            }\r\n\r\n            navButtons.appendChild(link);\r\n        });\r\n\r\n        topbarContainer.appendChild(navButtons);\r\n        document.body.prepend(topbarContainer);\r\n\r\n        if (window.lucide) {\r\n            lucide.createIcons();\r\n        }\r\n    }\r\n\r\n    function initTopbar() {\r\n        if (document.readyState === 'loading') {\r\n            document.addEventListener('DOMContentLoaded', createTopbar);\r\n        } else {\r\n            createTopbar();\r\n        }\r\n    }\r\n})();\r\n\n</script>\r\n\r\n    <div style=\"max-width: 700px; margin: 0 auto; padding: 80px 24px 40px;\">\r\n        <h1 style=\"font-size: 1.75rem; margin-bottom: 24px;\">Disclaimer</h1>\r\n\r\n        <div style=\"color: var(--text-muted); line-height: 1.8; font-size: 0.9375rem;\">\r\n            <p style=\"margin-bottom: 16px;\"><strong style=\"color: var(--text);\">Last updated:</strong> December 2025</p>\r\n\r\n            <h2 style=\"font-size: 1.125rem; color: var(--text); margin: 24px 0 12px;\">Educational Purpose</h2>\r\n            <p style=\"margin-bottom: 16px;\">Phantom Unblocked is intended for educational and entertainment purposes\r\n                only. This service is designed to demonstrate web technologies and provide access to unrestricted educational\r\n                resources.</p>\r\n\r\n            <h2 style=\"font-size: 1.125rem; color: var(--text); margin: 24px 0 12px;\">Third-Party Content</h2>\r\n            <p style=\"margin-bottom: 16px;\">We do not own, host, or control any of the games, movies, music, or other\r\n                content accessible through this service. All third-party content belongs to their respective owners and\r\n                is accessed through external sources.</p>\r\n\r\n            <h2 style=\"font-size: 1.125rem; color: var(--text); margin: 24px 0 12px;\">No Affiliation</h2>\r\n            <p style=\"margin-bottom: 16px;\">Phantom Unblocked is not affiliated with, endorsed by, or connected to any\r\n                of the third-party services, games, or platforms that may be accessed through this service.</p>\r\n\r\n            <h2 style=\"font-size: 1.125rem; color: var(--text); margin: 24px 0 12px;\">User Responsibility</h2>\r\n            <p style=\"margin-bottom: 16px;\">Users are responsible for ensuring their use of this service complies with\r\n                all applicable laws, regulations, and institutional policies. If your school or organization prohibits\r\n                the use of such services, please respect those policies.</p>\r\n\r\n            <h2 style=\"font-size: 1.125rem; color: var(--text); margin: 24px 0 12px;\">No Guarantee</h2>\r\n            <p style=\"margin-bottom: 16px;\">We make no guarantees about the availability, functionality, or reliability\r\n                of this service or any content accessed through it. Services may be unavailable, blocked, or change\r\n                without notice.</p>\r\n\r\n            <h2 style=\"font-size: 1.125rem; color: var(--text); margin: 24px 0 12px;\">Privacy</h2>\r\n            <p style=\"margin-bottom: 16px;\">We do not collect personal information. However, third-party services\r\n                accessed through this platform may have their own privacy policies and data collection practices.</p>\r\n        </div>\r\n\r\n        <a href=\"../index.html\"\r\n            style=\"display: inline-flex; align-items: center; gap: 8px; margin-top: 24px; color: var(--text-muted); font-size: 0.875rem;\">\r\n            <i class=\"fa-solid fa-arrow-left\"></i>\r\n            Back to Home\r\n        </a>\r\n    </div>\r\n\r\n    <script>\n// footer\r\n(function () {\r\n    'use strict';\r\n\r\n    let rootPrefix = '';\r\n    const scriptName = 'components/footer.js';\r\n    const scripts = document.getElementsByTagName('script');\r\n    for (let i = 0; i < scripts.length; i++) {\r\n        const src = scripts[i].getAttribute('src');\r\n        if (src && src.includes(scriptName)) {\r\n            rootPrefix = src.split(scriptName)[0];\r\n            break;\r\n        }\r\n    }\r\n\r\n    const config = window.SITE_CONFIG || { name: 'Phantom', version: '1.0.0', discord: { inviteUrl: '#' }, changelog: [], cloakPresets: [] };\r\n    const STORAGE_KEY = 'void_settings';\r\n    let storedSettings = {};\r\n    try { storedSettings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n\r\n    // settings\r\n    let settings = { ...(config.defaults || {}), ...storedSettings };\r\n\r\n    const footer = document.createElement('footer');\r\n    footer.id = 'site-footer';\r\n    footer.innerHTML = `\r\n        <style>\r\n            #site-footer {\r\n                margin-top: 0px;\r\n                padding: 20px;\r\n                border-top: 1px solid var(--border, #1f1f1f);\r\n                text-align: center;\r\n                background: transparent;\r\n            }\r\n            #site-footer .footer-links {\r\n                display: flex;\r\n                gap: 16px;\r\n                justify-content: center;\r\n                margin-bottom: 8px;\r\n                flex-wrap: wrap;\r\n            }\r\n            #site-footer .footer-link {\r\n                font-size: 12px;\r\n                color: var(--text-muted, #71717a);\r\n                text-decoration: none;\r\n                transition: color 0.15s;\r\n                font-family: 'Inter', sans-serif;\r\n                cursor: pointer;\r\n            }\r\n            #site-footer .footer-link:hover {\r\n                color: var(--text, #e4e4e7);\r\n            }\r\n            #site-footer .footer-version {\r\n                font-size: 11px;\r\n                color: var(--text-dim, #52525b);\r\n                cursor: pointer;\r\n                font-family: 'Inter', sans-serif;\r\n            }\r\n            #site-footer .footer-version:hover {\r\n                color: var(--text-muted, #71717a);\r\n            }\r\n        </style>\r\n        <div class=\"footer-links\">\r\n            <a href=\"${rootPrefix}pages/settings.html\" class=\"footer-link\"><i class=\"fa-solid fa-gear\"></i> Settings</a>\r\n            <a id=\"footer-changelog\" class=\"footer-link\"><i class=\"fa-solid fa-clock-rotate-left\"></i> Changelog</a>\r\n            <a href=\"${config.discord?.inviteUrl || '#'}\" target=\"_blank\" class=\"footer-link\"><i class=\"fa-brands fa-discord\"></i> Discord</a>\r\n            <a href=\"${rootPrefix}pages/terms.html\" class=\"footer-link\">Terms</a>\r\n            <a href=\"${rootPrefix}pages/disclaimer.html\" class=\"footer-link\">Disclaimer</a>\r\n            <a href=\"${rootPrefix}pages/extra.html\" class=\"footer-link\">Credits</a>\r\n        </div>\r\n        <span class=\"footer-version\" id=\"footer-version\">${config.name || 'Phantom'} v${config.version || '1.0.0'}</span>\r\n    `;\r\n\r\n    document.body.appendChild(footer);\r\n\r\n\r\n\r\n    // gtm\r\n    // Inject GTM head script if not already present\r\n    if (!document.querySelector('script[src*=\"googletagmanager.com/gtm.js\"]')) {\r\n        window.dataLayer = window.dataLayer || [];\r\n        window.dataLayer.push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' });\r\n        const gtmScript = document.createElement('script');\r\n        gtmScript.async = true;\r\n        gtmScript.src = 'https://www.googletagmanager.com/gtm.js?id=GTM-5LMBC27Z';\r\n        document.head.insertBefore(gtmScript, document.head.firstChild);\r\n    }\r\n\r\n    // Add GTM noscript fallback (for pages that don't have it in HTML)\r\n    if (!document.querySelector('noscript iframe[src*=\"googletagmanager\"]')) {\r\n        const gtmNoscript = document.createElement('noscript');\r\n        gtmNoscript.innerHTML = '<iframe src=\"https://www.googletagmanager.com/ns.html?id=GTM-5LMBC27Z\" height=\"0\" width=\"0\" style=\"display:none;visibility:hidden\"></iframe>';\r\n        document.body.insertBefore(gtmNoscript, document.body.firstChild);\r\n    }\r\n\r\n    const openChangelog = (e, customTitle, customContent) => {\r\n        if (e && e.preventDefault) e.preventDefault();\r\n        const changes = customContent || config.changelog || ['No changes listed'];\r\n\r\n        // Use standard modal structure from main.css\r\n        const overlay = document.createElement('div');\r\n        overlay.className = 'modal-overlay';\r\n\r\n        overlay.innerHTML = `\r\n            <div class=\"modal\" style=\"width: 400px; max-width: 90vw;\">\r\n                <div class=\"modal-header\">\r\n                    <h3 class=\"modal-title\">${customTitle || 'What\\'s New in v' + config.version}</h3>\r\n                    <button class=\"modal-close\"><i class=\"fa-solid fa-xmark\"></i></button>\r\n                </div>\r\n                <div class=\"modal-body\">\r\n                    <ul style=\"margin: 0; padding-left: 20px; color: var(--text-muted); font-size: 0.875rem; line-height: 1.6;\">\r\n                        ${changes.map(c => '<li>' + c + '</li>').join('')}\r\n                    </ul>\r\n                </div>\r\n                <div class=\"modal-footer\">\r\n                    <a href=\"${config.discord?.inviteUrl || '#'}\" target=\"_blank\" style=\"color: #5865F2; text-decoration: none; font-size: 13px; display: inline-flex; align-items: center; gap: 6px;\">\r\n                        <i class=\"fa-brands fa-discord\"></i> Join Discord\r\n                    </a>\r\n                </div>\r\n            </div>\r\n        `;\r\n\r\n        document.body.appendChild(overlay);\r\n\r\n        // Trigger animation\r\n        requestAnimationFrame(() => overlay.classList.add('show'));\r\n\r\n        const close = () => {\r\n            overlay.classList.remove('show');\r\n            setTimeout(() => overlay.remove(), 200);\r\n        };\r\n\r\n        overlay.querySelector('.modal-close').onclick = close;\r\n        overlay.onclick = (e) => { if (e.target === overlay) close(); };\r\n    };\r\n\r\n    // Expose openChangelog globally\r\n    window.openChangelog = openChangelog;\r\n\r\n    const changelogBtn = document.getElementById('footer-changelog');\r\n    if (changelogBtn) changelogBtn.onclick = openChangelog;\r\n\r\n    const versionBtn = document.getElementById('footer-version');\r\n    if (versionBtn) versionBtn.onclick = openChangelog;\r\n\r\n    // sync\r\n    // syncRemoteChangelog removed - using local config\r\n\r\n\r\n    // Initialize Sync\r\n    // syncRemoteChangelog();\r\n\r\n    const currentVersion = config.version;\r\n    const lastVersion = settings.lastVersion;\r\n\r\n    if (settings.showChangelogOnUpdate && lastVersion && lastVersion !== currentVersion) {\r\n        setTimeout(() => {\r\n            openChangelog();\r\n            settings.lastVersion = currentVersion;\r\n            localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n        }, 1000);\r\n    } else if (!lastVersion) {\r\n        settings.lastVersion = currentVersion;\r\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n    }\r\n\r\n    // panic\r\n    if (settings.panicKey) {\r\n        document.addEventListener('keydown', (e) => {\r\n            const keys = settings.panicModifiers || ['ctrl', 'shift'];\r\n            const triggerKey = settings.panicKey.toLowerCase();\r\n            const pressedKey = e.key.toLowerCase();\r\n\r\n            // Check modifiers\r\n            const ctrlMatch = keys.includes('ctrl') === e.ctrlKey;\r\n            const shiftMatch = keys.includes('shift') === e.shiftKey;\r\n            const altMatch = keys.includes('alt') === e.altKey;\r\n\r\n            if (ctrlMatch && shiftMatch && altMatch && pressedKey === triggerKey) {\r\n                e.preventDefault();\r\n\r\n                // Show white screen instantly (if panic-overlay exists in parent)\r\n                const parentOverlay = window.parent?.document?.getElementById('panic-overlay');\r\n                if (parentOverlay) {\r\n                    parentOverlay.style.display = 'block';\r\n                } else {\r\n                    // Create overlay if it doesn't exist\r\n                    const overlay = document.createElement('div');\r\n                    overlay.id = 'panic-overlay';\r\n                    overlay.style.cssText = 'position:fixed;inset:0;background:white;z-index:99999;';\r\n                    document.body.appendChild(overlay);\r\n                }\r\n\r\n                // Redirect immediately\r\n                const url = settings.panicUrl || 'https://classroom.google.com';\r\n                try { window.top.location.href = url; } catch { window.location.href = url; }\r\n            }\r\n        }, true); // Use capture phase for faster response\r\n    }\r\n\r\n    // Cloaking logic has been moved to scripts/cloaking.js for better synchronization.\r\n    // If you need cloaking on a specific page, include that script.\r\n\r\n\r\n    window.addEventListener('beforeunload', (e) => {\r\n        // Reload settings to get latest value\r\n        try { settings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n\r\n        if (window.top === window.self && settings.leaveConfirmation) {\r\n            e.preventDefault();\r\n            e.returnValue = '';\r\n            return '';\r\n        }\r\n    });\r\n\r\n    // discord\r\n    let crateInstance = null;\r\n\r\n    function initDiscord() {\r\n        if (settings.discordWidget && config.discord && config.discord.widgetServer && config.discord.widgetChannel) {\r\n            // Check if already loaded\r\n            if (document.querySelector('script[src*=\"@widgetbot/crate\"]')) {\r\n                if (crateInstance) crateInstance.show();\r\n                return;\r\n            }\r\n\r\n            const crateScript = document.createElement('script');\r\n            crateScript.src = 'https://cdn.jsdelivr.net/npm/@widgetbot/crate@3';\r\n            crateScript.async = true;\r\n            crateScript.defer = true;\r\n            crateScript.onload = () => {\r\n                crateInstance = new Crate({\r\n                    server: config.discord.widgetServer,\r\n                    channel: config.discord.widgetChannel,\r\n                    glyph: ['https://cdn.discordapp.com/embed/avatars/0.png', '100%'],\r\n                    location: ['bottom', 'right']\r\n                });\r\n            };\r\n            document.body.appendChild(crateScript);\r\n        } else {\r\n            // Hide if disabled\r\n            if (crateInstance) crateInstance.hide();\r\n        }\r\n    }\r\n\r\n    // Initialize\r\n    initDiscord();\r\n\r\n    // Listen for settings change to toggle dynamically\r\n    window.addEventListener('storage', (e) => {\r\n        if (e.key === STORAGE_KEY) {\r\n            try { settings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n            initDiscord();\r\n        }\r\n    });\r\n\r\n    // Listen for internal event\r\n    window.addEventListener('settings-changed', (e) => {\r\n        settings = e.detail;\r\n        initDiscord();\r\n    });\r\n\r\n    // counters\r\n    // Only show on home page (index2.html) checking if main-content exists\r\n    const mainContent = document.querySelector('.main-content');\r\n    // Ensure we are on the home page view (search bar checks etc) or just check existence\r\n    if (mainContent && document.querySelector('.featured-section')) {\r\n        const counterContainer = document.createElement('div');\r\n        counterContainer.id = 'supercounters-wrapper';\r\n        counterContainer.style.marginTop = '24px';\r\n        counterContainer.style.textAlign = 'center';\r\n        counterContainer.style.opacity = '0.8';\r\n\r\n        // Use iframe to isolate document.write from the widget\r\n        const iframe = document.createElement('iframe');\r\n        iframe.style.border = 'none';\r\n        iframe.style.width = '150px';\r\n        iframe.style.height = '40px';\r\n        iframe.style.overflow = 'hidden';\r\n\r\n        // Widget code\r\n        const widgetCode = `\r\n            <html>\r\n            <body style=\"margin:0;display:flex;justify-content:center;align-items:center;background:transparent;\">\r\n                <script type=\"text/javascript\" src=\"//widget.supercounters.com/ssl/online_i.js\"><\\/script>\r\n                <script type=\"text/javascript\">sc_online_i(1726449,\"ffffff\",\"000000\");<\\/script>\r\n            </body>\r\n            </html>\r\n        `;\r\n\r\n        iframe.srcdoc = widgetCode;\r\n        counterContainer.appendChild(iframe);\r\n        mainContent.appendChild(counterContainer);\r\n    }\r\n})();\r\n\n</script>\r\n</body>\r\n\r\n</html>","pages/error.html":"<!DOCTYPE html>\r\n<html dir=\"ltr\" lang=\"en\">\r\n\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n    <title></title>\r\n    <style>\r\n     \r\n        html {\r\n            -webkit-text-size-adjust: 100%;\r\n            font-size: 100%;\r\n        }\r\n\r\n        body {\r\n            --background-color: #fff;\r\n            --error-code-color: var(--google-gray-700);\r\n            --google-blue-100: rgb(210, 227, 252);\r\n            --google-blue-300: rgb(138, 180, 248);\r\n            --google-blue-600: rgb(26, 115, 232);\r\n            --google-blue-700: rgb(25, 103, 210);\r\n            --google-gray-100: rgb(241, 243, 244);\r\n            --google-gray-300: rgb(218, 220, 224);\r\n            --google-gray-500: rgb(154, 160, 166);\r\n            --google-gray-50: rgb(248, 249, 250);\r\n            --google-gray-600: rgb(128, 134, 139);\r\n            --google-gray-700: rgb(95, 99, 104);\r\n            --google-gray-800: rgb(60, 64, 67);\r\n            --google-gray-900: rgb(32, 33, 36);\r\n            --heading-color: var(--google-gray-900);\r\n            --link-color: rgb(88, 88, 88);\r\n            --primary-button-fill-color-active: var(--google-blue-700);\r\n            --primary-button-fill-color: var(--google-blue-600);\r\n            --primary-button-text-color: #fff;\r\n            --quiet-background-color: rgb(247, 247, 247);\r\n            --secondary-button-border-color: var(--google-gray-500);\r\n            --secondary-button-fill-color: #fff;\r\n            --secondary-button-hover-border-color: var(--google-gray-600);\r\n            --secondary-button-hover-fill-color: var(--google-gray-50);\r\n            --secondary-button-text-color: var(--google-gray-700);\r\n            --small-link-color: var(--google-gray-700);\r\n            --text-color: var(--google-gray-700);\r\n            background: var(--background-color);\r\n            color: var(--text-color);\r\n            word-wrap: break-word;\r\n            font-family: 'Segoe UI', Tahoma, sans-serif;\r\n            margin: 0;\r\n            font-size: 100%;\r\n        }\r\n\r\n        @media (prefers-color-scheme: dark) {\r\n            body {\r\n                --background-color: var(--google-gray-900);\r\n                --error-code-color: var(--google-gray-500);\r\n                --heading-color: var(--google-gray-500);\r\n                --link-color: var(--google-blue-300);\r\n                --primary-button-fill-color-active: rgb(129, 162, 208);\r\n                --primary-button-fill-color: var(--google-blue-300);\r\n                --primary-button-text-color: var(--google-gray-900);\r\n                --quiet-background-color: var(--background-color);\r\n                --secondary-button-border-color: var(--google-gray-700);\r\n                --secondary-button-fill-color: var(--google-gray-900);\r\n                --secondary-button-hover-fill-color: rgb(48, 51, 57);\r\n                --secondary-button-text-color: var(--google-blue-300);\r\n                --small-link-color: var(--google-blue-300);\r\n                --text-color: var(--google-gray-500);\r\n            }\r\n        }\r\n\r\n        /* Layout & Typography */\r\n        .interstitial-wrapper {\r\n            box-sizing: border-box;\r\n            font-size: 1.0em;\r\n            line-height: 1.6em;\r\n            margin: 14vh auto 0;\r\n            max-width: 600px;\r\n            width: 100%;\r\n            padding: 0 0px;\r\n        }\r\n\r\n        h1 {\r\n            color: var(--heading-color);\r\n            font-size: 1.6em;\r\n            font-weight: normal;\r\n            line-height: 1.25em;\r\n            margin-bottom: 16px;\r\n            margin-top: 0;\r\n            word-wrap: break-word;\r\n        }\r\n\r\n        h1 span {\r\n            font-weight: 500;\r\n        }\r\n\r\n        p {\r\n            margin: 0;\r\n        }\r\n\r\n        a {\r\n            color: var(--link-color);\r\n            text-decoration: none;\r\n        }\r\n\r\n        .icon {\r\n            height: 72px;\r\n            margin: 0 0 40px;\r\n            width: 72px;\r\n            background-repeat: no-repeat;\r\n            background-size: 100%;\r\n            display: inline-block;\r\n        }\r\n\r\n        .icon-generic {\r\n            content: image-set(url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJAAAACQAQMAAADdiHD7AAAABlBMVEUAAABTU1OoaSf/AAAAAXRSTlMAQObYZgAAAFJJREFUeF7t0cENgDAMQ9FwYgxG6WjpaIzCCAxQxVggFuDiCvlLOeRdHR9yzjncHVoq3npu+wQUrUuJHylSTmBaespJyJQoObUeyxDQb3bEm5Au81c0pSCD8HYAAAAASUVORK5CYII=) 2x);\r\n        }\r\n\r\n        @media (prefers-color-scheme: dark) {\r\n            .icon {\r\n                filter: invert(1);\r\n            }\r\n        }\r\n\r\n        .error-code {\r\n            color: var(--error-code-color);\r\n            font-size: .8em;\r\n            margin-top: 12px;\r\n            text-transform: uppercase;\r\n        }\r\n\r\n        /* Navigation / Buttons */\r\n        .nav-wrapper {\r\n            margin-top: 51px;\r\n        }\r\n\r\n        .nav-wrapper::after {\r\n            clear: both;\r\n            content: '';\r\n            display: table;\r\n            width: 100%;\r\n        }\r\n\r\n        button {\r\n            appearance: auto;\r\n            background-attachment: scroll;\r\n            background-clip: border-box;\r\n            background-color: rgb(193, 196, 255);\r\n            background-image: none;\r\n            background-origin: padding-box;\r\n            background-position-x: 0%;\r\n            background-position-y: 0%;\r\n            background-repeat: repeat;\r\n            background-size: auto;\r\n            border-bottom-color: rgb(32, 33, 36);\r\n            border-bottom-left-radius: 20px;\r\n            border-bottom-right-radius: 20px;\r\n            border-bottom-style: none;\r\n            border-bottom-width: 0px;\r\n            border-image-outset: 0;\r\n            border-image-repeat: stretch;\r\n            border-image-slice: 100%;\r\n            border-image-source: none;\r\n            border-image-width: 1;\r\n            border-left-color: rgb(32, 33, 36);\r\n            border-left-style: none;\r\n            border-left-width: 0px;\r\n            border-right-color: rgb(32, 33, 36);\r\n            border-right-style: none;\r\n            border-right-width: 0px;\r\n            border-top-color: rgb(32, 33, 36);\r\n            border-top-left-radius: 20px;\r\n            border-top-right-radius: 20px;\r\n            border-top-style: none;\r\n            border-top-width: 0px;\r\n            box-sizing: border-box;\r\n            color: rgb(32, 33, 36);\r\n            cursor: pointer;\r\n            display: block;\r\n            float: right;\r\n            font-family: Arial;\r\n            font-feature-settings: normal;\r\n            font-kerning: auto;\r\n            font-language-override: normal;\r\n            font-optical-sizing: auto;\r\n            font-size: 13.125px;\r\n            font-size-adjust: none;\r\n            font-stretch: 100%;\r\n            font-style: normal;\r\n            font-variant-alternates: normal;\r\n            font-variant-caps: normal;\r\n            font-variant-east-asian: normal;\r\n            font-variant-emoji: normal;\r\n            font-variant-ligatures: normal;\r\n            font-variant-numeric: normal;\r\n            font-variant-position: normal;\r\n            font-variation-settings: normal;\r\n            font-weight: 400;\r\n            height: 33.3333px;\r\n            letter-spacing: normal;\r\n            line-height: normal;\r\n            margin-bottom: 0px;\r\n            margin-left: 0px;\r\n            margin-right: 0px;\r\n            margin-top: 0px;\r\n            overflow-wrap: break-word;\r\n            padding-block-end: 9px;\r\n            padding-block-start: 9px;\r\n            padding-bottom: 9px;\r\n            padding-inline-end: 9px;\r\n            padding-inline-start: 9px;\r\n            padding-left: 9px;\r\n            padding-right: 9px;\r\n            padding-top: 9px;\r\n            text-align: center;\r\n            text-indent: 0px;\r\n            text-rendering: auto;\r\n            text-shadow: none;\r\n            text-size-adjust: 100%;\r\n            text-transform: none;\r\n            transition-behavior: normal;\r\n            transition-delay: 0s;\r\n            transition-duration: 0.15s;\r\n            transition-property: box-shadow;\r\n            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\r\n            user-select: none;\r\n            width: 59.5833px;\r\n            word-spacing: 0px;\r\n            -webkit-border-image: none;\r\n        }\r\n\r\n        .suggested-left>#control-buttons {\r\n            float: left;\r\n        }\r\n\r\n        /* Mobile tweaks */\r\n        @media (max-width: 420px) {\r\n            .nav-wrapper .secondary-button {\r\n                float: none;\r\n                margin: 16px 0 0;\r\n                padding: 16px;\r\n                width: 100%;\r\n            }\r\n\r\n            button {\r\n                float: none;\r\n                width: 100%;\r\n            }\r\n\r\n            .suggested-left>#control-buttons {\r\n                float: none;\r\n            }\r\n        }\r\n\r\n        /* Fixed nav for strict heights/widths */\r\n        @media (min-width: 240px) and (max-width: 420px) and (min-height: 401px),\r\n        (min-width: 421px) and (min-height: 240px) and (max-height: 560px) {\r\n            .nav-wrapper {\r\n                background: var(--background-color);\r\n                bottom: 0;\r\n                box-shadow: 0 -12px 24px var(--background-color);\r\n                left: 0;\r\n                margin: 0 auto;\r\n                max-width: 1000px;\r\n                padding-inline-end: 24px;\r\n                padding-inline-start: 24px;\r\n                position: fixed;\r\n                right: 0;\r\n                width: 100%;\r\n                z-index: 2;\r\n                padding-bottom: 24px;\r\n                padding-top: 24px;\r\n            }\r\n\r\n            .interstitial-wrapper {\r\n                max-width: 736px;\r\n            }\r\n\r\n            #main-content {\r\n                padding-bottom: 40px;\r\n            }\r\n        }\r\n    </style>\r\n</head>\r\n\r\n<body class=\"neterror\">\r\n    <div id=\"main-frame-error\" class=\"interstitial-wrapper\">\r\n        <div id=\"main-content\">\r\n            <div class=\"icon icon-generic\"></div>\r\n            <div id=\"main-message\">\r\n                <h1>\r\n                    <span>This site cant be reached</span>\r\n                </h1>\r\n                <p>\r\n                    <strong id=\"origin-text\"></strong>s <abbr id=\"dnsDefinition\">DNS address</abbr> could not be found.\r\n                    Diagnosing the problem.\r\n                </p>\r\n                <div class=\"error-code\">DNS_PROBE_POSSIBLE</div>\r\n            </div>\r\n        </div>\r\n        <div id=\"buttons\" class=\"nav-wrapper suggested-left\">\r\n            <div id=\"control-buttons\">\r\n                <button id=\"reload-button\" class=\"text-button\" onclick=\"location.reload()\">Reload</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <script>\r\n        const origin = window.location.hostname || \"This site\";\r\n        document.getElementById(\"origin-text\").textContent = origin;\r\n        document.title = origin;\r\n\r\n        // Remove favicon for fake error page\r\n        document.querySelectorAll(\"link[rel*='icon']\").forEach(l => l.remove());\r\n        const link = document.createElement('link');\r\n        link.rel = 'icon';\r\n        link.href = 'data:,';\r\n        document.head.appendChild(link);\r\n    </script>\r\n</body>\r\n\r\n</html>","pages/extra.html":"<!DOCTYPE html>\r\n<html lang=\"en\">\r\n\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n    <title>About - Phantom</title>\r\n    <link rel=\"icon\" href=\"../favicon.svg\" type=\"image/svg+xml\">\r\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css\">\r\n    <style>\n/* phantom styling */\r\n\r\n@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');\r\n\r\n/* variables */\r\n:root {\r\n    /* Core colors (can be overridden by user settings) */\r\n    --bg: #0a0a0a;\r\n    --surface: #0f0f0f;\r\n    --surface-hover: #1a1a1a;\r\n    --surface-active: #252525;\r\n    --border: #1f1f1f;\r\n    --border-light: #2a2a2a;\r\n\r\n    /* Text */\r\n    --text: #e4e4e7;\r\n    --text-muted: #71717a;\r\n    --text-dim: #52525b;\r\n\r\n    /* Accent (customizable) */\r\n    --accent: #ffffff;\r\n    --accent-dim: rgba(255, 255, 255, 0.8);\r\n    --accent-glow: rgba(255, 255, 255, 0.1);\r\n\r\n    /* Status colors */\r\n    --success: #22c55e;\r\n    --warning: #f59e0b;\r\n    --error: #ef4444;\r\n    --info: #3b82f6;\r\n\r\n    /* Shadows */\r\n    --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.3);\r\n    --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.4);\r\n    --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.5);\r\n    --shadow-xl: 0 16px 48px rgba(0, 0, 0, 0.6);\r\n\r\n    /* Spacing */\r\n    --space-xs: 4px;\r\n    --space-sm: 8px;\r\n    --space-md: 16px;\r\n    --space-lg: 24px;\r\n    --space-xl: 32px;\r\n    --space-2xl: 48px;\r\n\r\n    /* Border radius */\r\n    --radius-sm: 4px;\r\n    --radius-md: 8px;\r\n    --radius-lg: 12px;\r\n    --radius-xl: 16px;\r\n    --radius-full: 9999px;\r\n\r\n    /* Transitions */\r\n    --transition-fast: 0.1s ease;\r\n    --transition-normal: 0.2s ease;\r\n    --transition-slow: 0.3s ease;\r\n\r\n    /* Z-index layers */\r\n    --z-base: 1;\r\n    --z-dropdown: 100;\r\n    --z-sticky: 500;\r\n    --z-modal: 1000;\r\n    --z-toast: 2000;\r\n    --z-max: 9999;\r\n\r\n    /* Typography */\r\n    --font-sans: 'Inter', system-ui, -apple-system, sans-serif;\r\n    --font-mono: 'JetBrains Mono', 'Fira Code', monospace;\r\n\r\n    /* Background (customizable) */\r\n    --bg-image: none;\r\n}\r\n\r\n/* base */\r\n*,\r\n*::before,\r\n*::after {\r\n    box-sizing: border-box;\r\n    margin: 0;\r\n    padding: 0;\r\n}\r\n\r\nhtml {\r\n    font-size: 16px;\r\n    scroll-behavior: smooth;\r\n    -webkit-font-smoothing: antialiased;\r\n    -moz-osx-font-smoothing: grayscale;\r\n}\r\n\r\nbody {\r\n    font-family: var(--font-sans);\r\n    background: var(--bg);\r\n    background-image: var(--bg-image);\r\n    background-size: cover;\r\n    background-position: var(--bg-image-position, center);\r\n    background-attachment: fixed;\r\n    color: var(--text);\r\n    line-height: 1.5;\r\n    min-height: 100vh;\r\n    overflow-x: hidden;\r\n}\r\n\r\n/* Ensure background manager takes precedence */\r\nhtml.phantom-bg-active body {\r\n    background: transparent !important;\r\n    background-image: none !important;\r\n}\r\n\r\n/* Selection */\r\n::selection {\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n}\r\n\r\n/* Focus states */\r\n:focus-visible {\r\n    outline: 2px solid var(--accent);\r\n    outline-offset: 2px;\r\n}\r\n\r\n/* Links */\r\na {\r\n    color: var(--accent);\r\n    text-decoration: none;\r\n    transition: opacity var(--transition-fast);\r\n}\r\n\r\na:hover {\r\n    opacity: 0.8;\r\n}\r\n\r\n/* Scrollbar */\r\n::-webkit-scrollbar {\r\n    width: 8px;\r\n    height: 8px;\r\n}\r\n\r\n::-webkit-scrollbar-track {\r\n    background: var(--surface);\r\n}\r\n\r\n::-webkit-scrollbar-thumb {\r\n    background: var(--border-light);\r\n    border-radius: var(--radius-full);\r\n}\r\n\r\n::-webkit-scrollbar-thumb:hover {\r\n    background: var(--text-muted);\r\n}\r\n\r\n/* text */\r\nh1,\r\nh2,\r\nh3,\r\nh4,\r\nh5,\r\nh6 {\r\n    font-weight: 600;\r\n    line-height: 1.2;\r\n    color: var(--text);\r\n}\r\n\r\nh1 {\r\n    font-size: 2.5rem;\r\n}\r\n\r\nh2 {\r\n    font-size: 2rem;\r\n}\r\n\r\nh3 {\r\n    font-size: 1.5rem;\r\n}\r\n\r\nh4 {\r\n    font-size: 1.25rem;\r\n}\r\n\r\nh5 {\r\n    font-size: 1rem;\r\n}\r\n\r\nh6 {\r\n    font-size: 0.875rem;\r\n}\r\n\r\np {\r\n    color: var(--text-muted);\r\n    line-height: 1.6;\r\n}\r\n\r\n.text-sm {\r\n    font-size: 0.875rem;\r\n}\r\n\r\n.text-xs {\r\n    font-size: 0.75rem;\r\n}\r\n\r\n.text-lg {\r\n    font-size: 1.125rem;\r\n}\r\n\r\n.text-muted {\r\n    color: var(--text-muted);\r\n}\r\n\r\n.text-dim {\r\n    color: var(--text-dim);\r\n}\r\n\r\n.text-center {\r\n    text-align: center;\r\n}\r\n\r\n/* buttons */\r\n.btn {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    gap: var(--space-sm);\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-family: var(--font-sans);\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-md);\r\n    background: var(--surface);\r\n    color: var(--text);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n    white-space: nowrap;\r\n}\r\n\r\n.btn:hover {\r\n    background: var(--surface-hover);\r\n    border-color: var(--border-light);\r\n}\r\n\r\n.btn:active {\r\n    background: var(--surface-active);\r\n    transform: scale(0.98);\r\n}\r\n\r\n.btn-primary {\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n    border-color: var(--accent);\r\n}\r\n\r\n.btn-primary:hover {\r\n    opacity: 0.9;\r\n    background: var(--accent);\r\n}\r\n\r\n.btn-ghost {\r\n    background: transparent;\r\n    border-color: transparent;\r\n}\r\n\r\n.btn-ghost:hover {\r\n    background: var(--surface-hover);\r\n}\r\n\r\n.btn-icon {\r\n    width: 36px;\r\n    height: 36px;\r\n    padding: 0;\r\n    border-radius: var(--radius-md);\r\n}\r\n\r\n.btn-sm {\r\n    padding: var(--space-xs) var(--space-sm);\r\n    font-size: 0.75rem;\r\n}\r\n\r\n.btn-lg {\r\n    padding: var(--space-md) var(--space-lg);\r\n    font-size: 1rem;\r\n}\r\n\r\n/* inputs */\r\n.input {\r\n    width: 100%;\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-family: var(--font-sans);\r\n    font-size: 0.875rem;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-md);\r\n    color: var(--text);\r\n    transition: border-color var(--transition-fast);\r\n}\r\n\r\n.input:hover {\r\n    border-color: var(--border-light);\r\n}\r\n\r\n.input:focus {\r\n    outline: none;\r\n    border-color: var(--accent);\r\n}\r\n\r\n.input::placeholder {\r\n    color: var(--text-dim);\r\n}\r\n\r\n.input-group {\r\n    display: flex;\r\n    gap: var(--space-sm);\r\n}\r\n\r\n.input-group .input {\r\n    flex: 1;\r\n}\r\n\r\n/* Select */\r\n.select {\r\n    appearance: none;\r\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%2371717a' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E\");\r\n    background-repeat: no-repeat;\r\n    background-position: right 12px center;\r\n    padding-right: 36px;\r\n    cursor: pointer;\r\n}\r\n\r\n/* Checkbox/Toggle */\r\n.toggle {\r\n    position: relative;\r\n    width: 44px;\r\n    height: 24px;\r\n    background: var(--border);\r\n    border-radius: var(--radius-full);\r\n    cursor: pointer;\r\n    transition: background var(--transition-fast);\r\n}\r\n\r\n.toggle::after {\r\n    content: '';\r\n    position: absolute;\r\n    top: 2px;\r\n    left: 2px;\r\n    width: 20px;\r\n    height: 20px;\r\n    background: var(--text);\r\n    border-radius: 50%;\r\n    transition: transform var(--transition-fast);\r\n}\r\n\r\n.toggle.active {\r\n    background: var(--accent);\r\n}\r\n\r\n.toggle.active::after {\r\n    transform: translateX(20px);\r\n    background: var(--bg);\r\n}\r\n\r\n/* cards */\r\n.card {\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-lg);\r\n    overflow: hidden;\r\n    transition: all var(--transition-normal);\r\n}\r\n\r\n.card:hover {\r\n    border-color: var(--border-light);\r\n    box-shadow: var(--shadow-md);\r\n}\r\n\r\n.card-header {\r\n    padding: var(--space-md);\r\n    border-bottom: 1px solid var(--border);\r\n}\r\n\r\n.card-body {\r\n    padding: var(--space-md);\r\n}\r\n\r\n.card-footer {\r\n    padding: var(--space-md);\r\n    border-top: 1px solid var(--border);\r\n}\r\n\r\n\r\n/* Featured badge */\r\n.badge-featured {\r\n    position: absolute;\r\n    top: var(--space-sm);\r\n    left: var(--space-sm);\r\n    padding: var(--space-xs) var(--space-sm);\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n    font-size: 0.625rem;\r\n    font-weight: 700;\r\n    text-transform: uppercase;\r\n    letter-spacing: 0.05em;\r\n    border-radius: var(--radius-sm);\r\n}\r\n\r\n/* Favorite star */\r\n.favorite-btn {\r\n    position: absolute;\r\n    top: var(--space-sm);\r\n    right: var(--space-sm);\r\n    width: 32px;\r\n    height: 32px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background: rgba(0, 0, 0, 0.5);\r\n    border: none;\r\n    border-radius: 50%;\r\n    color: var(--text-muted);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n    opacity: 0;\r\n}\r\n\r\n.media-card:hover .favorite-btn {\r\n    opacity: 1;\r\n}\r\n\r\n.favorite-btn:hover {\r\n    background: rgba(0, 0, 0, 0.7);\r\n    color: var(--text);\r\n}\r\n\r\n.favorite-btn.active {\r\n    color: #fbbf24;\r\n    opacity: 1;\r\n}\r\n\r\n/* grid */\r\n.grid {\r\n    display: grid;\r\n    gap: var(--space-md);\r\n}\r\n\r\n.grid-cols-2 {\r\n    grid-template-columns: repeat(2, 1fr);\r\n}\r\n\r\n.grid-cols-3 {\r\n    grid-template-columns: repeat(3, 1fr);\r\n}\r\n\r\n.grid-cols-4 {\r\n    grid-template-columns: repeat(4, 1fr);\r\n}\r\n\r\n.grid-cols-5 {\r\n    grid-template-columns: repeat(5, 1fr);\r\n}\r\n\r\n.grid-cols-6 {\r\n    grid-template-columns: repeat(6, 1fr);\r\n}\r\n\r\n/* Auto-fit grid for responsive cards */\r\n.grid-auto {\r\n    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));\r\n}\r\n\r\n.grid-auto-lg {\r\n    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\r\n}\r\n\r\n/* flex */\r\n.flex {\r\n    display: flex;\r\n}\r\n\r\n.flex-col {\r\n    flex-direction: column;\r\n}\r\n\r\n.flex-wrap {\r\n    flex-wrap: wrap;\r\n}\r\n\r\n.items-center {\r\n    align-items: center;\r\n}\r\n\r\n.items-start {\r\n    align-items: flex-start;\r\n}\r\n\r\n.items-end {\r\n    align-items: flex-end;\r\n}\r\n\r\n.justify-center {\r\n    justify-content: center;\r\n}\r\n\r\n.justify-between {\r\n    justify-content: space-between;\r\n}\r\n\r\n.justify-end {\r\n    justify-content: flex-end;\r\n}\r\n\r\n.gap-xs {\r\n    gap: var(--space-xs);\r\n}\r\n\r\n.gap-sm {\r\n    gap: var(--space-sm);\r\n}\r\n\r\n.gap-md {\r\n    gap: var(--space-md);\r\n}\r\n\r\n.gap-lg {\r\n    gap: var(--space-lg);\r\n}\r\n\r\n.flex-1 {\r\n    flex: 1;\r\n}\r\n\r\n/* spacing */\r\n.p-xs {\r\n    padding: var(--space-xs);\r\n}\r\n\r\n.p-sm {\r\n    padding: var(--space-sm);\r\n}\r\n\r\n.p-md {\r\n    padding: var(--space-md);\r\n}\r\n\r\n.p-lg {\r\n    padding: var(--space-lg);\r\n}\r\n\r\n.p-xl {\r\n    padding: var(--space-xl);\r\n}\r\n\r\n.m-xs {\r\n    margin: var(--space-xs);\r\n}\r\n\r\n.m-sm {\r\n    margin: var(--space-sm);\r\n}\r\n\r\n.m-md {\r\n    margin: var(--space-md);\r\n}\r\n\r\n.m-lg {\r\n    margin: var(--space-lg);\r\n}\r\n\r\n.mt-sm {\r\n    margin-top: var(--space-sm);\r\n}\r\n\r\n.mt-md {\r\n    margin-top: var(--space-md);\r\n}\r\n\r\n.mt-lg {\r\n    margin-top: var(--space-lg);\r\n}\r\n\r\n.mb-sm {\r\n    margin-bottom: var(--space-sm);\r\n}\r\n\r\n.mb-md {\r\n    margin-bottom: var(--space-md);\r\n}\r\n\r\n.mb-lg {\r\n    margin-bottom: var(--space-lg);\r\n}\r\n\r\n/* modals */\r\n.modal-overlay {\r\n    position: fixed;\r\n    inset: 0;\r\n    background: rgba(0, 0, 0, 0.8);\r\n    backdrop-filter: blur(4px);\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    z-index: var(--z-modal);\r\n    opacity: 0;\r\n    visibility: hidden;\r\n    transition: all var(--transition-normal);\r\n}\r\n\r\n.modal-overlay.show {\r\n    opacity: 1;\r\n    visibility: visible;\r\n}\r\n\r\n.modal {\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-xl);\r\n    max-width: 90vw;\r\n    max-height: 90vh;\r\n    overflow: hidden;\r\n    transform: scale(0.95);\r\n    transition: transform var(--transition-normal);\r\n}\r\n\r\n.modal-overlay.show .modal {\r\n    transform: scale(1);\r\n}\r\n\r\n.modal-header {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    padding: var(--space-md);\r\n    border-bottom: 1px solid var(--border);\r\n}\r\n\r\n.modal-title {\r\n    font-size: 1rem;\r\n    font-weight: 600;\r\n}\r\n\r\n.modal-close {\r\n    width: 32px;\r\n    height: 32px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background: transparent;\r\n    border: none;\r\n    color: var(--text-muted);\r\n    cursor: pointer;\r\n    border-radius: var(--radius-md);\r\n    transition: all var(--transition-fast);\r\n}\r\n\r\n.modal-close:hover {\r\n    background: var(--surface-hover);\r\n    color: var(--text);\r\n}\r\n\r\n.modal-body {\r\n    padding: var(--space-md);\r\n    overflow-y: auto;\r\n}\r\n\r\n.modal-footer {\r\n    display: flex;\r\n    justify-content: flex-end;\r\n    gap: var(--space-sm);\r\n    padding: var(--space-md);\r\n    border-top: 1px solid var(--border);\r\n}\r\n\r\n/* tabs */\r\n.tabs {\r\n    display: flex;\r\n    gap: 2px;\r\n    background: var(--surface);\r\n    padding: var(--space-xs);\r\n    border-radius: var(--radius-md);\r\n    border: 1px solid var(--border);\r\n}\r\n\r\n.tab {\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    color: var(--text-muted);\r\n    background: transparent;\r\n    border: none;\r\n    border-radius: var(--radius-sm);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n}\r\n\r\n.tab:hover {\r\n    color: var(--text);\r\n}\r\n\r\n.tab.active {\r\n    background: var(--surface-hover);\r\n    color: var(--text);\r\n}\r\n\r\n/* search */\r\n\r\n/* ============================================\r\n   OFFLINE INDICATOR\r\n   ============================================ */\r\n.offline-banner {\r\n    position: fixed;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    padding: var(--space-sm) var(--space-md);\r\n    background: var(--warning);\r\n    color: var(--bg);\r\n    text-align: center;\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    z-index: var(--z-toast);\r\n    transform: translateY(-100%);\r\n    transition: transform var(--transition-normal);\r\n}\r\n\r\n.offline-banner.show {\r\n    transform: translateY(0);\r\n}\r\n\r\n.offline-badge {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    gap: var(--space-xs);\r\n    padding: var(--space-xs) var(--space-sm);\r\n    background: var(--warning);\r\n    color: var(--bg);\r\n    font-size: 0.625rem;\r\n    font-weight: 600;\r\n    text-transform: uppercase;\r\n    border-radius: var(--radius-sm);\r\n}\r\n\r\n/* ============================================\r\n   LOADING STATES\r\n   ============================================ */\r\n.skeleton {\r\n    background: linear-gradient(90deg, var(--surface) 0%, var(--surface-hover) 50%, var(--surface) 100%);\r\n    background-size: 200% 100%;\r\n    animation: shimmer 1.5s infinite;\r\n    border-radius: var(--radius-md);\r\n}\r\n\r\n@keyframes shimmer {\r\n    0% {\r\n        background-position: 200% 0;\r\n    }\r\n\r\n    100% {\r\n        background-position: -200% 0;\r\n    }\r\n}\r\n\r\n.spinner {\r\n    width: 24px;\r\n    height: 24px;\r\n    border: 2px solid var(--border);\r\n    border-top-color: var(--accent);\r\n    border-radius: 50%;\r\n    animation: spin 0.8s linear infinite;\r\n}\r\n\r\n@keyframes spin {\r\n    to {\r\n        transform: rotate(360deg);\r\n    }\r\n}\r\n\r\n/* ============================================\r\n   ANIMATIONS\r\n   ============================================ */\r\n@keyframes fadeIn {\r\n    from {\r\n        opacity: 0;\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n    }\r\n}\r\n\r\n@keyframes slideUp {\r\n    from {\r\n        opacity: 0;\r\n        transform: translateY(10px);\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n        transform: translateY(0);\r\n    }\r\n}\r\n\r\n@keyframes scaleIn {\r\n    from {\r\n        opacity: 0;\r\n        transform: scale(0.95);\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n        transform: scale(1);\r\n    }\r\n}\r\n\r\n.animate-fadeIn {\r\n    animation: fadeIn var(--transition-normal) ease;\r\n}\r\n\r\n.animate-slideUp {\r\n    animation: slideUp var(--transition-normal) ease;\r\n}\r\n\r\n.animate-scaleIn {\r\n    animation: scaleIn var(--transition-normal) ease;\r\n}\r\n\r\n/* ============================================\r\n   UTILITIES\r\n   ============================================ */\r\n.hidden {\r\n    display: none !important;\r\n}\r\n\r\n.sr-only {\r\n    position: absolute;\r\n    width: 1px;\r\n    height: 1px;\r\n    padding: 0;\r\n    margin: -1px;\r\n    overflow: hidden;\r\n    clip: rect(0, 0, 0, 0);\r\n    border: 0;\r\n}\r\n\r\n.truncate {\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n}\r\n\r\n.w-full {\r\n    width: 100%;\r\n}\r\n\r\n.h-full {\r\n    height: 100%;\r\n}\r\n\r\n.relative {\r\n    position: relative;\r\n}\r\n\r\n.absolute {\r\n    position: absolute;\r\n}\r\n\r\n.fixed {\r\n    position: fixed;\r\n}\r\n\r\n.inset-0 {\r\n    inset: 0;\r\n}\r\n\r\n/* ============================================\r\n   RESPONSIVE\r\n   ============================================ */\r\n@media (max-width: 768px) {\r\n    h1 {\r\n        font-size: 1.75rem;\r\n    }\r\n\r\n    h2 {\r\n        font-size: 1.5rem;\r\n    }\r\n\r\n    h3 {\r\n        font-size: 1.25rem;\r\n    }\r\n\r\n    .grid-auto {\r\n        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));\r\n    }\r\n\r\n    .hide-mobile {\r\n        display: none !important;\r\n    }\r\n}\r\n\r\n@media (min-width: 769px) {\r\n    .hide-desktop {\r\n        display: none !important;\r\n    }\r\n}\n</style>\r\n    <style>\n/* ============================================\r\n   EXTRA PAGE - LIGHTWEIGHT STYLES\r\n   ============================================ */\r\n\r\n.extra-page {\r\n    max-width: 600px;\r\n    margin: 0 auto;\r\n    padding: 80px 24px 60px;\r\n}\r\n\r\n/* Hero */\r\n.extra-hero {\r\n    text-align: center;\r\n    margin-bottom: 48px;\r\n}\r\n\r\n.extra-hero-icon {\r\n    font-size: 3rem;\r\n    margin-bottom: 16px;\r\n    color: var(--text-muted);\r\n}\r\n\r\n.extra-hero h1 {\r\n    font-size: 2rem;\r\n    font-weight: 600;\r\n    margin-bottom: 8px;\r\n}\r\n\r\n.version-badge {\r\n    display: inline-block;\r\n    padding: 4px 12px;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-full);\r\n    font-size: 0.75rem;\r\n    color: var(--text-dim);\r\n    margin-bottom: 16px;\r\n}\r\n\r\n.extra-hero p {\r\n    color: var(--text-muted);\r\n    font-size: 0.9375rem;\r\n    max-width: 400px;\r\n    margin: 0 auto;\r\n}\r\n\r\n/* Quick Links */\r\n.quick-links {\r\n    display: flex;\r\n    justify-content: center;\r\n    gap: 12px;\r\n    margin-top: 24px;\r\n}\r\n\r\n.quick-link {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    gap: 8px;\r\n    padding: 10px 18px;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-md);\r\n    font-size: 0.875rem;\r\n    color: var(--text-muted);\r\n    text-decoration: none;\r\n    transition: all 0.2s ease;\r\n}\r\n\r\n.quick-link:hover {\r\n    background: var(--surface-hover);\r\n    border-color: var(--border-light);\r\n    color: var(--text);\r\n    opacity: 1;\r\n}\r\n\r\n/* Section */\r\n.extra-section {\r\n    margin-bottom: 32px;\r\n}\r\n\r\n.extra-section-header {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 10px;\r\n    margin-bottom: 16px;\r\n    color: var(--text-muted);\r\n}\r\n\r\n.extra-section-header i {\r\n    font-size: 0.875rem;\r\n}\r\n\r\n.extra-section-header h2 {\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    text-transform: lowercase;\r\n}\r\n\r\n/* Credit Card */\r\n.credit-card {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 16px;\r\n    padding: 20px;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-lg);\r\n}\r\n\r\n.credit-avatar {\r\n    width: 48px;\r\n    height: 48px;\r\n    border-radius: 50%;\r\n    background: var(--surface-hover);\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    font-size: 1.25rem;\r\n    font-weight: 600;\r\n    color: var(--text-muted);\r\n}\r\n\r\n.credit-info h3 {\r\n    font-size: 1rem;\r\n    font-weight: 600;\r\n    margin-bottom: 2px;\r\n}\r\n\r\n.credit-info p {\r\n    font-size: 0.8125rem;\r\n    color: var(--text-dim);\r\n}\r\n\r\n/* Roadmap */\r\n.roadmap-container {\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-lg);\r\n    overflow: hidden;\r\n}\r\n\r\n.roadmap-toggle {\r\n    width: 100%;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    padding: 16px 20px;\r\n    background: transparent;\r\n    border: none;\r\n    color: var(--text-muted);\r\n    cursor: pointer;\r\n    font-family: inherit;\r\n    font-size: 0.875rem;\r\n    transition: background 0.15s;\r\n}\r\n\r\n.roadmap-toggle:hover {\r\n    background: var(--surface-hover);\r\n}\r\n\r\n.roadmap-toggle i {\r\n    transition: transform 0.2s;\r\n}\r\n\r\n.roadmap-toggle.open i {\r\n    transform: rotate(180deg);\r\n}\r\n\r\n.roadmap-content {\r\n    display: none;\r\n    padding: 0 20px 20px;\r\n}\r\n\r\n.roadmap-content.show {\r\n    display: block;\r\n}\r\n\r\n.roadmap-list {\r\n    list-style: none;\r\n}\r\n\r\n.roadmap-item {\r\n    display: flex;\r\n    align-items: flex-start;\r\n    gap: 10px;\r\n    padding: 10px 0;\r\n    border-bottom: 1px solid var(--border);\r\n    font-size: 0.8125rem;\r\n    color: var(--text-muted);\r\n    line-height: 1.5;\r\n}\r\n\r\n.roadmap-item:last-child {\r\n    border-bottom: none;\r\n}\r\n\r\n.roadmap-item.done {\r\n    text-decoration: line-through;\r\n    opacity: 0.4;\r\n}\r\n\r\n.roadmap-item i {\r\n    margin-top: 2px;\r\n    font-size: 0.6875rem;\r\n    opacity: 0.6;\r\n}\r\n\r\n.roadmap-item.done i {\r\n    color: var(--success);\r\n}\r\n\r\n.roadmap-item.pending i {\r\n    color: var(--text-dim);\r\n}\r\n\r\n/* Credits List */\r\n.credits-list {\r\n    list-style: none;\r\n}\r\n\r\n.credit-item {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    padding: 12px 0;\r\n    border-bottom: 1px solid var(--border);\r\n}\r\n\r\n.credit-item:last-child {\r\n    border-bottom: none;\r\n}\r\n\r\n.credit-name {\r\n    font-size: 0.875rem;\r\n    color: var(--text);\r\n    font-weight: 500;\r\n}\r\n\r\n.credit-role {\r\n    font-size: 0.75rem;\r\n    color: var(--text-dim);\r\n}\r\n\r\n/* License */\r\n.license-notice {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 14px;\r\n    padding: 20px;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-lg);\r\n}\r\n\r\n.license-notice>i {\r\n    font-size: 1.25rem;\r\n    color: var(--text-dim);\r\n}\r\n\r\n.license-notice-content h3 {\r\n    font-size: 0.9375rem;\r\n    font-weight: 600;\r\n    margin-bottom: 2px;\r\n}\r\n\r\n.license-notice-content p {\r\n    font-size: 0.8125rem;\r\n    color: var(--text-dim);\r\n}\r\n\r\n/* Back Link */\r\n.back-link {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    gap: 8px;\r\n    margin-top: 24px;\r\n    padding: 10px 16px;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-md);\r\n    color: var(--text-muted);\r\n    font-size: 0.8125rem;\r\n    text-decoration: none;\r\n    transition: all 0.2s;\r\n}\r\n\r\n.back-link:hover {\r\n    background: var(--surface-hover);\r\n    color: var(--text);\r\n    opacity: 1;\r\n}\r\n\r\n/* Mobile */\r\n@media (max-width: 480px) {\r\n    .extra-page {\r\n        padding: 80px 16px 40px;\r\n    }\r\n\r\n    .quick-links {\r\n        flex-direction: column;\r\n    }\r\n\r\n    .quick-link {\r\n        justify-content: center;\r\n    }\r\n}\n</style>\r\n    <style>\n/* Topbar Styles - Clean & Dark */\r\n/* Note: Inter font is imported in main.css */\r\n\r\nbody {\r\n    margin: 0;\r\n    padding: 0;\r\n    background-color: var(--bg);\r\n    font-family: 'Inter', sans-serif;\r\n}\r\n\r\n#topbar-container {\r\n    position: fixed;\r\n    top: 11px;\r\n    left: 50%;\r\n    transform: translateX(-50%);\r\n    background-color: var(--surface);\r\n    border-radius: 9999px;\r\n    padding: 8px 14px;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 10px;\r\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);\r\n    z-index: 10000;\r\n    border: 1px solid var(--border);\r\n    height: 48px;\r\n    box-sizing: border-box;\r\n}\r\n\r\n#topbar-container::before {\r\n    content: '';\r\n    position: absolute;\r\n    top: -7px;\r\n    bottom: -7px;\r\n    left: -7px;\r\n    right: -7px;\r\n    z-index: -1;\r\n    border-radius: 9999px;\r\n}\r\n\r\n.logo-section {\r\n    display: flex;\r\n    align-items: center;\r\n    padding-right: 10px;\r\n    border-right: 1px solid var(--border);\r\n    height: 32px;\r\n    text-decoration: none;\r\n    color: inherit;\r\n}\r\n\r\n.logo-placeholder {\r\n    width: 28px;\r\n    height: 28px;\r\n    background-color: var(--surface-hover);\r\n    border-radius: 6px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    color: var(--text-muted);\r\n}\r\n\r\n.logo-placeholder i,\r\n.logo-placeholder svg {\r\n    width: 16px;\r\n    height: 16px;\r\n}\r\n\r\n.nav-buttons {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 4px;\r\n}\r\n\r\n.nav-separator {\r\n    width: 1px;\r\n    height: 20px;\r\n    background-color: var(--border);\r\n    margin: 0 6px;\r\n}\r\n\r\n.nav-btn {\r\n    background: transparent;\r\n    border: none;\r\n    color: var(--text-muted);\r\n    text-decoration: none;\r\n    display: flex;\r\n    align-items: center;\r\n    padding: 6px 10px;\r\n    border-radius: 99px;\r\n    height: 32px;\r\n    box-sizing: border-box;\r\n    transition: color 0.15s, background-color 0.15s;\r\n    position: relative;\r\n}\r\n\r\n.nav-badge-beta {\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n    font-size: 8px;\r\n    font-weight: 700;\r\n    color: var(--text);\r\n    background: var(--secondary);\r\n    padding: 2px 4px;\r\n    border-radius: 4px;\r\n    line-height: 1;\r\n    transform: translate(20%, -20%);\r\n    pointer-events: none;\r\n}\r\n\r\n.nav-btn:hover {\r\n    color: var(--text);\r\n    background-color: var(--surface-hover);\r\n}\r\n\r\n.nav-btn i,\r\n.nav-btn svg {\r\n    width: 18px;\r\n    height: 18px;\r\n    min-width: 18px;\r\n}\r\n\r\n.nav-btn span {\r\n    max-width: 0;\r\n    opacity: 0;\r\n    margin-left: 0;\r\n    overflow: hidden;\r\n    white-space: nowrap;\r\n    font-weight: 500;\r\n    font-size: 13px;\r\n    transition: max-width 0.23s ease, opacity 0.17s ease, margin-left 0.23s ease;\r\n}\r\n\r\n#topbar-container:hover .nav-btn span {\r\n    max-width: 70px;\r\n    opacity: 1;\r\n    margin-left: 8px;\r\n}\n</style>\r\n    <style>\n/**\r\n * PHANTOM - BACKGROUND STYLES\r\n */\r\n.phantom-background {\r\n    position: fixed;\r\n    inset: 0;\r\n    width: 100vw;\r\n    height: 100vh;\r\n    z-index: -1;\r\n    overflow: hidden;\r\n    background: transparent;\r\n    pointer-events: none;\r\n    opacity: 1;\r\n    transition: background-color 0.3s ease;\r\n}\r\n\r\n.phantom-background.active {\r\n    opacity: 1;\r\n}\r\n\r\n.phantom-background-overlay {\r\n    position: absolute;\r\n    inset: 0;\r\n    z-index: 2;\r\n    background: rgba(0, 0, 0, var(--bg-overlay, 0.4));\r\n    transition: background-color 0.3s ease;\r\n}\r\n\r\n.phantom-background-layer {\r\n    position: absolute;\r\n    inset: 0;\r\n    z-index: 1;\r\n    transition: opacity 0.3s ease-in-out;\r\n}\r\n\r\n.phantom-background-media {\r\n    width: 100%;\r\n    height: 100%;\r\n    object-fit: cover;\r\n    object-position: var(--bg-image-position, center);\r\n    display: block;\r\n    border: none;\r\n}\r\n\r\n/* Video and Iframe positioning for full background cover */\r\n.phantom-background-layer video.phantom-background-media,\r\n.phantom-background-layer iframe.phantom-background-media {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    transform: none;\r\n    pointer-events: none;\r\n    min-width: 100%;\r\n    min-height: 100%;\r\n    max-width: none;\r\n    max-height: none;\r\n    object-position: var(--bg-image-position, center);\r\n}\r\n\r\n/* Ensure iframes cover entire background */\r\n.phantom-background-layer iframe.phantom-background-media {\r\n    border: none;\r\n    object-fit: cover;\r\n}\r\n\r\n/* Ensure content on top remains readable */\r\nhtml {\r\n    background-color: var(--bg);\r\n}\r\n\r\nbody {\r\n    position: relative;\r\n    z-index: 0;\r\n    background: transparent !important;\r\n    /* Allow background to show through */\r\n}\r\n\r\n/* Specific adjustments for transparency if needed */\r\n.main-content,\r\n.home-page {\r\n    background: transparent !important;\r\n}\r\n\r\n/* Glassmorphism for containers when background is active */\r\n.phantom-background.active~.offline-banner,\r\n.phantom-background.active~.home-page .card,\r\n.phantom-background.active~.home-page .featured-card,\r\n.phantom-background.active~.home-page .search-bar,\r\n.phantom-background.active~.settings-panel {\r\n    backdrop-filter: blur(10px);\r\n    -webkit-backdrop-filter: blur(10px);\r\n    background: rgba(15, 15, 15, 0.7) !important;\r\n}\n</style>\r\n</head>\r\n\r\n<body>\r\n    <script>\n// site config\r\n\r\nwindow.SITE_CONFIG = {\r\n    name: \"Phantom\",\r\n    fullName: \"Phantom Unblocked\",\r\n    version: \"1.0.12\",\r\n\r\n    changelog: [\r\n        \"1.0.12: tiny fixxes and changes\",\r\n        \"some code consolidation and fixxes\",\r\n        \"suggest features in the discord server\"\r\n    ],\r\n\r\n    // quotes\r\n    quotes: [\r\n        \"lebron lebron lebronn james\",\r\n        \"so tuff\",\r\n        \"it is what it is\",\r\n        \"do ur work\",\r\n        \"this is what happens when u dont touch grass\",\r\n        \"FULL BOX\",\r\n        \"FULL PIECE\",\r\n        \"200!\",\r\n        \"press esc + refresh + power button for hacks\",\r\n        \"press ctrl+x to hide your screen\",\r\n        \"change the tab title and favicon in settings\",\r\n        \"TEACHERR!\",\r\n        \"1 pump\",\r\n        \"303 headshot\",\r\n        \"bros prolly a 60 ovr\",\r\n        \"take the L lil bro\",  \r\n        \"lebron is OUR goat\",\r\n        \"stop looking at my screen\",\r\n    ],\r\n\r\n    // todo\r\n    // *** for strikethrough\r\n    // ** for bold\r\n    todos: [\r\n        \"***fixxed aboutblank opening while securly is on (previously if popups were off it would load intab instead of clickto launch now it will use clicktolaunch unless popups are blocked)***\",\r\n        \"***fix the proxy***\",\r\n        \"***fix panic panickey, add quote talking about it***\",\r\n        \"***fix theatermode, make it hide buttons after a few seconds and ensure all content is being displayed and move the description to the bottom***\",\r\n        \"***change back player to use old styling, change the surface to use background colors for the bottom part where description is shown, looking just like the background***\",\r\n        \"***add image and video support for backgrounds***\",\r\n        \"***fix aichat, make the title use the same ai request as the users question unless its in image mode where it will use text mode and fix ai chat to remember modes better***\",\r\n        \"***add cloaking to quotes***\",\r\n        \"***add a default cloak and fix it so icons work in aboutblank for whatever reason they only work when you go to settings in aboutblank where it correctly applies***\",\r\n        \"***for search suggestions add highlighting for whatever will happen when you click enter, in search suggestions fix all games not sending you to the games page***\",\r\n        \"***fix games to make multi library the default, put it in config.js***\",\r\n        \"***rename movies shortcut in index2.html to primeshows, add shortcuts to main pages in the topbar and change the current shortcuts to more popular games***\",\r\n        \"***make announcements show even on first visit unlike changelog and allow disabling it via settings***\",\r\n        \"***fix leave comformation asking u to leave each time you click something***\",\r\n        \"***change the shortcuts on the main page to include pages***\",\r\n        \"***add movies to the search bar in main page***\",\r\n        \"***fix background not turning off soon***\",\r\n        \"***fix music page to hide youtube player unless toggled via 3 dot small button, and always shown on proxy mode, fix all the controls for video time, volume***\",\r\n        \"**add singlefile this is lowk so hard i dont really understand it**\",\r\n        \"**advertise phantom (too much work tbh)**\",\r\n        \"**add a watch page for youtube and twitch**\",\r\n        \"**add a miniplayer for music**\",\r\n        \"***shorten some page's code***\",\r\n        \"***fix paths in search autocomplete***\",\r\n        \"***fix markdown in ai not using correct text colors***\",\r\n        \"***make backgrounds show in the loading screen***\",\r\n        \"***fix icons for topbar in code.html***\",\r\n        \"**fix wisp server not notifying or autoswitiching when offline in proxy**\",\r\n        \"***fix code runner open not working at all***\",\r\n        \"***make backgrounds show in player.html***\",\r\n        \"***make backgrounds show in staticsjv2***\",\r\n        \"***make player.html player controls use theme colros not hardcoded***\",\r\n        \"***make ai chat and music sidebar go all the way down and up with borders***\",\r\n        \"**make the only song in music be lebron lebron lebron james**\",\r\n        \"**fix music controls**\",\r\n        \"***finish extra page into credits and make this todo be tucked away somewhere and not the main part of it***\"\r\n    ],\r\n    defaultWisp: \"wss://glseries.net/wisp/\",\r\n    wispServers: [\r\n        { name: \"GLSeries Wisp\", url: \"wss://glseries.net/wisp/\" },\r\n        { name: \"Rhw's Wisp\", url: \"wss://wisp.rhw.one/\" },\r\n    ],\r\n\r\n    discord: {\r\n        inviteUrl: \"https://discord.gg/tHWx9NXp5p\",\r\n        widgetServer: \"1447673724017971324\",\r\n        widgetChannel: \"1447673726228496617\",\r\n    },\r\n\r\n    firstVisitCloak: false, //fake error page\r\n    defaults: {\r\n        cloakMode: \"about:blank\",\r\n        tabTitle: \"You've already responded\",\r\n        tabFavicon: \"https://ssl.gstatic.com/docs/spreadsheets/forms/forms_icon_2023q4.ico\",\r\n        cloakRotation: false,\r\n        cloakInterval: 5000,\r\n        panicKey: \"x\",\r\n        panicModifiers: [\"ctrl\", \"shift\"],\r\n        panicUrl: \"https://classroom.google.com\",\r\n        maxMovieRating: \"R\",\r\n        gameLibrary: \"multi\",\r\n        discordWidget: true,\r\n        miniplayer: true,\r\n        leaveConfirmation: false,\r\n        showChangelogOnUpdate: true,\r\n        themeRotation: true,\r\n        lastThemeRotation: 0,\r\n        backgroundRotation: true,\r\n        lastBackgroundRotation: 0,\r\n        lastSeenFeatured: 'none',\r\n        background: { type: 'color', value: '#0a0a0a' },\r\n        customBackground: { id: 'none', type: 'none' },\r\n        accentColor: '#ffffff',\r\n        surfaceColor: '#0f0f0f',\r\n        secondaryColor: '#2e2e33',\r\n        textColor: '#e4e4e7',\r\n    },\r\n\r\n    themePresets: {\r\n        dark: { name: 'Dark (Default)', bg: { type: 'color', value: '#0a0a0a' }, surface: '#0f0f0f', surfaceHover: '#1a1a1a', surfaceActive: '#252525', secondary: '#2e2e33', border: '#2a2a2a', borderLight: '#2a2a2a', text: '#e4e4e7', textSec: '#71717a', textDim: '#52525b', accent: '#ffffff' },\r\n        midnight: { name: 'Midnight', bg: { type: 'color', value: '#000000' }, surface: '#050505', surfaceHover: '#111111', surfaceActive: '#1a1a1a', secondary: '#111111', border: '#1a1a1a', borderLight: '#111111', text: '#ededed', textSec: '#a3a3a3', textDim: '#737373', accent: '#d4d4d4' },\r\n        abyss: { name: 'Abyss', bg: { type: 'color', value: '#020617' }, surface: '#0f172a', surfaceHover: '#1e293b', surfaceActive: '#334155', secondary: '#1e293b', border: '#1e293b', borderLight: '#1e293b', text: '#f1f5f9', textSec: '#94a3b8', textDim: '#64748b', accent: '#38bdf8' },\r\n        phantom: { name: 'Phantom', bg: { type: 'color', value: '#0f0a14' }, surface: '#1a0f24', surfaceHover: '#2e1a40', surfaceActive: '#4c2a5c', secondary: '#2e1a40', border: '#2e1a40', borderLight: '#2e1a40', text: '#f3e8ff', textSec: '#d8b4fe', textDim: '#c084fc', accent: '#c084fc' },\r\n        rosepine: { name: 'Rose Pine', bg: { type: 'color', value: '#191724' }, surface: '#1f1d2e', surfaceHover: '#26233a', surfaceActive: '#524f67', secondary: '#26233a', border: '#26233a', borderLight: '#1f1d2e', text: '#e0def4', textSec: '#908caa', textDim: '#6e6a86', accent: '#ebbcba' },\r\n        ocean: { name: 'Oceanic', bg: { type: 'color', value: '#011627' }, surface: '#0b2942', surfaceHover: '#1d3b53', surfaceActive: '#2d4b63', secondary: '#0b2942', border: '#1d3b53', borderLight: '#0b2942', text: '#d6deeb', textSec: '#5f7e97', textDim: '#011627', accent: '#7fdbca' },\r\n        forest: { name: 'Forest', bg: { type: 'color', value: '#020d06' }, surface: '#051a0d', surfaceHover: '#0a2e17', surfaceActive: '#0f4221', secondary: '#051a0d', border: '#0a2e17', borderLight: '#051a0d', text: '#ecfdf5', textSec: '#6ee7b7', textDim: '#064e3b', accent: '#10b981' },\r\n        crimson: { name: 'Crimson', bg: { type: 'color', value: '#1a0505' }, surface: '#230a0a', surfaceHover: '#7b0a0aff', surfaceActive: '#7f1d1d', secondary: '#230a0a', border: '#480f0fff', borderLight: '#230a0a', text: '#fef2f2', textSec: '#fecaca', textDim: '#450a0a', accent: '#ef4444' },\r\n        flame: { name: 'Flame', bg: { type: 'color', value: '#0c0202' }, surface: '#1c0a0a', surfaceHover: '#451a03', surfaceActive: '#9a3412', secondary: '#1c0a0a', border: '#451a03', borderLight: '#9a3412', text: '#fff7ed', textSec: '#fdba74', textDim: '#ea580c', accent: '#f59e0b' }\r\n    },\r\n\r\n    backgroundPresets: [\r\n        { id: 'none', name: 'None (Theme Default)', type: 'none' },\r\n        { id: 'Night sky', name: 'Night sky', type: 'image', url: 'https://images.pexels.com/photos/5675745/pexels-photo-5675745.jpeg', overlay: 0.3 },\r\n        { id: 'winter-mountains', name: 'Winter mountains', type: 'image', url: 'https://images.pexels.com/photos/1287145/pexels-photo-1287145.jpeg', overlay: 0.3 },\r\n        { id: 'f1 car', name: 'F1 Car', type: 'image', url: 'https://images.pexels.com/photos/14401632/pexels-photo-14401632.jpeg', overlay: 0.3 },\r\n        { id: 'moon-landing', name: 'Moon Landing', type: 'image', url: 'https://images.pexels.com/photos/41162/moon-landing-apollo-11-nasa-buzz-aldrin-41162.jpeg', overlay: 0.3, objectPosition: 'top left', active: true },\r\n        { id: 'turtle', name: 'Turtle', type: 'image', url: 'https://images.unsplash.com/photo-1501791187590-9ef2612ba1eb?q=80&w=1932&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D', overlay: 0.3 },\r\n        { id: 'road', name: 'Road', type: 'image', url: 'https://images.unsplash.com/photo-1508233620467-f79f1e317a05', overlay: 0.3 },\r\n        { id: 'railroad', name: 'Railroad', type: 'image', url: 'https://images.unsplash.com/photo-1505832018823-50331d70d237', overlay: 0.3 },\r\n        { id: 'mountain', name: 'Mountain', type: 'image', url: 'https://raw.githubusercontent.com/evanhnry/brave-wallpapers/refs/heads/main/Brave/clay-banks-u27Rrbs9Dwc-unsplash.jpg', overlay: 0.3 },\r\n    ],\r\n\r\n    cloakPresets: [\r\n        { name: \"Phantom\", icon: \"/favicon.svg\", title: \"Phantom Unblocked\" },\r\n        { name: \"Edpuzzle\", icon: \"https://edpuzzle.imgix.net/favicons/favicon-32.png\", title: \"Edpuzzle\" },\r\n        { name: \"Google Docs\", icon: \"https://ssl.gstatic.com/docs/documents/images/kix-favicon7.ico\", title: \"Untitled document - Google Docs\" },\r\n        { name: \"Canvas\", icon: \"https://du11hjcvx0uqb.cloudfront.net/dist/images/favicon-e10d657a73.ico\", title: \"Dashboard\" },\r\n        { name: \"Desmos\", icon: \"https://www.desmos.com/favicon.ico\", title: \"Desmos | Graphing Calculator\" },\r\n        { name: \"Khan Academy\", icon: \"https://cdn.kastatic.org/images/favicon.ico\", title: \"Khan Academy\" },\r\n        { name: \"Wikipedia\", icon: \"https://en.wikipedia.org/favicon.ico\", title: \"World War II - Wikipedia\" },\r\n        { name: \"Classroom\", icon: \"https://ssl.gstatic.com/classroom/favicon.png\", title: \"Home - Classroom\" },\r\n        { name: \"Canva\", icon: \"https://static.canva.com/static/images/android-192x192-2.png\", title: \"Home - Canva\" },\r\n        { name: \"Quiz\", icon: \"https://ssl.gstatic.com/docs/spreadsheets/forms/forms_icon_2023q4.ico\", title: \"You've already responded\" },\r\n        { name: \"Blooket\", icon: \"https://play.blooket.com/favicon.ico\", title: \"Play Blooket | Blooket\" },\r\n        { name: \"Gmail\", icon: \"https://ssl.gstatic.com/ui/v1/icons/mail/rfr/gmail.ico\", title: \"Gmail\" },\r\n        { name: \"YouTube\", icon: \"https://www.youtube.com/favicon.ico\", title: \"YouTube\" },\r\n        { name: \"Powerschool\", icon: \"https://waverlyk12.powerschool.com/favicon.ico\", title: \"Grades and Attendance\" },\r\n        { name: \"nothing\", icon: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=\", title: \"\\u200B\" },\r\n    ]\r\n}\r\n\r\n\r\n\n</script>\r\n    <script>\n// settings handler\r\n(function () {\r\n    'use strict';\r\n\r\n    const STORAGE_KEY = 'void_settings';\r\n\r\n    const getDefaults = () => {\r\n        return window.SITE_CONFIG?.defaults || {\r\n            cloakMode: 'none',\r\n            cloakRotation: false,\r\n            cloakInterval: 5000,\r\n            panicKey: 'x',\r\n            panicModifiers: ['ctrl', 'shift'],\r\n            panicUrl: 'https://classroom.google.com',\r\n            maxMovieRating: 'R',\r\n            offlineGames: [],\r\n            gameLibrary: 'multi',\r\n            leaveConfirmation: false\r\n        };\r\n    };\r\n\r\n    const load = () => {\r\n        try {\r\n            const stored = localStorage.getItem(STORAGE_KEY);\r\n            if (stored) {\r\n                return { ...getDefaults(), ...JSON.parse(stored) };\r\n            }\r\n        } catch (e) {\r\n            console.warn('Failed to load settings:', e);\r\n        }\r\n        return getDefaults();\r\n    };\r\n\r\n    const save = (settings) => {\r\n        try {\r\n            localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n            window.dispatchEvent(new CustomEvent('settings-changed', { detail: settings }));\r\n            if (window.parent !== window) {\r\n                window.parent.postMessage({ type: 'settings-update' }, '*');\r\n            }\r\n        } catch (e) {\r\n            console.warn('Failed to save settings:', e);\r\n        }\r\n    };\r\n\r\n    let _settings = load();\r\n\r\n    window.Settings = {\r\n        get(key) { return _settings[key]; },\r\n\r\n        getAll() { return { ..._settings }; },\r\n\r\n        set(key, value) {\r\n            _settings[key] = value;\r\n            save(_settings);\r\n            this.apply();\r\n            return value;\r\n        },\r\n\r\n        update(partial) {\r\n            _settings = { ..._settings, ...partial };\r\n            save(_settings);\r\n            this.apply();\r\n        },\r\n\r\n        reset() {\r\n            _settings = getDefaults();\r\n            save(_settings);\r\n            this.apply();\r\n        },\r\n\r\n        apply() {\r\n            const root = document.documentElement;\r\n            const s = _settings;\r\n            const d = window.SITE_CONFIG?.defaults || {};\r\n\r\n            const vars = {\r\n                '--accent': s.accentColor || d.accentColor || '#ffffff',\r\n                '--surface': s.surfaceColor || d.surfaceColor || '#0f0f0f',\r\n                '--surface-hover': s.surfaceHoverColor || d.surfaceHoverColor || '#1a1a1a',\r\n                '--surface-active': s.surfaceActiveColor || d.surfaceActiveColor || '#252525',\r\n                '--secondary': s.secondaryColor || d.secondaryColor || '#2e2e33',\r\n                '--border': s.borderColor || d.borderColor || '#1f1f1f',\r\n                '--border-light': s.borderLightColor || d.borderLightColor || '#2a2a2a',\r\n                '--text': s.textColor || d.textColor || '#e4e4e7',\r\n                '--text-muted': s.textSecondaryColor || d.textSecondaryColor || '#71717a',\r\n                '--text-dim': s.textDimColor || d.textDimColor || '#52525b',\r\n                '--toggle': s.toggleColor || d.toggleColor,\r\n                '--toggle-knob': s.toggleKnobColor || d.toggleKnobColor\r\n            };\r\n\r\n            Object.entries(vars).forEach(([key, val]) => {\r\n                if (val) root.style.setProperty(key, val);\r\n            });\r\n\r\n            const themeBg = s.background || d.background || { type: 'color', value: '#0a0a0a' };\r\n            const customBg = s.customBackground;\r\n            const isCustomActive = customBg && customBg.type !== 'none';\r\n\r\n            if (themeBg.type === 'color') {\r\n                root.style.setProperty('--bg', themeBg.value);\r\n            }\r\n\r\n            if (isCustomActive && customBg.url) {\r\n                root.style.setProperty('--bg-image', `url(${customBg.url})`);\r\n\r\n                let position = customBg.objectPosition;\r\n                if (customBg.id && customBg.id !== 'custom') {\r\n                    const preset = window.SITE_CONFIG?.backgroundPresets?.find(b => b.id === customBg.id);\r\n                    if (preset?.objectPosition) position = preset.objectPosition;\r\n                }\r\n\r\n                root.style.setProperty('--bg-image-position', position || 'center');\r\n            } else if (themeBg.type === 'image' || themeBg.type === 'video') {\r\n                root.style.setProperty('--bg-image', `url(${themeBg.value || themeBg.url})`);\r\n                root.style.setProperty('--bg-image-position', themeBg.objectPosition || 'center');\r\n            } else if (themeBg.type === 'gradient') {\r\n                root.style.setProperty('--bg-image', themeBg.value || themeBg.url);\r\n                root.style.setProperty('--bg-image-position', 'center');\r\n            } else {\r\n                root.style.setProperty('--bg-image', 'none');\r\n            }\r\n        },\r\n\r\n        onChange(callback) {\r\n            window.addEventListener('settings-changed', (e) => callback(e.detail));\r\n        },\r\n\r\n        isRatingAllowed(rating) {\r\n            if (!rating || rating === 'NR' || rating === 'NC-17') return false;\r\n            const ratingOrder = ['G', 'PG', 'PG-13', 'R'];\r\n            const maxIndex = ratingOrder.indexOf(_settings.maxMovieRating);\r\n            const ratingIndex = ratingOrder.indexOf(rating);\r\n            return maxIndex !== -1 && ratingIndex !== -1 && ratingIndex <= maxIndex;\r\n        }\r\n    };\r\n\r\n    // panic button go brr\r\n    const handlePanic = (e) => {\r\n        const mods = _settings.panicModifiers || [];\r\n        const key = _settings.panicKey || 'x';\r\n\r\n        if (mods.includes('ctrl') !== e.ctrlKey) return;\r\n        if (mods.includes('shift') !== e.shiftKey) return;\r\n        if (mods.includes('alt') !== e.altKey) return;\r\n\r\n        if (e.key.toLowerCase() === key.toLowerCase()) {\r\n            e.preventDefault();\r\n            const overlayId = 'panic-overlay';\r\n            let overlay = window.parent?.document?.getElementById(overlayId) || document.getElementById(overlayId);\r\n\r\n            if (!overlay) {\r\n                overlay = document.createElement('div');\r\n                overlay.id = overlayId;\r\n                overlay.style.cssText = 'position:fixed;inset:0;background:white;z-index:99999;';\r\n                document.body.appendChild(overlay);\r\n            } else {\r\n                overlay.style.display = 'block';\r\n            }\r\n\r\n            window.location.replace(_settings.panicUrl || 'https://classroom.google.com');\r\n        }\r\n    };\r\n\r\n    const init = () => {\r\n        Settings.apply();\r\n\r\n        const featured = window.SITE_CONFIG?.featuredBackground;\r\n        const activePreset = window.SITE_CONFIG?.backgroundPresets?.find(p => p.active);\r\n\r\n        const target = activePreset || featured;\r\n\r\n        if (target?.id && target.id !== _settings.lastSeenFeatured) {\r\n            Settings.update({\r\n                customBackground: target,\r\n                lastSeenFeatured: target.id,\r\n                backgroundRotation: false\r\n            });\r\n        }\r\n\r\n        document.addEventListener('keydown', handlePanic, true);\r\n\r\n        window.addEventListener('storage', (e) => {\r\n            if (e.key === STORAGE_KEY) {\r\n                _settings = load();\r\n                Settings.apply();\r\n                window.dispatchEvent(new CustomEvent('settings-changed', { detail: _settings }));\r\n            }\r\n        });\r\n\r\n        window.addEventListener('message', (e) => {\r\n            if (e.data?.type === 'settings-update' || e.data === 'updateCloak') {\r\n                _settings = load();\r\n                Settings.apply();\r\n                window.dispatchEvent(new CustomEvent('settings-changed', { detail: _settings }));\r\n            }\r\n        });\r\n\r\n        window.addEventListener('beforeunload', (e) => {\r\n            if (document.getElementById('main-frame') && _settings.leaveConfirmation) {\r\n                e.preventDefault();\r\n                return e.returnValue = '';\r\n            }\r\n        });\r\n    };\r\n\r\n    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', init);\r\n    else init();\r\n})();\r\n\n</script>\r\n    <script>\n// background stuff\r\n(function () {\r\n    'use strict';\r\n\r\n    if (window.BackgroundManager) return;\r\n\r\n    const YOUTUBE_REGEX = /(?:youtube\\.com\\/watch\\?v=|youtu\\.be\\/|youtube\\.com\\/embed\\/)([a-zA-Z0-9_-]{11})/;\r\n\r\n    const BackgroundManager = {\r\n        container: null,\r\n        mediaLayer: null,\r\n        elements: { video: null, image: null, iframe: null },\r\n        current: { type: null, url: null },\r\n        cacheName: 'phantom-bg-cache-v2',\r\n\r\n        init() {\r\n            this.container = document.createElement('div');\r\n            this.container.className = 'phantom-background';\r\n            this.container.innerHTML = '<div class=\"phantom-background-overlay\"></div><div class=\"phantom-background-layer\"></div>';\r\n            this.mediaLayer = this.container.querySelector('.phantom-background-layer');\r\n            document.body.insertBefore(this.container, document.body.firstChild);\r\n\r\n            const apply = () => this.applyBackground();\r\n            window.addEventListener('settings-changed', apply);\r\n            window.addEventListener('storage', apply);\r\n            window.addEventListener('beforeunload', () => this.cleanup());\r\n            window.addEventListener('pagehide', () => this.cleanup());\r\n\r\n            document.addEventListener('visibilitychange', () => {\r\n                const video = this.elements.video;\r\n                if (!video) return;\r\n                if (document.hidden) video.pause();\r\n                else if (this.current.type === 'video') video.play().catch(() => { });\r\n            });\r\n\r\n            this.applyBackground();\r\n        },\r\n\r\n        applyBackground() {\r\n            if (!this.container) return; // Wait for init() to create the container\r\n\r\n            const s = window.Settings?.getAll() || {};\r\n            const custom = s.customBackground;\r\n            const theme = s.background || {};\r\n\r\n            let type = null, url = null, pos = null, overlay = 0.4;\r\n\r\n            if (custom && custom.type !== 'none') {\r\n                // Refresh from config if possible to get latest props like objectPosition\r\n                if (custom.id && custom.id !== 'custom') {\r\n                    const preset = window.SITE_CONFIG?.backgroundPresets?.find(b => b.id === custom.id);\r\n                    if (preset) Object.assign(custom, preset);\r\n                }\r\n                ({ type, url, objectPosition: pos, overlay = 0.4 } = custom);\r\n            } else if (theme.type === 'image' || theme.type === 'video' || theme.type === 'youtube') {\r\n                type = theme.type;\r\n                url = theme.value || theme.url;\r\n                pos = theme.objectPosition;\r\n                overlay = theme.overlay || 0.4;\r\n            }\r\n\r\n            document.documentElement.style.setProperty('--bg-overlay', overlay);\r\n\r\n            // Handle common positioning typos and normalize\r\n            if (pos && typeof pos === 'string') {\r\n                pos = pos.toLowerCase().trim()\r\n                    .replace(/\\s+/g, ' ') // Normalize multiple spaces\r\n                    .replace('topleft', 'top left')\r\n                    .replace('topright', 'top right')\r\n                    .replace('bottomleft', 'bottom left')\r\n                    .replace('bottomright', 'bottom right')\r\n                    .replace('centercenter', 'center')\r\n                    .replace('centerleft', 'center left')\r\n                    .replace('centerright', 'center right');\r\n            }\r\n\r\n            document.documentElement.style.setProperty('--bg-image-position', pos || 'center');\r\n\r\n            if (!type || !url) {\r\n                this.clear();\r\n                document.documentElement.style.backgroundColor = 'var(--bg)';\r\n                document.documentElement.style.setProperty('--bg-image-position', 'center');\r\n                return;\r\n            }\r\n            if (this.current.type === type && this.current.url === url) return;\r\n\r\n            this.current = { type, url };\r\n\r\n            if (type === 'video' || url.match(/\\.(mp4|webm|ogg|mov|m4v)$/i)) {\r\n                this.clearMedia();\r\n                this.createVideo(url, pos);\r\n                this.container.classList.add('active');\r\n                document.documentElement.classList.add('phantom-bg-active');\r\n                document.body.classList.add('phantom-bg-active');\r\n            } else if (type === 'youtube' || YOUTUBE_REGEX.test(url)) {\r\n                this.clearMedia();\r\n                this.createYouTube(url, pos);\r\n                this.container.classList.add('active');\r\n                document.documentElement.classList.add('phantom-bg-active');\r\n                document.body.classList.add('phantom-bg-active');\r\n            } else if (type === 'image') {\r\n                this.handleImageBackground(url, pos);\r\n            }\r\n        },\r\n\r\n        async getProxiedCachedUrl(url) {\r\n            // Local images don't need proxying\r\n            if (!url.startsWith('http') || url.includes(location.hostname)) return url;\r\n\r\n            // Try direct load first (faster)\r\n            try {\r\n                const directTest = await fetch(url, { method: 'HEAD', mode: 'cors' });\r\n                if (directTest.ok) return url;\r\n            } catch (e) {\r\n                // CORS blocked, need to proxy\r\n            }\r\n\r\n            // Wait for BareMux (max 500ms)\r\n            let retries = 0;\r\n            while (!window.BareMux && retries < 5) {\r\n                await new Promise(r => setTimeout(r, 100));\r\n                retries++;\r\n            }\r\n\r\n            if (!window.BareMux) {\r\n                console.warn(\"Background: BareMux not found, trying direct URL.\");\r\n                return url; // Try direct anyway\r\n            }\r\n\r\n            try {\r\n                const client = new window.BareMux.BareClient();\r\n                const response = await client.fetch(url);\r\n                if (!response.ok) throw new Error('Proxy fetch failed');\r\n\r\n                const blob = await response.blob();\r\n                return URL.createObjectURL(blob);\r\n            } catch (error) {\r\n                console.error(\"Background proxy failed:\", error);\r\n                return url; // Fallback to direct URL\r\n            }\r\n        },\r\n\r\n        async handleImageBackground(url, pos) {\r\n            // Pre-load the image (proxied/cached or direct)\r\n            const finalUrl = await this.getProxiedCachedUrl(url);\r\n\r\n            // Check if this is still the current background after async fetch\r\n            if (this.current.url !== url) {\r\n                if (finalUrl && finalUrl.startsWith('blob:')) URL.revokeObjectURL(finalUrl);\r\n                return;\r\n            }\r\n\r\n            this.clearMedia();\r\n            this.createImage(finalUrl, pos);\r\n        },\r\n\r\n        createVideo(url, pos) {\r\n            const el = Object.assign(document.createElement('video'), {\r\n                className: 'phantom-background-media', src: url, autoplay: true, loop: true, muted: true, playsInline: true, volume: 0\r\n            });\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n            el.onerror = () => (this.elements.video = null);\r\n            this.elements.video = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        createImage(url, pos) {\r\n            const el = Object.assign(document.createElement('img'), {\r\n                className: 'phantom-background-media',\r\n                src: url\r\n            });\r\n\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n\r\n            el.onload = () => {\r\n                if (this.current.url === url || url.startsWith('blob:')) {\r\n                    this.container.classList.add('active');\r\n                    document.documentElement.classList.add('phantom-bg-active');\r\n                    document.body.classList.add('phantom-bg-active');\r\n                }\r\n            };\r\n            el.onerror = () => {\r\n                console.warn(\"Background image failed to load:\", url);\r\n                if (this.elements.image === el) this.elements.image = null;\r\n            };\r\n\r\n            this.elements.image = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        // youtube logic\r\n        createYouTube(url, pos) {\r\n            const id = url.match(YOUTUBE_REGEX)?.[1];\r\n            if (!id) return;\r\n            const el = Object.assign(document.createElement('iframe'), {\r\n                className: 'phantom-background-media',\r\n                src: `https://www.youtube.com/embed/${id}?autoplay=1&loop=1&playlist=${id}&controls=0&modestbranding=1&rel=0&mute=1&enablejsapi=1`,\r\n                allow: 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture'\r\n            });\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n            this.elements.iframe = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        clearMedia() {\r\n            Object.entries(this.elements).forEach(([key, el]) => {\r\n                if (!el) return;\r\n                if (key === 'video') { el.pause(); el.src = ''; }\r\n                if (key === 'iframe') el.src = 'about:blank';\r\n                if (key === 'image' && el.src.startsWith('blob:')) {\r\n                    URL.revokeObjectURL(el.src);\r\n                }\r\n                el.remove();\r\n                this.elements[key] = null;\r\n            });\r\n        },\r\n\r\n        clear() {\r\n            this.clearMedia();\r\n            this.current = { type: null, url: null };\r\n            document.documentElement.classList.remove('phantom-bg-active');\r\n            document.body.classList.remove('phantom-bg-active');\r\n            document.documentElement.style.backgroundColor = '';\r\n            if (this.container) this.container.classList.remove('active');\r\n        },\r\n\r\n        cleanup() {\r\n            this.clearMedia();\r\n        }\r\n    };\r\n\r\n    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', () => BackgroundManager.init());\r\n    else BackgroundManager.init();\r\n\r\n    window.BackgroundManager = BackgroundManager;\r\n})();\r\n\n</script>\r\n    <script>\n(function () {\r\n    const style = document.createElement('style');\r\n    style.textContent = `\r\n        .notify-container { position: fixed; top: 16px; right: 16px; z-index: 99999; display: flex; flex-direction: column; gap: 8px; pointer-events: none; font-family: 'Inter', sans-serif; }\r\n        .notify-toast { display: flex; align-items: center; gap: 12px; padding: 12px 16px; background: rgba(15, 15, 15, 0.9); backdrop-filter: blur(10px); border: 1px solid var(--border, #1f1f1f); border-radius: 10px; color: #e4e4e7; font-size: 13px; min-width: 280px; max-width: 380px; box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4); pointer-events: auto; transform: translateX(120%); opacity: 0; transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1), opacity 0.3s ease; position: relative; overflow: hidden; }\r\n        .notify-toast.show { transform: translateX(0); opacity: 1; }\r\n        .notify-toast.hiding { transform: translateX(120%); opacity: 0; }\r\n        .notify-icon { width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }\r\n        .notify-icon svg { width: 18px; height: 18px; }\r\n        .notify-content { flex: 1; line-height: 1.4; }\r\n        .notify-title { font-weight: 600; margin-bottom: 2px; }\r\n        .notify-message { color: #a1a1aa; font-size: 12px; }\r\n        .notify-close { background: none; border: none; color: #52525b; cursor: pointer; padding: 4px; border-radius: 4px; display: flex; align-items: center; justify-content: center; }\r\n        .notify-close:hover { background: rgba(255,255,255,0.1); color: #fff; }\r\n        .notify-close svg { width: 14px; height: 14px; }\r\n        .notify-toast.success { border-left: 3px solid #22c55e; } .notify-toast.success .notify-icon { color: #22c55e; }\r\n        .notify-toast.error { border-left: 3px solid #ef4444; } .notify-toast.error .notify-icon { color: #ef4444; }\r\n        .notify-toast.warning { border-left: 3px solid #f59e0b; } .notify-toast.warning .notify-icon { color: #f59e0b; }\r\n        .notify-toast.info { border-left: 3px solid #3b82f6; } .notify-toast.info .notify-icon { color: #3b82f6; }\r\n        .notify-progress { position: absolute; bottom: 0; left: 0; height: 2px; background: rgba(255, 255, 255, 0.2); transition: width linear; }\r\n    `;\r\n    document.head.appendChild(style);\r\n\r\n    let container = null;\r\n    const getContainer = () => container || (container = document.body.appendChild(Object.assign(document.createElement('div'), { className: 'notify-container' })));\r\n\r\n    const icons = {\r\n        success: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"20 6 9 17 4 12\"></polyline></svg>`,\r\n        error: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"15\" y1=\"9\" x2=\"9\" y2=\"15\"></line><line x1=\"9\" y1=\"9\" x2=\"15\" y2=\"15\"></line></svg>`,\r\n        warning: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\"></path><line x1=\"12\" y1=\"9\" x2=\"12\" y2=\"13\"></line><line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\"></line></svg>`,\r\n        info: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"12\" y1=\"16\" x2=\"12\" y2=\"12\"></line><line x1=\"12\" y1=\"8\" x2=\"12.01\" y2=\"8\"></line></svg>`,\r\n        close: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line><line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line></svg>`\r\n    };\r\n\r\n    function notify(type, title, msg = '', dur = 4000) {\r\n        const t = document.createElement('div');\r\n        t.className = `notify-toast ${type}`;\r\n        t.innerHTML = `<div class=\"notify-icon\">${icons[type]}</div><div class=\"notify-content\"><div class=\"notify-title\">${title}</div><div class=\"notify-message\">${msg}</div></div><button class=\"notify-close\">${icons.close}</button><div class=\"notify-progress\"></div>`;\r\n        const p = t.querySelector('.notify-progress');\r\n        const dismiss = () => { t.classList.add('hiding'); setTimeout(() => t.remove(), 300); };\r\n        t.querySelector('.notify-close').onclick = dismiss;\r\n        p.style.width = '100%';\r\n        setTimeout(() => { p.style.transition = `width ${dur}ms linear`; p.style.width = '0%'; }, 50);\r\n        let timer = setTimeout(dismiss, dur);\r\n        t.onmouseenter = () => { clearTimeout(timer); p.style.transition = 'none'; };\r\n        t.onmouseleave = () => {\r\n            const rem = (parseFloat(getComputedStyle(p).width) / t.offsetWidth) * dur;\r\n            p.style.transition = `width ${rem}ms linear`; p.style.width = '0%';\r\n            timer = setTimeout(dismiss, rem);\r\n        };\r\n        getContainer().appendChild(t);\r\n        requestAnimationFrame(() => t.classList.add('show'));\r\n    }\r\n\r\n    window.Notify = {\r\n        success: (a, b, c) => notify('success', a, b, c),\r\n        error: (a, b, c) => notify('error', a, b, c),\r\n        warning: (a, b, c) => notify('warning', a, b, c),\r\n        info: (a, b, c) => notify('info', a, b, c)\r\n    };\r\n})();\r\n\n</script>\r\n    <script>\n// topbar\r\n(function () {\r\n    let rootPrefix = '';\r\n    const scriptName = 'components/topbar.js';\r\n    const scripts = document.getElementsByTagName('script');\r\n    for (let i = 0; i < scripts.length; i++) {\r\n        const src = scripts[i].getAttribute('src');\r\n        if (src && src.includes(scriptName)) {\r\n            rootPrefix = src.split(scriptName)[0];\r\n            break;\r\n        }\r\n    }\r\n\r\n    if (!window.lucide && !document.querySelector('script[src*=\"lucide\"]')) {\r\n        const script = document.createElement('script');\r\n        script.src = 'https://unpkg.com/lucide@latest';\r\n        script.onload = () => {\r\n            if (window.lucide) lucide.createIcons();\r\n        };\r\n        document.head.appendChild(script);\r\n    }\r\n\r\n    initTopbar();\r\n\r\n    function createTopbar() {\r\n        const topbarContainer = document.createElement('div');\r\n        topbarContainer.id = 'topbar-container';\r\n\r\n        const logoSection = document.createElement('a');\r\n        logoSection.className = 'logo-section';\r\n        logoSection.href = rootPrefix + 'index2.html';\r\n        logoSection.innerHTML = '<div class=\"logo-placeholder\"><i data-lucide=\"zap\"></i></div>';\r\n        topbarContainer.appendChild(logoSection);\r\n\r\n        const navButtons = document.createElement('div');\r\n        navButtons.className = 'nav-buttons';\r\n\r\n        const buttons = [\r\n            { name: 'Music', icon: 'music', link: 'pages/music.html', badge: 'BETA' },\r\n            { name: 'Movies', icon: 'film', link: 'pages/movies.html' },\r\n            { name: 'Games', icon: 'gamepad-2', link: 'pages/games.html' },\r\n            { name: 'Watch', icon: 'play', link: 'pages/watch.html' },\r\n            { name: 'Search', icon: 'search', link: 'staticsjv2/index.html' },\r\n            { name: 'AI Chat', icon: 'bot', link: 'pages/chat.html' },\r\n            { separator: true },\r\n            { name: 'Settings', icon: 'settings', link: 'pages/settings.html' }\r\n        ];\r\n\r\n        buttons.forEach(btn => {\r\n            if (btn.separator) {\r\n                const separator = document.createElement('div');\r\n                separator.className = 'nav-separator';\r\n                navButtons.appendChild(separator);\r\n                return;\r\n            }\r\n\r\n            const link = document.createElement('a');   \r\n            link.href = rootPrefix + btn.link;\r\n            link.className = 'nav-btn';\r\n\r\n            const icon = document.createElement('i');\r\n            icon.setAttribute('data-lucide', btn.icon);\r\n            link.appendChild(icon);\r\n\r\n            const span = document.createElement('span');\r\n            span.textContent = btn.name;\r\n            link.appendChild(span);\r\n\r\n            if (btn.badge) {\r\n                const badge = document.createElement('div');\r\n                badge.className = 'nav-badge-beta';\r\n                badge.textContent = btn.badge;\r\n                link.appendChild(badge);\r\n            }\r\n\r\n            navButtons.appendChild(link);\r\n        });\r\n\r\n        topbarContainer.appendChild(navButtons);\r\n        document.body.prepend(topbarContainer);\r\n\r\n        if (window.lucide) {\r\n            lucide.createIcons();\r\n        }\r\n    }\r\n\r\n    function initTopbar() {\r\n        if (document.readyState === 'loading') {\r\n            document.addEventListener('DOMContentLoaded', createTopbar);\r\n        } else {\r\n            createTopbar();\r\n        }\r\n    }\r\n})();\r\n\n</script>\r\n\r\n    <div class=\"extra-page\">\r\n        <!-- Header -->\r\n        <section class=\"extra-hero\">\r\n            <div class=\"extra-hero-icon\">\r\n                <i class=\"fa-solid fa-ghost\"></i>\r\n            </div>\r\n            <h1>Phantom</h1>\r\n            <div class=\"version-badge\" id=\"version-text\">v1.0.0</div>\r\n            <p>the goat unblocked website</p>\r\n\r\n            <div class=\"quick-links\">\r\n                <a href=\"https://github.com/Destroyed12121/Phantom101\" target=\"_blank\" rel=\"noopener\"\r\n                    class=\"quick-link\">\r\n                    <i class=\"fa-brands fa-github\"></i>\r\n                    Source\r\n                </a>\r\n                <a id=\"discord-link\" href=\"#\" target=\"_blank\" rel=\"noopener\" class=\"quick-link\">\r\n                    <i class=\"fa-brands fa-discord\"></i>\r\n                    Discord\r\n                </a>\r\n            </div>\r\n        </section>\r\n\r\n        <!-- Made by -->\r\n        <section class=\"extra-section\">\r\n            <div class=\"extra-section-header\">\r\n                <i class=\"fa-solid fa-user\"></i>\r\n                <h2>Owner</h2>\r\n            </div>\r\n            <div class=\"credit-card\">\r\n                <div class=\"credit-avatar\">D</div>\r\n                <div class=\"credit-info\">\r\n                    <h3>Destroyed12121</h3>\r\n                    <p>the guy who made this</p>\r\n                </div>\r\n            </div>\r\n        </section>\r\n\r\n        <!-- Credits -->\r\n        <section class=\"extra-section\">\r\n            <div class=\"extra-section-header\">\r\n                <i class=\"fa-solid fa-heart\"></i>\r\n                <h2>Credits</h2>\r\n            </div>\r\n            <div class=\"roadmap-container\">\r\n                <button class=\"roadmap-toggle\" id=\"credits-toggle\">\r\n                    <span>credits</span>\r\n                    <i class=\"fa-solid fa-chevron-down\"></i>\r\n                </button>\r\n                <div class=\"roadmap-content\" id=\"credits-content\">\r\n                    <ul class=\"credits-list\">\r\n                        <li class=\"credit-item\">\r\n                            <span class=\"credit-name\">Titanium Network</span>\r\n                            <span class=\"credit-role\">Scramjet Proxy</span>\r\n                        </li>\r\n                        <li class=\"credit-item\">\r\n                            <span class=\"credit-name\">gn-math</span>\r\n                            <span class=\"credit-role\">Games</span>\r\n                        </li>\r\n                        <li class=\"credit-item\">\r\n                            <span class=\"credit-name\">Ultimate Game Stash</span>\r\n                            <span class=\"credit-role\">Games</span>\r\n                        </li>\r\n                        <li class=\"credit-item\">\r\n                            <span class=\"credit-name\">technonyte00</span>\r\n                            <span class=\"credit-role\">Music</span>\r\n                        </li>\r\n                        <li class=\"credit-item\">\r\n                            <span class=\"credit-name\">Pollinations.ai</span>\r\n                            <span class=\"credit-role\">AI API</span>\r\n                        </li>\r\n                        <li class=\"credit-item\">\r\n                            <span class=\"credit-name\">glseries.net</span>\r\n                            <span class=\"credit-role\">Wisp</span>\r\n                        </li>\r\n                        <li class=\"credit-item\">\r\n                            <span class=\"credit-name\">rhw.one</span>\r\n                            <span class=\"credit-role\">Wisp</span>\r\n                        </li>\r\n                    </ul>\r\n                </div>\r\n            </div>\r\n        </section>\r\n\r\n        <section class=\"extra-section\">\r\n            <div class=\"extra-section-header\">\r\n                <i class=\"fa-solid fa-list-check\"></i>\r\n                <h2>Todo list</h2>\r\n            </div>\r\n            <div class=\"roadmap-container\">\r\n                <button class=\"roadmap-toggle\" id=\"roadmap-toggle\">\r\n                    <span>todo list & more notes</span>\r\n                    <i class=\"fa-solid fa-chevron-down\"></i>\r\n                </button>\r\n                <div class=\"roadmap-content\" id=\"roadmap-content\">\r\n                    <ul class=\"roadmap-list\" id=\"roadmap-list\">\r\n                        <li class=\"roadmap-item pending\"><i\r\n                                class=\"fa-solid fa-spinner fa-spin\"></i><span>Loading...</span></li>\r\n                    </ul>\r\n                </div>\r\n            </div>\r\n        </section>\r\n\r\n        <!-- License -->\r\n        <section class=\"extra-section\">\r\n            <div class=\"license-notice\">\r\n                <i class=\"fa-solid fa-scale-balanced\"></i>\r\n                <div class=\"license-notice-content\">\r\n                    <h3>GNU GPL v3.0</h3>\r\n                    <p>This project is open source. You may use, modify, and distribute it under the GNU GPL v3.0\r\n                        license.</p>\r\n                </div>\r\n            </div>\r\n        </section>\r\n\r\n        <a href=\"../index.html\" class=\"back-link\">\r\n            <i class=\"fa-solid fa-arrow-left\"></i>\r\n            Back\r\n        </a>\r\n    </div>\r\n\r\n    <script>\nwindow.Quotes = {\r\n    // Use data from config, fallback to empty array if not found\r\n    getData() {\r\n        return (window.SITE_CONFIG && window.SITE_CONFIG.quotes) || [];\r\n    },\r\n\r\n    getRandom() {\r\n        const data = this.getData();\r\n        if (!data.length) return null; // Return null if no quotes\r\n        return data[Math.floor(Math.random() * data.length)];\r\n    },\r\n    init(force = false) {\r\n        const quote = this.getRandom();\r\n        if (!quote) return; // Do nothing if no quotes\r\n\r\n        const targets = [\r\n            '#quote',\r\n            '#quote-display',\r\n            '#subtitle',\r\n            '.page-subtitle',\r\n            '.extra-hero p',\r\n            '.loading-text'\r\n        ];\r\n\r\n        targets.forEach(selector => {\r\n            document.querySelectorAll(selector).forEach(el => {\r\n                // Only update if force is true, or it's empty, or has placeholder text\r\n                const text = el.textContent.trim();\r\n                if (force || !text || text === 'Loading...' || text.includes('Stream movies') || text.includes('Customize your')) {\r\n                    el.textContent = quote;\r\n                }\r\n            });\r\n        });\r\n    }\r\n};\r\n\r\nwindow.QUOTES = window.Quotes.getData();\r\n\r\n// Run automatically on load\r\nif (document.readyState === 'loading') {\r\n    document.addEventListener('DOMContentLoaded', () => window.Quotes.init());\r\n} else {\r\n    window.Quotes.init();\r\n}\r\n\n</script>\r\n    <script>\n// footer\r\n(function () {\r\n    'use strict';\r\n\r\n    let rootPrefix = '';\r\n    const scriptName = 'components/footer.js';\r\n    const scripts = document.getElementsByTagName('script');\r\n    for (let i = 0; i < scripts.length; i++) {\r\n        const src = scripts[i].getAttribute('src');\r\n        if (src && src.includes(scriptName)) {\r\n            rootPrefix = src.split(scriptName)[0];\r\n            break;\r\n        }\r\n    }\r\n\r\n    const config = window.SITE_CONFIG || { name: 'Phantom', version: '1.0.0', discord: { inviteUrl: '#' }, changelog: [], cloakPresets: [] };\r\n    const STORAGE_KEY = 'void_settings';\r\n    let storedSettings = {};\r\n    try { storedSettings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n\r\n    // settings\r\n    let settings = { ...(config.defaults || {}), ...storedSettings };\r\n\r\n    const footer = document.createElement('footer');\r\n    footer.id = 'site-footer';\r\n    footer.innerHTML = `\r\n        <style>\r\n            #site-footer {\r\n                margin-top: 0px;\r\n                padding: 20px;\r\n                border-top: 1px solid var(--border, #1f1f1f);\r\n                text-align: center;\r\n                background: transparent;\r\n            }\r\n            #site-footer .footer-links {\r\n                display: flex;\r\n                gap: 16px;\r\n                justify-content: center;\r\n                margin-bottom: 8px;\r\n                flex-wrap: wrap;\r\n            }\r\n            #site-footer .footer-link {\r\n                font-size: 12px;\r\n                color: var(--text-muted, #71717a);\r\n                text-decoration: none;\r\n                transition: color 0.15s;\r\n                font-family: 'Inter', sans-serif;\r\n                cursor: pointer;\r\n            }\r\n            #site-footer .footer-link:hover {\r\n                color: var(--text, #e4e4e7);\r\n            }\r\n            #site-footer .footer-version {\r\n                font-size: 11px;\r\n                color: var(--text-dim, #52525b);\r\n                cursor: pointer;\r\n                font-family: 'Inter', sans-serif;\r\n            }\r\n            #site-footer .footer-version:hover {\r\n                color: var(--text-muted, #71717a);\r\n            }\r\n        </style>\r\n        <div class=\"footer-links\">\r\n            <a href=\"${rootPrefix}pages/settings.html\" class=\"footer-link\"><i class=\"fa-solid fa-gear\"></i> Settings</a>\r\n            <a id=\"footer-changelog\" class=\"footer-link\"><i class=\"fa-solid fa-clock-rotate-left\"></i> Changelog</a>\r\n            <a href=\"${config.discord?.inviteUrl || '#'}\" target=\"_blank\" class=\"footer-link\"><i class=\"fa-brands fa-discord\"></i> Discord</a>\r\n            <a href=\"${rootPrefix}pages/terms.html\" class=\"footer-link\">Terms</a>\r\n            <a href=\"${rootPrefix}pages/disclaimer.html\" class=\"footer-link\">Disclaimer</a>\r\n            <a href=\"${rootPrefix}pages/extra.html\" class=\"footer-link\">Credits</a>\r\n        </div>\r\n        <span class=\"footer-version\" id=\"footer-version\">${config.name || 'Phantom'} v${config.version || '1.0.0'}</span>\r\n    `;\r\n\r\n    document.body.appendChild(footer);\r\n\r\n\r\n\r\n    // gtm\r\n    // Inject GTM head script if not already present\r\n    if (!document.querySelector('script[src*=\"googletagmanager.com/gtm.js\"]')) {\r\n        window.dataLayer = window.dataLayer || [];\r\n        window.dataLayer.push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' });\r\n        const gtmScript = document.createElement('script');\r\n        gtmScript.async = true;\r\n        gtmScript.src = 'https://www.googletagmanager.com/gtm.js?id=GTM-5LMBC27Z';\r\n        document.head.insertBefore(gtmScript, document.head.firstChild);\r\n    }\r\n\r\n    // Add GTM noscript fallback (for pages that don't have it in HTML)\r\n    if (!document.querySelector('noscript iframe[src*=\"googletagmanager\"]')) {\r\n        const gtmNoscript = document.createElement('noscript');\r\n        gtmNoscript.innerHTML = '<iframe src=\"https://www.googletagmanager.com/ns.html?id=GTM-5LMBC27Z\" height=\"0\" width=\"0\" style=\"display:none;visibility:hidden\"></iframe>';\r\n        document.body.insertBefore(gtmNoscript, document.body.firstChild);\r\n    }\r\n\r\n    const openChangelog = (e, customTitle, customContent) => {\r\n        if (e && e.preventDefault) e.preventDefault();\r\n        const changes = customContent || config.changelog || ['No changes listed'];\r\n\r\n        // Use standard modal structure from main.css\r\n        const overlay = document.createElement('div');\r\n        overlay.className = 'modal-overlay';\r\n\r\n        overlay.innerHTML = `\r\n            <div class=\"modal\" style=\"width: 400px; max-width: 90vw;\">\r\n                <div class=\"modal-header\">\r\n                    <h3 class=\"modal-title\">${customTitle || 'What\\'s New in v' + config.version}</h3>\r\n                    <button class=\"modal-close\"><i class=\"fa-solid fa-xmark\"></i></button>\r\n                </div>\r\n                <div class=\"modal-body\">\r\n                    <ul style=\"margin: 0; padding-left: 20px; color: var(--text-muted); font-size: 0.875rem; line-height: 1.6;\">\r\n                        ${changes.map(c => '<li>' + c + '</li>').join('')}\r\n                    </ul>\r\n                </div>\r\n                <div class=\"modal-footer\">\r\n                    <a href=\"${config.discord?.inviteUrl || '#'}\" target=\"_blank\" style=\"color: #5865F2; text-decoration: none; font-size: 13px; display: inline-flex; align-items: center; gap: 6px;\">\r\n                        <i class=\"fa-brands fa-discord\"></i> Join Discord\r\n                    </a>\r\n                </div>\r\n            </div>\r\n        `;\r\n\r\n        document.body.appendChild(overlay);\r\n\r\n        // Trigger animation\r\n        requestAnimationFrame(() => overlay.classList.add('show'));\r\n\r\n        const close = () => {\r\n            overlay.classList.remove('show');\r\n            setTimeout(() => overlay.remove(), 200);\r\n        };\r\n\r\n        overlay.querySelector('.modal-close').onclick = close;\r\n        overlay.onclick = (e) => { if (e.target === overlay) close(); };\r\n    };\r\n\r\n    // Expose openChangelog globally\r\n    window.openChangelog = openChangelog;\r\n\r\n    const changelogBtn = document.getElementById('footer-changelog');\r\n    if (changelogBtn) changelogBtn.onclick = openChangelog;\r\n\r\n    const versionBtn = document.getElementById('footer-version');\r\n    if (versionBtn) versionBtn.onclick = openChangelog;\r\n\r\n    // sync\r\n    // syncRemoteChangelog removed - using local config\r\n\r\n\r\n    // Initialize Sync\r\n    // syncRemoteChangelog();\r\n\r\n    const currentVersion = config.version;\r\n    const lastVersion = settings.lastVersion;\r\n\r\n    if (settings.showChangelogOnUpdate && lastVersion && lastVersion !== currentVersion) {\r\n        setTimeout(() => {\r\n            openChangelog();\r\n            settings.lastVersion = currentVersion;\r\n            localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n        }, 1000);\r\n    } else if (!lastVersion) {\r\n        settings.lastVersion = currentVersion;\r\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n    }\r\n\r\n    // panic\r\n    if (settings.panicKey) {\r\n        document.addEventListener('keydown', (e) => {\r\n            const keys = settings.panicModifiers || ['ctrl', 'shift'];\r\n            const triggerKey = settings.panicKey.toLowerCase();\r\n            const pressedKey = e.key.toLowerCase();\r\n\r\n            // Check modifiers\r\n            const ctrlMatch = keys.includes('ctrl') === e.ctrlKey;\r\n            const shiftMatch = keys.includes('shift') === e.shiftKey;\r\n            const altMatch = keys.includes('alt') === e.altKey;\r\n\r\n            if (ctrlMatch && shiftMatch && altMatch && pressedKey === triggerKey) {\r\n                e.preventDefault();\r\n\r\n                // Show white screen instantly (if panic-overlay exists in parent)\r\n                const parentOverlay = window.parent?.document?.getElementById('panic-overlay');\r\n                if (parentOverlay) {\r\n                    parentOverlay.style.display = 'block';\r\n                } else {\r\n                    // Create overlay if it doesn't exist\r\n                    const overlay = document.createElement('div');\r\n                    overlay.id = 'panic-overlay';\r\n                    overlay.style.cssText = 'position:fixed;inset:0;background:white;z-index:99999;';\r\n                    document.body.appendChild(overlay);\r\n                }\r\n\r\n                // Redirect immediately\r\n                const url = settings.panicUrl || 'https://classroom.google.com';\r\n                try { window.top.location.href = url; } catch { window.location.href = url; }\r\n            }\r\n        }, true); // Use capture phase for faster response\r\n    }\r\n\r\n    // Cloaking logic has been moved to scripts/cloaking.js for better synchronization.\r\n    // If you need cloaking on a specific page, include that script.\r\n\r\n\r\n    window.addEventListener('beforeunload', (e) => {\r\n        // Reload settings to get latest value\r\n        try { settings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n\r\n        if (window.top === window.self && settings.leaveConfirmation) {\r\n            e.preventDefault();\r\n            e.returnValue = '';\r\n            return '';\r\n        }\r\n    });\r\n\r\n    // discord\r\n    let crateInstance = null;\r\n\r\n    function initDiscord() {\r\n        if (settings.discordWidget && config.discord && config.discord.widgetServer && config.discord.widgetChannel) {\r\n            // Check if already loaded\r\n            if (document.querySelector('script[src*=\"@widgetbot/crate\"]')) {\r\n                if (crateInstance) crateInstance.show();\r\n                return;\r\n            }\r\n\r\n            const crateScript = document.createElement('script');\r\n            crateScript.src = 'https://cdn.jsdelivr.net/npm/@widgetbot/crate@3';\r\n            crateScript.async = true;\r\n            crateScript.defer = true;\r\n            crateScript.onload = () => {\r\n                crateInstance = new Crate({\r\n                    server: config.discord.widgetServer,\r\n                    channel: config.discord.widgetChannel,\r\n                    glyph: ['https://cdn.discordapp.com/embed/avatars/0.png', '100%'],\r\n                    location: ['bottom', 'right']\r\n                });\r\n            };\r\n            document.body.appendChild(crateScript);\r\n        } else {\r\n            // Hide if disabled\r\n            if (crateInstance) crateInstance.hide();\r\n        }\r\n    }\r\n\r\n    // Initialize\r\n    initDiscord();\r\n\r\n    // Listen for settings change to toggle dynamically\r\n    window.addEventListener('storage', (e) => {\r\n        if (e.key === STORAGE_KEY) {\r\n            try { settings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n            initDiscord();\r\n        }\r\n    });\r\n\r\n    // Listen for internal event\r\n    window.addEventListener('settings-changed', (e) => {\r\n        settings = e.detail;\r\n        initDiscord();\r\n    });\r\n\r\n    // counters\r\n    // Only show on home page (index2.html) checking if main-content exists\r\n    const mainContent = document.querySelector('.main-content');\r\n    // Ensure we are on the home page view (search bar checks etc) or just check existence\r\n    if (mainContent && document.querySelector('.featured-section')) {\r\n        const counterContainer = document.createElement('div');\r\n        counterContainer.id = 'supercounters-wrapper';\r\n        counterContainer.style.marginTop = '24px';\r\n        counterContainer.style.textAlign = 'center';\r\n        counterContainer.style.opacity = '0.8';\r\n\r\n        // Use iframe to isolate document.write from the widget\r\n        const iframe = document.createElement('iframe');\r\n        iframe.style.border = 'none';\r\n        iframe.style.width = '150px';\r\n        iframe.style.height = '40px';\r\n        iframe.style.overflow = 'hidden';\r\n\r\n        // Widget code\r\n        const widgetCode = `\r\n            <html>\r\n            <body style=\"margin:0;display:flex;justify-content:center;align-items:center;background:transparent;\">\r\n                <script type=\"text/javascript\" src=\"//widget.supercounters.com/ssl/online_i.js\"><\\/script>\r\n                <script type=\"text/javascript\">sc_online_i(1726449,\"ffffff\",\"000000\");<\\/script>\r\n            </body>\r\n            </html>\r\n        `;\r\n\r\n        iframe.srcdoc = widgetCode;\r\n        counterContainer.appendChild(iframe);\r\n        mainContent.appendChild(counterContainer);\r\n    }\r\n})();\r\n\n</script>\r\n    <script>\r\n        if (window.Settings) Settings.apply();\r\n\r\n        // Set version & discord from config\r\n        if (window.SITE_CONFIG) {\r\n            document.getElementById('version-text').textContent = `v${SITE_CONFIG.version}`;\r\n            document.getElementById('discord-link').href = SITE_CONFIG.discord?.inviteUrl || '#';\r\n        }\r\n\r\n        // Credits toggle\r\n        const creditsToggle = document.getElementById('credits-toggle');\r\n        const creditsContent = document.getElementById('credits-content');\r\n        creditsToggle.addEventListener('click', () => {\r\n            creditsToggle.classList.toggle('open');\r\n            creditsContent.classList.toggle('show');\r\n        });\r\n\r\n        // Roadmap toggle\r\n        const toggle = document.getElementById('roadmap-toggle');\r\n        const content = document.getElementById('roadmap-content');\r\n        toggle.addEventListener('click', () => {\r\n            toggle.classList.toggle('open');\r\n            content.classList.toggle('show');\r\n        });\r\n\r\n        // Load TODO from config.js\r\n        function loadRoadmap() {\r\n            const list = document.getElementById('roadmap-list');\r\n            const todos = (window.SITE_CONFIG && window.SITE_CONFIG.todos) || [];\r\n            if (!todos.length) {\r\n                list.innerHTML = '<li class=\"roadmap-item\">nothing here yet</li>';\r\n                return;\r\n            }\r\n\r\n            const items = todos.map(t => {\r\n                const isDone = t.startsWith('***');\r\n                const content = t.replace(/\\*\\*\\*/g, '').replace(/\\*\\*/g, '').trim();\r\n                return { content, isDone };\r\n            });\r\n\r\n            const sorted = [...items.filter(i => !i.isDone), ...items.filter(i => i.isDone)];\r\n            list.innerHTML = sorted.map(i => `\r\n                <li class=\"roadmap-item ${i.isDone ? 'done' : 'pending'}\">\r\n                    <i class=\"fa-solid ${i.isDone ? 'fa-check' : 'fa-clock'}\"></i>\r\n                    <span>${i.content.replace(/</g, '&lt;')}</span>\r\n                </li>\r\n            `).join('');\r\n        }\r\n        loadRoadmap();\r\n    </script>\r\n</body>\r\n\r\n</html>","pages/games.html":"<!DOCTYPE html>\r\n<html lang=\"en\">\r\n\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n    <title>Games - Phantom</title>\r\n    <link rel=\"icon\" href=\"../favicon.svg\" type=\"image/svg+xml\">\r\n    <meta name=\"referrer\" content=\"origin\">\r\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css\">\r\n    <style>\n/* phantom styling */\r\n\r\n@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');\r\n\r\n/* variables */\r\n:root {\r\n    /* Core colors (can be overridden by user settings) */\r\n    --bg: #0a0a0a;\r\n    --surface: #0f0f0f;\r\n    --surface-hover: #1a1a1a;\r\n    --surface-active: #252525;\r\n    --border: #1f1f1f;\r\n    --border-light: #2a2a2a;\r\n\r\n    /* Text */\r\n    --text: #e4e4e7;\r\n    --text-muted: #71717a;\r\n    --text-dim: #52525b;\r\n\r\n    /* Accent (customizable) */\r\n    --accent: #ffffff;\r\n    --accent-dim: rgba(255, 255, 255, 0.8);\r\n    --accent-glow: rgba(255, 255, 255, 0.1);\r\n\r\n    /* Status colors */\r\n    --success: #22c55e;\r\n    --warning: #f59e0b;\r\n    --error: #ef4444;\r\n    --info: #3b82f6;\r\n\r\n    /* Shadows */\r\n    --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.3);\r\n    --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.4);\r\n    --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.5);\r\n    --shadow-xl: 0 16px 48px rgba(0, 0, 0, 0.6);\r\n\r\n    /* Spacing */\r\n    --space-xs: 4px;\r\n    --space-sm: 8px;\r\n    --space-md: 16px;\r\n    --space-lg: 24px;\r\n    --space-xl: 32px;\r\n    --space-2xl: 48px;\r\n\r\n    /* Border radius */\r\n    --radius-sm: 4px;\r\n    --radius-md: 8px;\r\n    --radius-lg: 12px;\r\n    --radius-xl: 16px;\r\n    --radius-full: 9999px;\r\n\r\n    /* Transitions */\r\n    --transition-fast: 0.1s ease;\r\n    --transition-normal: 0.2s ease;\r\n    --transition-slow: 0.3s ease;\r\n\r\n    /* Z-index layers */\r\n    --z-base: 1;\r\n    --z-dropdown: 100;\r\n    --z-sticky: 500;\r\n    --z-modal: 1000;\r\n    --z-toast: 2000;\r\n    --z-max: 9999;\r\n\r\n    /* Typography */\r\n    --font-sans: 'Inter', system-ui, -apple-system, sans-serif;\r\n    --font-mono: 'JetBrains Mono', 'Fira Code', monospace;\r\n\r\n    /* Background (customizable) */\r\n    --bg-image: none;\r\n}\r\n\r\n/* base */\r\n*,\r\n*::before,\r\n*::after {\r\n    box-sizing: border-box;\r\n    margin: 0;\r\n    padding: 0;\r\n}\r\n\r\nhtml {\r\n    font-size: 16px;\r\n    scroll-behavior: smooth;\r\n    -webkit-font-smoothing: antialiased;\r\n    -moz-osx-font-smoothing: grayscale;\r\n}\r\n\r\nbody {\r\n    font-family: var(--font-sans);\r\n    background: var(--bg);\r\n    background-image: var(--bg-image);\r\n    background-size: cover;\r\n    background-position: var(--bg-image-position, center);\r\n    background-attachment: fixed;\r\n    color: var(--text);\r\n    line-height: 1.5;\r\n    min-height: 100vh;\r\n    overflow-x: hidden;\r\n}\r\n\r\n/* Ensure background manager takes precedence */\r\nhtml.phantom-bg-active body {\r\n    background: transparent !important;\r\n    background-image: none !important;\r\n}\r\n\r\n/* Selection */\r\n::selection {\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n}\r\n\r\n/* Focus states */\r\n:focus-visible {\r\n    outline: 2px solid var(--accent);\r\n    outline-offset: 2px;\r\n}\r\n\r\n/* Links */\r\na {\r\n    color: var(--accent);\r\n    text-decoration: none;\r\n    transition: opacity var(--transition-fast);\r\n}\r\n\r\na:hover {\r\n    opacity: 0.8;\r\n}\r\n\r\n/* Scrollbar */\r\n::-webkit-scrollbar {\r\n    width: 8px;\r\n    height: 8px;\r\n}\r\n\r\n::-webkit-scrollbar-track {\r\n    background: var(--surface);\r\n}\r\n\r\n::-webkit-scrollbar-thumb {\r\n    background: var(--border-light);\r\n    border-radius: var(--radius-full);\r\n}\r\n\r\n::-webkit-scrollbar-thumb:hover {\r\n    background: var(--text-muted);\r\n}\r\n\r\n/* text */\r\nh1,\r\nh2,\r\nh3,\r\nh4,\r\nh5,\r\nh6 {\r\n    font-weight: 600;\r\n    line-height: 1.2;\r\n    color: var(--text);\r\n}\r\n\r\nh1 {\r\n    font-size: 2.5rem;\r\n}\r\n\r\nh2 {\r\n    font-size: 2rem;\r\n}\r\n\r\nh3 {\r\n    font-size: 1.5rem;\r\n}\r\n\r\nh4 {\r\n    font-size: 1.25rem;\r\n}\r\n\r\nh5 {\r\n    font-size: 1rem;\r\n}\r\n\r\nh6 {\r\n    font-size: 0.875rem;\r\n}\r\n\r\np {\r\n    color: var(--text-muted);\r\n    line-height: 1.6;\r\n}\r\n\r\n.text-sm {\r\n    font-size: 0.875rem;\r\n}\r\n\r\n.text-xs {\r\n    font-size: 0.75rem;\r\n}\r\n\r\n.text-lg {\r\n    font-size: 1.125rem;\r\n}\r\n\r\n.text-muted {\r\n    color: var(--text-muted);\r\n}\r\n\r\n.text-dim {\r\n    color: var(--text-dim);\r\n}\r\n\r\n.text-center {\r\n    text-align: center;\r\n}\r\n\r\n/* buttons */\r\n.btn {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    gap: var(--space-sm);\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-family: var(--font-sans);\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-md);\r\n    background: var(--surface);\r\n    color: var(--text);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n    white-space: nowrap;\r\n}\r\n\r\n.btn:hover {\r\n    background: var(--surface-hover);\r\n    border-color: var(--border-light);\r\n}\r\n\r\n.btn:active {\r\n    background: var(--surface-active);\r\n    transform: scale(0.98);\r\n}\r\n\r\n.btn-primary {\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n    border-color: var(--accent);\r\n}\r\n\r\n.btn-primary:hover {\r\n    opacity: 0.9;\r\n    background: var(--accent);\r\n}\r\n\r\n.btn-ghost {\r\n    background: transparent;\r\n    border-color: transparent;\r\n}\r\n\r\n.btn-ghost:hover {\r\n    background: var(--surface-hover);\r\n}\r\n\r\n.btn-icon {\r\n    width: 36px;\r\n    height: 36px;\r\n    padding: 0;\r\n    border-radius: var(--radius-md);\r\n}\r\n\r\n.btn-sm {\r\n    padding: var(--space-xs) var(--space-sm);\r\n    font-size: 0.75rem;\r\n}\r\n\r\n.btn-lg {\r\n    padding: var(--space-md) var(--space-lg);\r\n    font-size: 1rem;\r\n}\r\n\r\n/* inputs */\r\n.input {\r\n    width: 100%;\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-family: var(--font-sans);\r\n    font-size: 0.875rem;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-md);\r\n    color: var(--text);\r\n    transition: border-color var(--transition-fast);\r\n}\r\n\r\n.input:hover {\r\n    border-color: var(--border-light);\r\n}\r\n\r\n.input:focus {\r\n    outline: none;\r\n    border-color: var(--accent);\r\n}\r\n\r\n.input::placeholder {\r\n    color: var(--text-dim);\r\n}\r\n\r\n.input-group {\r\n    display: flex;\r\n    gap: var(--space-sm);\r\n}\r\n\r\n.input-group .input {\r\n    flex: 1;\r\n}\r\n\r\n/* Select */\r\n.select {\r\n    appearance: none;\r\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%2371717a' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E\");\r\n    background-repeat: no-repeat;\r\n    background-position: right 12px center;\r\n    padding-right: 36px;\r\n    cursor: pointer;\r\n}\r\n\r\n/* Checkbox/Toggle */\r\n.toggle {\r\n    position: relative;\r\n    width: 44px;\r\n    height: 24px;\r\n    background: var(--border);\r\n    border-radius: var(--radius-full);\r\n    cursor: pointer;\r\n    transition: background var(--transition-fast);\r\n}\r\n\r\n.toggle::after {\r\n    content: '';\r\n    position: absolute;\r\n    top: 2px;\r\n    left: 2px;\r\n    width: 20px;\r\n    height: 20px;\r\n    background: var(--text);\r\n    border-radius: 50%;\r\n    transition: transform var(--transition-fast);\r\n}\r\n\r\n.toggle.active {\r\n    background: var(--accent);\r\n}\r\n\r\n.toggle.active::after {\r\n    transform: translateX(20px);\r\n    background: var(--bg);\r\n}\r\n\r\n/* cards */\r\n.card {\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-lg);\r\n    overflow: hidden;\r\n    transition: all var(--transition-normal);\r\n}\r\n\r\n.card:hover {\r\n    border-color: var(--border-light);\r\n    box-shadow: var(--shadow-md);\r\n}\r\n\r\n.card-header {\r\n    padding: var(--space-md);\r\n    border-bottom: 1px solid var(--border);\r\n}\r\n\r\n.card-body {\r\n    padding: var(--space-md);\r\n}\r\n\r\n.card-footer {\r\n    padding: var(--space-md);\r\n    border-top: 1px solid var(--border);\r\n}\r\n\r\n\r\n/* Featured badge */\r\n.badge-featured {\r\n    position: absolute;\r\n    top: var(--space-sm);\r\n    left: var(--space-sm);\r\n    padding: var(--space-xs) var(--space-sm);\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n    font-size: 0.625rem;\r\n    font-weight: 700;\r\n    text-transform: uppercase;\r\n    letter-spacing: 0.05em;\r\n    border-radius: var(--radius-sm);\r\n}\r\n\r\n/* Favorite star */\r\n.favorite-btn {\r\n    position: absolute;\r\n    top: var(--space-sm);\r\n    right: var(--space-sm);\r\n    width: 32px;\r\n    height: 32px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background: rgba(0, 0, 0, 0.5);\r\n    border: none;\r\n    border-radius: 50%;\r\n    color: var(--text-muted);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n    opacity: 0;\r\n}\r\n\r\n.media-card:hover .favorite-btn {\r\n    opacity: 1;\r\n}\r\n\r\n.favorite-btn:hover {\r\n    background: rgba(0, 0, 0, 0.7);\r\n    color: var(--text);\r\n}\r\n\r\n.favorite-btn.active {\r\n    color: #fbbf24;\r\n    opacity: 1;\r\n}\r\n\r\n/* grid */\r\n.grid {\r\n    display: grid;\r\n    gap: var(--space-md);\r\n}\r\n\r\n.grid-cols-2 {\r\n    grid-template-columns: repeat(2, 1fr);\r\n}\r\n\r\n.grid-cols-3 {\r\n    grid-template-columns: repeat(3, 1fr);\r\n}\r\n\r\n.grid-cols-4 {\r\n    grid-template-columns: repeat(4, 1fr);\r\n}\r\n\r\n.grid-cols-5 {\r\n    grid-template-columns: repeat(5, 1fr);\r\n}\r\n\r\n.grid-cols-6 {\r\n    grid-template-columns: repeat(6, 1fr);\r\n}\r\n\r\n/* Auto-fit grid for responsive cards */\r\n.grid-auto {\r\n    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));\r\n}\r\n\r\n.grid-auto-lg {\r\n    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\r\n}\r\n\r\n/* flex */\r\n.flex {\r\n    display: flex;\r\n}\r\n\r\n.flex-col {\r\n    flex-direction: column;\r\n}\r\n\r\n.flex-wrap {\r\n    flex-wrap: wrap;\r\n}\r\n\r\n.items-center {\r\n    align-items: center;\r\n}\r\n\r\n.items-start {\r\n    align-items: flex-start;\r\n}\r\n\r\n.items-end {\r\n    align-items: flex-end;\r\n}\r\n\r\n.justify-center {\r\n    justify-content: center;\r\n}\r\n\r\n.justify-between {\r\n    justify-content: space-between;\r\n}\r\n\r\n.justify-end {\r\n    justify-content: flex-end;\r\n}\r\n\r\n.gap-xs {\r\n    gap: var(--space-xs);\r\n}\r\n\r\n.gap-sm {\r\n    gap: var(--space-sm);\r\n}\r\n\r\n.gap-md {\r\n    gap: var(--space-md);\r\n}\r\n\r\n.gap-lg {\r\n    gap: var(--space-lg);\r\n}\r\n\r\n.flex-1 {\r\n    flex: 1;\r\n}\r\n\r\n/* spacing */\r\n.p-xs {\r\n    padding: var(--space-xs);\r\n}\r\n\r\n.p-sm {\r\n    padding: var(--space-sm);\r\n}\r\n\r\n.p-md {\r\n    padding: var(--space-md);\r\n}\r\n\r\n.p-lg {\r\n    padding: var(--space-lg);\r\n}\r\n\r\n.p-xl {\r\n    padding: var(--space-xl);\r\n}\r\n\r\n.m-xs {\r\n    margin: var(--space-xs);\r\n}\r\n\r\n.m-sm {\r\n    margin: var(--space-sm);\r\n}\r\n\r\n.m-md {\r\n    margin: var(--space-md);\r\n}\r\n\r\n.m-lg {\r\n    margin: var(--space-lg);\r\n}\r\n\r\n.mt-sm {\r\n    margin-top: var(--space-sm);\r\n}\r\n\r\n.mt-md {\r\n    margin-top: var(--space-md);\r\n}\r\n\r\n.mt-lg {\r\n    margin-top: var(--space-lg);\r\n}\r\n\r\n.mb-sm {\r\n    margin-bottom: var(--space-sm);\r\n}\r\n\r\n.mb-md {\r\n    margin-bottom: var(--space-md);\r\n}\r\n\r\n.mb-lg {\r\n    margin-bottom: var(--space-lg);\r\n}\r\n\r\n/* modals */\r\n.modal-overlay {\r\n    position: fixed;\r\n    inset: 0;\r\n    background: rgba(0, 0, 0, 0.8);\r\n    backdrop-filter: blur(4px);\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    z-index: var(--z-modal);\r\n    opacity: 0;\r\n    visibility: hidden;\r\n    transition: all var(--transition-normal);\r\n}\r\n\r\n.modal-overlay.show {\r\n    opacity: 1;\r\n    visibility: visible;\r\n}\r\n\r\n.modal {\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-xl);\r\n    max-width: 90vw;\r\n    max-height: 90vh;\r\n    overflow: hidden;\r\n    transform: scale(0.95);\r\n    transition: transform var(--transition-normal);\r\n}\r\n\r\n.modal-overlay.show .modal {\r\n    transform: scale(1);\r\n}\r\n\r\n.modal-header {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    padding: var(--space-md);\r\n    border-bottom: 1px solid var(--border);\r\n}\r\n\r\n.modal-title {\r\n    font-size: 1rem;\r\n    font-weight: 600;\r\n}\r\n\r\n.modal-close {\r\n    width: 32px;\r\n    height: 32px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background: transparent;\r\n    border: none;\r\n    color: var(--text-muted);\r\n    cursor: pointer;\r\n    border-radius: var(--radius-md);\r\n    transition: all var(--transition-fast);\r\n}\r\n\r\n.modal-close:hover {\r\n    background: var(--surface-hover);\r\n    color: var(--text);\r\n}\r\n\r\n.modal-body {\r\n    padding: var(--space-md);\r\n    overflow-y: auto;\r\n}\r\n\r\n.modal-footer {\r\n    display: flex;\r\n    justify-content: flex-end;\r\n    gap: var(--space-sm);\r\n    padding: var(--space-md);\r\n    border-top: 1px solid var(--border);\r\n}\r\n\r\n/* tabs */\r\n.tabs {\r\n    display: flex;\r\n    gap: 2px;\r\n    background: var(--surface);\r\n    padding: var(--space-xs);\r\n    border-radius: var(--radius-md);\r\n    border: 1px solid var(--border);\r\n}\r\n\r\n.tab {\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    color: var(--text-muted);\r\n    background: transparent;\r\n    border: none;\r\n    border-radius: var(--radius-sm);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n}\r\n\r\n.tab:hover {\r\n    color: var(--text);\r\n}\r\n\r\n.tab.active {\r\n    background: var(--surface-hover);\r\n    color: var(--text);\r\n}\r\n\r\n/* search */\r\n\r\n/* ============================================\r\n   OFFLINE INDICATOR\r\n   ============================================ */\r\n.offline-banner {\r\n    position: fixed;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    padding: var(--space-sm) var(--space-md);\r\n    background: var(--warning);\r\n    color: var(--bg);\r\n    text-align: center;\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    z-index: var(--z-toast);\r\n    transform: translateY(-100%);\r\n    transition: transform var(--transition-normal);\r\n}\r\n\r\n.offline-banner.show {\r\n    transform: translateY(0);\r\n}\r\n\r\n.offline-badge {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    gap: var(--space-xs);\r\n    padding: var(--space-xs) var(--space-sm);\r\n    background: var(--warning);\r\n    color: var(--bg);\r\n    font-size: 0.625rem;\r\n    font-weight: 600;\r\n    text-transform: uppercase;\r\n    border-radius: var(--radius-sm);\r\n}\r\n\r\n/* ============================================\r\n   LOADING STATES\r\n   ============================================ */\r\n.skeleton {\r\n    background: linear-gradient(90deg, var(--surface) 0%, var(--surface-hover) 50%, var(--surface) 100%);\r\n    background-size: 200% 100%;\r\n    animation: shimmer 1.5s infinite;\r\n    border-radius: var(--radius-md);\r\n}\r\n\r\n@keyframes shimmer {\r\n    0% {\r\n        background-position: 200% 0;\r\n    }\r\n\r\n    100% {\r\n        background-position: -200% 0;\r\n    }\r\n}\r\n\r\n.spinner {\r\n    width: 24px;\r\n    height: 24px;\r\n    border: 2px solid var(--border);\r\n    border-top-color: var(--accent);\r\n    border-radius: 50%;\r\n    animation: spin 0.8s linear infinite;\r\n}\r\n\r\n@keyframes spin {\r\n    to {\r\n        transform: rotate(360deg);\r\n    }\r\n}\r\n\r\n/* ============================================\r\n   ANIMATIONS\r\n   ============================================ */\r\n@keyframes fadeIn {\r\n    from {\r\n        opacity: 0;\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n    }\r\n}\r\n\r\n@keyframes slideUp {\r\n    from {\r\n        opacity: 0;\r\n        transform: translateY(10px);\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n        transform: translateY(0);\r\n    }\r\n}\r\n\r\n@keyframes scaleIn {\r\n    from {\r\n        opacity: 0;\r\n        transform: scale(0.95);\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n        transform: scale(1);\r\n    }\r\n}\r\n\r\n.animate-fadeIn {\r\n    animation: fadeIn var(--transition-normal) ease;\r\n}\r\n\r\n.animate-slideUp {\r\n    animation: slideUp var(--transition-normal) ease;\r\n}\r\n\r\n.animate-scaleIn {\r\n    animation: scaleIn var(--transition-normal) ease;\r\n}\r\n\r\n/* ============================================\r\n   UTILITIES\r\n   ============================================ */\r\n.hidden {\r\n    display: none !important;\r\n}\r\n\r\n.sr-only {\r\n    position: absolute;\r\n    width: 1px;\r\n    height: 1px;\r\n    padding: 0;\r\n    margin: -1px;\r\n    overflow: hidden;\r\n    clip: rect(0, 0, 0, 0);\r\n    border: 0;\r\n}\r\n\r\n.truncate {\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n}\r\n\r\n.w-full {\r\n    width: 100%;\r\n}\r\n\r\n.h-full {\r\n    height: 100%;\r\n}\r\n\r\n.relative {\r\n    position: relative;\r\n}\r\n\r\n.absolute {\r\n    position: absolute;\r\n}\r\n\r\n.fixed {\r\n    position: fixed;\r\n}\r\n\r\n.inset-0 {\r\n    inset: 0;\r\n}\r\n\r\n/* ============================================\r\n   RESPONSIVE\r\n   ============================================ */\r\n@media (max-width: 768px) {\r\n    h1 {\r\n        font-size: 1.75rem;\r\n    }\r\n\r\n    h2 {\r\n        font-size: 1.5rem;\r\n    }\r\n\r\n    h3 {\r\n        font-size: 1.25rem;\r\n    }\r\n\r\n    .grid-auto {\r\n        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));\r\n    }\r\n\r\n    .hide-mobile {\r\n        display: none !important;\r\n    }\r\n}\r\n\r\n@media (min-width: 769px) {\r\n    .hide-desktop {\r\n        display: none !important;\r\n    }\r\n}\n</style>\r\n    <style>\n/* Topbar Styles - Clean & Dark */\r\n/* Note: Inter font is imported in main.css */\r\n\r\nbody {\r\n    margin: 0;\r\n    padding: 0;\r\n    background-color: var(--bg);\r\n    font-family: 'Inter', sans-serif;\r\n}\r\n\r\n#topbar-container {\r\n    position: fixed;\r\n    top: 11px;\r\n    left: 50%;\r\n    transform: translateX(-50%);\r\n    background-color: var(--surface);\r\n    border-radius: 9999px;\r\n    padding: 8px 14px;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 10px;\r\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);\r\n    z-index: 10000;\r\n    border: 1px solid var(--border);\r\n    height: 48px;\r\n    box-sizing: border-box;\r\n}\r\n\r\n#topbar-container::before {\r\n    content: '';\r\n    position: absolute;\r\n    top: -7px;\r\n    bottom: -7px;\r\n    left: -7px;\r\n    right: -7px;\r\n    z-index: -1;\r\n    border-radius: 9999px;\r\n}\r\n\r\n.logo-section {\r\n    display: flex;\r\n    align-items: center;\r\n    padding-right: 10px;\r\n    border-right: 1px solid var(--border);\r\n    height: 32px;\r\n    text-decoration: none;\r\n    color: inherit;\r\n}\r\n\r\n.logo-placeholder {\r\n    width: 28px;\r\n    height: 28px;\r\n    background-color: var(--surface-hover);\r\n    border-radius: 6px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    color: var(--text-muted);\r\n}\r\n\r\n.logo-placeholder i,\r\n.logo-placeholder svg {\r\n    width: 16px;\r\n    height: 16px;\r\n}\r\n\r\n.nav-buttons {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 4px;\r\n}\r\n\r\n.nav-separator {\r\n    width: 1px;\r\n    height: 20px;\r\n    background-color: var(--border);\r\n    margin: 0 6px;\r\n}\r\n\r\n.nav-btn {\r\n    background: transparent;\r\n    border: none;\r\n    color: var(--text-muted);\r\n    text-decoration: none;\r\n    display: flex;\r\n    align-items: center;\r\n    padding: 6px 10px;\r\n    border-radius: 99px;\r\n    height: 32px;\r\n    box-sizing: border-box;\r\n    transition: color 0.15s, background-color 0.15s;\r\n    position: relative;\r\n}\r\n\r\n.nav-badge-beta {\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n    font-size: 8px;\r\n    font-weight: 700;\r\n    color: var(--text);\r\n    background: var(--secondary);\r\n    padding: 2px 4px;\r\n    border-radius: 4px;\r\n    line-height: 1;\r\n    transform: translate(20%, -20%);\r\n    pointer-events: none;\r\n}\r\n\r\n.nav-btn:hover {\r\n    color: var(--text);\r\n    background-color: var(--surface-hover);\r\n}\r\n\r\n.nav-btn i,\r\n.nav-btn svg {\r\n    width: 18px;\r\n    height: 18px;\r\n    min-width: 18px;\r\n}\r\n\r\n.nav-btn span {\r\n    max-width: 0;\r\n    opacity: 0;\r\n    margin-left: 0;\r\n    overflow: hidden;\r\n    white-space: nowrap;\r\n    font-weight: 500;\r\n    font-size: 13px;\r\n    transition: max-width 0.23s ease, opacity 0.17s ease, margin-left 0.23s ease;\r\n}\r\n\r\n#topbar-container:hover .nav-btn span {\r\n    max-width: 70px;\r\n    opacity: 1;\r\n    margin-left: 8px;\r\n}\n</style>\r\n    <style>\n/**\r\n * PHANTOM - BACKGROUND STYLES\r\n */\r\n.phantom-background {\r\n    position: fixed;\r\n    inset: 0;\r\n    width: 100vw;\r\n    height: 100vh;\r\n    z-index: -1;\r\n    overflow: hidden;\r\n    background: transparent;\r\n    pointer-events: none;\r\n    opacity: 1;\r\n    transition: background-color 0.3s ease;\r\n}\r\n\r\n.phantom-background.active {\r\n    opacity: 1;\r\n}\r\n\r\n.phantom-background-overlay {\r\n    position: absolute;\r\n    inset: 0;\r\n    z-index: 2;\r\n    background: rgba(0, 0, 0, var(--bg-overlay, 0.4));\r\n    transition: background-color 0.3s ease;\r\n}\r\n\r\n.phantom-background-layer {\r\n    position: absolute;\r\n    inset: 0;\r\n    z-index: 1;\r\n    transition: opacity 0.3s ease-in-out;\r\n}\r\n\r\n.phantom-background-media {\r\n    width: 100%;\r\n    height: 100%;\r\n    object-fit: cover;\r\n    object-position: var(--bg-image-position, center);\r\n    display: block;\r\n    border: none;\r\n}\r\n\r\n/* Video and Iframe positioning for full background cover */\r\n.phantom-background-layer video.phantom-background-media,\r\n.phantom-background-layer iframe.phantom-background-media {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    transform: none;\r\n    pointer-events: none;\r\n    min-width: 100%;\r\n    min-height: 100%;\r\n    max-width: none;\r\n    max-height: none;\r\n    object-position: var(--bg-image-position, center);\r\n}\r\n\r\n/* Ensure iframes cover entire background */\r\n.phantom-background-layer iframe.phantom-background-media {\r\n    border: none;\r\n    object-fit: cover;\r\n}\r\n\r\n/* Ensure content on top remains readable */\r\nhtml {\r\n    background-color: var(--bg);\r\n}\r\n\r\nbody {\r\n    position: relative;\r\n    z-index: 0;\r\n    background: transparent !important;\r\n    /* Allow background to show through */\r\n}\r\n\r\n/* Specific adjustments for transparency if needed */\r\n.main-content,\r\n.home-page {\r\n    background: transparent !important;\r\n}\r\n\r\n/* Glassmorphism for containers when background is active */\r\n.phantom-background.active~.offline-banner,\r\n.phantom-background.active~.home-page .card,\r\n.phantom-background.active~.home-page .featured-card,\r\n.phantom-background.active~.home-page .search-bar,\r\n.phantom-background.active~.settings-panel {\r\n    backdrop-filter: blur(10px);\r\n    -webkit-backdrop-filter: blur(10px);\r\n    background: rgba(15, 15, 15, 0.7) !important;\r\n}\n</style>\r\n    <style>\n/* Page Layout - Shared styles for games, movies, and similar pages */\r\n\r\n.page-header {\r\n    text-align: center;\r\n    margin-bottom: 24px;\r\n}\r\n\r\n.page-title {\r\n    font-size: 1.5rem;\r\n    font-weight: 700;\r\n    margin-bottom: 4px;\r\n}\r\n\r\n.page-subtitle {\r\n    color: var(--text-muted);\r\n    font-size: 0.875rem;\r\n    min-height: 1.25em;\r\n}\r\n\r\n/* Controls bar - search + filters */\r\n.controls {\r\n    display: flex;\r\n    gap: 10px;\r\n    justify-content: center;\r\n    flex-wrap: wrap;\r\n    margin-bottom: 24px;\r\n    max-width: 800px;\r\n    margin-left: auto;\r\n    margin-right: auto;\r\n}\r\n\r\n/* Shared search box */\r\n.search-box {\r\n    flex: 1;\r\n    min-width: 300px;\r\n    max-width: 100%;\r\n    width: 100%;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: 9999px;\r\n    padding: 12px 20px;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 12px;\r\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);\r\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\r\n    position: relative;\r\n}\r\n\r\n.search-box i {\r\n    color: var(--text-muted);\r\n    font-size: 14px;\r\n}\r\n\r\n.search-box input {\r\n    flex: 1;\r\n    background: transparent;\r\n    border: none;\r\n    outline: none;\r\n    color: var(--text);\r\n    font-size: 0.9375rem;\r\n}\r\n\r\n.search-box input::placeholder {\r\n    color: var(--text-muted);\r\n}\r\n\r\n/* Control Buttons (restored) */\r\n.ctrl-btn {\r\n    padding: 10px 16px;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: 9999px;\r\n    color: var(--text);\r\n    font-size: 0.8125rem;\r\n    font-weight: 500;\r\n    cursor: pointer;\r\n    transition: all 0.15s;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 8px;\r\n}\r\n\r\n.ctrl-btn:hover {\r\n    background: var(--surface-hover);\r\n    border-color: var(--text);\r\n}\r\n\r\n/* Select wrapper with custom dropdown arrow */\r\n.select-wrapper {\r\n    position: relative;\r\n}\r\n\r\n.select-wrapper select {\r\n    appearance: none;\r\n    padding: 10px 32px 10px 16px;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: 9999px;\r\n    color: var(--text);\r\n    font-size: 0.8125rem;\r\n    font-weight: 500;\r\n    cursor: pointer;\r\n    outline: none;\r\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\r\n}\r\n\r\n.select-wrapper::after {\r\n    content: '\\f078';\r\n    font-family: 'Font Awesome 6 Free';\r\n    font-weight: 900;\r\n    position: absolute;\r\n    right: 12px;\r\n    top: 50%;\r\n    transform: translateY(-50%);\r\n    font-size: 0.75rem;\r\n    color: var(--text-muted);\r\n    pointer-events: none;\r\n}\n</style>\r\n    <style>\n.games-page {\r\n    min-height: 100vh;\r\n    padding: 70px 20px 20px;\r\n}\r\n\r\n/* Page layout, controls, search-box, select-wrapper imported from layout.css */\r\n\r\n/* Grid */\r\n.game-grid {\r\n    display: grid;\r\n    grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));\r\n    gap: 14px;\r\n    max-width: 1200px;\r\n    margin: 0 auto;\r\n}\r\n\r\n.game-card {\r\n    position: relative;\r\n    background: rgba(255, 255, 255, 0.03);\r\n    backdrop-filter: blur(12px);\r\n    -webkit-backdrop-filter: blur(12px);\r\n    border: 1px solid rgba(255, 255, 255, 0.1);\r\n    border-radius: 10px;\r\n    overflow: hidden;\r\n    cursor: pointer;\r\n    transition: all 0.15s;\r\n    display: flex;\r\n    flex-direction: column;\r\n}\r\n\r\n.game-card:hover {\r\n    transform: translateY(-3px) scale(1.02);\r\n    border-color: var(--border-light);\r\n    background: var(--surface-hover);\r\n    z-index: 5;\r\n}\r\n\r\n.game-img-wrapper {\r\n    position: relative;\r\n    width: 100%;\r\n    aspect-ratio: 4/3;\r\n    background: #000;\r\n    overflow: hidden;\r\n}\r\n\r\n.game-img-wrapper img {\r\n    width: 100%;\r\n    height: 100%;\r\n    object-fit: cover;\r\n    transition: transform 0.3s;\r\n}\r\n\r\n.game-card:hover img {\r\n    transform: scale(1.1);\r\n}\r\n\r\n.like-btn {\r\n    position: absolute;\r\n    top: 6px;\r\n    right: 6px;\r\n    width: 28px;\r\n    height: 28px;\r\n    border-radius: 50%;\r\n    background: rgba(0, 0, 0, 0.6);\r\n    border: none;\r\n    color: #fff;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    cursor: pointer;\r\n    opacity: 0;\r\n    transition: all 0.2s;\r\n}\r\n\r\n.game-card:hover .like-btn {\r\n    opacity: 1;\r\n}\r\n\r\n.like-btn.active {\r\n    color: #ef4444;\r\n    opacity: 1;\r\n}\r\n\r\n.like-btn:hover {\r\n    transform: scale(1.1);\r\n    background: rgba(0, 0, 0, 0.8);\r\n}\r\n\r\n.game-info {\r\n    padding: 10px;\r\n    flex: 1;\r\n}\r\n\r\n.game-title {\r\n    font-size: 0.8125rem;\r\n    font-weight: 600;\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n    text-align: center;\r\n}\r\n\r\n.section-header {\r\n    max-width: 1200px;\r\n    margin: 0 auto 16px;\r\n    padding: 0 4px;\r\n    font-size: 1rem;\r\n    font-weight: 700;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 8px;\r\n}\r\n\r\n.section-header i {\r\n    color: var(--accent, #3b82f6);\r\n}\r\n\r\n#liked-section {\r\n    margin-bottom: 40px;\r\n    display: none;\r\n}\n</style>\r\n</head>\r\n\r\n<body>\r\n    <script>\n// topbar\r\n(function () {\r\n    let rootPrefix = '';\r\n    const scriptName = 'components/topbar.js';\r\n    const scripts = document.getElementsByTagName('script');\r\n    for (let i = 0; i < scripts.length; i++) {\r\n        const src = scripts[i].getAttribute('src');\r\n        if (src && src.includes(scriptName)) {\r\n            rootPrefix = src.split(scriptName)[0];\r\n            break;\r\n        }\r\n    }\r\n\r\n    if (!window.lucide && !document.querySelector('script[src*=\"lucide\"]')) {\r\n        const script = document.createElement('script');\r\n        script.src = 'https://unpkg.com/lucide@latest';\r\n        script.onload = () => {\r\n            if (window.lucide) lucide.createIcons();\r\n        };\r\n        document.head.appendChild(script);\r\n    }\r\n\r\n    initTopbar();\r\n\r\n    function createTopbar() {\r\n        const topbarContainer = document.createElement('div');\r\n        topbarContainer.id = 'topbar-container';\r\n\r\n        const logoSection = document.createElement('a');\r\n        logoSection.className = 'logo-section';\r\n        logoSection.href = rootPrefix + 'index2.html';\r\n        logoSection.innerHTML = '<div class=\"logo-placeholder\"><i data-lucide=\"zap\"></i></div>';\r\n        topbarContainer.appendChild(logoSection);\r\n\r\n        const navButtons = document.createElement('div');\r\n        navButtons.className = 'nav-buttons';\r\n\r\n        const buttons = [\r\n            { name: 'Music', icon: 'music', link: 'pages/music.html', badge: 'BETA' },\r\n            { name: 'Movies', icon: 'film', link: 'pages/movies.html' },\r\n            { name: 'Games', icon: 'gamepad-2', link: 'pages/games.html' },\r\n            { name: 'Watch', icon: 'play', link: 'pages/watch.html' },\r\n            { name: 'Search', icon: 'search', link: 'staticsjv2/index.html' },\r\n            { name: 'AI Chat', icon: 'bot', link: 'pages/chat.html' },\r\n            { separator: true },\r\n            { name: 'Settings', icon: 'settings', link: 'pages/settings.html' }\r\n        ];\r\n\r\n        buttons.forEach(btn => {\r\n            if (btn.separator) {\r\n                const separator = document.createElement('div');\r\n                separator.className = 'nav-separator';\r\n                navButtons.appendChild(separator);\r\n                return;\r\n            }\r\n\r\n            const link = document.createElement('a');   \r\n            link.href = rootPrefix + btn.link;\r\n            link.className = 'nav-btn';\r\n\r\n            const icon = document.createElement('i');\r\n            icon.setAttribute('data-lucide', btn.icon);\r\n            link.appendChild(icon);\r\n\r\n            const span = document.createElement('span');\r\n            span.textContent = btn.name;\r\n            link.appendChild(span);\r\n\r\n            if (btn.badge) {\r\n                const badge = document.createElement('div');\r\n                badge.className = 'nav-badge-beta';\r\n                badge.textContent = btn.badge;\r\n                link.appendChild(badge);\r\n            }\r\n\r\n            navButtons.appendChild(link);\r\n        });\r\n\r\n        topbarContainer.appendChild(navButtons);\r\n        document.body.prepend(topbarContainer);\r\n\r\n        if (window.lucide) {\r\n            lucide.createIcons();\r\n        }\r\n    }\r\n\r\n    function initTopbar() {\r\n        if (document.readyState === 'loading') {\r\n            document.addEventListener('DOMContentLoaded', createTopbar);\r\n        } else {\r\n            createTopbar();\r\n        }\r\n    }\r\n})();\r\n\n</script>\r\n\r\n    <div class=\"games-page\">\r\n        <header class=\"page-header\">\r\n            <h1 class=\"page-title\">Games Library</h1>\r\n            <p class=\"page-subtitle\" id=\"quote-display\">Loading...</p>\r\n        </header>\r\n\r\n        <div class=\"controls\">\r\n            <div class=\"search-box\">\r\n                <i class=\"fa-solid fa-search\"></i>\r\n                <input type=\"text\" id=\"search-input\" placeholder=\"Search games...\">\r\n            </div>\r\n\r\n            <div class=\"select-wrapper\">\r\n                <select id=\"lib-select\">\r\n                    <option value=\"multi\">Multi (Default)</option>\r\n                    <option value=\"gnmath\">Gnmath</option>\r\n                    <option value=\"ugs\">UGS</option>\r\n                </select>\r\n            </div>\r\n\r\n            <div class=\"select-wrapper\">\r\n                <select id=\"sort-select\">\r\n                    <option value=\"popularity\">Popularity</option>\r\n                    <option value=\"name\">Name</option>\r\n                    <option value=\"newest\">Newest</option>\r\n                </select>\r\n            </div>\r\n        </div>\r\n\r\n        <div id=\"liked-section\">\r\n            <div class=\"section-header\">\r\n                <i class=\"fa-solid fa-heart\"></i> Liked Games\r\n            </div>\r\n            <div class=\"game-grid\" id=\"liked-grid\"></div>\r\n        </div>\r\n\r\n        <div class=\"section-header\">\r\n            <i class=\"fa-solid fa-gamepad\"></i> <span id=\"game-count\">All Games</span>\r\n        </div>\r\n        <div class=\"game-grid\" id=\"games-grid\">\r\n            <!-- Loading Skeletons -->\r\n            <div class=\"game-card\">\r\n                <div style=\"aspect-ratio:4/3;background:var(--surface);\"></div>\r\n            </div>\r\n            <div class=\"game-card\">\r\n                <div style=\"aspect-ratio:4/3;background:var(--surface);\"></div>\r\n            </div>\r\n            <div class=\"game-card\">\r\n                <div style=\"aspect-ratio:4/3;background:var(--surface);\"></div>\r\n            </div>\r\n            <div class=\"game-card\">\r\n                <div style=\"aspect-ratio:4/3;background:var(--surface);\"></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <script>\n// site config\r\n\r\nwindow.SITE_CONFIG = {\r\n    name: \"Phantom\",\r\n    fullName: \"Phantom Unblocked\",\r\n    version: \"1.0.12\",\r\n\r\n    changelog: [\r\n        \"1.0.12: tiny fixxes and changes\",\r\n        \"some code consolidation and fixxes\",\r\n        \"suggest features in the discord server\"\r\n    ],\r\n\r\n    // quotes\r\n    quotes: [\r\n        \"lebron lebron lebronn james\",\r\n        \"so tuff\",\r\n        \"it is what it is\",\r\n        \"do ur work\",\r\n        \"this is what happens when u dont touch grass\",\r\n        \"FULL BOX\",\r\n        \"FULL PIECE\",\r\n        \"200!\",\r\n        \"press esc + refresh + power button for hacks\",\r\n        \"press ctrl+x to hide your screen\",\r\n        \"change the tab title and favicon in settings\",\r\n        \"TEACHERR!\",\r\n        \"1 pump\",\r\n        \"303 headshot\",\r\n        \"bros prolly a 60 ovr\",\r\n        \"take the L lil bro\",  \r\n        \"lebron is OUR goat\",\r\n        \"stop looking at my screen\",\r\n    ],\r\n\r\n    // todo\r\n    // *** for strikethrough\r\n    // ** for bold\r\n    todos: [\r\n        \"***fixxed aboutblank opening while securly is on (previously if popups were off it would load intab instead of clickto launch now it will use clicktolaunch unless popups are blocked)***\",\r\n        \"***fix the proxy***\",\r\n        \"***fix panic panickey, add quote talking about it***\",\r\n        \"***fix theatermode, make it hide buttons after a few seconds and ensure all content is being displayed and move the description to the bottom***\",\r\n        \"***change back player to use old styling, change the surface to use background colors for the bottom part where description is shown, looking just like the background***\",\r\n        \"***add image and video support for backgrounds***\",\r\n        \"***fix aichat, make the title use the same ai request as the users question unless its in image mode where it will use text mode and fix ai chat to remember modes better***\",\r\n        \"***add cloaking to quotes***\",\r\n        \"***add a default cloak and fix it so icons work in aboutblank for whatever reason they only work when you go to settings in aboutblank where it correctly applies***\",\r\n        \"***for search suggestions add highlighting for whatever will happen when you click enter, in search suggestions fix all games not sending you to the games page***\",\r\n        \"***fix games to make multi library the default, put it in config.js***\",\r\n        \"***rename movies shortcut in index2.html to primeshows, add shortcuts to main pages in the topbar and change the current shortcuts to more popular games***\",\r\n        \"***make announcements show even on first visit unlike changelog and allow disabling it via settings***\",\r\n        \"***fix leave comformation asking u to leave each time you click something***\",\r\n        \"***change the shortcuts on the main page to include pages***\",\r\n        \"***add movies to the search bar in main page***\",\r\n        \"***fix background not turning off soon***\",\r\n        \"***fix music page to hide youtube player unless toggled via 3 dot small button, and always shown on proxy mode, fix all the controls for video time, volume***\",\r\n        \"**add singlefile this is lowk so hard i dont really understand it**\",\r\n        \"**advertise phantom (too much work tbh)**\",\r\n        \"**add a watch page for youtube and twitch**\",\r\n        \"**add a miniplayer for music**\",\r\n        \"***shorten some page's code***\",\r\n        \"***fix paths in search autocomplete***\",\r\n        \"***fix markdown in ai not using correct text colors***\",\r\n        \"***make backgrounds show in the loading screen***\",\r\n        \"***fix icons for topbar in code.html***\",\r\n        \"**fix wisp server not notifying or autoswitiching when offline in proxy**\",\r\n        \"***fix code runner open not working at all***\",\r\n        \"***make backgrounds show in player.html***\",\r\n        \"***make backgrounds show in staticsjv2***\",\r\n        \"***make player.html player controls use theme colros not hardcoded***\",\r\n        \"***make ai chat and music sidebar go all the way down and up with borders***\",\r\n        \"**make the only song in music be lebron lebron lebron james**\",\r\n        \"**fix music controls**\",\r\n        \"***finish extra page into credits and make this todo be tucked away somewhere and not the main part of it***\"\r\n    ],\r\n    defaultWisp: \"wss://glseries.net/wisp/\",\r\n    wispServers: [\r\n        { name: \"GLSeries Wisp\", url: \"wss://glseries.net/wisp/\" },\r\n        { name: \"Rhw's Wisp\", url: \"wss://wisp.rhw.one/\" },\r\n    ],\r\n\r\n    discord: {\r\n        inviteUrl: \"https://discord.gg/tHWx9NXp5p\",\r\n        widgetServer: \"1447673724017971324\",\r\n        widgetChannel: \"1447673726228496617\",\r\n    },\r\n\r\n    firstVisitCloak: false, //fake error page\r\n    defaults: {\r\n        cloakMode: \"about:blank\",\r\n        tabTitle: \"You've already responded\",\r\n        tabFavicon: \"https://ssl.gstatic.com/docs/spreadsheets/forms/forms_icon_2023q4.ico\",\r\n        cloakRotation: false,\r\n        cloakInterval: 5000,\r\n        panicKey: \"x\",\r\n        panicModifiers: [\"ctrl\", \"shift\"],\r\n        panicUrl: \"https://classroom.google.com\",\r\n        maxMovieRating: \"R\",\r\n        gameLibrary: \"multi\",\r\n        discordWidget: true,\r\n        miniplayer: true,\r\n        leaveConfirmation: false,\r\n        showChangelogOnUpdate: true,\r\n        themeRotation: true,\r\n        lastThemeRotation: 0,\r\n        backgroundRotation: true,\r\n        lastBackgroundRotation: 0,\r\n        lastSeenFeatured: 'none',\r\n        background: { type: 'color', value: '#0a0a0a' },\r\n        customBackground: { id: 'none', type: 'none' },\r\n        accentColor: '#ffffff',\r\n        surfaceColor: '#0f0f0f',\r\n        secondaryColor: '#2e2e33',\r\n        textColor: '#e4e4e7',\r\n    },\r\n\r\n    themePresets: {\r\n        dark: { name: 'Dark (Default)', bg: { type: 'color', value: '#0a0a0a' }, surface: '#0f0f0f', surfaceHover: '#1a1a1a', surfaceActive: '#252525', secondary: '#2e2e33', border: '#2a2a2a', borderLight: '#2a2a2a', text: '#e4e4e7', textSec: '#71717a', textDim: '#52525b', accent: '#ffffff' },\r\n        midnight: { name: 'Midnight', bg: { type: 'color', value: '#000000' }, surface: '#050505', surfaceHover: '#111111', surfaceActive: '#1a1a1a', secondary: '#111111', border: '#1a1a1a', borderLight: '#111111', text: '#ededed', textSec: '#a3a3a3', textDim: '#737373', accent: '#d4d4d4' },\r\n        abyss: { name: 'Abyss', bg: { type: 'color', value: '#020617' }, surface: '#0f172a', surfaceHover: '#1e293b', surfaceActive: '#334155', secondary: '#1e293b', border: '#1e293b', borderLight: '#1e293b', text: '#f1f5f9', textSec: '#94a3b8', textDim: '#64748b', accent: '#38bdf8' },\r\n        phantom: { name: 'Phantom', bg: { type: 'color', value: '#0f0a14' }, surface: '#1a0f24', surfaceHover: '#2e1a40', surfaceActive: '#4c2a5c', secondary: '#2e1a40', border: '#2e1a40', borderLight: '#2e1a40', text: '#f3e8ff', textSec: '#d8b4fe', textDim: '#c084fc', accent: '#c084fc' },\r\n        rosepine: { name: 'Rose Pine', bg: { type: 'color', value: '#191724' }, surface: '#1f1d2e', surfaceHover: '#26233a', surfaceActive: '#524f67', secondary: '#26233a', border: '#26233a', borderLight: '#1f1d2e', text: '#e0def4', textSec: '#908caa', textDim: '#6e6a86', accent: '#ebbcba' },\r\n        ocean: { name: 'Oceanic', bg: { type: 'color', value: '#011627' }, surface: '#0b2942', surfaceHover: '#1d3b53', surfaceActive: '#2d4b63', secondary: '#0b2942', border: '#1d3b53', borderLight: '#0b2942', text: '#d6deeb', textSec: '#5f7e97', textDim: '#011627', accent: '#7fdbca' },\r\n        forest: { name: 'Forest', bg: { type: 'color', value: '#020d06' }, surface: '#051a0d', surfaceHover: '#0a2e17', surfaceActive: '#0f4221', secondary: '#051a0d', border: '#0a2e17', borderLight: '#051a0d', text: '#ecfdf5', textSec: '#6ee7b7', textDim: '#064e3b', accent: '#10b981' },\r\n        crimson: { name: 'Crimson', bg: { type: 'color', value: '#1a0505' }, surface: '#230a0a', surfaceHover: '#7b0a0aff', surfaceActive: '#7f1d1d', secondary: '#230a0a', border: '#480f0fff', borderLight: '#230a0a', text: '#fef2f2', textSec: '#fecaca', textDim: '#450a0a', accent: '#ef4444' },\r\n        flame: { name: 'Flame', bg: { type: 'color', value: '#0c0202' }, surface: '#1c0a0a', surfaceHover: '#451a03', surfaceActive: '#9a3412', secondary: '#1c0a0a', border: '#451a03', borderLight: '#9a3412', text: '#fff7ed', textSec: '#fdba74', textDim: '#ea580c', accent: '#f59e0b' }\r\n    },\r\n\r\n    backgroundPresets: [\r\n        { id: 'none', name: 'None (Theme Default)', type: 'none' },\r\n        { id: 'Night sky', name: 'Night sky', type: 'image', url: 'https://images.pexels.com/photos/5675745/pexels-photo-5675745.jpeg', overlay: 0.3 },\r\n        { id: 'winter-mountains', name: 'Winter mountains', type: 'image', url: 'https://images.pexels.com/photos/1287145/pexels-photo-1287145.jpeg', overlay: 0.3 },\r\n        { id: 'f1 car', name: 'F1 Car', type: 'image', url: 'https://images.pexels.com/photos/14401632/pexels-photo-14401632.jpeg', overlay: 0.3 },\r\n        { id: 'moon-landing', name: 'Moon Landing', type: 'image', url: 'https://images.pexels.com/photos/41162/moon-landing-apollo-11-nasa-buzz-aldrin-41162.jpeg', overlay: 0.3, objectPosition: 'top left', active: true },\r\n        { id: 'turtle', name: 'Turtle', type: 'image', url: 'https://images.unsplash.com/photo-1501791187590-9ef2612ba1eb?q=80&w=1932&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D', overlay: 0.3 },\r\n        { id: 'road', name: 'Road', type: 'image', url: 'https://images.unsplash.com/photo-1508233620467-f79f1e317a05', overlay: 0.3 },\r\n        { id: 'railroad', name: 'Railroad', type: 'image', url: 'https://images.unsplash.com/photo-1505832018823-50331d70d237', overlay: 0.3 },\r\n        { id: 'mountain', name: 'Mountain', type: 'image', url: 'https://raw.githubusercontent.com/evanhnry/brave-wallpapers/refs/heads/main/Brave/clay-banks-u27Rrbs9Dwc-unsplash.jpg', overlay: 0.3 },\r\n    ],\r\n\r\n    cloakPresets: [\r\n        { name: \"Phantom\", icon: \"/favicon.svg\", title: \"Phantom Unblocked\" },\r\n        { name: \"Edpuzzle\", icon: \"https://edpuzzle.imgix.net/favicons/favicon-32.png\", title: \"Edpuzzle\" },\r\n        { name: \"Google Docs\", icon: \"https://ssl.gstatic.com/docs/documents/images/kix-favicon7.ico\", title: \"Untitled document - Google Docs\" },\r\n        { name: \"Canvas\", icon: \"https://du11hjcvx0uqb.cloudfront.net/dist/images/favicon-e10d657a73.ico\", title: \"Dashboard\" },\r\n        { name: \"Desmos\", icon: \"https://www.desmos.com/favicon.ico\", title: \"Desmos | Graphing Calculator\" },\r\n        { name: \"Khan Academy\", icon: \"https://cdn.kastatic.org/images/favicon.ico\", title: \"Khan Academy\" },\r\n        { name: \"Wikipedia\", icon: \"https://en.wikipedia.org/favicon.ico\", title: \"World War II - Wikipedia\" },\r\n        { name: \"Classroom\", icon: \"https://ssl.gstatic.com/classroom/favicon.png\", title: \"Home - Classroom\" },\r\n        { name: \"Canva\", icon: \"https://static.canva.com/static/images/android-192x192-2.png\", title: \"Home - Canva\" },\r\n        { name: \"Quiz\", icon: \"https://ssl.gstatic.com/docs/spreadsheets/forms/forms_icon_2023q4.ico\", title: \"You've already responded\" },\r\n        { name: \"Blooket\", icon: \"https://play.blooket.com/favicon.ico\", title: \"Play Blooket | Blooket\" },\r\n        { name: \"Gmail\", icon: \"https://ssl.gstatic.com/ui/v1/icons/mail/rfr/gmail.ico\", title: \"Gmail\" },\r\n        { name: \"YouTube\", icon: \"https://www.youtube.com/favicon.ico\", title: \"YouTube\" },\r\n        { name: \"Powerschool\", icon: \"https://waverlyk12.powerschool.com/favicon.ico\", title: \"Grades and Attendance\" },\r\n        { name: \"nothing\", icon: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=\", title: \"\\u200B\" },\r\n    ]\r\n}\r\n\r\n\r\n\n</script>\r\n    <script>\n// settings handler\r\n(function () {\r\n    'use strict';\r\n\r\n    const STORAGE_KEY = 'void_settings';\r\n\r\n    const getDefaults = () => {\r\n        return window.SITE_CONFIG?.defaults || {\r\n            cloakMode: 'none',\r\n            cloakRotation: false,\r\n            cloakInterval: 5000,\r\n            panicKey: 'x',\r\n            panicModifiers: ['ctrl', 'shift'],\r\n            panicUrl: 'https://classroom.google.com',\r\n            maxMovieRating: 'R',\r\n            offlineGames: [],\r\n            gameLibrary: 'multi',\r\n            leaveConfirmation: false\r\n        };\r\n    };\r\n\r\n    const load = () => {\r\n        try {\r\n            const stored = localStorage.getItem(STORAGE_KEY);\r\n            if (stored) {\r\n                return { ...getDefaults(), ...JSON.parse(stored) };\r\n            }\r\n        } catch (e) {\r\n            console.warn('Failed to load settings:', e);\r\n        }\r\n        return getDefaults();\r\n    };\r\n\r\n    const save = (settings) => {\r\n        try {\r\n            localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n            window.dispatchEvent(new CustomEvent('settings-changed', { detail: settings }));\r\n            if (window.parent !== window) {\r\n                window.parent.postMessage({ type: 'settings-update' }, '*');\r\n            }\r\n        } catch (e) {\r\n            console.warn('Failed to save settings:', e);\r\n        }\r\n    };\r\n\r\n    let _settings = load();\r\n\r\n    window.Settings = {\r\n        get(key) { return _settings[key]; },\r\n\r\n        getAll() { return { ..._settings }; },\r\n\r\n        set(key, value) {\r\n            _settings[key] = value;\r\n            save(_settings);\r\n            this.apply();\r\n            return value;\r\n        },\r\n\r\n        update(partial) {\r\n            _settings = { ..._settings, ...partial };\r\n            save(_settings);\r\n            this.apply();\r\n        },\r\n\r\n        reset() {\r\n            _settings = getDefaults();\r\n            save(_settings);\r\n            this.apply();\r\n        },\r\n\r\n        apply() {\r\n            const root = document.documentElement;\r\n            const s = _settings;\r\n            const d = window.SITE_CONFIG?.defaults || {};\r\n\r\n            const vars = {\r\n                '--accent': s.accentColor || d.accentColor || '#ffffff',\r\n                '--surface': s.surfaceColor || d.surfaceColor || '#0f0f0f',\r\n                '--surface-hover': s.surfaceHoverColor || d.surfaceHoverColor || '#1a1a1a',\r\n                '--surface-active': s.surfaceActiveColor || d.surfaceActiveColor || '#252525',\r\n                '--secondary': s.secondaryColor || d.secondaryColor || '#2e2e33',\r\n                '--border': s.borderColor || d.borderColor || '#1f1f1f',\r\n                '--border-light': s.borderLightColor || d.borderLightColor || '#2a2a2a',\r\n                '--text': s.textColor || d.textColor || '#e4e4e7',\r\n                '--text-muted': s.textSecondaryColor || d.textSecondaryColor || '#71717a',\r\n                '--text-dim': s.textDimColor || d.textDimColor || '#52525b',\r\n                '--toggle': s.toggleColor || d.toggleColor,\r\n                '--toggle-knob': s.toggleKnobColor || d.toggleKnobColor\r\n            };\r\n\r\n            Object.entries(vars).forEach(([key, val]) => {\r\n                if (val) root.style.setProperty(key, val);\r\n            });\r\n\r\n            const themeBg = s.background || d.background || { type: 'color', value: '#0a0a0a' };\r\n            const customBg = s.customBackground;\r\n            const isCustomActive = customBg && customBg.type !== 'none';\r\n\r\n            if (themeBg.type === 'color') {\r\n                root.style.setProperty('--bg', themeBg.value);\r\n            }\r\n\r\n            if (isCustomActive && customBg.url) {\r\n                root.style.setProperty('--bg-image', `url(${customBg.url})`);\r\n\r\n                let position = customBg.objectPosition;\r\n                if (customBg.id && customBg.id !== 'custom') {\r\n                    const preset = window.SITE_CONFIG?.backgroundPresets?.find(b => b.id === customBg.id);\r\n                    if (preset?.objectPosition) position = preset.objectPosition;\r\n                }\r\n\r\n                root.style.setProperty('--bg-image-position', position || 'center');\r\n            } else if (themeBg.type === 'image' || themeBg.type === 'video') {\r\n                root.style.setProperty('--bg-image', `url(${themeBg.value || themeBg.url})`);\r\n                root.style.setProperty('--bg-image-position', themeBg.objectPosition || 'center');\r\n            } else if (themeBg.type === 'gradient') {\r\n                root.style.setProperty('--bg-image', themeBg.value || themeBg.url);\r\n                root.style.setProperty('--bg-image-position', 'center');\r\n            } else {\r\n                root.style.setProperty('--bg-image', 'none');\r\n            }\r\n        },\r\n\r\n        onChange(callback) {\r\n            window.addEventListener('settings-changed', (e) => callback(e.detail));\r\n        },\r\n\r\n        isRatingAllowed(rating) {\r\n            if (!rating || rating === 'NR' || rating === 'NC-17') return false;\r\n            const ratingOrder = ['G', 'PG', 'PG-13', 'R'];\r\n            const maxIndex = ratingOrder.indexOf(_settings.maxMovieRating);\r\n            const ratingIndex = ratingOrder.indexOf(rating);\r\n            return maxIndex !== -1 && ratingIndex !== -1 && ratingIndex <= maxIndex;\r\n        }\r\n    };\r\n\r\n    // panic button go brr\r\n    const handlePanic = (e) => {\r\n        const mods = _settings.panicModifiers || [];\r\n        const key = _settings.panicKey || 'x';\r\n\r\n        if (mods.includes('ctrl') !== e.ctrlKey) return;\r\n        if (mods.includes('shift') !== e.shiftKey) return;\r\n        if (mods.includes('alt') !== e.altKey) return;\r\n\r\n        if (e.key.toLowerCase() === key.toLowerCase()) {\r\n            e.preventDefault();\r\n            const overlayId = 'panic-overlay';\r\n            let overlay = window.parent?.document?.getElementById(overlayId) || document.getElementById(overlayId);\r\n\r\n            if (!overlay) {\r\n                overlay = document.createElement('div');\r\n                overlay.id = overlayId;\r\n                overlay.style.cssText = 'position:fixed;inset:0;background:white;z-index:99999;';\r\n                document.body.appendChild(overlay);\r\n            } else {\r\n                overlay.style.display = 'block';\r\n            }\r\n\r\n            window.location.replace(_settings.panicUrl || 'https://classroom.google.com');\r\n        }\r\n    };\r\n\r\n    const init = () => {\r\n        Settings.apply();\r\n\r\n        const featured = window.SITE_CONFIG?.featuredBackground;\r\n        const activePreset = window.SITE_CONFIG?.backgroundPresets?.find(p => p.active);\r\n\r\n        const target = activePreset || featured;\r\n\r\n        if (target?.id && target.id !== _settings.lastSeenFeatured) {\r\n            Settings.update({\r\n                customBackground: target,\r\n                lastSeenFeatured: target.id,\r\n                backgroundRotation: false\r\n            });\r\n        }\r\n\r\n        document.addEventListener('keydown', handlePanic, true);\r\n\r\n        window.addEventListener('storage', (e) => {\r\n            if (e.key === STORAGE_KEY) {\r\n                _settings = load();\r\n                Settings.apply();\r\n                window.dispatchEvent(new CustomEvent('settings-changed', { detail: _settings }));\r\n            }\r\n        });\r\n\r\n        window.addEventListener('message', (e) => {\r\n            if (e.data?.type === 'settings-update' || e.data === 'updateCloak') {\r\n                _settings = load();\r\n                Settings.apply();\r\n                window.dispatchEvent(new CustomEvent('settings-changed', { detail: _settings }));\r\n            }\r\n        });\r\n\r\n        window.addEventListener('beforeunload', (e) => {\r\n            if (document.getElementById('main-frame') && _settings.leaveConfirmation) {\r\n                e.preventDefault();\r\n                return e.returnValue = '';\r\n            }\r\n        });\r\n    };\r\n\r\n    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', init);\r\n    else init();\r\n})();\r\n\n</script>\r\n    <script>\n// background stuff\r\n(function () {\r\n    'use strict';\r\n\r\n    if (window.BackgroundManager) return;\r\n\r\n    const YOUTUBE_REGEX = /(?:youtube\\.com\\/watch\\?v=|youtu\\.be\\/|youtube\\.com\\/embed\\/)([a-zA-Z0-9_-]{11})/;\r\n\r\n    const BackgroundManager = {\r\n        container: null,\r\n        mediaLayer: null,\r\n        elements: { video: null, image: null, iframe: null },\r\n        current: { type: null, url: null },\r\n        cacheName: 'phantom-bg-cache-v2',\r\n\r\n        init() {\r\n            this.container = document.createElement('div');\r\n            this.container.className = 'phantom-background';\r\n            this.container.innerHTML = '<div class=\"phantom-background-overlay\"></div><div class=\"phantom-background-layer\"></div>';\r\n            this.mediaLayer = this.container.querySelector('.phantom-background-layer');\r\n            document.body.insertBefore(this.container, document.body.firstChild);\r\n\r\n            const apply = () => this.applyBackground();\r\n            window.addEventListener('settings-changed', apply);\r\n            window.addEventListener('storage', apply);\r\n            window.addEventListener('beforeunload', () => this.cleanup());\r\n            window.addEventListener('pagehide', () => this.cleanup());\r\n\r\n            document.addEventListener('visibilitychange', () => {\r\n                const video = this.elements.video;\r\n                if (!video) return;\r\n                if (document.hidden) video.pause();\r\n                else if (this.current.type === 'video') video.play().catch(() => { });\r\n            });\r\n\r\n            this.applyBackground();\r\n        },\r\n\r\n        applyBackground() {\r\n            if (!this.container) return; // Wait for init() to create the container\r\n\r\n            const s = window.Settings?.getAll() || {};\r\n            const custom = s.customBackground;\r\n            const theme = s.background || {};\r\n\r\n            let type = null, url = null, pos = null, overlay = 0.4;\r\n\r\n            if (custom && custom.type !== 'none') {\r\n                // Refresh from config if possible to get latest props like objectPosition\r\n                if (custom.id && custom.id !== 'custom') {\r\n                    const preset = window.SITE_CONFIG?.backgroundPresets?.find(b => b.id === custom.id);\r\n                    if (preset) Object.assign(custom, preset);\r\n                }\r\n                ({ type, url, objectPosition: pos, overlay = 0.4 } = custom);\r\n            } else if (theme.type === 'image' || theme.type === 'video' || theme.type === 'youtube') {\r\n                type = theme.type;\r\n                url = theme.value || theme.url;\r\n                pos = theme.objectPosition;\r\n                overlay = theme.overlay || 0.4;\r\n            }\r\n\r\n            document.documentElement.style.setProperty('--bg-overlay', overlay);\r\n\r\n            // Handle common positioning typos and normalize\r\n            if (pos && typeof pos === 'string') {\r\n                pos = pos.toLowerCase().trim()\r\n                    .replace(/\\s+/g, ' ') // Normalize multiple spaces\r\n                    .replace('topleft', 'top left')\r\n                    .replace('topright', 'top right')\r\n                    .replace('bottomleft', 'bottom left')\r\n                    .replace('bottomright', 'bottom right')\r\n                    .replace('centercenter', 'center')\r\n                    .replace('centerleft', 'center left')\r\n                    .replace('centerright', 'center right');\r\n            }\r\n\r\n            document.documentElement.style.setProperty('--bg-image-position', pos || 'center');\r\n\r\n            if (!type || !url) {\r\n                this.clear();\r\n                document.documentElement.style.backgroundColor = 'var(--bg)';\r\n                document.documentElement.style.setProperty('--bg-image-position', 'center');\r\n                return;\r\n            }\r\n            if (this.current.type === type && this.current.url === url) return;\r\n\r\n            this.current = { type, url };\r\n\r\n            if (type === 'video' || url.match(/\\.(mp4|webm|ogg|mov|m4v)$/i)) {\r\n                this.clearMedia();\r\n                this.createVideo(url, pos);\r\n                this.container.classList.add('active');\r\n                document.documentElement.classList.add('phantom-bg-active');\r\n                document.body.classList.add('phantom-bg-active');\r\n            } else if (type === 'youtube' || YOUTUBE_REGEX.test(url)) {\r\n                this.clearMedia();\r\n                this.createYouTube(url, pos);\r\n                this.container.classList.add('active');\r\n                document.documentElement.classList.add('phantom-bg-active');\r\n                document.body.classList.add('phantom-bg-active');\r\n            } else if (type === 'image') {\r\n                this.handleImageBackground(url, pos);\r\n            }\r\n        },\r\n\r\n        async getProxiedCachedUrl(url) {\r\n            // Local images don't need proxying\r\n            if (!url.startsWith('http') || url.includes(location.hostname)) return url;\r\n\r\n            // Try direct load first (faster)\r\n            try {\r\n                const directTest = await fetch(url, { method: 'HEAD', mode: 'cors' });\r\n                if (directTest.ok) return url;\r\n            } catch (e) {\r\n                // CORS blocked, need to proxy\r\n            }\r\n\r\n            // Wait for BareMux (max 500ms)\r\n            let retries = 0;\r\n            while (!window.BareMux && retries < 5) {\r\n                await new Promise(r => setTimeout(r, 100));\r\n                retries++;\r\n            }\r\n\r\n            if (!window.BareMux) {\r\n                console.warn(\"Background: BareMux not found, trying direct URL.\");\r\n                return url; // Try direct anyway\r\n            }\r\n\r\n            try {\r\n                const client = new window.BareMux.BareClient();\r\n                const response = await client.fetch(url);\r\n                if (!response.ok) throw new Error('Proxy fetch failed');\r\n\r\n                const blob = await response.blob();\r\n                return URL.createObjectURL(blob);\r\n            } catch (error) {\r\n                console.error(\"Background proxy failed:\", error);\r\n                return url; // Fallback to direct URL\r\n            }\r\n        },\r\n\r\n        async handleImageBackground(url, pos) {\r\n            // Pre-load the image (proxied/cached or direct)\r\n            const finalUrl = await this.getProxiedCachedUrl(url);\r\n\r\n            // Check if this is still the current background after async fetch\r\n            if (this.current.url !== url) {\r\n                if (finalUrl && finalUrl.startsWith('blob:')) URL.revokeObjectURL(finalUrl);\r\n                return;\r\n            }\r\n\r\n            this.clearMedia();\r\n            this.createImage(finalUrl, pos);\r\n        },\r\n\r\n        createVideo(url, pos) {\r\n            const el = Object.assign(document.createElement('video'), {\r\n                className: 'phantom-background-media', src: url, autoplay: true, loop: true, muted: true, playsInline: true, volume: 0\r\n            });\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n            el.onerror = () => (this.elements.video = null);\r\n            this.elements.video = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        createImage(url, pos) {\r\n            const el = Object.assign(document.createElement('img'), {\r\n                className: 'phantom-background-media',\r\n                src: url\r\n            });\r\n\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n\r\n            el.onload = () => {\r\n                if (this.current.url === url || url.startsWith('blob:')) {\r\n                    this.container.classList.add('active');\r\n                    document.documentElement.classList.add('phantom-bg-active');\r\n                    document.body.classList.add('phantom-bg-active');\r\n                }\r\n            };\r\n            el.onerror = () => {\r\n                console.warn(\"Background image failed to load:\", url);\r\n                if (this.elements.image === el) this.elements.image = null;\r\n            };\r\n\r\n            this.elements.image = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        // youtube logic\r\n        createYouTube(url, pos) {\r\n            const id = url.match(YOUTUBE_REGEX)?.[1];\r\n            if (!id) return;\r\n            const el = Object.assign(document.createElement('iframe'), {\r\n                className: 'phantom-background-media',\r\n                src: `https://www.youtube.com/embed/${id}?autoplay=1&loop=1&playlist=${id}&controls=0&modestbranding=1&rel=0&mute=1&enablejsapi=1`,\r\n                allow: 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture'\r\n            });\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n            this.elements.iframe = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        clearMedia() {\r\n            Object.entries(this.elements).forEach(([key, el]) => {\r\n                if (!el) return;\r\n                if (key === 'video') { el.pause(); el.src = ''; }\r\n                if (key === 'iframe') el.src = 'about:blank';\r\n                if (key === 'image' && el.src.startsWith('blob:')) {\r\n                    URL.revokeObjectURL(el.src);\r\n                }\r\n                el.remove();\r\n                this.elements[key] = null;\r\n            });\r\n        },\r\n\r\n        clear() {\r\n            this.clearMedia();\r\n            this.current = { type: null, url: null };\r\n            document.documentElement.classList.remove('phantom-bg-active');\r\n            document.body.classList.remove('phantom-bg-active');\r\n            document.documentElement.style.backgroundColor = '';\r\n            if (this.container) this.container.classList.remove('active');\r\n        },\r\n\r\n        cleanup() {\r\n            this.clearMedia();\r\n        }\r\n    };\r\n\r\n    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', () => BackgroundManager.init());\r\n    else BackgroundManager.init();\r\n\r\n    window.BackgroundManager = BackgroundManager;\r\n})();\r\n\n</script>\r\n    <script>\nwindow.Quotes = {\r\n    // Use data from config, fallback to empty array if not found\r\n    getData() {\r\n        return (window.SITE_CONFIG && window.SITE_CONFIG.quotes) || [];\r\n    },\r\n\r\n    getRandom() {\r\n        const data = this.getData();\r\n        if (!data.length) return null; // Return null if no quotes\r\n        return data[Math.floor(Math.random() * data.length)];\r\n    },\r\n    init(force = false) {\r\n        const quote = this.getRandom();\r\n        if (!quote) return; // Do nothing if no quotes\r\n\r\n        const targets = [\r\n            '#quote',\r\n            '#quote-display',\r\n            '#subtitle',\r\n            '.page-subtitle',\r\n            '.extra-hero p',\r\n            '.loading-text'\r\n        ];\r\n\r\n        targets.forEach(selector => {\r\n            document.querySelectorAll(selector).forEach(el => {\r\n                // Only update if force is true, or it's empty, or has placeholder text\r\n                const text = el.textContent.trim();\r\n                if (force || !text || text === 'Loading...' || text.includes('Stream movies') || text.includes('Customize your')) {\r\n                    el.textContent = quote;\r\n                }\r\n            });\r\n        });\r\n    }\r\n};\r\n\r\nwindow.QUOTES = window.Quotes.getData();\r\n\r\n// Run automatically on load\r\nif (document.readyState === 'loading') {\r\n    document.addEventListener('DOMContentLoaded', () => window.Quotes.init());\r\n} else {\r\n    window.Quotes.init();\r\n}\r\n\n</script>\r\n    <script>\n(function () {\r\n    const style = document.createElement('style');\r\n    style.textContent = `\r\n        .notify-container { position: fixed; top: 16px; right: 16px; z-index: 99999; display: flex; flex-direction: column; gap: 8px; pointer-events: none; font-family: 'Inter', sans-serif; }\r\n        .notify-toast { display: flex; align-items: center; gap: 12px; padding: 12px 16px; background: rgba(15, 15, 15, 0.9); backdrop-filter: blur(10px); border: 1px solid var(--border, #1f1f1f); border-radius: 10px; color: #e4e4e7; font-size: 13px; min-width: 280px; max-width: 380px; box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4); pointer-events: auto; transform: translateX(120%); opacity: 0; transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1), opacity 0.3s ease; position: relative; overflow: hidden; }\r\n        .notify-toast.show { transform: translateX(0); opacity: 1; }\r\n        .notify-toast.hiding { transform: translateX(120%); opacity: 0; }\r\n        .notify-icon { width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }\r\n        .notify-icon svg { width: 18px; height: 18px; }\r\n        .notify-content { flex: 1; line-height: 1.4; }\r\n        .notify-title { font-weight: 600; margin-bottom: 2px; }\r\n        .notify-message { color: #a1a1aa; font-size: 12px; }\r\n        .notify-close { background: none; border: none; color: #52525b; cursor: pointer; padding: 4px; border-radius: 4px; display: flex; align-items: center; justify-content: center; }\r\n        .notify-close:hover { background: rgba(255,255,255,0.1); color: #fff; }\r\n        .notify-close svg { width: 14px; height: 14px; }\r\n        .notify-toast.success { border-left: 3px solid #22c55e; } .notify-toast.success .notify-icon { color: #22c55e; }\r\n        .notify-toast.error { border-left: 3px solid #ef4444; } .notify-toast.error .notify-icon { color: #ef4444; }\r\n        .notify-toast.warning { border-left: 3px solid #f59e0b; } .notify-toast.warning .notify-icon { color: #f59e0b; }\r\n        .notify-toast.info { border-left: 3px solid #3b82f6; } .notify-toast.info .notify-icon { color: #3b82f6; }\r\n        .notify-progress { position: absolute; bottom: 0; left: 0; height: 2px; background: rgba(255, 255, 255, 0.2); transition: width linear; }\r\n    `;\r\n    document.head.appendChild(style);\r\n\r\n    let container = null;\r\n    const getContainer = () => container || (container = document.body.appendChild(Object.assign(document.createElement('div'), { className: 'notify-container' })));\r\n\r\n    const icons = {\r\n        success: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"20 6 9 17 4 12\"></polyline></svg>`,\r\n        error: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"15\" y1=\"9\" x2=\"9\" y2=\"15\"></line><line x1=\"9\" y1=\"9\" x2=\"15\" y2=\"15\"></line></svg>`,\r\n        warning: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\"></path><line x1=\"12\" y1=\"9\" x2=\"12\" y2=\"13\"></line><line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\"></line></svg>`,\r\n        info: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"12\" y1=\"16\" x2=\"12\" y2=\"12\"></line><line x1=\"12\" y1=\"8\" x2=\"12.01\" y2=\"8\"></line></svg>`,\r\n        close: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line><line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line></svg>`\r\n    };\r\n\r\n    function notify(type, title, msg = '', dur = 4000) {\r\n        const t = document.createElement('div');\r\n        t.className = `notify-toast ${type}`;\r\n        t.innerHTML = `<div class=\"notify-icon\">${icons[type]}</div><div class=\"notify-content\"><div class=\"notify-title\">${title}</div><div class=\"notify-message\">${msg}</div></div><button class=\"notify-close\">${icons.close}</button><div class=\"notify-progress\"></div>`;\r\n        const p = t.querySelector('.notify-progress');\r\n        const dismiss = () => { t.classList.add('hiding'); setTimeout(() => t.remove(), 300); };\r\n        t.querySelector('.notify-close').onclick = dismiss;\r\n        p.style.width = '100%';\r\n        setTimeout(() => { p.style.transition = `width ${dur}ms linear`; p.style.width = '0%'; }, 50);\r\n        let timer = setTimeout(dismiss, dur);\r\n        t.onmouseenter = () => { clearTimeout(timer); p.style.transition = 'none'; };\r\n        t.onmouseleave = () => {\r\n            const rem = (parseFloat(getComputedStyle(p).width) / t.offsetWidth) * dur;\r\n            p.style.transition = `width ${rem}ms linear`; p.style.width = '0%';\r\n            timer = setTimeout(dismiss, rem);\r\n        };\r\n        getContainer().appendChild(t);\r\n        requestAnimationFrame(() => t.classList.add('show'));\r\n    }\r\n\r\n    window.Notify = {\r\n        success: (a, b, c) => notify('success', a, b, c),\r\n        error: (a, b, c) => notify('error', a, b, c),\r\n        warning: (a, b, c) => notify('warning', a, b, c),\r\n        info: (a, b, c) => notify('info', a, b, c)\r\n    };\r\n})();\r\n\n</script>\r\n    <script>\n// footer\r\n(function () {\r\n    'use strict';\r\n\r\n    let rootPrefix = '';\r\n    const scriptName = 'components/footer.js';\r\n    const scripts = document.getElementsByTagName('script');\r\n    for (let i = 0; i < scripts.length; i++) {\r\n        const src = scripts[i].getAttribute('src');\r\n        if (src && src.includes(scriptName)) {\r\n            rootPrefix = src.split(scriptName)[0];\r\n            break;\r\n        }\r\n    }\r\n\r\n    const config = window.SITE_CONFIG || { name: 'Phantom', version: '1.0.0', discord: { inviteUrl: '#' }, changelog: [], cloakPresets: [] };\r\n    const STORAGE_KEY = 'void_settings';\r\n    let storedSettings = {};\r\n    try { storedSettings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n\r\n    // settings\r\n    let settings = { ...(config.defaults || {}), ...storedSettings };\r\n\r\n    const footer = document.createElement('footer');\r\n    footer.id = 'site-footer';\r\n    footer.innerHTML = `\r\n        <style>\r\n            #site-footer {\r\n                margin-top: 0px;\r\n                padding: 20px;\r\n                border-top: 1px solid var(--border, #1f1f1f);\r\n                text-align: center;\r\n                background: transparent;\r\n            }\r\n            #site-footer .footer-links {\r\n                display: flex;\r\n                gap: 16px;\r\n                justify-content: center;\r\n                margin-bottom: 8px;\r\n                flex-wrap: wrap;\r\n            }\r\n            #site-footer .footer-link {\r\n                font-size: 12px;\r\n                color: var(--text-muted, #71717a);\r\n                text-decoration: none;\r\n                transition: color 0.15s;\r\n                font-family: 'Inter', sans-serif;\r\n                cursor: pointer;\r\n            }\r\n            #site-footer .footer-link:hover {\r\n                color: var(--text, #e4e4e7);\r\n            }\r\n            #site-footer .footer-version {\r\n                font-size: 11px;\r\n                color: var(--text-dim, #52525b);\r\n                cursor: pointer;\r\n                font-family: 'Inter', sans-serif;\r\n            }\r\n            #site-footer .footer-version:hover {\r\n                color: var(--text-muted, #71717a);\r\n            }\r\n        </style>\r\n        <div class=\"footer-links\">\r\n            <a href=\"${rootPrefix}pages/settings.html\" class=\"footer-link\"><i class=\"fa-solid fa-gear\"></i> Settings</a>\r\n            <a id=\"footer-changelog\" class=\"footer-link\"><i class=\"fa-solid fa-clock-rotate-left\"></i> Changelog</a>\r\n            <a href=\"${config.discord?.inviteUrl || '#'}\" target=\"_blank\" class=\"footer-link\"><i class=\"fa-brands fa-discord\"></i> Discord</a>\r\n            <a href=\"${rootPrefix}pages/terms.html\" class=\"footer-link\">Terms</a>\r\n            <a href=\"${rootPrefix}pages/disclaimer.html\" class=\"footer-link\">Disclaimer</a>\r\n            <a href=\"${rootPrefix}pages/extra.html\" class=\"footer-link\">Credits</a>\r\n        </div>\r\n        <span class=\"footer-version\" id=\"footer-version\">${config.name || 'Phantom'} v${config.version || '1.0.0'}</span>\r\n    `;\r\n\r\n    document.body.appendChild(footer);\r\n\r\n\r\n\r\n    // gtm\r\n    // Inject GTM head script if not already present\r\n    if (!document.querySelector('script[src*=\"googletagmanager.com/gtm.js\"]')) {\r\n        window.dataLayer = window.dataLayer || [];\r\n        window.dataLayer.push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' });\r\n        const gtmScript = document.createElement('script');\r\n        gtmScript.async = true;\r\n        gtmScript.src = 'https://www.googletagmanager.com/gtm.js?id=GTM-5LMBC27Z';\r\n        document.head.insertBefore(gtmScript, document.head.firstChild);\r\n    }\r\n\r\n    // Add GTM noscript fallback (for pages that don't have it in HTML)\r\n    if (!document.querySelector('noscript iframe[src*=\"googletagmanager\"]')) {\r\n        const gtmNoscript = document.createElement('noscript');\r\n        gtmNoscript.innerHTML = '<iframe src=\"https://www.googletagmanager.com/ns.html?id=GTM-5LMBC27Z\" height=\"0\" width=\"0\" style=\"display:none;visibility:hidden\"></iframe>';\r\n        document.body.insertBefore(gtmNoscript, document.body.firstChild);\r\n    }\r\n\r\n    const openChangelog = (e, customTitle, customContent) => {\r\n        if (e && e.preventDefault) e.preventDefault();\r\n        const changes = customContent || config.changelog || ['No changes listed'];\r\n\r\n        // Use standard modal structure from main.css\r\n        const overlay = document.createElement('div');\r\n        overlay.className = 'modal-overlay';\r\n\r\n        overlay.innerHTML = `\r\n            <div class=\"modal\" style=\"width: 400px; max-width: 90vw;\">\r\n                <div class=\"modal-header\">\r\n                    <h3 class=\"modal-title\">${customTitle || 'What\\'s New in v' + config.version}</h3>\r\n                    <button class=\"modal-close\"><i class=\"fa-solid fa-xmark\"></i></button>\r\n                </div>\r\n                <div class=\"modal-body\">\r\n                    <ul style=\"margin: 0; padding-left: 20px; color: var(--text-muted); font-size: 0.875rem; line-height: 1.6;\">\r\n                        ${changes.map(c => '<li>' + c + '</li>').join('')}\r\n                    </ul>\r\n                </div>\r\n                <div class=\"modal-footer\">\r\n                    <a href=\"${config.discord?.inviteUrl || '#'}\" target=\"_blank\" style=\"color: #5865F2; text-decoration: none; font-size: 13px; display: inline-flex; align-items: center; gap: 6px;\">\r\n                        <i class=\"fa-brands fa-discord\"></i> Join Discord\r\n                    </a>\r\n                </div>\r\n            </div>\r\n        `;\r\n\r\n        document.body.appendChild(overlay);\r\n\r\n        // Trigger animation\r\n        requestAnimationFrame(() => overlay.classList.add('show'));\r\n\r\n        const close = () => {\r\n            overlay.classList.remove('show');\r\n            setTimeout(() => overlay.remove(), 200);\r\n        };\r\n\r\n        overlay.querySelector('.modal-close').onclick = close;\r\n        overlay.onclick = (e) => { if (e.target === overlay) close(); };\r\n    };\r\n\r\n    // Expose openChangelog globally\r\n    window.openChangelog = openChangelog;\r\n\r\n    const changelogBtn = document.getElementById('footer-changelog');\r\n    if (changelogBtn) changelogBtn.onclick = openChangelog;\r\n\r\n    const versionBtn = document.getElementById('footer-version');\r\n    if (versionBtn) versionBtn.onclick = openChangelog;\r\n\r\n    // sync\r\n    // syncRemoteChangelog removed - using local config\r\n\r\n\r\n    // Initialize Sync\r\n    // syncRemoteChangelog();\r\n\r\n    const currentVersion = config.version;\r\n    const lastVersion = settings.lastVersion;\r\n\r\n    if (settings.showChangelogOnUpdate && lastVersion && lastVersion !== currentVersion) {\r\n        setTimeout(() => {\r\n            openChangelog();\r\n            settings.lastVersion = currentVersion;\r\n            localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n        }, 1000);\r\n    } else if (!lastVersion) {\r\n        settings.lastVersion = currentVersion;\r\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n    }\r\n\r\n    // panic\r\n    if (settings.panicKey) {\r\n        document.addEventListener('keydown', (e) => {\r\n            const keys = settings.panicModifiers || ['ctrl', 'shift'];\r\n            const triggerKey = settings.panicKey.toLowerCase();\r\n            const pressedKey = e.key.toLowerCase();\r\n\r\n            // Check modifiers\r\n            const ctrlMatch = keys.includes('ctrl') === e.ctrlKey;\r\n            const shiftMatch = keys.includes('shift') === e.shiftKey;\r\n            const altMatch = keys.includes('alt') === e.altKey;\r\n\r\n            if (ctrlMatch && shiftMatch && altMatch && pressedKey === triggerKey) {\r\n                e.preventDefault();\r\n\r\n                // Show white screen instantly (if panic-overlay exists in parent)\r\n                const parentOverlay = window.parent?.document?.getElementById('panic-overlay');\r\n                if (parentOverlay) {\r\n                    parentOverlay.style.display = 'block';\r\n                } else {\r\n                    // Create overlay if it doesn't exist\r\n                    const overlay = document.createElement('div');\r\n                    overlay.id = 'panic-overlay';\r\n                    overlay.style.cssText = 'position:fixed;inset:0;background:white;z-index:99999;';\r\n                    document.body.appendChild(overlay);\r\n                }\r\n\r\n                // Redirect immediately\r\n                const url = settings.panicUrl || 'https://classroom.google.com';\r\n                try { window.top.location.href = url; } catch { window.location.href = url; }\r\n            }\r\n        }, true); // Use capture phase for faster response\r\n    }\r\n\r\n    // Cloaking logic has been moved to scripts/cloaking.js for better synchronization.\r\n    // If you need cloaking on a specific page, include that script.\r\n\r\n\r\n    window.addEventListener('beforeunload', (e) => {\r\n        // Reload settings to get latest value\r\n        try { settings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n\r\n        if (window.top === window.self && settings.leaveConfirmation) {\r\n            e.preventDefault();\r\n            e.returnValue = '';\r\n            return '';\r\n        }\r\n    });\r\n\r\n    // discord\r\n    let crateInstance = null;\r\n\r\n    function initDiscord() {\r\n        if (settings.discordWidget && config.discord && config.discord.widgetServer && config.discord.widgetChannel) {\r\n            // Check if already loaded\r\n            if (document.querySelector('script[src*=\"@widgetbot/crate\"]')) {\r\n                if (crateInstance) crateInstance.show();\r\n                return;\r\n            }\r\n\r\n            const crateScript = document.createElement('script');\r\n            crateScript.src = 'https://cdn.jsdelivr.net/npm/@widgetbot/crate@3';\r\n            crateScript.async = true;\r\n            crateScript.defer = true;\r\n            crateScript.onload = () => {\r\n                crateInstance = new Crate({\r\n                    server: config.discord.widgetServer,\r\n                    channel: config.discord.widgetChannel,\r\n                    glyph: ['https://cdn.discordapp.com/embed/avatars/0.png', '100%'],\r\n                    location: ['bottom', 'right']\r\n                });\r\n            };\r\n            document.body.appendChild(crateScript);\r\n        } else {\r\n            // Hide if disabled\r\n            if (crateInstance) crateInstance.hide();\r\n        }\r\n    }\r\n\r\n    // Initialize\r\n    initDiscord();\r\n\r\n    // Listen for settings change to toggle dynamically\r\n    window.addEventListener('storage', (e) => {\r\n        if (e.key === STORAGE_KEY) {\r\n            try { settings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n            initDiscord();\r\n        }\r\n    });\r\n\r\n    // Listen for internal event\r\n    window.addEventListener('settings-changed', (e) => {\r\n        settings = e.detail;\r\n        initDiscord();\r\n    });\r\n\r\n    // counters\r\n    // Only show on home page (index2.html) checking if main-content exists\r\n    const mainContent = document.querySelector('.main-content');\r\n    // Ensure we are on the home page view (search bar checks etc) or just check existence\r\n    if (mainContent && document.querySelector('.featured-section')) {\r\n        const counterContainer = document.createElement('div');\r\n        counterContainer.id = 'supercounters-wrapper';\r\n        counterContainer.style.marginTop = '24px';\r\n        counterContainer.style.textAlign = 'center';\r\n        counterContainer.style.opacity = '0.8';\r\n\r\n        // Use iframe to isolate document.write from the widget\r\n        const iframe = document.createElement('iframe');\r\n        iframe.style.border = 'none';\r\n        iframe.style.width = '150px';\r\n        iframe.style.height = '40px';\r\n        iframe.style.overflow = 'hidden';\r\n\r\n        // Widget code\r\n        const widgetCode = `\r\n            <html>\r\n            <body style=\"margin:0;display:flex;justify-content:center;align-items:center;background:transparent;\">\r\n                <script type=\"text/javascript\" src=\"//widget.supercounters.com/ssl/online_i.js\"><\\/script>\r\n                <script type=\"text/javascript\">sc_online_i(1726449,\"ffffff\",\"000000\");<\\/script>\r\n            </body>\r\n            </html>\r\n        `;\r\n\r\n        iframe.srcdoc = widgetCode;\r\n        counterContainer.appendChild(iframe);\r\n        mainContent.appendChild(counterContainer);\r\n    }\r\n})();\r\n\n</script>\r\n    <script>\n/**\r\n * This file dynamically loads the UGS (Unblocked Games) library from the external source.\r\n * Source: https://github.com/bubbls/ugs-singlefile/blob/main/games.js\r\n */\r\n\r\nwindow.UGS_FILES_PROMISE = (async () => {\r\n    try {\r\n        // Use JSDelivr CDN for fast and reliable access to the GitHub file\r\n        const response = await fetch('https://cdn.jsdelivr.net/gh/bubbls/ugs-singlefile@main/games.js');\r\n        if (!response.ok) throw new Error('CDN response not OK');\r\n\r\n        const text = await response.text();\r\n\r\n        // Extract the 'files' array from the source code\r\n        // The source format is: const files = [ ... ];\r\n        const match = text.match(/const files = (\\[[\\s\\S]*?\\]);/);\r\n\r\n        if (match && match[1]) {\r\n            // Evaluates the array string into a real JavaScript array\r\n            // We use eval here because we are fetching a trusted script literal\r\n            const files = eval(match[1]);\r\n            window.UGS_FILES = files;\r\n            console.log(`[UGS] Successfully loaded ${files.length} games from CDN.`);\r\n            return files;\r\n        } else {\r\n            throw new Error('Could not parse files array from source');\r\n        }\r\n    } catch (error) {\r\n        console.error('[UGS] Failed to load games from CDN:', error);\r\n        window.UGS_FILES = window.UGS_FILES || [];\r\n        return window.UGS_FILES;\r\n    }\r\n})();\r\n\n</script>\r\n    <script>\nconst ZONES_1_URL = \"https://cdn.jsdelivr.net/gh/gn-math/assets@latest/zones.json\";\r\nconst HTML_PREFIX_1 = \"https://cdn.jsdelivr.net/gh/gn-math/html@main\";\r\nconst COVER_PREFIX_1 = \"https://cdn.jsdelivr.net/gh/gn-math/covers@main\";\r\nconst UGS_PREFIX = \"https://cdn.jsdelivr.net/gh/bubbls/ugs-singlefile/UGS-Files/\";\r\n\r\nconst Gloader = {\r\n    CACHE_KEY: 'phantom_games_cache',\r\n    EXPIRY_MS: 7 * 24 * 60 * 60 * 1000, // 7 Days\r\n\r\n    async load(lib = 'multi') {\r\n        const cached = localStorage.getItem(this.CACHE_KEY);\r\n        if (cached) {\r\n            try {\r\n                const { timestamp, data } = JSON.parse(cached);\r\n                if (Date.now() - timestamp < this.EXPIRY_MS && data.length > 0) {\r\n                    return data;\r\n                }\r\n            } catch (e) {\r\n                console.warn('Cache parse failed', e);\r\n            }\r\n        }\r\n\r\n        const games = await this.fetchGames(lib);\r\n        try {\r\n            localStorage.setItem(this.CACHE_KEY, JSON.stringify({\r\n                timestamp: Date.now(),\r\n                data: games\r\n            }));\r\n        } catch (e) {\r\n            console.warn('Cache write failed (storage full?)', e);\r\n        }\r\n        return games;\r\n    },\r\n\r\n    async fetchGames(lib) {\r\n        if (lib === 'lib1' || lib === 'gnmath') return this.loadGnmath();\r\n        if (lib === 'lib2' || lib === 'ugs') return this.loadUGS();\r\n\r\n        const [g, u] = await Promise.all([this.loadGnmath(), this.loadUGS()]);\r\n        return [...g, ...u];\r\n    },\r\n\r\n    async loadGnmath() {\r\n        try {\r\n            const res = await fetch(ZONES_1_URL);\r\n            const data = await res.json();\r\n            return data.map(g => ({\r\n                name: this.formatName((g.name || g.title).replace('-a.html', '')),\r\n                url: (g.url || g.file)?.replace('{HTML_URL}', HTML_PREFIX_1).replace('-a.html', '.html'),\r\n                img: (g.cover || g.img || g.image)?.replace('{COVER_URL}', COVER_PREFIX_1),\r\n                type: 'gnmath',\r\n                normalized: this.normalize(g.name || g.title)\r\n            }));\r\n        } catch (e) {\r\n            console.error('Gnmath load failed', e);\r\n            return [];\r\n        }\r\n    },\r\n\r\n    async loadUGS() {\r\n        if (!window.UGS_FILES && window.UGS_FILES_PROMISE) {\r\n            await window.UGS_FILES_PROMISE;\r\n        }\r\n        if (!window.UGS_FILES) return [];\r\n        return window.UGS_FILES.map(file => {\r\n            const name = file.replace(/^cl/i, '');\r\n            return {\r\n                name: this.formatName(name),\r\n                url: `${UGS_PREFIX}${encodeURIComponent(file.includes('.') ? file : file + '.html')}`,\r\n                type: 'ugs',\r\n                normalized: this.normalize(name)\r\n            };\r\n        });\r\n    },\r\n\r\n    formatName(name) {\r\n        return name ? name.replace(/\\.html$/i, '')\r\n            .replace(/[-_]/g, ' ')\r\n            .replace(/([a-z])([A-Z])/g, '$1 $2')\r\n            .replace(/\\(\\d+\\)$/, '')\r\n            .replace(/\\b\\w/g, l => l.toUpperCase())\r\n            .trim() : '';\r\n    },\r\n\r\n    normalize(name) {\r\n        return name ? name.toLowerCase().replace(/[^a-z0-9]/g, '').trim() : '';\r\n    }\r\n};\r\n\r\nwindow.Gloader = Gloader;\r\n\n</script>\r\n    <script>\nconst Games = {\r\n    lib: 'multi',\r\n    allGames: [],\r\n    filteredGames: [],\r\n    renderedCount: 0,\r\n    BATCH_SIZE: 50,\r\n    liked: JSON.parse(localStorage.getItem('liked_games') || '[]'),\r\n    isLoading: false,\r\n    firstLoad: true,\r\n\r\n    async init() {\r\n        this.lib = window.Settings?.get('gameLibrary') || 'multi';\r\n        // legacy\r\n        if (this.lib === 'lib1') this.lib = 'gnmath';\r\n        if (this.lib === 'lib2') this.lib = 'ugs';\r\n\r\n        window.addEventListener('scroll', () => {\r\n            if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight - 500) {\r\n                this.renderMore();\r\n            }\r\n        });\r\n\r\n        await this.loadGames();\r\n        this.checkRedirect(); //  ?gamename=\r\n        this.setupListeners();\r\n    },\r\n\r\n    async loadGames() {\r\n        if (this.isLoading) return;\r\n        this.isLoading = true;\r\n\r\n        if (this.firstLoad && window.Notify) {\r\n            window.Notify.info('Games', 'Loading game library...');\r\n        }\r\n\r\n        try {\r\n            if (!window.Gloader) {\r\n                console.error('Gloader missing');\r\n                return;\r\n            }\r\n            // Use centralized loader\r\n            this.allGames = await window.Gloader.load(this.lib);\r\n            this.filteredGames = [...this.allGames];\r\n            this.resetRender();\r\n\r\n            if (window.Notify) window.Notify.success('Games', `${this.allGames.length} games loaded`);\r\n        } catch (e) {\r\n            console.error(e);\r\n            if (window.Notify) window.Notify.error('Error', 'Failed to load games');\r\n        } finally {\r\n            this.isLoading = false;\r\n            this.firstLoad = false;\r\n        }\r\n    },\r\n\r\n    checkRedirect() {\r\n        const params = new URLSearchParams(window.location.search);\r\n        const target = params.get('gamename');\r\n        if (!target) return;\r\n\r\n        const targetNormalized = target.toLowerCase().replace(/[^a-z0-9]/g, '');\r\n        const game = this.allGames.find(g =>\r\n            (g.normalized && g.normalized === targetNormalized) ||\r\n            g.name.toLowerCase().replace(/[^a-z0-9]/g, '') === targetNormalized\r\n        );\r\n\r\n        if (game) {\r\n            console.log('Redirecting to game:', game.name);\r\n            this.openGame(game);\r\n        } else {\r\n            console.warn('Game not found for redirect:', target);\r\n        }\r\n    },\r\n\r\n    sort(method) {\r\n        if (method === 'name') {\r\n            this.filteredGames.sort((a, b) => a.name.localeCompare(b.name));\r\n        } else if (method === 'newest') {\r\n            this.filteredGames.reverse();\r\n        } else {\r\n            // Default order preservation if possible, or just index based\r\n            // Since we don't have original index easily, we might rely on load order\r\n        }\r\n        this.resetRender();\r\n    },\r\n\r\n    resetRender() {\r\n        const grid = document.getElementById('games-grid');\r\n        if (!grid) return;\r\n        grid.innerHTML = '';\r\n        this.renderedCount = 0;\r\n        this.updateLikedSection();\r\n        const countDisplay = document.getElementById('game-count');\r\n        if (countDisplay) countDisplay.innerText = `${this.filteredGames.length} Games`;\r\n        this.renderMore();\r\n    },\r\n\r\n    renderMore() {\r\n        if (this.renderedCount >= this.filteredGames.length) return;\r\n        const grid = document.getElementById('games-grid');\r\n        const batch = this.filteredGames.slice(this.renderedCount, this.renderedCount + this.BATCH_SIZE);\r\n        batch.forEach(game => grid.appendChild(this.createCard(game)));\r\n        this.renderedCount += batch.length;\r\n    },\r\n\r\n    createCard(game) {\r\n        const div = document.createElement('div');\r\n        div.className = 'game-card';\r\n        const isLiked = this.isLiked(game);\r\n        const imgHTML = game.img ?\r\n            `<img src=\"${game.img}\" loading=\"lazy\" alt=\"${game.name}\" onerror=\"this.parentElement.innerHTML='<div class=\\\\'game-placeholder\\\\'><i class=\\\\'fa-solid fa-gamepad\\\\'></i></div>'\">` :\r\n            `<div class=\"game-placeholder\"><i class=\"fa-solid fa-gamepad\"></i></div>`;\r\n\r\n        div.innerHTML = `\r\n            <div class=\"game-img-wrapper\">\r\n                ${imgHTML}\r\n                <button class=\"like-btn ${isLiked ? 'active' : ''}\"><i class=\"fa-solid fa-heart\"></i></button>\r\n            </div>\r\n            <div class=\"game-info\"><div class=\"game-title\">${game.name}</div></div>\r\n        `;\r\n\r\n        const open = () => this.openGame(game);\r\n        div.querySelector('.game-img-wrapper').onclick = open;\r\n        div.querySelector('.game-info').onclick = open;\r\n\r\n        const likeBtn = div.querySelector('.like-btn');\r\n        likeBtn.onclick = (e) => {\r\n            e.stopPropagation();\r\n            this.toggleLike(game);\r\n            likeBtn.classList.toggle('active', this.isLiked(game));\r\n            this.updateLikedSection();\r\n        };\r\n        return div;\r\n    },\r\n\r\n    updateLikedSection() {\r\n        const likedGrid = document.getElementById('liked-grid');\r\n        const likedSection = document.getElementById('liked-section');\r\n        if (!likedGrid) return;\r\n        const likedGames = this.allGames.filter(g => this.isLiked(g));\r\n        likedGrid.innerHTML = '';\r\n        if (likedGames.length > 0) {\r\n            likedSection.style.display = 'block';\r\n            likedGames.forEach(g => likedGrid.appendChild(this.createCard(g)));\r\n        } else {\r\n            likedSection.style.display = 'none';\r\n        }\r\n    },\r\n\r\n    openGame(game) {\r\n        window.location.href = `player.html?type=game&title=${encodeURIComponent(game.name)}&url=${encodeURIComponent(game.url)}`;\r\n    },\r\n\r\n    isLiked(game) { return this.liked.some(g => g.name === game.name); },\r\n\r\n    toggleLike(game) {\r\n        if (this.isLiked(game)) {\r\n            this.liked = this.liked.filter(g => g.name !== game.name);\r\n        } else {\r\n            this.liked.push({ name: game.name, url: game.url, img: game.img, type: game.type });\r\n        }\r\n        localStorage.setItem('liked_games', JSON.stringify(this.liked));\r\n    },\r\n\r\n    setupListeners() {\r\n        const searchInput = document.getElementById('search-input');\r\n        if (searchInput) {\r\n            let timer;\r\n            searchInput.oninput = (e) => {\r\n                clearTimeout(timer);\r\n                timer = setTimeout(() => this.performSearch(e.target.value.toLowerCase().trim()), 300);\r\n            };\r\n        }\r\n        const libSelect = document.getElementById('lib-select');\r\n        if (libSelect) {\r\n            libSelect.value = this.lib;\r\n            libSelect.onchange = (e) => {\r\n                const newLib = e.target.value;\r\n                if (newLib === this.lib) return;\r\n\r\n                // Just set the setting; the 'settings-changed' listener below handles the loadGames call\r\n                window.Settings?.set('gameLibrary', newLib);\r\n            };\r\n        }\r\n        window.addEventListener('settings-changed', (e) => {\r\n            if (e.detail.gameLibrary && e.detail.gameLibrary !== this.lib) {\r\n                this.lib = e.detail.gameLibrary;\r\n                if (libSelect) libSelect.value = this.lib;\r\n                this.loadGames();\r\n            }\r\n        });\r\n        const sortSelect = document.getElementById('sort-select');\r\n        if (sortSelect) sortSelect.onchange = (e) => this.sort(e.target.value);\r\n    },\r\n\r\n    performSearch(term) {\r\n        this.filteredGames = term ? this.allGames.filter(g => g.name.toLowerCase().includes(term)) : [...this.allGames];\r\n        this.resetRender();\r\n    }\r\n};\r\n\r\ndocument.addEventListener('DOMContentLoaded', () => Games.init());\r\n\n</script>\r\n    <script>\r\n\r\n\r\n    </script>\r\n</body>\r\n\r\n</html>","pages/movies.html":"<!DOCTYPE html>\r\n<html lang=\"en\">\r\n\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n    <title>Movies - Phantom</title>\r\n    <link rel=\"icon\" href=\"../favicon.svg\" type=\"image/svg+xml\">\r\n    <meta name=\"referrer\" content=\"origin\">\r\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css\">\r\n    <style>\n/* phantom styling */\r\n\r\n@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');\r\n\r\n/* variables */\r\n:root {\r\n    /* Core colors (can be overridden by user settings) */\r\n    --bg: #0a0a0a;\r\n    --surface: #0f0f0f;\r\n    --surface-hover: #1a1a1a;\r\n    --surface-active: #252525;\r\n    --border: #1f1f1f;\r\n    --border-light: #2a2a2a;\r\n\r\n    /* Text */\r\n    --text: #e4e4e7;\r\n    --text-muted: #71717a;\r\n    --text-dim: #52525b;\r\n\r\n    /* Accent (customizable) */\r\n    --accent: #ffffff;\r\n    --accent-dim: rgba(255, 255, 255, 0.8);\r\n    --accent-glow: rgba(255, 255, 255, 0.1);\r\n\r\n    /* Status colors */\r\n    --success: #22c55e;\r\n    --warning: #f59e0b;\r\n    --error: #ef4444;\r\n    --info: #3b82f6;\r\n\r\n    /* Shadows */\r\n    --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.3);\r\n    --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.4);\r\n    --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.5);\r\n    --shadow-xl: 0 16px 48px rgba(0, 0, 0, 0.6);\r\n\r\n    /* Spacing */\r\n    --space-xs: 4px;\r\n    --space-sm: 8px;\r\n    --space-md: 16px;\r\n    --space-lg: 24px;\r\n    --space-xl: 32px;\r\n    --space-2xl: 48px;\r\n\r\n    /* Border radius */\r\n    --radius-sm: 4px;\r\n    --radius-md: 8px;\r\n    --radius-lg: 12px;\r\n    --radius-xl: 16px;\r\n    --radius-full: 9999px;\r\n\r\n    /* Transitions */\r\n    --transition-fast: 0.1s ease;\r\n    --transition-normal: 0.2s ease;\r\n    --transition-slow: 0.3s ease;\r\n\r\n    /* Z-index layers */\r\n    --z-base: 1;\r\n    --z-dropdown: 100;\r\n    --z-sticky: 500;\r\n    --z-modal: 1000;\r\n    --z-toast: 2000;\r\n    --z-max: 9999;\r\n\r\n    /* Typography */\r\n    --font-sans: 'Inter', system-ui, -apple-system, sans-serif;\r\n    --font-mono: 'JetBrains Mono', 'Fira Code', monospace;\r\n\r\n    /* Background (customizable) */\r\n    --bg-image: none;\r\n}\r\n\r\n/* base */\r\n*,\r\n*::before,\r\n*::after {\r\n    box-sizing: border-box;\r\n    margin: 0;\r\n    padding: 0;\r\n}\r\n\r\nhtml {\r\n    font-size: 16px;\r\n    scroll-behavior: smooth;\r\n    -webkit-font-smoothing: antialiased;\r\n    -moz-osx-font-smoothing: grayscale;\r\n}\r\n\r\nbody {\r\n    font-family: var(--font-sans);\r\n    background: var(--bg);\r\n    background-image: var(--bg-image);\r\n    background-size: cover;\r\n    background-position: var(--bg-image-position, center);\r\n    background-attachment: fixed;\r\n    color: var(--text);\r\n    line-height: 1.5;\r\n    min-height: 100vh;\r\n    overflow-x: hidden;\r\n}\r\n\r\n/* Ensure background manager takes precedence */\r\nhtml.phantom-bg-active body {\r\n    background: transparent !important;\r\n    background-image: none !important;\r\n}\r\n\r\n/* Selection */\r\n::selection {\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n}\r\n\r\n/* Focus states */\r\n:focus-visible {\r\n    outline: 2px solid var(--accent);\r\n    outline-offset: 2px;\r\n}\r\n\r\n/* Links */\r\na {\r\n    color: var(--accent);\r\n    text-decoration: none;\r\n    transition: opacity var(--transition-fast);\r\n}\r\n\r\na:hover {\r\n    opacity: 0.8;\r\n}\r\n\r\n/* Scrollbar */\r\n::-webkit-scrollbar {\r\n    width: 8px;\r\n    height: 8px;\r\n}\r\n\r\n::-webkit-scrollbar-track {\r\n    background: var(--surface);\r\n}\r\n\r\n::-webkit-scrollbar-thumb {\r\n    background: var(--border-light);\r\n    border-radius: var(--radius-full);\r\n}\r\n\r\n::-webkit-scrollbar-thumb:hover {\r\n    background: var(--text-muted);\r\n}\r\n\r\n/* text */\r\nh1,\r\nh2,\r\nh3,\r\nh4,\r\nh5,\r\nh6 {\r\n    font-weight: 600;\r\n    line-height: 1.2;\r\n    color: var(--text);\r\n}\r\n\r\nh1 {\r\n    font-size: 2.5rem;\r\n}\r\n\r\nh2 {\r\n    font-size: 2rem;\r\n}\r\n\r\nh3 {\r\n    font-size: 1.5rem;\r\n}\r\n\r\nh4 {\r\n    font-size: 1.25rem;\r\n}\r\n\r\nh5 {\r\n    font-size: 1rem;\r\n}\r\n\r\nh6 {\r\n    font-size: 0.875rem;\r\n}\r\n\r\np {\r\n    color: var(--text-muted);\r\n    line-height: 1.6;\r\n}\r\n\r\n.text-sm {\r\n    font-size: 0.875rem;\r\n}\r\n\r\n.text-xs {\r\n    font-size: 0.75rem;\r\n}\r\n\r\n.text-lg {\r\n    font-size: 1.125rem;\r\n}\r\n\r\n.text-muted {\r\n    color: var(--text-muted);\r\n}\r\n\r\n.text-dim {\r\n    color: var(--text-dim);\r\n}\r\n\r\n.text-center {\r\n    text-align: center;\r\n}\r\n\r\n/* buttons */\r\n.btn {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    gap: var(--space-sm);\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-family: var(--font-sans);\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-md);\r\n    background: var(--surface);\r\n    color: var(--text);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n    white-space: nowrap;\r\n}\r\n\r\n.btn:hover {\r\n    background: var(--surface-hover);\r\n    border-color: var(--border-light);\r\n}\r\n\r\n.btn:active {\r\n    background: var(--surface-active);\r\n    transform: scale(0.98);\r\n}\r\n\r\n.btn-primary {\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n    border-color: var(--accent);\r\n}\r\n\r\n.btn-primary:hover {\r\n    opacity: 0.9;\r\n    background: var(--accent);\r\n}\r\n\r\n.btn-ghost {\r\n    background: transparent;\r\n    border-color: transparent;\r\n}\r\n\r\n.btn-ghost:hover {\r\n    background: var(--surface-hover);\r\n}\r\n\r\n.btn-icon {\r\n    width: 36px;\r\n    height: 36px;\r\n    padding: 0;\r\n    border-radius: var(--radius-md);\r\n}\r\n\r\n.btn-sm {\r\n    padding: var(--space-xs) var(--space-sm);\r\n    font-size: 0.75rem;\r\n}\r\n\r\n.btn-lg {\r\n    padding: var(--space-md) var(--space-lg);\r\n    font-size: 1rem;\r\n}\r\n\r\n/* inputs */\r\n.input {\r\n    width: 100%;\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-family: var(--font-sans);\r\n    font-size: 0.875rem;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-md);\r\n    color: var(--text);\r\n    transition: border-color var(--transition-fast);\r\n}\r\n\r\n.input:hover {\r\n    border-color: var(--border-light);\r\n}\r\n\r\n.input:focus {\r\n    outline: none;\r\n    border-color: var(--accent);\r\n}\r\n\r\n.input::placeholder {\r\n    color: var(--text-dim);\r\n}\r\n\r\n.input-group {\r\n    display: flex;\r\n    gap: var(--space-sm);\r\n}\r\n\r\n.input-group .input {\r\n    flex: 1;\r\n}\r\n\r\n/* Select */\r\n.select {\r\n    appearance: none;\r\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%2371717a' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E\");\r\n    background-repeat: no-repeat;\r\n    background-position: right 12px center;\r\n    padding-right: 36px;\r\n    cursor: pointer;\r\n}\r\n\r\n/* Checkbox/Toggle */\r\n.toggle {\r\n    position: relative;\r\n    width: 44px;\r\n    height: 24px;\r\n    background: var(--border);\r\n    border-radius: var(--radius-full);\r\n    cursor: pointer;\r\n    transition: background var(--transition-fast);\r\n}\r\n\r\n.toggle::after {\r\n    content: '';\r\n    position: absolute;\r\n    top: 2px;\r\n    left: 2px;\r\n    width: 20px;\r\n    height: 20px;\r\n    background: var(--text);\r\n    border-radius: 50%;\r\n    transition: transform var(--transition-fast);\r\n}\r\n\r\n.toggle.active {\r\n    background: var(--accent);\r\n}\r\n\r\n.toggle.active::after {\r\n    transform: translateX(20px);\r\n    background: var(--bg);\r\n}\r\n\r\n/* cards */\r\n.card {\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-lg);\r\n    overflow: hidden;\r\n    transition: all var(--transition-normal);\r\n}\r\n\r\n.card:hover {\r\n    border-color: var(--border-light);\r\n    box-shadow: var(--shadow-md);\r\n}\r\n\r\n.card-header {\r\n    padding: var(--space-md);\r\n    border-bottom: 1px solid var(--border);\r\n}\r\n\r\n.card-body {\r\n    padding: var(--space-md);\r\n}\r\n\r\n.card-footer {\r\n    padding: var(--space-md);\r\n    border-top: 1px solid var(--border);\r\n}\r\n\r\n\r\n/* Featured badge */\r\n.badge-featured {\r\n    position: absolute;\r\n    top: var(--space-sm);\r\n    left: var(--space-sm);\r\n    padding: var(--space-xs) var(--space-sm);\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n    font-size: 0.625rem;\r\n    font-weight: 700;\r\n    text-transform: uppercase;\r\n    letter-spacing: 0.05em;\r\n    border-radius: var(--radius-sm);\r\n}\r\n\r\n/* Favorite star */\r\n.favorite-btn {\r\n    position: absolute;\r\n    top: var(--space-sm);\r\n    right: var(--space-sm);\r\n    width: 32px;\r\n    height: 32px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background: rgba(0, 0, 0, 0.5);\r\n    border: none;\r\n    border-radius: 50%;\r\n    color: var(--text-muted);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n    opacity: 0;\r\n}\r\n\r\n.media-card:hover .favorite-btn {\r\n    opacity: 1;\r\n}\r\n\r\n.favorite-btn:hover {\r\n    background: rgba(0, 0, 0, 0.7);\r\n    color: var(--text);\r\n}\r\n\r\n.favorite-btn.active {\r\n    color: #fbbf24;\r\n    opacity: 1;\r\n}\r\n\r\n/* grid */\r\n.grid {\r\n    display: grid;\r\n    gap: var(--space-md);\r\n}\r\n\r\n.grid-cols-2 {\r\n    grid-template-columns: repeat(2, 1fr);\r\n}\r\n\r\n.grid-cols-3 {\r\n    grid-template-columns: repeat(3, 1fr);\r\n}\r\n\r\n.grid-cols-4 {\r\n    grid-template-columns: repeat(4, 1fr);\r\n}\r\n\r\n.grid-cols-5 {\r\n    grid-template-columns: repeat(5, 1fr);\r\n}\r\n\r\n.grid-cols-6 {\r\n    grid-template-columns: repeat(6, 1fr);\r\n}\r\n\r\n/* Auto-fit grid for responsive cards */\r\n.grid-auto {\r\n    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));\r\n}\r\n\r\n.grid-auto-lg {\r\n    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\r\n}\r\n\r\n/* flex */\r\n.flex {\r\n    display: flex;\r\n}\r\n\r\n.flex-col {\r\n    flex-direction: column;\r\n}\r\n\r\n.flex-wrap {\r\n    flex-wrap: wrap;\r\n}\r\n\r\n.items-center {\r\n    align-items: center;\r\n}\r\n\r\n.items-start {\r\n    align-items: flex-start;\r\n}\r\n\r\n.items-end {\r\n    align-items: flex-end;\r\n}\r\n\r\n.justify-center {\r\n    justify-content: center;\r\n}\r\n\r\n.justify-between {\r\n    justify-content: space-between;\r\n}\r\n\r\n.justify-end {\r\n    justify-content: flex-end;\r\n}\r\n\r\n.gap-xs {\r\n    gap: var(--space-xs);\r\n}\r\n\r\n.gap-sm {\r\n    gap: var(--space-sm);\r\n}\r\n\r\n.gap-md {\r\n    gap: var(--space-md);\r\n}\r\n\r\n.gap-lg {\r\n    gap: var(--space-lg);\r\n}\r\n\r\n.flex-1 {\r\n    flex: 1;\r\n}\r\n\r\n/* spacing */\r\n.p-xs {\r\n    padding: var(--space-xs);\r\n}\r\n\r\n.p-sm {\r\n    padding: var(--space-sm);\r\n}\r\n\r\n.p-md {\r\n    padding: var(--space-md);\r\n}\r\n\r\n.p-lg {\r\n    padding: var(--space-lg);\r\n}\r\n\r\n.p-xl {\r\n    padding: var(--space-xl);\r\n}\r\n\r\n.m-xs {\r\n    margin: var(--space-xs);\r\n}\r\n\r\n.m-sm {\r\n    margin: var(--space-sm);\r\n}\r\n\r\n.m-md {\r\n    margin: var(--space-md);\r\n}\r\n\r\n.m-lg {\r\n    margin: var(--space-lg);\r\n}\r\n\r\n.mt-sm {\r\n    margin-top: var(--space-sm);\r\n}\r\n\r\n.mt-md {\r\n    margin-top: var(--space-md);\r\n}\r\n\r\n.mt-lg {\r\n    margin-top: var(--space-lg);\r\n}\r\n\r\n.mb-sm {\r\n    margin-bottom: var(--space-sm);\r\n}\r\n\r\n.mb-md {\r\n    margin-bottom: var(--space-md);\r\n}\r\n\r\n.mb-lg {\r\n    margin-bottom: var(--space-lg);\r\n}\r\n\r\n/* modals */\r\n.modal-overlay {\r\n    position: fixed;\r\n    inset: 0;\r\n    background: rgba(0, 0, 0, 0.8);\r\n    backdrop-filter: blur(4px);\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    z-index: var(--z-modal);\r\n    opacity: 0;\r\n    visibility: hidden;\r\n    transition: all var(--transition-normal);\r\n}\r\n\r\n.modal-overlay.show {\r\n    opacity: 1;\r\n    visibility: visible;\r\n}\r\n\r\n.modal {\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-xl);\r\n    max-width: 90vw;\r\n    max-height: 90vh;\r\n    overflow: hidden;\r\n    transform: scale(0.95);\r\n    transition: transform var(--transition-normal);\r\n}\r\n\r\n.modal-overlay.show .modal {\r\n    transform: scale(1);\r\n}\r\n\r\n.modal-header {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    padding: var(--space-md);\r\n    border-bottom: 1px solid var(--border);\r\n}\r\n\r\n.modal-title {\r\n    font-size: 1rem;\r\n    font-weight: 600;\r\n}\r\n\r\n.modal-close {\r\n    width: 32px;\r\n    height: 32px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background: transparent;\r\n    border: none;\r\n    color: var(--text-muted);\r\n    cursor: pointer;\r\n    border-radius: var(--radius-md);\r\n    transition: all var(--transition-fast);\r\n}\r\n\r\n.modal-close:hover {\r\n    background: var(--surface-hover);\r\n    color: var(--text);\r\n}\r\n\r\n.modal-body {\r\n    padding: var(--space-md);\r\n    overflow-y: auto;\r\n}\r\n\r\n.modal-footer {\r\n    display: flex;\r\n    justify-content: flex-end;\r\n    gap: var(--space-sm);\r\n    padding: var(--space-md);\r\n    border-top: 1px solid var(--border);\r\n}\r\n\r\n/* tabs */\r\n.tabs {\r\n    display: flex;\r\n    gap: 2px;\r\n    background: var(--surface);\r\n    padding: var(--space-xs);\r\n    border-radius: var(--radius-md);\r\n    border: 1px solid var(--border);\r\n}\r\n\r\n.tab {\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    color: var(--text-muted);\r\n    background: transparent;\r\n    border: none;\r\n    border-radius: var(--radius-sm);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n}\r\n\r\n.tab:hover {\r\n    color: var(--text);\r\n}\r\n\r\n.tab.active {\r\n    background: var(--surface-hover);\r\n    color: var(--text);\r\n}\r\n\r\n/* search */\r\n\r\n/* ============================================\r\n   OFFLINE INDICATOR\r\n   ============================================ */\r\n.offline-banner {\r\n    position: fixed;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    padding: var(--space-sm) var(--space-md);\r\n    background: var(--warning);\r\n    color: var(--bg);\r\n    text-align: center;\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    z-index: var(--z-toast);\r\n    transform: translateY(-100%);\r\n    transition: transform var(--transition-normal);\r\n}\r\n\r\n.offline-banner.show {\r\n    transform: translateY(0);\r\n}\r\n\r\n.offline-badge {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    gap: var(--space-xs);\r\n    padding: var(--space-xs) var(--space-sm);\r\n    background: var(--warning);\r\n    color: var(--bg);\r\n    font-size: 0.625rem;\r\n    font-weight: 600;\r\n    text-transform: uppercase;\r\n    border-radius: var(--radius-sm);\r\n}\r\n\r\n/* ============================================\r\n   LOADING STATES\r\n   ============================================ */\r\n.skeleton {\r\n    background: linear-gradient(90deg, var(--surface) 0%, var(--surface-hover) 50%, var(--surface) 100%);\r\n    background-size: 200% 100%;\r\n    animation: shimmer 1.5s infinite;\r\n    border-radius: var(--radius-md);\r\n}\r\n\r\n@keyframes shimmer {\r\n    0% {\r\n        background-position: 200% 0;\r\n    }\r\n\r\n    100% {\r\n        background-position: -200% 0;\r\n    }\r\n}\r\n\r\n.spinner {\r\n    width: 24px;\r\n    height: 24px;\r\n    border: 2px solid var(--border);\r\n    border-top-color: var(--accent);\r\n    border-radius: 50%;\r\n    animation: spin 0.8s linear infinite;\r\n}\r\n\r\n@keyframes spin {\r\n    to {\r\n        transform: rotate(360deg);\r\n    }\r\n}\r\n\r\n/* ============================================\r\n   ANIMATIONS\r\n   ============================================ */\r\n@keyframes fadeIn {\r\n    from {\r\n        opacity: 0;\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n    }\r\n}\r\n\r\n@keyframes slideUp {\r\n    from {\r\n        opacity: 0;\r\n        transform: translateY(10px);\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n        transform: translateY(0);\r\n    }\r\n}\r\n\r\n@keyframes scaleIn {\r\n    from {\r\n        opacity: 0;\r\n        transform: scale(0.95);\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n        transform: scale(1);\r\n    }\r\n}\r\n\r\n.animate-fadeIn {\r\n    animation: fadeIn var(--transition-normal) ease;\r\n}\r\n\r\n.animate-slideUp {\r\n    animation: slideUp var(--transition-normal) ease;\r\n}\r\n\r\n.animate-scaleIn {\r\n    animation: scaleIn var(--transition-normal) ease;\r\n}\r\n\r\n/* ============================================\r\n   UTILITIES\r\n   ============================================ */\r\n.hidden {\r\n    display: none !important;\r\n}\r\n\r\n.sr-only {\r\n    position: absolute;\r\n    width: 1px;\r\n    height: 1px;\r\n    padding: 0;\r\n    margin: -1px;\r\n    overflow: hidden;\r\n    clip: rect(0, 0, 0, 0);\r\n    border: 0;\r\n}\r\n\r\n.truncate {\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n}\r\n\r\n.w-full {\r\n    width: 100%;\r\n}\r\n\r\n.h-full {\r\n    height: 100%;\r\n}\r\n\r\n.relative {\r\n    position: relative;\r\n}\r\n\r\n.absolute {\r\n    position: absolute;\r\n}\r\n\r\n.fixed {\r\n    position: fixed;\r\n}\r\n\r\n.inset-0 {\r\n    inset: 0;\r\n}\r\n\r\n/* ============================================\r\n   RESPONSIVE\r\n   ============================================ */\r\n@media (max-width: 768px) {\r\n    h1 {\r\n        font-size: 1.75rem;\r\n    }\r\n\r\n    h2 {\r\n        font-size: 1.5rem;\r\n    }\r\n\r\n    h3 {\r\n        font-size: 1.25rem;\r\n    }\r\n\r\n    .grid-auto {\r\n        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));\r\n    }\r\n\r\n    .hide-mobile {\r\n        display: none !important;\r\n    }\r\n}\r\n\r\n@media (min-width: 769px) {\r\n    .hide-desktop {\r\n        display: none !important;\r\n    }\r\n}\n</style>\r\n    <style>\n/* Topbar Styles - Clean & Dark */\r\n/* Note: Inter font is imported in main.css */\r\n\r\nbody {\r\n    margin: 0;\r\n    padding: 0;\r\n    background-color: var(--bg);\r\n    font-family: 'Inter', sans-serif;\r\n}\r\n\r\n#topbar-container {\r\n    position: fixed;\r\n    top: 11px;\r\n    left: 50%;\r\n    transform: translateX(-50%);\r\n    background-color: var(--surface);\r\n    border-radius: 9999px;\r\n    padding: 8px 14px;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 10px;\r\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);\r\n    z-index: 10000;\r\n    border: 1px solid var(--border);\r\n    height: 48px;\r\n    box-sizing: border-box;\r\n}\r\n\r\n#topbar-container::before {\r\n    content: '';\r\n    position: absolute;\r\n    top: -7px;\r\n    bottom: -7px;\r\n    left: -7px;\r\n    right: -7px;\r\n    z-index: -1;\r\n    border-radius: 9999px;\r\n}\r\n\r\n.logo-section {\r\n    display: flex;\r\n    align-items: center;\r\n    padding-right: 10px;\r\n    border-right: 1px solid var(--border);\r\n    height: 32px;\r\n    text-decoration: none;\r\n    color: inherit;\r\n}\r\n\r\n.logo-placeholder {\r\n    width: 28px;\r\n    height: 28px;\r\n    background-color: var(--surface-hover);\r\n    border-radius: 6px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    color: var(--text-muted);\r\n}\r\n\r\n.logo-placeholder i,\r\n.logo-placeholder svg {\r\n    width: 16px;\r\n    height: 16px;\r\n}\r\n\r\n.nav-buttons {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 4px;\r\n}\r\n\r\n.nav-separator {\r\n    width: 1px;\r\n    height: 20px;\r\n    background-color: var(--border);\r\n    margin: 0 6px;\r\n}\r\n\r\n.nav-btn {\r\n    background: transparent;\r\n    border: none;\r\n    color: var(--text-muted);\r\n    text-decoration: none;\r\n    display: flex;\r\n    align-items: center;\r\n    padding: 6px 10px;\r\n    border-radius: 99px;\r\n    height: 32px;\r\n    box-sizing: border-box;\r\n    transition: color 0.15s, background-color 0.15s;\r\n    position: relative;\r\n}\r\n\r\n.nav-badge-beta {\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n    font-size: 8px;\r\n    font-weight: 700;\r\n    color: var(--text);\r\n    background: var(--secondary);\r\n    padding: 2px 4px;\r\n    border-radius: 4px;\r\n    line-height: 1;\r\n    transform: translate(20%, -20%);\r\n    pointer-events: none;\r\n}\r\n\r\n.nav-btn:hover {\r\n    color: var(--text);\r\n    background-color: var(--surface-hover);\r\n}\r\n\r\n.nav-btn i,\r\n.nav-btn svg {\r\n    width: 18px;\r\n    height: 18px;\r\n    min-width: 18px;\r\n}\r\n\r\n.nav-btn span {\r\n    max-width: 0;\r\n    opacity: 0;\r\n    margin-left: 0;\r\n    overflow: hidden;\r\n    white-space: nowrap;\r\n    font-weight: 500;\r\n    font-size: 13px;\r\n    transition: max-width 0.23s ease, opacity 0.17s ease, margin-left 0.23s ease;\r\n}\r\n\r\n#topbar-container:hover .nav-btn span {\r\n    max-width: 70px;\r\n    opacity: 1;\r\n    margin-left: 8px;\r\n}\n</style>\r\n    <style>\n/* Page Layout - Shared styles for games, movies, and similar pages */\r\n\r\n.page-header {\r\n    text-align: center;\r\n    margin-bottom: 24px;\r\n}\r\n\r\n.page-title {\r\n    font-size: 1.5rem;\r\n    font-weight: 700;\r\n    margin-bottom: 4px;\r\n}\r\n\r\n.page-subtitle {\r\n    color: var(--text-muted);\r\n    font-size: 0.875rem;\r\n    min-height: 1.25em;\r\n}\r\n\r\n/* Controls bar - search + filters */\r\n.controls {\r\n    display: flex;\r\n    gap: 10px;\r\n    justify-content: center;\r\n    flex-wrap: wrap;\r\n    margin-bottom: 24px;\r\n    max-width: 800px;\r\n    margin-left: auto;\r\n    margin-right: auto;\r\n}\r\n\r\n/* Shared search box */\r\n.search-box {\r\n    flex: 1;\r\n    min-width: 300px;\r\n    max-width: 100%;\r\n    width: 100%;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: 9999px;\r\n    padding: 12px 20px;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 12px;\r\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);\r\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\r\n    position: relative;\r\n}\r\n\r\n.search-box i {\r\n    color: var(--text-muted);\r\n    font-size: 14px;\r\n}\r\n\r\n.search-box input {\r\n    flex: 1;\r\n    background: transparent;\r\n    border: none;\r\n    outline: none;\r\n    color: var(--text);\r\n    font-size: 0.9375rem;\r\n}\r\n\r\n.search-box input::placeholder {\r\n    color: var(--text-muted);\r\n}\r\n\r\n/* Control Buttons (restored) */\r\n.ctrl-btn {\r\n    padding: 10px 16px;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: 9999px;\r\n    color: var(--text);\r\n    font-size: 0.8125rem;\r\n    font-weight: 500;\r\n    cursor: pointer;\r\n    transition: all 0.15s;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 8px;\r\n}\r\n\r\n.ctrl-btn:hover {\r\n    background: var(--surface-hover);\r\n    border-color: var(--text);\r\n}\r\n\r\n/* Select wrapper with custom dropdown arrow */\r\n.select-wrapper {\r\n    position: relative;\r\n}\r\n\r\n.select-wrapper select {\r\n    appearance: none;\r\n    padding: 10px 32px 10px 16px;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: 9999px;\r\n    color: var(--text);\r\n    font-size: 0.8125rem;\r\n    font-weight: 500;\r\n    cursor: pointer;\r\n    outline: none;\r\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\r\n}\r\n\r\n.select-wrapper::after {\r\n    content: '\\f078';\r\n    font-family: 'Font Awesome 6 Free';\r\n    font-weight: 900;\r\n    position: absolute;\r\n    right: 12px;\r\n    top: 50%;\r\n    transform: translateY(-50%);\r\n    font-size: 0.75rem;\r\n    color: var(--text-muted);\r\n    pointer-events: none;\r\n}\n</style>\r\n    <style>\n/* Media Card Components - Shared across movies.html and potentially others */\r\n\r\n.media-card {\r\n    position: relative;\r\n    aspect-ratio: 3/4;\r\n    border-radius: var(--radius-lg);\r\n    overflow: hidden;\r\n    cursor: pointer;\r\n    background: var(--surface);\r\n    transition: transform var(--transition-normal), box-shadow var(--transition-normal);\r\n}\r\n\r\n.media-card:hover {\r\n    transform: translateY(-4px) scale(1.02);\r\n    box-shadow: var(--shadow-lg);\r\n}\r\n\r\n.media-card img {\r\n    width: 100%;\r\n    height: 100%;\r\n    object-fit: cover;\r\n}\r\n\r\n.media-card-overlay {\r\n    position: absolute;\r\n    inset: 0;\r\n    background: linear-gradient(to top, rgba(0, 0, 0, 0.9) 0%, transparent 50%);\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: flex-end;\r\n    padding: var(--space-md);\r\n    opacity: 0;\r\n    transition: opacity var(--transition-normal);\r\n}\r\n\r\n.media-card:hover .media-card-overlay {\r\n    opacity: 1;\r\n}\r\n\r\n.media-card-overview {\r\n    color: #ffffff;\r\n    font-size: 0.75rem;\r\n    line-height: 1.4;\r\n    display: -webkit-box;\r\n    -webkit-line-clamp: 4;\r\n    line-clamp: 4;\r\n    -webkit-box-orient: vertical;\r\n    overflow: hidden;\r\n    margin-bottom: var(--space-sm);\r\n    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.8);\r\n    font-weight: 500;\r\n}\r\n\r\n.media-card-title {\r\n    font-size: 0.875rem;\r\n    font-weight: 600;\r\n    color: var(--text);\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n}\r\n\r\n.media-card-meta {\r\n    font-size: 0.75rem;\r\n    color: var(--text-muted);\r\n    margin-top: var(--space-xs);\r\n}\r\n\r\n.media-card-rating {\r\n    position: absolute;\r\n    top: 8px;\r\n    right: 8px;\r\n    background: rgba(0, 0, 0, 0.6);\r\n    color: rgba(255, 255, 255, 0.9);\r\n    padding: 2px 6px;\r\n    border-radius: 4px;\r\n    font-size: 0.75rem;\r\n    font-weight: 600;\r\n    z-index: 20;\r\n    backdrop-filter: blur(4px);\r\n    border: 1px solid rgba(255, 255, 255, 0.1);\r\n    opacity: 0;\r\n    transition: opacity 0.2s;\r\n}\r\n\r\n.media-card:hover .media-card-rating {\r\n    opacity: 1;\r\n    background: rgba(0, 0, 0, 0.8);\r\n}\n</style>\r\n    <style>\n    .movies-page {\r\n        min-height: 100vh;\r\n        padding: 70px 20px 20px;\r\n    }\r\n\r\n    /* Page layout, controls, search-box imported from layout.css */\r\n\r\n    .tab-toggle {\r\n        display: flex;\r\n        background: var(--surface);\r\n        border: 1px solid var(--border);\r\n        border-radius: 9999px;\r\n        overflow: hidden;\r\n    }\r\n\r\n    .tab-btn {\r\n        padding: 10px 16px;\r\n        background: transparent;\r\n        border: none;\r\n        color: var(--text-muted);\r\n        font-size: 0.8125rem;\r\n        font-weight: 500;\r\n        cursor: pointer;\r\n        transition: all 0.15s;\r\n    }\r\n\r\n    .tab-btn:hover {\r\n        color: var(--text);\r\n        background: var(--surface-hover);\r\n    }\r\n\r\n    .tab-btn.active {\r\n        background: var(--text);\r\n        color: var(--bg);\r\n    }\r\n\r\n    .category-pills {\r\n        display: flex;\r\n        gap: 8px;\r\n        flex-wrap: wrap;\r\n        justify-content: center;\r\n    }\r\n\r\n    .category-pill {\r\n        padding: 8px 14px;\r\n        background: var(--surface);\r\n        border: 1px solid var(--border);\r\n        border-radius: 9999px;\r\n        color: var(--text-muted);\r\n        font-size: 0.75rem;\r\n        cursor: pointer;\r\n        transition: all 0.15s;\r\n    }\r\n\r\n    .category-pill:hover {\r\n        color: var(--text);\r\n        background: var(--surface-hover);\r\n    }\r\n\r\n    .category-pill.active {\r\n        background: var(--text);\r\n        color: var(--bg);\r\n        border-color: var(--text);\r\n    }\r\n\r\n    /* Grid */\r\n    .media-grid {\r\n        display: grid;\r\n        /* Grid: Change '140px' to a smaller number (e.g. 100px) for more movies per row */\r\n        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));\r\n        gap: 14px;\r\n        max-width: 1200px;\r\n        margin: 0 auto;\r\n    }\r\n\r\n\r\n\r\n    /* Search Suggestions */\r\n    .search-suggestions {\r\n        display: none;\r\n        position: absolute;\r\n        top: 100%;\r\n        left: 0;\r\n        right: 0;\r\n        margin-top: 8px;\r\n        background: var(--surface);\r\n        border: 1px solid var(--border);\r\n        border-radius: 12px;\r\n        max-height: 300px;\r\n        overflow-y: auto;\r\n        z-index: 100;\r\n    }\r\n\r\n    .search-suggestions.show {\r\n        display: block;\r\n    }\r\n\r\n    .suggestion-item {\r\n        display: flex;\r\n        gap: 10px;\r\n        padding: 10px;\r\n        cursor: pointer;\r\n        transition: background 0.15s;\r\n    }\r\n\r\n    .suggestion-item:hover {\r\n        background: var(--surface-hover);\r\n    }\r\n\r\n    .suggestion-item img {\r\n        width: 40px;\r\n        height: 60px;\r\n        object-fit: cover;\r\n        border-radius: 4px;\r\n    }\r\n\r\n    .suggestion-info {\r\n        flex: 1;\r\n        overflow: hidden;\r\n    }\r\n\r\n    .suggestion-title {\r\n        font-size: 0.8125rem;\r\n        font-weight: 500;\r\n    }\r\n\r\n    .suggestion-meta {\r\n        font-size: 0.6875rem;\r\n        color: var(--text-muted);\r\n    }\r\n\r\n    /* Season Explorer */\r\n    .season-explorer {\r\n        display: none;\r\n        position: fixed;\r\n        inset: 0;\r\n        background: rgba(0, 0, 0, 0.9);\r\n        z-index: 10000;\r\n        padding: 80px 20px 20px;\r\n        overflow-y: auto;\r\n    }\r\n\r\n    .season-explorer.show {\r\n        display: block;\r\n    }\r\n\r\n    .season-explorer-header {\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: space-between;\r\n        margin-bottom: 20px;\r\n        max-width: 800px;\r\n        margin-left: auto;\r\n        margin-right: auto;\r\n    }\r\n\r\n    .season-explorer-title {\r\n        font-size: 1.25rem;\r\n        font-weight: 700;\r\n    }\r\n\r\n    .season-explorer-close {\r\n        background: var(--surface);\r\n        border: 1px solid var(--border);\r\n        border-radius: 50%;\r\n        width: 36px;\r\n        height: 36px;\r\n        color: var(--text);\r\n        cursor: pointer;\r\n    }\r\n\r\n    .seasons-list,\r\n    .episodes-list {\r\n        display: flex;\r\n        flex-wrap: wrap;\r\n        gap: 10px;\r\n        max-width: 800px;\r\n        margin: 0 auto 20px;\r\n    }\r\n\r\n    .season-btn,\r\n    .episode-btn {\r\n        padding: 10px 18px;\r\n        background: var(--surface);\r\n        border: 1px solid var(--border);\r\n        border-radius: 8px;\r\n        color: var(--text);\r\n        font-size: 0.8125rem;\r\n        cursor: pointer;\r\n        transition: all 0.15s;\r\n    }\r\n\r\n    .season-btn:hover,\r\n    .episode-btn:hover {\r\n        background: var(--surface-hover);\r\n    }\r\n\r\n    .season-btn.active {\r\n        background: var(--text);\r\n        color: var(--bg);\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n    /* Loading */\r\n    .loading {\r\n        text-align: center;\r\n        padding: 40px;\r\n        color: var(--text-muted);\r\n    }\r\n\r\n    /* .skeleton handled by main.css */\r\n\r\n    @keyframes shimmer {\r\n        0% {\r\n            background-position: 200% 0;\r\n        }\r\n\r\n        100% {\r\n            background-position: -200% 0;\r\n        }\r\n    }\r\n\r\n    .load-more-card {\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        background: var(--surface);\r\n        border: none;\r\n        border-radius: 12px;\r\n        cursor: pointer;\r\n        transition: all 0.3s ease;\r\n        min-height: 220px;\r\n        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\r\n        opacity: 0.9;\r\n        overflow: hidden;\r\n    }\r\n\r\n    .load-more-card:hover {\r\n        background: var(--surface-hover);\r\n        transform: scale(1.05);\r\n        /* Slight growth */\r\n        opacity: 0.6;\r\n        /* Fade out effect */\r\n        z-index: 50;\r\n    }\r\n\r\n    .load-more-content {\r\n        text-align: center;\r\n        color: var(--text-muted);\r\n        transition: color 0.3s;\r\n    }\r\n\r\n    .load-more-card:hover .load-more-content {\r\n        color: var(--text);\r\n    }\r\n\r\n    .load-more-content i {\r\n        display: block;\r\n        font-size: 3.5rem;\r\n        /* Much bigger icon */\r\n        margin-bottom: 12px;\r\n    }\r\n\r\n    /* Improved Card Typography & Rating moved to card.css */\r\n\r\n    /* Dropdown Styling */\r\n    #genre-select option {\r\n        background: var(--bg);\r\n        color: var(--text);\r\n    }\n</style>\r\n    <style>\n/**\r\n * PHANTOM - BACKGROUND STYLES\r\n */\r\n.phantom-background {\r\n    position: fixed;\r\n    inset: 0;\r\n    width: 100vw;\r\n    height: 100vh;\r\n    z-index: -1;\r\n    overflow: hidden;\r\n    background: transparent;\r\n    pointer-events: none;\r\n    opacity: 1;\r\n    transition: background-color 0.3s ease;\r\n}\r\n\r\n.phantom-background.active {\r\n    opacity: 1;\r\n}\r\n\r\n.phantom-background-overlay {\r\n    position: absolute;\r\n    inset: 0;\r\n    z-index: 2;\r\n    background: rgba(0, 0, 0, var(--bg-overlay, 0.4));\r\n    transition: background-color 0.3s ease;\r\n}\r\n\r\n.phantom-background-layer {\r\n    position: absolute;\r\n    inset: 0;\r\n    z-index: 1;\r\n    transition: opacity 0.3s ease-in-out;\r\n}\r\n\r\n.phantom-background-media {\r\n    width: 100%;\r\n    height: 100%;\r\n    object-fit: cover;\r\n    object-position: var(--bg-image-position, center);\r\n    display: block;\r\n    border: none;\r\n}\r\n\r\n/* Video and Iframe positioning for full background cover */\r\n.phantom-background-layer video.phantom-background-media,\r\n.phantom-background-layer iframe.phantom-background-media {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    transform: none;\r\n    pointer-events: none;\r\n    min-width: 100%;\r\n    min-height: 100%;\r\n    max-width: none;\r\n    max-height: none;\r\n    object-position: var(--bg-image-position, center);\r\n}\r\n\r\n/* Ensure iframes cover entire background */\r\n.phantom-background-layer iframe.phantom-background-media {\r\n    border: none;\r\n    object-fit: cover;\r\n}\r\n\r\n/* Ensure content on top remains readable */\r\nhtml {\r\n    background-color: var(--bg);\r\n}\r\n\r\nbody {\r\n    position: relative;\r\n    z-index: 0;\r\n    background: transparent !important;\r\n    /* Allow background to show through */\r\n}\r\n\r\n/* Specific adjustments for transparency if needed */\r\n.main-content,\r\n.home-page {\r\n    background: transparent !important;\r\n}\r\n\r\n/* Glassmorphism for containers when background is active */\r\n.phantom-background.active~.offline-banner,\r\n.phantom-background.active~.home-page .card,\r\n.phantom-background.active~.home-page .featured-card,\r\n.phantom-background.active~.home-page .search-bar,\r\n.phantom-background.active~.settings-panel {\r\n    backdrop-filter: blur(10px);\r\n    -webkit-backdrop-filter: blur(10px);\r\n    background: rgba(15, 15, 15, 0.7) !important;\r\n}\n</style>\r\n</head>\r\n\r\n<body>\r\n    <script>\n// topbar\r\n(function () {\r\n    let rootPrefix = '';\r\n    const scriptName = 'components/topbar.js';\r\n    const scripts = document.getElementsByTagName('script');\r\n    for (let i = 0; i < scripts.length; i++) {\r\n        const src = scripts[i].getAttribute('src');\r\n        if (src && src.includes(scriptName)) {\r\n            rootPrefix = src.split(scriptName)[0];\r\n            break;\r\n        }\r\n    }\r\n\r\n    if (!window.lucide && !document.querySelector('script[src*=\"lucide\"]')) {\r\n        const script = document.createElement('script');\r\n        script.src = 'https://unpkg.com/lucide@latest';\r\n        script.onload = () => {\r\n            if (window.lucide) lucide.createIcons();\r\n        };\r\n        document.head.appendChild(script);\r\n    }\r\n\r\n    initTopbar();\r\n\r\n    function createTopbar() {\r\n        const topbarContainer = document.createElement('div');\r\n        topbarContainer.id = 'topbar-container';\r\n\r\n        const logoSection = document.createElement('a');\r\n        logoSection.className = 'logo-section';\r\n        logoSection.href = rootPrefix + 'index2.html';\r\n        logoSection.innerHTML = '<div class=\"logo-placeholder\"><i data-lucide=\"zap\"></i></div>';\r\n        topbarContainer.appendChild(logoSection);\r\n\r\n        const navButtons = document.createElement('div');\r\n        navButtons.className = 'nav-buttons';\r\n\r\n        const buttons = [\r\n            { name: 'Music', icon: 'music', link: 'pages/music.html', badge: 'BETA' },\r\n            { name: 'Movies', icon: 'film', link: 'pages/movies.html' },\r\n            { name: 'Games', icon: 'gamepad-2', link: 'pages/games.html' },\r\n            { name: 'Watch', icon: 'play', link: 'pages/watch.html' },\r\n            { name: 'Search', icon: 'search', link: 'staticsjv2/index.html' },\r\n            { name: 'AI Chat', icon: 'bot', link: 'pages/chat.html' },\r\n            { separator: true },\r\n            { name: 'Settings', icon: 'settings', link: 'pages/settings.html' }\r\n        ];\r\n\r\n        buttons.forEach(btn => {\r\n            if (btn.separator) {\r\n                const separator = document.createElement('div');\r\n                separator.className = 'nav-separator';\r\n                navButtons.appendChild(separator);\r\n                return;\r\n            }\r\n\r\n            const link = document.createElement('a');   \r\n            link.href = rootPrefix + btn.link;\r\n            link.className = 'nav-btn';\r\n\r\n            const icon = document.createElement('i');\r\n            icon.setAttribute('data-lucide', btn.icon);\r\n            link.appendChild(icon);\r\n\r\n            const span = document.createElement('span');\r\n            span.textContent = btn.name;\r\n            link.appendChild(span);\r\n\r\n            if (btn.badge) {\r\n                const badge = document.createElement('div');\r\n                badge.className = 'nav-badge-beta';\r\n                badge.textContent = btn.badge;\r\n                link.appendChild(badge);\r\n            }\r\n\r\n            navButtons.appendChild(link);\r\n        });\r\n\r\n        topbarContainer.appendChild(navButtons);\r\n        document.body.prepend(topbarContainer);\r\n\r\n        if (window.lucide) {\r\n            lucide.createIcons();\r\n        }\r\n    }\r\n\r\n    function initTopbar() {\r\n        if (document.readyState === 'loading') {\r\n            document.addEventListener('DOMContentLoaded', createTopbar);\r\n        } else {\r\n            createTopbar();\r\n        }\r\n    }\r\n})();\r\n\n</script>\r\n\r\n    <div class=\"movies-page\">\r\n        <header class=\"page-header\">\r\n            <h1 class=\"page-title\">Movies & TV</h1>\r\n            <p class=\"page-subtitle\">Stream movies and TV shows</p>\r\n        </header>\r\n\r\n        <div class=\"controls\">\r\n            <div class=\"search-box\">\r\n                <i class=\"fa-solid fa-search\"></i>\r\n                <input type=\"text\" id=\"search-input\" placeholder=\"Search movies & TV...\">\r\n                <div class=\"search-suggestions\" id=\"suggestions\"></div>\r\n            </div>\r\n            <div class=\"tab-toggle\">\r\n                <button class=\"tab-btn active\" id=\"movies-tab\">Movies</button>\r\n                <button class=\"tab-btn\" id=\"tv-tab\">TV Shows</button>\r\n            </div>\r\n            <div class=\"search-box\" style=\"flex:0; min-width: 150px;\">\r\n                <select id=\"genre-select\"\r\n                    style=\"width:100%; background:transparent; border:none; color:var(--text); outline:none;\">\r\n                    <option value=\"\">All Genres</option>\r\n                </select>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"controls\">\r\n            <div class=\"category-pills\" id=\"category-pills\">\r\n                <button class=\"category-pill active\" data-cat=\"featured\">Featured</button>\r\n                <button class=\"category-pill\" data-cat=\"popular\">Popular</button>\r\n                <button class=\"category-pill\" data-cat=\"top_rated\">Top Rated</button>\r\n                <button class=\"category-pill\" data-cat=\"now_playing\">Now Playing</button>\r\n                <button class=\"category-pill\" data-cat=\"upcoming\">Upcoming</button>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"media-grid\" id=\"media-grid\">\r\n            <div class=\"media-card\">\r\n                <div class=\"skeleton\" style=\"width:100%;height:100%;\"></div>\r\n            </div>\r\n            <div class=\"media-card\">\r\n                <div class=\"skeleton\" style=\"width:100%;height:100%;\"></div>\r\n            </div>\r\n            <div class=\"media-card\">\r\n                <div class=\"skeleton\" style=\"width:100%;height:100%;\"></div>\r\n            </div>\r\n            <div class=\"media-card\">\r\n                <div class=\"skeleton\" style=\"width:100%;height:100%;\"></div>\r\n            </div>\r\n            <div class=\"media-card\">\r\n                <div class=\"skeleton\" style=\"width:100%;height:100%;\"></div>\r\n            </div>\r\n            <div class=\"media-card\">\r\n                <div class=\"skeleton\" style=\"width:100%;height:100%;\"></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n\r\n\r\n    <!-- Season Explorer -->\r\n    <div class=\"season-explorer\" id=\"season-explorer\">\r\n        <div class=\"season-explorer-header\">\r\n            <span class=\"season-explorer-title\" id=\"show-title\">Select Episode</span>\r\n            <button class=\"season-explorer-close\" onclick=\"closeSeasonExplorer()\"><i\r\n                    class=\"fa-solid fa-xmark\"></i></button>\r\n        </div>\r\n        <div class=\"seasons-list\" id=\"seasons-list\"></div>\r\n        <div class=\"episodes-list\" id=\"episodes-list\"></div>\r\n    </div>\r\n\r\n\r\n    <script>\n(function () {\r\n    const style = document.createElement('style');\r\n    style.textContent = `\r\n        .notify-container { position: fixed; top: 16px; right: 16px; z-index: 99999; display: flex; flex-direction: column; gap: 8px; pointer-events: none; font-family: 'Inter', sans-serif; }\r\n        .notify-toast { display: flex; align-items: center; gap: 12px; padding: 12px 16px; background: rgba(15, 15, 15, 0.9); backdrop-filter: blur(10px); border: 1px solid var(--border, #1f1f1f); border-radius: 10px; color: #e4e4e7; font-size: 13px; min-width: 280px; max-width: 380px; box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4); pointer-events: auto; transform: translateX(120%); opacity: 0; transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1), opacity 0.3s ease; position: relative; overflow: hidden; }\r\n        .notify-toast.show { transform: translateX(0); opacity: 1; }\r\n        .notify-toast.hiding { transform: translateX(120%); opacity: 0; }\r\n        .notify-icon { width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }\r\n        .notify-icon svg { width: 18px; height: 18px; }\r\n        .notify-content { flex: 1; line-height: 1.4; }\r\n        .notify-title { font-weight: 600; margin-bottom: 2px; }\r\n        .notify-message { color: #a1a1aa; font-size: 12px; }\r\n        .notify-close { background: none; border: none; color: #52525b; cursor: pointer; padding: 4px; border-radius: 4px; display: flex; align-items: center; justify-content: center; }\r\n        .notify-close:hover { background: rgba(255,255,255,0.1); color: #fff; }\r\n        .notify-close svg { width: 14px; height: 14px; }\r\n        .notify-toast.success { border-left: 3px solid #22c55e; } .notify-toast.success .notify-icon { color: #22c55e; }\r\n        .notify-toast.error { border-left: 3px solid #ef4444; } .notify-toast.error .notify-icon { color: #ef4444; }\r\n        .notify-toast.warning { border-left: 3px solid #f59e0b; } .notify-toast.warning .notify-icon { color: #f59e0b; }\r\n        .notify-toast.info { border-left: 3px solid #3b82f6; } .notify-toast.info .notify-icon { color: #3b82f6; }\r\n        .notify-progress { position: absolute; bottom: 0; left: 0; height: 2px; background: rgba(255, 255, 255, 0.2); transition: width linear; }\r\n    `;\r\n    document.head.appendChild(style);\r\n\r\n    let container = null;\r\n    const getContainer = () => container || (container = document.body.appendChild(Object.assign(document.createElement('div'), { className: 'notify-container' })));\r\n\r\n    const icons = {\r\n        success: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"20 6 9 17 4 12\"></polyline></svg>`,\r\n        error: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"15\" y1=\"9\" x2=\"9\" y2=\"15\"></line><line x1=\"9\" y1=\"9\" x2=\"15\" y2=\"15\"></line></svg>`,\r\n        warning: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\"></path><line x1=\"12\" y1=\"9\" x2=\"12\" y2=\"13\"></line><line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\"></line></svg>`,\r\n        info: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"12\" y1=\"16\" x2=\"12\" y2=\"12\"></line><line x1=\"12\" y1=\"8\" x2=\"12.01\" y2=\"8\"></line></svg>`,\r\n        close: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line><line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line></svg>`\r\n    };\r\n\r\n    function notify(type, title, msg = '', dur = 4000) {\r\n        const t = document.createElement('div');\r\n        t.className = `notify-toast ${type}`;\r\n        t.innerHTML = `<div class=\"notify-icon\">${icons[type]}</div><div class=\"notify-content\"><div class=\"notify-title\">${title}</div><div class=\"notify-message\">${msg}</div></div><button class=\"notify-close\">${icons.close}</button><div class=\"notify-progress\"></div>`;\r\n        const p = t.querySelector('.notify-progress');\r\n        const dismiss = () => { t.classList.add('hiding'); setTimeout(() => t.remove(), 300); };\r\n        t.querySelector('.notify-close').onclick = dismiss;\r\n        p.style.width = '100%';\r\n        setTimeout(() => { p.style.transition = `width ${dur}ms linear`; p.style.width = '0%'; }, 50);\r\n        let timer = setTimeout(dismiss, dur);\r\n        t.onmouseenter = () => { clearTimeout(timer); p.style.transition = 'none'; };\r\n        t.onmouseleave = () => {\r\n            const rem = (parseFloat(getComputedStyle(p).width) / t.offsetWidth) * dur;\r\n            p.style.transition = `width ${rem}ms linear`; p.style.width = '0%';\r\n            timer = setTimeout(dismiss, rem);\r\n        };\r\n        getContainer().appendChild(t);\r\n        requestAnimationFrame(() => t.classList.add('show'));\r\n    }\r\n\r\n    window.Notify = {\r\n        success: (a, b, c) => notify('success', a, b, c),\r\n        error: (a, b, c) => notify('error', a, b, c),\r\n        warning: (a, b, c) => notify('warning', a, b, c),\r\n        info: (a, b, c) => notify('info', a, b, c)\r\n    };\r\n})();\r\n\n</script>\r\n    <script>\n// site config\r\n\r\nwindow.SITE_CONFIG = {\r\n    name: \"Phantom\",\r\n    fullName: \"Phantom Unblocked\",\r\n    version: \"1.0.12\",\r\n\r\n    changelog: [\r\n        \"1.0.12: tiny fixxes and changes\",\r\n        \"some code consolidation and fixxes\",\r\n        \"suggest features in the discord server\"\r\n    ],\r\n\r\n    // quotes\r\n    quotes: [\r\n        \"lebron lebron lebronn james\",\r\n        \"so tuff\",\r\n        \"it is what it is\",\r\n        \"do ur work\",\r\n        \"this is what happens when u dont touch grass\",\r\n        \"FULL BOX\",\r\n        \"FULL PIECE\",\r\n        \"200!\",\r\n        \"press esc + refresh + power button for hacks\",\r\n        \"press ctrl+x to hide your screen\",\r\n        \"change the tab title and favicon in settings\",\r\n        \"TEACHERR!\",\r\n        \"1 pump\",\r\n        \"303 headshot\",\r\n        \"bros prolly a 60 ovr\",\r\n        \"take the L lil bro\",  \r\n        \"lebron is OUR goat\",\r\n        \"stop looking at my screen\",\r\n    ],\r\n\r\n    // todo\r\n    // *** for strikethrough\r\n    // ** for bold\r\n    todos: [\r\n        \"***fixxed aboutblank opening while securly is on (previously if popups were off it would load intab instead of clickto launch now it will use clicktolaunch unless popups are blocked)***\",\r\n        \"***fix the proxy***\",\r\n        \"***fix panic panickey, add quote talking about it***\",\r\n        \"***fix theatermode, make it hide buttons after a few seconds and ensure all content is being displayed and move the description to the bottom***\",\r\n        \"***change back player to use old styling, change the surface to use background colors for the bottom part where description is shown, looking just like the background***\",\r\n        \"***add image and video support for backgrounds***\",\r\n        \"***fix aichat, make the title use the same ai request as the users question unless its in image mode where it will use text mode and fix ai chat to remember modes better***\",\r\n        \"***add cloaking to quotes***\",\r\n        \"***add a default cloak and fix it so icons work in aboutblank for whatever reason they only work when you go to settings in aboutblank where it correctly applies***\",\r\n        \"***for search suggestions add highlighting for whatever will happen when you click enter, in search suggestions fix all games not sending you to the games page***\",\r\n        \"***fix games to make multi library the default, put it in config.js***\",\r\n        \"***rename movies shortcut in index2.html to primeshows, add shortcuts to main pages in the topbar and change the current shortcuts to more popular games***\",\r\n        \"***make announcements show even on first visit unlike changelog and allow disabling it via settings***\",\r\n        \"***fix leave comformation asking u to leave each time you click something***\",\r\n        \"***change the shortcuts on the main page to include pages***\",\r\n        \"***add movies to the search bar in main page***\",\r\n        \"***fix background not turning off soon***\",\r\n        \"***fix music page to hide youtube player unless toggled via 3 dot small button, and always shown on proxy mode, fix all the controls for video time, volume***\",\r\n        \"**add singlefile this is lowk so hard i dont really understand it**\",\r\n        \"**advertise phantom (too much work tbh)**\",\r\n        \"**add a watch page for youtube and twitch**\",\r\n        \"**add a miniplayer for music**\",\r\n        \"***shorten some page's code***\",\r\n        \"***fix paths in search autocomplete***\",\r\n        \"***fix markdown in ai not using correct text colors***\",\r\n        \"***make backgrounds show in the loading screen***\",\r\n        \"***fix icons for topbar in code.html***\",\r\n        \"**fix wisp server not notifying or autoswitiching when offline in proxy**\",\r\n        \"***fix code runner open not working at all***\",\r\n        \"***make backgrounds show in player.html***\",\r\n        \"***make backgrounds show in staticsjv2***\",\r\n        \"***make player.html player controls use theme colros not hardcoded***\",\r\n        \"***make ai chat and music sidebar go all the way down and up with borders***\",\r\n        \"**make the only song in music be lebron lebron lebron james**\",\r\n        \"**fix music controls**\",\r\n        \"***finish extra page into credits and make this todo be tucked away somewhere and not the main part of it***\"\r\n    ],\r\n    defaultWisp: \"wss://glseries.net/wisp/\",\r\n    wispServers: [\r\n        { name: \"GLSeries Wisp\", url: \"wss://glseries.net/wisp/\" },\r\n        { name: \"Rhw's Wisp\", url: \"wss://wisp.rhw.one/\" },\r\n    ],\r\n\r\n    discord: {\r\n        inviteUrl: \"https://discord.gg/tHWx9NXp5p\",\r\n        widgetServer: \"1447673724017971324\",\r\n        widgetChannel: \"1447673726228496617\",\r\n    },\r\n\r\n    firstVisitCloak: false, //fake error page\r\n    defaults: {\r\n        cloakMode: \"about:blank\",\r\n        tabTitle: \"You've already responded\",\r\n        tabFavicon: \"https://ssl.gstatic.com/docs/spreadsheets/forms/forms_icon_2023q4.ico\",\r\n        cloakRotation: false,\r\n        cloakInterval: 5000,\r\n        panicKey: \"x\",\r\n        panicModifiers: [\"ctrl\", \"shift\"],\r\n        panicUrl: \"https://classroom.google.com\",\r\n        maxMovieRating: \"R\",\r\n        gameLibrary: \"multi\",\r\n        discordWidget: true,\r\n        miniplayer: true,\r\n        leaveConfirmation: false,\r\n        showChangelogOnUpdate: true,\r\n        themeRotation: true,\r\n        lastThemeRotation: 0,\r\n        backgroundRotation: true,\r\n        lastBackgroundRotation: 0,\r\n        lastSeenFeatured: 'none',\r\n        background: { type: 'color', value: '#0a0a0a' },\r\n        customBackground: { id: 'none', type: 'none' },\r\n        accentColor: '#ffffff',\r\n        surfaceColor: '#0f0f0f',\r\n        secondaryColor: '#2e2e33',\r\n        textColor: '#e4e4e7',\r\n    },\r\n\r\n    themePresets: {\r\n        dark: { name: 'Dark (Default)', bg: { type: 'color', value: '#0a0a0a' }, surface: '#0f0f0f', surfaceHover: '#1a1a1a', surfaceActive: '#252525', secondary: '#2e2e33', border: '#2a2a2a', borderLight: '#2a2a2a', text: '#e4e4e7', textSec: '#71717a', textDim: '#52525b', accent: '#ffffff' },\r\n        midnight: { name: 'Midnight', bg: { type: 'color', value: '#000000' }, surface: '#050505', surfaceHover: '#111111', surfaceActive: '#1a1a1a', secondary: '#111111', border: '#1a1a1a', borderLight: '#111111', text: '#ededed', textSec: '#a3a3a3', textDim: '#737373', accent: '#d4d4d4' },\r\n        abyss: { name: 'Abyss', bg: { type: 'color', value: '#020617' }, surface: '#0f172a', surfaceHover: '#1e293b', surfaceActive: '#334155', secondary: '#1e293b', border: '#1e293b', borderLight: '#1e293b', text: '#f1f5f9', textSec: '#94a3b8', textDim: '#64748b', accent: '#38bdf8' },\r\n        phantom: { name: 'Phantom', bg: { type: 'color', value: '#0f0a14' }, surface: '#1a0f24', surfaceHover: '#2e1a40', surfaceActive: '#4c2a5c', secondary: '#2e1a40', border: '#2e1a40', borderLight: '#2e1a40', text: '#f3e8ff', textSec: '#d8b4fe', textDim: '#c084fc', accent: '#c084fc' },\r\n        rosepine: { name: 'Rose Pine', bg: { type: 'color', value: '#191724' }, surface: '#1f1d2e', surfaceHover: '#26233a', surfaceActive: '#524f67', secondary: '#26233a', border: '#26233a', borderLight: '#1f1d2e', text: '#e0def4', textSec: '#908caa', textDim: '#6e6a86', accent: '#ebbcba' },\r\n        ocean: { name: 'Oceanic', bg: { type: 'color', value: '#011627' }, surface: '#0b2942', surfaceHover: '#1d3b53', surfaceActive: '#2d4b63', secondary: '#0b2942', border: '#1d3b53', borderLight: '#0b2942', text: '#d6deeb', textSec: '#5f7e97', textDim: '#011627', accent: '#7fdbca' },\r\n        forest: { name: 'Forest', bg: { type: 'color', value: '#020d06' }, surface: '#051a0d', surfaceHover: '#0a2e17', surfaceActive: '#0f4221', secondary: '#051a0d', border: '#0a2e17', borderLight: '#051a0d', text: '#ecfdf5', textSec: '#6ee7b7', textDim: '#064e3b', accent: '#10b981' },\r\n        crimson: { name: 'Crimson', bg: { type: 'color', value: '#1a0505' }, surface: '#230a0a', surfaceHover: '#7b0a0aff', surfaceActive: '#7f1d1d', secondary: '#230a0a', border: '#480f0fff', borderLight: '#230a0a', text: '#fef2f2', textSec: '#fecaca', textDim: '#450a0a', accent: '#ef4444' },\r\n        flame: { name: 'Flame', bg: { type: 'color', value: '#0c0202' }, surface: '#1c0a0a', surfaceHover: '#451a03', surfaceActive: '#9a3412', secondary: '#1c0a0a', border: '#451a03', borderLight: '#9a3412', text: '#fff7ed', textSec: '#fdba74', textDim: '#ea580c', accent: '#f59e0b' }\r\n    },\r\n\r\n    backgroundPresets: [\r\n        { id: 'none', name: 'None (Theme Default)', type: 'none' },\r\n        { id: 'Night sky', name: 'Night sky', type: 'image', url: 'https://images.pexels.com/photos/5675745/pexels-photo-5675745.jpeg', overlay: 0.3 },\r\n        { id: 'winter-mountains', name: 'Winter mountains', type: 'image', url: 'https://images.pexels.com/photos/1287145/pexels-photo-1287145.jpeg', overlay: 0.3 },\r\n        { id: 'f1 car', name: 'F1 Car', type: 'image', url: 'https://images.pexels.com/photos/14401632/pexels-photo-14401632.jpeg', overlay: 0.3 },\r\n        { id: 'moon-landing', name: 'Moon Landing', type: 'image', url: 'https://images.pexels.com/photos/41162/moon-landing-apollo-11-nasa-buzz-aldrin-41162.jpeg', overlay: 0.3, objectPosition: 'top left', active: true },\r\n        { id: 'turtle', name: 'Turtle', type: 'image', url: 'https://images.unsplash.com/photo-1501791187590-9ef2612ba1eb?q=80&w=1932&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D', overlay: 0.3 },\r\n        { id: 'road', name: 'Road', type: 'image', url: 'https://images.unsplash.com/photo-1508233620467-f79f1e317a05', overlay: 0.3 },\r\n        { id: 'railroad', name: 'Railroad', type: 'image', url: 'https://images.unsplash.com/photo-1505832018823-50331d70d237', overlay: 0.3 },\r\n        { id: 'mountain', name: 'Mountain', type: 'image', url: 'https://raw.githubusercontent.com/evanhnry/brave-wallpapers/refs/heads/main/Brave/clay-banks-u27Rrbs9Dwc-unsplash.jpg', overlay: 0.3 },\r\n    ],\r\n\r\n    cloakPresets: [\r\n        { name: \"Phantom\", icon: \"/favicon.svg\", title: \"Phantom Unblocked\" },\r\n        { name: \"Edpuzzle\", icon: \"https://edpuzzle.imgix.net/favicons/favicon-32.png\", title: \"Edpuzzle\" },\r\n        { name: \"Google Docs\", icon: \"https://ssl.gstatic.com/docs/documents/images/kix-favicon7.ico\", title: \"Untitled document - Google Docs\" },\r\n        { name: \"Canvas\", icon: \"https://du11hjcvx0uqb.cloudfront.net/dist/images/favicon-e10d657a73.ico\", title: \"Dashboard\" },\r\n        { name: \"Desmos\", icon: \"https://www.desmos.com/favicon.ico\", title: \"Desmos | Graphing Calculator\" },\r\n        { name: \"Khan Academy\", icon: \"https://cdn.kastatic.org/images/favicon.ico\", title: \"Khan Academy\" },\r\n        { name: \"Wikipedia\", icon: \"https://en.wikipedia.org/favicon.ico\", title: \"World War II - Wikipedia\" },\r\n        { name: \"Classroom\", icon: \"https://ssl.gstatic.com/classroom/favicon.png\", title: \"Home - Classroom\" },\r\n        { name: \"Canva\", icon: \"https://static.canva.com/static/images/android-192x192-2.png\", title: \"Home - Canva\" },\r\n        { name: \"Quiz\", icon: \"https://ssl.gstatic.com/docs/spreadsheets/forms/forms_icon_2023q4.ico\", title: \"You've already responded\" },\r\n        { name: \"Blooket\", icon: \"https://play.blooket.com/favicon.ico\", title: \"Play Blooket | Blooket\" },\r\n        { name: \"Gmail\", icon: \"https://ssl.gstatic.com/ui/v1/icons/mail/rfr/gmail.ico\", title: \"Gmail\" },\r\n        { name: \"YouTube\", icon: \"https://www.youtube.com/favicon.ico\", title: \"YouTube\" },\r\n        { name: \"Powerschool\", icon: \"https://waverlyk12.powerschool.com/favicon.ico\", title: \"Grades and Attendance\" },\r\n        { name: \"nothing\", icon: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=\", title: \"\\u200B\" },\r\n    ]\r\n}\r\n\r\n\r\n\n</script>\r\n    <script>\n// settings handler\r\n(function () {\r\n    'use strict';\r\n\r\n    const STORAGE_KEY = 'void_settings';\r\n\r\n    const getDefaults = () => {\r\n        return window.SITE_CONFIG?.defaults || {\r\n            cloakMode: 'none',\r\n            cloakRotation: false,\r\n            cloakInterval: 5000,\r\n            panicKey: 'x',\r\n            panicModifiers: ['ctrl', 'shift'],\r\n            panicUrl: 'https://classroom.google.com',\r\n            maxMovieRating: 'R',\r\n            offlineGames: [],\r\n            gameLibrary: 'multi',\r\n            leaveConfirmation: false\r\n        };\r\n    };\r\n\r\n    const load = () => {\r\n        try {\r\n            const stored = localStorage.getItem(STORAGE_KEY);\r\n            if (stored) {\r\n                return { ...getDefaults(), ...JSON.parse(stored) };\r\n            }\r\n        } catch (e) {\r\n            console.warn('Failed to load settings:', e);\r\n        }\r\n        return getDefaults();\r\n    };\r\n\r\n    const save = (settings) => {\r\n        try {\r\n            localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n            window.dispatchEvent(new CustomEvent('settings-changed', { detail: settings }));\r\n            if (window.parent !== window) {\r\n                window.parent.postMessage({ type: 'settings-update' }, '*');\r\n            }\r\n        } catch (e) {\r\n            console.warn('Failed to save settings:', e);\r\n        }\r\n    };\r\n\r\n    let _settings = load();\r\n\r\n    window.Settings = {\r\n        get(key) { return _settings[key]; },\r\n\r\n        getAll() { return { ..._settings }; },\r\n\r\n        set(key, value) {\r\n            _settings[key] = value;\r\n            save(_settings);\r\n            this.apply();\r\n            return value;\r\n        },\r\n\r\n        update(partial) {\r\n            _settings = { ..._settings, ...partial };\r\n            save(_settings);\r\n            this.apply();\r\n        },\r\n\r\n        reset() {\r\n            _settings = getDefaults();\r\n            save(_settings);\r\n            this.apply();\r\n        },\r\n\r\n        apply() {\r\n            const root = document.documentElement;\r\n            const s = _settings;\r\n            const d = window.SITE_CONFIG?.defaults || {};\r\n\r\n            const vars = {\r\n                '--accent': s.accentColor || d.accentColor || '#ffffff',\r\n                '--surface': s.surfaceColor || d.surfaceColor || '#0f0f0f',\r\n                '--surface-hover': s.surfaceHoverColor || d.surfaceHoverColor || '#1a1a1a',\r\n                '--surface-active': s.surfaceActiveColor || d.surfaceActiveColor || '#252525',\r\n                '--secondary': s.secondaryColor || d.secondaryColor || '#2e2e33',\r\n                '--border': s.borderColor || d.borderColor || '#1f1f1f',\r\n                '--border-light': s.borderLightColor || d.borderLightColor || '#2a2a2a',\r\n                '--text': s.textColor || d.textColor || '#e4e4e7',\r\n                '--text-muted': s.textSecondaryColor || d.textSecondaryColor || '#71717a',\r\n                '--text-dim': s.textDimColor || d.textDimColor || '#52525b',\r\n                '--toggle': s.toggleColor || d.toggleColor,\r\n                '--toggle-knob': s.toggleKnobColor || d.toggleKnobColor\r\n            };\r\n\r\n            Object.entries(vars).forEach(([key, val]) => {\r\n                if (val) root.style.setProperty(key, val);\r\n            });\r\n\r\n            const themeBg = s.background || d.background || { type: 'color', value: '#0a0a0a' };\r\n            const customBg = s.customBackground;\r\n            const isCustomActive = customBg && customBg.type !== 'none';\r\n\r\n            if (themeBg.type === 'color') {\r\n                root.style.setProperty('--bg', themeBg.value);\r\n            }\r\n\r\n            if (isCustomActive && customBg.url) {\r\n                root.style.setProperty('--bg-image', `url(${customBg.url})`);\r\n\r\n                let position = customBg.objectPosition;\r\n                if (customBg.id && customBg.id !== 'custom') {\r\n                    const preset = window.SITE_CONFIG?.backgroundPresets?.find(b => b.id === customBg.id);\r\n                    if (preset?.objectPosition) position = preset.objectPosition;\r\n                }\r\n\r\n                root.style.setProperty('--bg-image-position', position || 'center');\r\n            } else if (themeBg.type === 'image' || themeBg.type === 'video') {\r\n                root.style.setProperty('--bg-image', `url(${themeBg.value || themeBg.url})`);\r\n                root.style.setProperty('--bg-image-position', themeBg.objectPosition || 'center');\r\n            } else if (themeBg.type === 'gradient') {\r\n                root.style.setProperty('--bg-image', themeBg.value || themeBg.url);\r\n                root.style.setProperty('--bg-image-position', 'center');\r\n            } else {\r\n                root.style.setProperty('--bg-image', 'none');\r\n            }\r\n        },\r\n\r\n        onChange(callback) {\r\n            window.addEventListener('settings-changed', (e) => callback(e.detail));\r\n        },\r\n\r\n        isRatingAllowed(rating) {\r\n            if (!rating || rating === 'NR' || rating === 'NC-17') return false;\r\n            const ratingOrder = ['G', 'PG', 'PG-13', 'R'];\r\n            const maxIndex = ratingOrder.indexOf(_settings.maxMovieRating);\r\n            const ratingIndex = ratingOrder.indexOf(rating);\r\n            return maxIndex !== -1 && ratingIndex !== -1 && ratingIndex <= maxIndex;\r\n        }\r\n    };\r\n\r\n    // panic button go brr\r\n    const handlePanic = (e) => {\r\n        const mods = _settings.panicModifiers || [];\r\n        const key = _settings.panicKey || 'x';\r\n\r\n        if (mods.includes('ctrl') !== e.ctrlKey) return;\r\n        if (mods.includes('shift') !== e.shiftKey) return;\r\n        if (mods.includes('alt') !== e.altKey) return;\r\n\r\n        if (e.key.toLowerCase() === key.toLowerCase()) {\r\n            e.preventDefault();\r\n            const overlayId = 'panic-overlay';\r\n            let overlay = window.parent?.document?.getElementById(overlayId) || document.getElementById(overlayId);\r\n\r\n            if (!overlay) {\r\n                overlay = document.createElement('div');\r\n                overlay.id = overlayId;\r\n                overlay.style.cssText = 'position:fixed;inset:0;background:white;z-index:99999;';\r\n                document.body.appendChild(overlay);\r\n            } else {\r\n                overlay.style.display = 'block';\r\n            }\r\n\r\n            window.location.replace(_settings.panicUrl || 'https://classroom.google.com');\r\n        }\r\n    };\r\n\r\n    const init = () => {\r\n        Settings.apply();\r\n\r\n        const featured = window.SITE_CONFIG?.featuredBackground;\r\n        const activePreset = window.SITE_CONFIG?.backgroundPresets?.find(p => p.active);\r\n\r\n        const target = activePreset || featured;\r\n\r\n        if (target?.id && target.id !== _settings.lastSeenFeatured) {\r\n            Settings.update({\r\n                customBackground: target,\r\n                lastSeenFeatured: target.id,\r\n                backgroundRotation: false\r\n            });\r\n        }\r\n\r\n        document.addEventListener('keydown', handlePanic, true);\r\n\r\n        window.addEventListener('storage', (e) => {\r\n            if (e.key === STORAGE_KEY) {\r\n                _settings = load();\r\n                Settings.apply();\r\n                window.dispatchEvent(new CustomEvent('settings-changed', { detail: _settings }));\r\n            }\r\n        });\r\n\r\n        window.addEventListener('message', (e) => {\r\n            if (e.data?.type === 'settings-update' || e.data === 'updateCloak') {\r\n                _settings = load();\r\n                Settings.apply();\r\n                window.dispatchEvent(new CustomEvent('settings-changed', { detail: _settings }));\r\n            }\r\n        });\r\n\r\n        window.addEventListener('beforeunload', (e) => {\r\n            if (document.getElementById('main-frame') && _settings.leaveConfirmation) {\r\n                e.preventDefault();\r\n                return e.returnValue = '';\r\n            }\r\n        });\r\n    };\r\n\r\n    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', init);\r\n    else init();\r\n})();\r\n\n</script>\r\n    <script>\n// background stuff\r\n(function () {\r\n    'use strict';\r\n\r\n    if (window.BackgroundManager) return;\r\n\r\n    const YOUTUBE_REGEX = /(?:youtube\\.com\\/watch\\?v=|youtu\\.be\\/|youtube\\.com\\/embed\\/)([a-zA-Z0-9_-]{11})/;\r\n\r\n    const BackgroundManager = {\r\n        container: null,\r\n        mediaLayer: null,\r\n        elements: { video: null, image: null, iframe: null },\r\n        current: { type: null, url: null },\r\n        cacheName: 'phantom-bg-cache-v2',\r\n\r\n        init() {\r\n            this.container = document.createElement('div');\r\n            this.container.className = 'phantom-background';\r\n            this.container.innerHTML = '<div class=\"phantom-background-overlay\"></div><div class=\"phantom-background-layer\"></div>';\r\n            this.mediaLayer = this.container.querySelector('.phantom-background-layer');\r\n            document.body.insertBefore(this.container, document.body.firstChild);\r\n\r\n            const apply = () => this.applyBackground();\r\n            window.addEventListener('settings-changed', apply);\r\n            window.addEventListener('storage', apply);\r\n            window.addEventListener('beforeunload', () => this.cleanup());\r\n            window.addEventListener('pagehide', () => this.cleanup());\r\n\r\n            document.addEventListener('visibilitychange', () => {\r\n                const video = this.elements.video;\r\n                if (!video) return;\r\n                if (document.hidden) video.pause();\r\n                else if (this.current.type === 'video') video.play().catch(() => { });\r\n            });\r\n\r\n            this.applyBackground();\r\n        },\r\n\r\n        applyBackground() {\r\n            if (!this.container) return; // Wait for init() to create the container\r\n\r\n            const s = window.Settings?.getAll() || {};\r\n            const custom = s.customBackground;\r\n            const theme = s.background || {};\r\n\r\n            let type = null, url = null, pos = null, overlay = 0.4;\r\n\r\n            if (custom && custom.type !== 'none') {\r\n                // Refresh from config if possible to get latest props like objectPosition\r\n                if (custom.id && custom.id !== 'custom') {\r\n                    const preset = window.SITE_CONFIG?.backgroundPresets?.find(b => b.id === custom.id);\r\n                    if (preset) Object.assign(custom, preset);\r\n                }\r\n                ({ type, url, objectPosition: pos, overlay = 0.4 } = custom);\r\n            } else if (theme.type === 'image' || theme.type === 'video' || theme.type === 'youtube') {\r\n                type = theme.type;\r\n                url = theme.value || theme.url;\r\n                pos = theme.objectPosition;\r\n                overlay = theme.overlay || 0.4;\r\n            }\r\n\r\n            document.documentElement.style.setProperty('--bg-overlay', overlay);\r\n\r\n            // Handle common positioning typos and normalize\r\n            if (pos && typeof pos === 'string') {\r\n                pos = pos.toLowerCase().trim()\r\n                    .replace(/\\s+/g, ' ') // Normalize multiple spaces\r\n                    .replace('topleft', 'top left')\r\n                    .replace('topright', 'top right')\r\n                    .replace('bottomleft', 'bottom left')\r\n                    .replace('bottomright', 'bottom right')\r\n                    .replace('centercenter', 'center')\r\n                    .replace('centerleft', 'center left')\r\n                    .replace('centerright', 'center right');\r\n            }\r\n\r\n            document.documentElement.style.setProperty('--bg-image-position', pos || 'center');\r\n\r\n            if (!type || !url) {\r\n                this.clear();\r\n                document.documentElement.style.backgroundColor = 'var(--bg)';\r\n                document.documentElement.style.setProperty('--bg-image-position', 'center');\r\n                return;\r\n            }\r\n            if (this.current.type === type && this.current.url === url) return;\r\n\r\n            this.current = { type, url };\r\n\r\n            if (type === 'video' || url.match(/\\.(mp4|webm|ogg|mov|m4v)$/i)) {\r\n                this.clearMedia();\r\n                this.createVideo(url, pos);\r\n                this.container.classList.add('active');\r\n                document.documentElement.classList.add('phantom-bg-active');\r\n                document.body.classList.add('phantom-bg-active');\r\n            } else if (type === 'youtube' || YOUTUBE_REGEX.test(url)) {\r\n                this.clearMedia();\r\n                this.createYouTube(url, pos);\r\n                this.container.classList.add('active');\r\n                document.documentElement.classList.add('phantom-bg-active');\r\n                document.body.classList.add('phantom-bg-active');\r\n            } else if (type === 'image') {\r\n                this.handleImageBackground(url, pos);\r\n            }\r\n        },\r\n\r\n        async getProxiedCachedUrl(url) {\r\n            // Local images don't need proxying\r\n            if (!url.startsWith('http') || url.includes(location.hostname)) return url;\r\n\r\n            // Try direct load first (faster)\r\n            try {\r\n                const directTest = await fetch(url, { method: 'HEAD', mode: 'cors' });\r\n                if (directTest.ok) return url;\r\n            } catch (e) {\r\n                // CORS blocked, need to proxy\r\n            }\r\n\r\n            // Wait for BareMux (max 500ms)\r\n            let retries = 0;\r\n            while (!window.BareMux && retries < 5) {\r\n                await new Promise(r => setTimeout(r, 100));\r\n                retries++;\r\n            }\r\n\r\n            if (!window.BareMux) {\r\n                console.warn(\"Background: BareMux not found, trying direct URL.\");\r\n                return url; // Try direct anyway\r\n            }\r\n\r\n            try {\r\n                const client = new window.BareMux.BareClient();\r\n                const response = await client.fetch(url);\r\n                if (!response.ok) throw new Error('Proxy fetch failed');\r\n\r\n                const blob = await response.blob();\r\n                return URL.createObjectURL(blob);\r\n            } catch (error) {\r\n                console.error(\"Background proxy failed:\", error);\r\n                return url; // Fallback to direct URL\r\n            }\r\n        },\r\n\r\n        async handleImageBackground(url, pos) {\r\n            // Pre-load the image (proxied/cached or direct)\r\n            const finalUrl = await this.getProxiedCachedUrl(url);\r\n\r\n            // Check if this is still the current background after async fetch\r\n            if (this.current.url !== url) {\r\n                if (finalUrl && finalUrl.startsWith('blob:')) URL.revokeObjectURL(finalUrl);\r\n                return;\r\n            }\r\n\r\n            this.clearMedia();\r\n            this.createImage(finalUrl, pos);\r\n        },\r\n\r\n        createVideo(url, pos) {\r\n            const el = Object.assign(document.createElement('video'), {\r\n                className: 'phantom-background-media', src: url, autoplay: true, loop: true, muted: true, playsInline: true, volume: 0\r\n            });\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n            el.onerror = () => (this.elements.video = null);\r\n            this.elements.video = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        createImage(url, pos) {\r\n            const el = Object.assign(document.createElement('img'), {\r\n                className: 'phantom-background-media',\r\n                src: url\r\n            });\r\n\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n\r\n            el.onload = () => {\r\n                if (this.current.url === url || url.startsWith('blob:')) {\r\n                    this.container.classList.add('active');\r\n                    document.documentElement.classList.add('phantom-bg-active');\r\n                    document.body.classList.add('phantom-bg-active');\r\n                }\r\n            };\r\n            el.onerror = () => {\r\n                console.warn(\"Background image failed to load:\", url);\r\n                if (this.elements.image === el) this.elements.image = null;\r\n            };\r\n\r\n            this.elements.image = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        // youtube logic\r\n        createYouTube(url, pos) {\r\n            const id = url.match(YOUTUBE_REGEX)?.[1];\r\n            if (!id) return;\r\n            const el = Object.assign(document.createElement('iframe'), {\r\n                className: 'phantom-background-media',\r\n                src: `https://www.youtube.com/embed/${id}?autoplay=1&loop=1&playlist=${id}&controls=0&modestbranding=1&rel=0&mute=1&enablejsapi=1`,\r\n                allow: 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture'\r\n            });\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n            this.elements.iframe = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        clearMedia() {\r\n            Object.entries(this.elements).forEach(([key, el]) => {\r\n                if (!el) return;\r\n                if (key === 'video') { el.pause(); el.src = ''; }\r\n                if (key === 'iframe') el.src = 'about:blank';\r\n                if (key === 'image' && el.src.startsWith('blob:')) {\r\n                    URL.revokeObjectURL(el.src);\r\n                }\r\n                el.remove();\r\n                this.elements[key] = null;\r\n            });\r\n        },\r\n\r\n        clear() {\r\n            this.clearMedia();\r\n            this.current = { type: null, url: null };\r\n            document.documentElement.classList.remove('phantom-bg-active');\r\n            document.body.classList.remove('phantom-bg-active');\r\n            document.documentElement.style.backgroundColor = '';\r\n            if (this.container) this.container.classList.remove('active');\r\n        },\r\n\r\n        cleanup() {\r\n            this.clearMedia();\r\n        }\r\n    };\r\n\r\n    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', () => BackgroundManager.init());\r\n    else BackgroundManager.init();\r\n\r\n    window.BackgroundManager = BackgroundManager;\r\n})();\r\n\n</script>\r\n    <script>\nwindow.Quotes = {\r\n    // Use data from config, fallback to empty array if not found\r\n    getData() {\r\n        return (window.SITE_CONFIG && window.SITE_CONFIG.quotes) || [];\r\n    },\r\n\r\n    getRandom() {\r\n        const data = this.getData();\r\n        if (!data.length) return null; // Return null if no quotes\r\n        return data[Math.floor(Math.random() * data.length)];\r\n    },\r\n    init(force = false) {\r\n        const quote = this.getRandom();\r\n        if (!quote) return; // Do nothing if no quotes\r\n\r\n        const targets = [\r\n            '#quote',\r\n            '#quote-display',\r\n            '#subtitle',\r\n            '.page-subtitle',\r\n            '.extra-hero p',\r\n            '.loading-text'\r\n        ];\r\n\r\n        targets.forEach(selector => {\r\n            document.querySelectorAll(selector).forEach(el => {\r\n                // Only update if force is true, or it's empty, or has placeholder text\r\n                const text = el.textContent.trim();\r\n                if (force || !text || text === 'Loading...' || text.includes('Stream movies') || text.includes('Customize your')) {\r\n                    el.textContent = quote;\r\n                }\r\n            });\r\n        });\r\n    }\r\n};\r\n\r\nwindow.QUOTES = window.Quotes.getData();\r\n\r\n// Run automatically on load\r\nif (document.readyState === 'loading') {\r\n    document.addEventListener('DOMContentLoaded', () => window.Quotes.init());\r\n} else {\r\n    window.Quotes.init();\r\n}\r\n\n</script>\r\n    <script>\nconst API_KEY = '2713804610e1e236b1cf44bfac3a7776';\r\nconst IMG_BASE = 'https://image.tmdb.org/t/p/w300';\r\n\r\nconst FEATURED = [{\r\n    id: 950779,\r\n    title: \"Five Nights at Freddy's\",\r\n    poster_path: \"/A4j8S6moJS2zNtRR8oWF08gRnL5.jpg\",\r\n    release_date: \"2023-10-25\",\r\n    vote_average: 7.6,\r\n    media_type: \"movie\",\r\n    overview: \"Recently fired and desperate for work, a troubled young man named Mike agrees to take a position as a night security guard at an abandoned theme restaurant: Freddy Fazbear's Pizzeria. But he soon discovers that nothing at Freddy's is what it seems.\"\r\n}, {\r\n    id: 1047585,\r\n    title: \"Five Nights at Freddy's 2\",\r\n    poster_path: \"/x0f24255a019409893902996.jpg\",\r\n    release_date: \"2025-12-05\",\r\n    vote_average: 0,\r\n    media_type: \"movie\",\r\n    overview: \"The sequel to the 2023 film Five Nights at Freddy's. (Coming Soon)\"\r\n}, {\r\n    id: 76600,\r\n    title: \"Avatar: The Way of Water\",\r\n    poster_path: \"/t6HIqrRAclMCA60NsSmeqe9RmNV.jpg\",\r\n    release_date: \"2022-12-14\",\r\n    vote_average: 7.7,\r\n    media_type: \"movie\",\r\n    overview: \"Set more than a decade after the events of the first film, learn the story of the Sully family (Jake, Neytiri, and their kids), the trouble that follows them, the lengths they go to keep each other safe, the battles they fight to stay alive, and the tragedies they endure.\"\r\n}, {\r\n    id: 677179,\r\n    title: \"Creed III\",\r\n    poster_path: \"/cvsXj3I9Q2iyyIo95AecSd1tad7.jpg\",\r\n    release_date: \"2023-03-01\",\r\n    vote_average: 7.2,\r\n    media_type: \"movie\",\r\n    overview: \"After dominating the boxing world, Adonis Creed has been thriving in both his career and family life. When a childhood friend and former boxing prodigy, Damian Anderson, resurfaces after serving a long sentence in prison, he is eager to prove that he deserves his shot in the ring.\"\r\n}, {\r\n    id: 361743,\r\n    title: \"Top Gun: Maverick\",\r\n    poster_path: \"/62HCnUTziyWcpDaBO2i1DX17ljH.jpg\",\r\n    release_date: \"2022-05-24\",\r\n    vote_average: 8.3,\r\n    media_type: \"movie\",\r\n    overview: \"After more than thirty years of service as one of the Navys top aviators, and dodging the advancement in rank that would ground him, Pete Maverick Mitchell finds himself training a detachment of TOP GUN graduates for a specialized mission the likes of which no living pilot has ever seen.\"\r\n}, {\r\n    id: 502356,\r\n    title: \"The Super Mario Bros. Movie\",\r\n    poster_path: \"/qNBAXBIQlnOThrVvA6mA2K5ggV6.jpg\",\r\n    release_date: \"2023-04-05\",\r\n    vote_average: 7.8,\r\n    media_type: \"movie\",\r\n    overview: \"While working underground to fix a water main, Brooklyn plumbersand brothersMario and Luigi are transported down a mysterious pipe and wander into a magical new world. But when the brothers are separated, Mario embarks on an epic quest to find Luigi.\"\r\n}, {\r\n    id: 693134,\r\n    title: \"Dune: Part Two\",\r\n    poster_path: \"/1pdfLvkbY9ohJlCjQH2CZjjYVvJ.jpg\",\r\n    release_date: \"2024-02-27\",\r\n    vote_average: 8.3,\r\n    media_type: \"movie\",\r\n    overview: \"Follow the mythic journey of Paul Atreides as he unites with Chani and the Fremen while on a warpath of revenge against the conspirators who destroyed his family.\"\r\n}, {\r\n    id: 872585,\r\n    title: \"Oppenheimer\",\r\n    poster_path: \"/8Gxv8gSFCU0XGDykEGv7zR1n2ua.jpg\",\r\n    release_date: \"2023-07-19\",\r\n    vote_average: 8.1,\r\n    media_type: \"movie\",\r\n    overview: \"The story of J. Robert Oppenheimer's role in the development of the atomic bomb during World War II.\"\r\n}, {\r\n    id: 569094,\r\n    title: \"Spider-Man: Across the Spider-Verse\",\r\n    poster_path: \"/8Vt6mWEReuy4Of61Lnj5Xj704m8.jpg\",\r\n    release_date: \"2023-05-31\",\r\n    vote_average: 8.4,\r\n    media_type: \"movie\",\r\n    overview: \"After reuniting with Gwen Stacy, Brooklyns full-time, friendly neighborhood Spider-Man is catapulted across the Multiverse, where he encounters the Spider Society, a team of Spider-People charged with protecting the Multiverses very existence.\"\r\n}, {\r\n    id: 157336,\r\n    title: \"Interstellar\",\r\n    poster_path: \"/gEU2QniL6C971PN62uvp2GMz5iH.jpg\",\r\n    release_date: \"2014-11-05\",\r\n    vote_average: 8.4,\r\n    media_type: \"movie\",\r\n    overview: \"The adventures of a group of explorers who make use of a newly discovered wormhole to surpass the limitations on human space travel and conquer the vast distances involved in an interstellar voyage.\"\r\n}, {\r\n    id: 299534,\r\n    title: \"Avengers: Endgame\",\r\n    poster_path: \"/or06FN3Dka5tukK1e9sl16pB3iy.jpg\",\r\n    release_date: \"2019-04-24\",\r\n    vote_average: 8.3,\r\n    media_type: \"movie\",\r\n    overview: \"After the devastating events of Infinity War, the universe is in ruins. With the help of remaining allies, the Avengers assemble once more in order to reverse Thanos' actions and restore balance to the universe.\"\r\n}, {\r\n    id: 496243,\r\n    title: \"Parasite\",\r\n    poster_path: \"/7IiTTgloJzvGI1TAYymC8urRhuB.jpg\",\r\n    release_date: \"2019-05-30\",\r\n    vote_average: 8.5,\r\n    media_type: \"movie\",\r\n    overview: \"All-unemployed Ki-taek's family takes peculiar interest in the wealthy and glamorous Parks for their livelihood until they get entangled in an unexpected incident.\"\r\n}, {\r\n    id: 27205,\r\n    title: \"Inception\",\r\n    poster_path: \"/oYuLEt3zVCKqJCZVPr6QqXV6An5.jpg\",\r\n    release_date: \"2010-07-15\",\r\n    vote_average: 8.4,\r\n    media_type: \"movie\",\r\n    overview: \"Cobb, a skilled thief who commits corporate espionage by infiltrating the subconscious of his targets is offered a chance to regain his old life as payment for a task considered to be impossible: \\\"inception\\\", the implantation of another person's idea into a target's subconscious.\"\r\n}, {\r\n    id: 155,\r\n    title: \"The Dark Knight\",\r\n    poster_path: \"/qJ2tW6WMUDux911r6m7haRef0WH.jpg\",\r\n    release_date: \"2008-07-14\",\r\n    vote_average: 8.5,\r\n    media_type: \"movie\",\r\n    overview: \"Batman raises the stakes in his war on crime. With the help of Lt. Jim Gordon and District Attorney Harvey Dent, Batman sets out to dismantle the remaining criminal organizations that plague the streets. The partnership proves to be effective, but they soon find themselves prey to a reign of chaos unleashed by a rising criminal mastermind known to the terrified citizens of Gotham as the Joker.\"\r\n}, {\r\n    id: 634649,\r\n    title: \"Spider-Man: No Way Home\",\r\n    poster_path: \"/1g0dhYtq4irTY1GPXvft6k4YLjm.jpg\",\r\n    release_date: \"2021-12-15\",\r\n    vote_average: 8.0,\r\n    media_type: \"movie\",\r\n    overview: \"Peter Parker is unmasked and no longer able to separate his normal life from the high-stakes of being a super-hero. When he asks for help from Doctor Strange the stakes become even more dangerous, forcing him to discover what it truly means to be Spider-Man.\"\r\n}, {\r\n    id: 763215,\r\n    title: \"Damsel\",\r\n    poster_path: \"/sMp34cNKjIb18JkPriu42ShF7qO.jpg\",\r\n    release_date: \"2024-03-08\",\r\n    vote_average: 7.2,\r\n    media_type: \"movie\",\r\n    overview: \"A young woman's marriage to a charming prince turns into a fierce fight for survival when she is offered up as a sacrifice to a fire-breathing dragon.\"\r\n}, {\r\n    id: 603,\r\n    title: \"The Matrix\",\r\n    poster_path: \"/f89U3ADr1oiB1s9GkdPOEpXUk5H.jpg\",\r\n    release_date: \"1999-03-30\",\r\n    vote_average: 8.2,\r\n    media_type: \"movie\",\r\n    overview: \"Set in the 22nd century, The Matrix tells the story of a computer hacker who joins a group of underground insurgents fighting the vast and powerful computers who now rule the earth.\"\r\n}, {\r\n    id: 671,\r\n    title: \"Harry Potter and the Sorcerer's Stone\",\r\n    poster_path: \"/wuMc08IPKEatf9rnMNXvIDxqP4W.jpg\",\r\n    release_date: \"2001-11-16\",\r\n    vote_average: 7.9,\r\n    media_type: \"movie\",\r\n    overview: \"Harry Potter has lived under the stairs at his aunt and uncle's house his whole life. But on his 11th birthday, he learns he's a powerful wizard -- with a place waiting for him at the Hogwarts School of Witchcraft and Wizardry. As he learns to harness his newfound powers with the help of the school's kindly headmaster, Harry uncovers the truth about his parents' deaths -- and about the villain who's to blame.\"\r\n}, {\r\n    id: 954,\r\n    title: \"Mission: Impossible - Dead Reckoning Part One\",\r\n    poster_path: \"/NNxYkU70HPurnNCSiCjYAmacwm.jpg\",\r\n    release_date: \"2023-07-08\",\r\n    vote_average: 7.6,\r\n    media_type: \"movie\",\r\n    overview: \"Ethan Hunt and his IMF team embark on their most dangerous mission yet: To track down a terrifying new weapon that threatens all of humanity before it falls into the wrong hands.\"\r\n}, {\r\n    id: 385687,\r\n    title: \"Fast X\",\r\n    poster_path: \"/fiVW06jE7z9YnO4trhaMEdclSiC.jpg\",\r\n    release_date: \"2023-05-17\",\r\n    vote_average: 7.2,\r\n    media_type: \"movie\",\r\n    overview: \"Over many missions and against impossible odds, Dom Toretto and his family have outsmarted, out-nerved and outdriven every foe in their path. Now, they confront the most lethal opponent they've ever faced: A terrifying threat emerging from the shadows of the past who's fueled by blood revenge, and who is determined to shatter this family and destroy everythingand everyonethat Dom loves, forever.\"\r\n}, {\r\n    id: 453395,\r\n    title: \"Doctor Strange in the Multiverse of Madness\",\r\n    poster_path: \"/9Gtg2DzBhmYamXBS1hKAhiwbBKS.jpg\",\r\n    release_date: \"2022-05-04\",\r\n    vote_average: 7.4,\r\n    media_type: \"movie\",\r\n    overview: \"Doctor Strange, with the help of mystical allies both old and new, traverses the mind-bending and dangerous alternate realities of the Multiverse to confront a mysterious new adversary.\"\r\n}, {\r\n    id: 414906,\r\n    title: \"The Batman\",\r\n    poster_path: \"/74xTEgt7R36Fpooo50x9TfdLn74.jpg\",\r\n    release_date: \"2022-03-01\",\r\n    vote_average: 7.7,\r\n    media_type: \"movie\",\r\n    overview: \"In his second year of fighting crime, Batman uncovers corruption in Gotham City that connects to his own family while facing a serial killer known as the Riddler.\"\r\n}, {\r\n    id: 505642,\r\n    title: \"Black Panther: Wakanda Forever\",\r\n    poster_path: \"/sv1xJUazXeYqALzczSZ3O6nkH75.jpg\",\r\n    release_date: \"2022-11-09\",\r\n    vote_average: 7.2,\r\n    media_type: \"movie\",\r\n    overview: \"Queen Ramonda, Shuri, MBaku, Okoye and the Dora Milaje fight to protect their nation from intervening world powers in the wake of King TChallas death.\"\r\n}, {\r\n    id: 436270,\r\n    title: \"Black Adam\",\r\n    poster_path: \"/pFlaoHTZeyNkG83vxsAJiGzfSsa.jpg\",\r\n    release_date: \"2022-10-19\",\r\n    vote_average: 7.1,\r\n    media_type: \"movie\",\r\n    overview: \"Nearly 5,000 years after he was bested on himself the almighty powers of the Egyptian godsand imprisoned just as quicklyBlack Adam is freed from his earthly tomb, ready to unleash his unique form of justice on the modern world.\"\r\n}, {\r\n    id: 335787,\r\n    title: \"Uncharted\",\r\n    poster_path: \"/rJHC1RUORuUhtf06xptQlhaUDh6.jpg\",\r\n    release_date: \"2022-02-10\",\r\n    vote_average: 7.0,\r\n    media_type: \"movie\",\r\n    overview: \"A young street-smart, Nathan Drake and his wisecracking partner Victor Sully Sullivan embark on a dangerous pursuit of the greatest treasure never found while also tracking clues that may lead to Nathans long-lost brother.\"\r\n}, {\r\n    id: 1011985,\r\n    title: \"Kung Fu Panda 4\",\r\n    poster_path: \"/kDp1vUBnMpe8ak4rjgl3cLELqjU.jpg\",\r\n    release_date: \"2024-03-02\",\r\n    vote_average: 7.6,\r\n    media_type: \"movie\",\r\n    overview: \"Po is gearing up to become the spiritual leader of his Valley of Peace, but also needs someone to take his place as Dragon Warrior. As such, he will train a new kung fu practitioner for the spot and will encounter a villain called the Chameleon who conjures villains from the past.\"\r\n}, {\r\n    id: 934632,\r\n    title: \"Rebel Moon - Part Two: The Scargiver\",\r\n    poster_path: \"/cxevDYdeFkiixRShbObdwAHBZry.jpg\",\r\n    release_date: \"2024-04-19\",\r\n    vote_average: 6.8,\r\n    media_type: \"movie\",\r\n    overview: \"The rebels gear up for battle against the ruthless forces of the Motherworld as unbreakable bonds are forged, heroes emerge  and legends are made.\"\r\n}, {\r\n    id: 823464,\r\n    title: \"Godzilla x Kong: The New Empire\",\r\n    poster_path: \"/tMefBSflv6PGmWv7PVOed9AQhtd.jpg\",\r\n    release_date: \"2024-03-27\",\r\n    vote_average: 7.2,\r\n    media_type: \"movie\",\r\n    overview: \"Following their explosive showdown, Godzilla and Kong must reunite against a colossal undiscovered threat hidden within our world, challenging their very existence  and our own.\"\r\n}, {\r\n    id: 609681,\r\n    title: \"The Marvels\",\r\n    poster_path: \"/9GBhzXMFjgcZ3FdR9w3bUMMTx5d.jpg\",\r\n    release_date: \"2023-11-08\",\r\n    vote_average: 6.3,\r\n    media_type: \"movie\",\r\n    overview: \"Carol Danvers, aka Captain Marvel, has reclaimed her identity from the tyrannical Kree and taken revenge on the Supreme Intelligence. But unintended consequences see Carol shouldering the burden of a destabilized universe. When her duties send her to an anomalous wormhole linked to a Kree revolutionary, her powers become entangled with that of Jersey City super-fan Kamala Khan, aka Ms. Marvel, and Carols estranged niece, now S.A.B.E.R. astronaut Captain Monica Rambeau. Together, this unlikely trio must team up and learn to work in concert to save the universe.\"\r\n}, {\r\n    id: 787699,\r\n    title: \"Wonka\",\r\n    poster_path: \"/qhb1qOilapbapxWQn9jtRCMwXJF.jpg\",\r\n    release_date: \"2023-12-06\",\r\n    vote_average: 7.2,\r\n    media_type: \"movie\",\r\n    overview: \"Willy Wonka  chock-full of ideas and determined to change the world one delectable bite at a time  is proof that the best things in life begin with a dream, and if youre lucky enough to meet Willy Wonka, anything is possible.\"\r\n}, {\r\n    id: 346698,\r\n    title: \"Barbie\",\r\n    poster_path: \"/iuFNMS8U5cb6xfzi51QaajTrKB.jpg\",\r\n    release_date: \"2023-07-19\",\r\n    vote_average: 7.1,\r\n    media_type: \"movie\",\r\n    overview: \"Barbie and Ken are having the time of their lives in the colorful and seemingly perfect world of Barbie Land. However, when they get a chance to go to the real world, they soon discover the joys and perils of living among humans.\"\r\n}, {\r\n    id: 447365,\r\n    title: \"Guardians of the Galaxy Vol. 3\",\r\n    poster_path: \"/r2J02Z2OpNTctfOSN1Ydgii51I3.jpg\",\r\n    release_date: \"2023-05-03\",\r\n    vote_average: 8.0,\r\n    media_type: \"movie\",\r\n    overview: \"Peter Quill, still reeling from the loss of Gamora, must rally his team around him to defend the universe along with protecting one of their own. A mission that, if not completed successfully, could quite possibly lead to the end of the Guardians as we know them.\"\r\n}, {\r\n    id: 603692,\r\n    title: \"John Wick: Chapter 4\",\r\n    poster_path: \"/vZloFAK7NmvMGKE7VkF5UPurDq.jpg\",\r\n    release_date: \"2023-03-22\",\r\n    vote_average: 7.8,\r\n    media_type: \"movie\",\r\n    overview: \"With the price on his head ever increasing, John Wick uncovers a path to defeating The High Table. But before he can earn his freedom, Wick must face off against a new enemy with powerful alliances across the globe and forces that turn old friends into foes.\"\r\n}, {\r\n    id: 475557,\r\n    title: \"Joker\",\r\n    poster_path: \"/udDclJoHjfjb8Ekgsd4FDteOkCU.jpg\",\r\n    release_date: \"2019-10-02\",\r\n    vote_average: 8.2,\r\n    media_type: \"movie\",\r\n    overview: \"During the 1980s, a failed stand-up comedian is driven insane and turns to a life of crime and chaos in Gotham City while becoming an infamous psychopathic crime figure.\"\r\n}, {\r\n    id: 1726,\r\n    title: \"Iron Man\",\r\n    poster_path: \"/78lPtwv72eTNqFW9COBYI0dWDJa.jpg\",\r\n    release_date: \"2008-04-30\",\r\n    vote_average: 7.6,\r\n    media_type: \"movie\",\r\n    overview: \"After being held captive in an Afghan cave, billionaire engineer Tony Stark creates a unique weaponized suit of armor to fight evil.\"\r\n}, {\r\n    id: 299536,\r\n    title: \"Avengers: Infinity War\",\r\n    poster_path: \"/7WsyChQLEftFiDOVTGkv3hFpyyt.jpg\",\r\n    release_date: \"2018-04-25\",\r\n    vote_average: 8.3,\r\n    media_type: \"movie\",\r\n    overview: \"As the Avengers and their allies have continued to protect the world from threats too large for any one hero to handle, a new danger has emerged from the cosmic shadows: Thanos.\"\r\n}, {\r\n    id: 284054,\r\n    title: \"Black Panther\",\r\n    poster_path: \"/uxzzxijgPIY7slzFvMotPv8wjKA.jpg\",\r\n    release_date: \"2018-02-13\",\r\n    vote_average: 7.4,\r\n    media_type: \"movie\",\r\n    overview: \"King T'Challa returns home to the reclusive, technologically advanced African nation of Wakanda to serve as his country's new leader. However, T'Challa soon finds that he is challenged for the throne from factions within his own country.\"\r\n}, {\r\n    id: 293660,\r\n    title: \"Deadpool\",\r\n    poster_path: \"/fSRb7vyIP8rQpL0I47P3qUsEKX3.jpg\",\r\n    release_date: \"2016-02-09\",\r\n    vote_average: 7.6,\r\n    media_type: \"movie\",\r\n    overview: \"The origin story of former Special Forces operative turned mercenary Wade Wilson, who, after being subjected to a rogue experiment that leaves him with accelerated healing powers, adopts the alter ego Deadpool.\"\r\n}, {\r\n    id: 263115,\r\n    title: \"Logan\",\r\n    poster_path: \"/fnbjc3A4U7j9PMdcsf7pixjA4ola.jpg\",\r\n    release_date: \"2017-02-28\",\r\n    vote_average: 7.8,\r\n    media_type: \"movie\",\r\n    overview: \"In the near future, a weary Logan cares for an ailing Professor X in a hideout on the Mexican border. But Logan's attempts to hide from the world and his legacy are upended when a young mutant arrives, pursued by dark forces.\"\r\n}, {\r\n    id: 118340,\r\n    title: \"Guardians of the Galaxy\",\r\n    poster_path: \"/r7vmZjiyZw9rpJMQJdXpJLS1YEX.jpg\",\r\n    release_date: \"2014-07-30\",\r\n    vote_average: 7.9,\r\n    media_type: \"movie\",\r\n    overview: \"Light years from Earth, 26 years after being abducted, Peter Quill finds himself the prime target of a manhunt after discovering an orb wanted by Ronan the Accuser.\"\r\n}, {\r\n    id: 284053,\r\n    title: \"Thor: Ragnarok\",\r\n    poster_path: \"/rzRwTcFvttcN1ZpX2xv4j3tSdJu.jpg\",\r\n    release_date: \"2017-10-25\",\r\n    vote_average: 7.6,\r\n    media_type: \"movie\",\r\n    overview: \"Thor is imprisoned on the other side of the universe without his mighty hammer and finds himself in a race against time to get back to Asgard to stop Ragnarok  the destruction of his homeworld and the end of Asgardian civilization.\"\r\n}, {\r\n    id: 271110,\r\n    title: \"Captain America: Civil War\",\r\n    poster_path: \"/rAGiXaUfPzY7CDEyNKUofk3Kw2e.jpg\",\r\n    release_date: \"2016-04-27\",\r\n    vote_average: 7.4,\r\n    media_type: \"movie\",\r\n    overview: \"Following the events of Age of Ultron, the collective governments of the world pass an act designed to regulate all superhuman activity. This polarizes opinion amongst the Avengers, causing two factions to side with Iron Man or Captain America, which causes an epic battle between former allies.\"\r\n}, {\r\n    id: 168259,\r\n    title: \"Furious 7\",\r\n    poster_path: \"/kto85hwb85Op8uFz5U4K5f4c4Ie.jpg\",\r\n    release_date: \"2015-04-01\",\r\n    vote_average: 7.2,\r\n    media_type: \"movie\",\r\n    overview: \"Deckard Shaw seeks revenge against Dominic Toretto and his family for his comatose brother.\"\r\n}, {\r\n    id: 519182,\r\n    title: \"Despicable Me 4\",\r\n    poster_path: \"/wWba3TaojhK7Ndyc1Q959b7mM02.jpg\",\r\n    release_date: \"2024-07-03\",\r\n    vote_average: 7.3,\r\n    media_type: \"movie\",\r\n    overview: \"Gru and Lucy and their girlsMargo, Edith and Agneswelcome a new member to the Gru family, Gru Jr., who is intent on tormenting his dad. Gru also faces a new nemesis in Maxime Le Mal and his femme fatale girlfriend Valentina, forcing the family to go on the run.\"\r\n}, {\r\n    id: 1022789,\r\n    title: \"Inside Out 2\",\r\n    poster_path: \"/vpnVM9B6NMmQpWeZvzLvDESb2QY.jpg\",\r\n    release_date: \"2024-06-12\",\r\n    vote_average: 7.7,\r\n    media_type: \"movie\",\r\n    overview: \"Teenager Riley's mind headquarters is undergoing a sudden demolition to make room for something entirely unexpected: new Emotions! Joy, Sadness, Anger, Fear and Disgust, whove long been running a successful operation by all accounts, arent sure how to feel when Anxiety shows up. And it looks like shes not alone.\"\r\n}, {\r\n    id: 746036,\r\n    title: \"The Fall Guy\",\r\n    poster_path: \"/tSz1qsmSJon0rqnHBxXZm ROTW2f.jpg\",\r\n    release_date: \"2024-04-24\",\r\n    vote_average: 7.3,\r\n    media_type: \"movie\",\r\n    overview: \"Fresh off an almost career-ending accident, stuntman Colt Seavers has to track down a missing movie star, solve a conspiracy and try to win back the love of his life while still doing his day job.\"\r\n}, {\r\n    id: 653346,\r\n    title: \"Kingdom of the Planet of the Apes\",\r\n    poster_path: \"/gKkl37BQuKTanygYQG1pyYgLVgf.jpg\",\r\n    release_date: \"2024-05-08\",\r\n    vote_average: 7.1,\r\n    media_type: \"movie\",\r\n    overview: \"Several generations in the future following Caesar's reign, in which apes are the dominant species living harmoniously and humans have been reduced to living in the shadows. As a new tyrannical ape leader builds his empire, one young ape undertakes a harrowing journey that will cause him to question all that he has known about the past and to make choices that will define a future for apes and humans alike.\"\r\n}, {\r\n    id: 1011985,\r\n    title: \"Kung Fu Panda 4\",\r\n    poster_path: \"/kDp1vUBnMpe8ak4rjgl3cLELqjU.jpg\",\r\n    release_date: \"2024-03-02\",\r\n    vote_average: 7.1,\r\n    media_type: \"movie\",\r\n    overview: \"Po is gearing up to become the spiritual leader of his Valley of Peace, but also needs someone to take his place as Dragon Warrior. As such, he will train a new kung fu practitioner for the spot and will encounter a villain called the Chameleon who conjures villains from the past.\"\r\n}, {\r\n    id: 969492,\r\n    title: \"Land of Bad\",\r\n    poster_path: \"/h3jYanWMEJq6JJsCopy1h7cT2Hs.jpg\",\r\n    release_date: \"2024-02-16\",\r\n    vote_average: 7.1,\r\n    media_type: \"movie\",\r\n    overview: \"When a Delta Force special ops mission goes terribly wrong, Air Force drone pilot Reaper has 48 hours to remedy what has devolved into a wild rescue operation. With no weapons and no communication other than the drone above, the ground mission becomes a full-scale battle when the team is discovered by the enemy.\"\r\n}, {\r\n    id: 933131,\r\n    title: \"Godzilla Minus One\",\r\n    poster_path: \"/hkxxMIGaiCTmrEArK7J92JkKN0X.jpg\",\r\n    release_date: \"2023-11-03\",\r\n    vote_average: 7.8,\r\n    media_type: \"movie\",\r\n    overview: \"In postwar Japan, Godzilla brings new devastation to an already scorched landscape. With no military intervention or government help in sight, the survivors must join together to fight back against the nuclear behemoth.\"\r\n}, {\r\n    id: 35941,\r\n    title: \"Terminator 2: Judgment Day\",\r\n    poster_path: \"/5M0j0B18abtBI5Tf7ACxMnMw52Q.jpg\",\r\n    release_date: \"1991-07-03\",\r\n    vote_average: 8.1,\r\n    media_type: \"movie\",\r\n    overview: \"Nearly 10 years have passed since Sarah Connor was targeted for termination by a cyborg from the future. Now her son, John, the future leader of the resistance, is the target for a newer, more deadly terminator. Once again, the resistance has managed to send a protector back to attempt to save John and his mother Sarah.\"\r\n}, {\r\n    id: 792307,\r\n    title: \"Poor Things\",\r\n    poster_path: \"/kCGlIMHnOm8JPXq3rXM6c5wMxcT.jpg\",\r\n    release_date: \"2023-12-07\",\r\n    vote_average: 7.8,\r\n    media_type: \"movie\",\r\n    overview: \"Brought back to life by an unorthodox scientist, a young woman runs off with a lawyer on a whirlwind adventure across the continents. Free from the prejudices of her times, she grows steadfast in her purpose to stand for equality and liberation.\"\r\n}, {\r\n    id: 609681,\r\n    title: \"The Marvels\",\r\n    poster_path: \"/9GBhzXMFjgcZ3FdR9w3bUMMTx5d.jpg\",\r\n    release_date: \"2023-11-08\",\r\n    vote_average: 6.2,\r\n    media_type: \"movie\",\r\n    overview: \"Carol Danvers, aka Captain Marvel, has reclaimed her identity from the tyrannical Kree and taken revenge on the Supreme Intelligence. But unintended consequences see Carol shouldering the burden of a destabilized universe. When her duties send her to an anomalous wormhole linked to a Kree revolutionary, her powers become entangled with that of Jersey City super-fan Kamala Khan, aka Ms. Marvel, and Carols estranged niece, now S.A.B.E.R. astronaut Captain Monica Rambeau. Together, this unlikely trio must team up and learn to work in concert to save the universe.\"\r\n}, {\r\n    id: 572802,\r\n    title: \"Aquaman and the Lost Kingdom\",\r\n    poster_path: \"/7lTnXOy0iNtBAdRP3TZvaKJ77F6.jpg\",\r\n    release_date: \"2023-12-20\",\r\n    vote_average: 6.8,\r\n    media_type: \"movie\",\r\n    overview: \"Black Manta seeks revenge on Aquaman for his father's death. Wielding the Black Trident power, he becomes a formidable foe. To defend Atlantis, Aquaman forges an alliance with his imprisoned brother. They must protect the kingdom.\"\r\n}, {\r\n    id: 46648,\r\n    title: \"True Grit\",\r\n    poster_path: \"/tF7M5m8303j55Z74L2Y7FfwjAAK.jpg\",\r\n    release_date: \"2010-12-22\",\r\n    vote_average: 7.4,\r\n    media_type: \"movie\",\r\n    overview: \"Following the murder of her father by hired hand Tom Chaney, 14-year-old farm girl Mattie Ross sets out to capture the killer. To aid her, she hires the toughest U.S. marshal she can find, a man with 'true grit,' Reuben J. 'Rooster' Cogburn.\"\r\n}, {\r\n    id: 24428,\r\n    title: \"The Avengers\",\r\n    poster_path: \"/RYMX2wcKCBAr24UyPD7xwmjaTn.jpg\",\r\n    release_date: \"2012-04-25\",\r\n    vote_average: 7.7,\r\n    media_type: \"movie\",\r\n    overview: \"When an unexpected enemy emerges and threatens global safety and security, Nick Fury, director of the international peacekeeping agency known as S.H.I.E.L.D., finds himself in need of a team to pull the world back from the brink of disaster. Spanning the globe, a daring recruitment effort begins!\"\r\n}, {\r\n    id: 1891,\r\n    title: \"The Empire Strikes Back\",\r\n    poster_path: \"/nNAeTmF4CtdSKOQIhfHYSCJOjX.jpg\",\r\n    release_date: \"1980-05-20\",\r\n    vote_average: 8.4,\r\n    media_type: \"movie\",\r\n    overview: \"The epic saga continues as Luke Skywalker, in hopes of defeating the evil Galactic Empire, learns the ways of the Jedi from aging master Yoda. But Darth Vader is more determined than ever to capture Luke. Meanwhile, rebel leader Princess Leia, cocky Han Solo, Chewbacca, and droids C-3PO and R2-D2 are thrown into various stages of capture, betrayal and despair.\"\r\n}];\r\n\r\nlet currentTab = 'movies';\r\nlet currentCategory = 'featured';\r\nlet currentGenreId = '';\r\nlet currentPage = 1;\r\nlet isLoading = false;\r\nlet currentShow = null;\r\n\r\nconst grid = document.getElementById('media-grid');\r\nconst searchInput = document.getElementById('search-input');\r\nconst suggestions = document.getElementById('suggestions');\r\n\r\n// init\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n    if (!grid) return;\r\n\r\n    loadGenres();\r\n    loadMedia();\r\n\r\n    document.getElementById('movies-tab').onclick = () => switchTab('movies');\r\n    document.getElementById('tv-tab').onclick = () => switchTab('tv');\r\n\r\n    document.querySelectorAll('.category-pill').forEach(btn => {\r\n        btn.onclick = () => {\r\n            document.querySelectorAll('.category-pill').forEach(b => b.classList.remove('active'));\r\n            btn.classList.add('active');\r\n            currentCategory = btn.dataset.cat;\r\n            currentGenreId = '';\r\n            const genreSelect = document.getElementById('genre-select');\r\n            if (genreSelect) genreSelect.value = '';\r\n            currentPage = 1;\r\n            loadMedia();\r\n        };\r\n    });\r\n\r\n    const loadMoreBtn = document.getElementById('load-more-btn');\r\n    if (loadMoreBtn) loadMoreBtn.onclick = () => {\r\n        currentPage++;\r\n        loadMedia(currentPage, true);\r\n    };\r\n\r\n    const genreSelect = document.getElementById('genre-select');\r\n    if (genreSelect) genreSelect.onchange = (e) => {\r\n        currentGenreId = e.target.value;\r\n        currentCategory = currentGenreId ? 'genre' : 'featured';\r\n        if (!currentGenreId) document.querySelector('.category-pill[data-cat=\"featured\"]').classList.add('active');\r\n        else document.querySelectorAll('.category-pill').forEach(b => b.classList.remove('active'));\r\n        currentPage = 1;\r\n        loadMedia();\r\n    };\r\n\r\n    let searchTimer;\r\n    if (searchInput) {\r\n        searchInput.oninput = () => {\r\n            clearTimeout(searchTimer);\r\n            searchTimer = setTimeout(searchMedia, 300);\r\n        };\r\n        document.onclick = (e) => {\r\n            if (!searchInput.parentElement.contains(e.target)) suggestions?.classList.remove('show');\r\n        };\r\n    }\r\n\r\n    // Help notification\r\n    setTimeout(() => {\r\n        if (window.Notify) {\r\n            Notify.info(\"Can't find a movie?\", \"Try using genres to browse the collection!\", 6000);\r\n        }\r\n    }, 15000);\r\n});\r\n\r\nfunction switchTab(tab) {\r\n    if (currentTab === tab) return;\r\n    currentTab = tab;\r\n    document.getElementById('movies-tab').classList.toggle('active', tab === 'movies');\r\n    document.getElementById('tv-tab').classList.toggle('active', tab === 'tv');\r\n    loadGenres();\r\n    currentPage = 1;\r\n    loadMedia();\r\n}\r\n\r\nasync function loadGenres() {\r\n    const type = currentTab === 'movies' ? 'movie' : 'tv';\r\n    const select = document.getElementById('genre-select');\r\n    if (!select) return;\r\n\r\n    try {\r\n        const res = await fetch(`https://api.themoviedb.org/3/genre/${type}/list?api_key=${API_KEY}`);\r\n        const data = await res.json();\r\n        select.innerHTML = '<option value=\"\">All Genres</option>' +\r\n            data.genres.map(g => `<option value=\"${g.id}\">${g.name}</option>`).join('');\r\n    } catch (e) { console.error(e); }\r\n}\r\n\r\nasync function loadMedia(page = 1, append = false) {\r\n    if (isLoading) return;\r\n    isLoading = true;\r\n\r\n    if (!append) grid.innerHTML = Array(12).fill('<div class=\"media-card\"><div class=\"skeleton\"></div></div>').join('');\r\n    else document.querySelector('.load-more-card')?.remove();\r\n\r\n    try {\r\n        let results = [];\r\n        let hasNext = false;\r\n\r\n        if (currentCategory === 'featured' && !currentGenreId && page === 1) {\r\n            results = [...FEATURED];\r\n        } else {\r\n            const type = currentTab === 'movies' ? 'movie' : 'tv';\r\n            const base = `https://api.themoviedb.org/3`;\r\n            let url = `${base}/discover/${type}?api_key=${API_KEY}&page=${page}&vote_count.gte=100&sort_by=popularity.desc`;\r\n\r\n            if (currentGenreId) url += `&with_genres=${currentGenreId}`;\r\n            else if (currentCategory === 'popular') url = `${base}/${type}/popular?api_key=${API_KEY}&page=${page}`;\r\n            else if (currentCategory === 'top_rated') url = `${base}/${type}/top_rated?api_key=${API_KEY}&page=${page}`;\r\n            else if (currentCategory === 'upcoming' && type === 'movie') url = `${base}/movie/upcoming?api_key=${API_KEY}&page=${page}`;\r\n\r\n            const res = await fetch(url);\r\n            const data = await res.json();\r\n            results = data.results;\r\n            hasNext = data.page < data.total_pages;\r\n        }\r\n\r\n        renderGrid(results, append, hasNext);\r\n    } catch (e) {\r\n        console.error(e);\r\n        if (!append) grid.innerHTML = '<div class=\"error-msg\">Failed to load content.</div>';\r\n    } finally {\r\n        isLoading = false;\r\n    }\r\n}\r\n\r\nfunction renderGrid(items, append = false, showLoadMore = false) {\r\n    if (!append) grid.innerHTML = '';\r\n\r\n    items.filter(m => m.poster_path).forEach(item => {\r\n        const card = document.createElement('div');\r\n        card.className = 'media-card';\r\n        const title = item.title || item.name;\r\n        const year = (item.release_date || item.first_air_date || '').split('-')[0];\r\n\r\n        card.innerHTML = `\r\n            <img src=\"${IMG_BASE}${item.poster_path}\" loading=\"lazy\" alt=\"${title}\">\r\n            <div class=\"media-card-overlay\">\r\n                <div class=\"media-card-overview\">${item.overview || ''}</div>\r\n                <div class=\"media-card-info\">\r\n                    <div class=\"media-card-title\">${title}</div>\r\n                    <div class=\"media-card-meta\">${year}</div>\r\n                </div>\r\n            </div>\r\n            ${item.vote_average ? `<div class=\"media-card-rating\">${item.vote_average.toFixed(1)}/10</div>` : ''}\r\n        `;\r\n\r\n        card.onclick = () => {\r\n            if (currentTab === 'tv' || item.media_type === 'tv') openSeasonExplorer(item);\r\n            else playMedia(item, 'movie');\r\n        };\r\n        grid.appendChild(card);\r\n    });\r\n\r\n    if (showLoadMore) {\r\n        const more = document.createElement('div');\r\n        more.className = 'media-card load-more-card';\r\n        more.innerHTML = '<div class=\"load-more-content\"><i class=\"fa-solid fa-plus\"></i><span>Load More</span></div>';\r\n        more.onclick = () => { currentPage++; loadMedia(currentPage, true); };\r\n        grid.appendChild(more);\r\n    }\r\n}\r\n\r\nfunction playMedia(item, type) {\r\n    const params = new URLSearchParams({\r\n        type,\r\n        id: item.id,\r\n        title: item.title || item.name\r\n    });\r\n    if (type === 'tv') {\r\n        params.append('season', item.season || 1);\r\n        params.append('episode', item.episode || 1);\r\n    }\r\n    sessionStorage.setItem('currentMovie', JSON.stringify(item));\r\n    window.location.href = `player.html?${params.toString()}`;\r\n}\r\n\r\nasync function searchMedia() {\r\n    const query = searchInput.value.trim();\r\n    if (query.length < 2) { suggestions?.classList.remove('show'); return; }\r\n\r\n    try {\r\n        const res = await fetch(`https://api.themoviedb.org/3/search/multi?api_key=${API_KEY}&query=${encodeURIComponent(query)}`);\r\n        const data = await res.json();\r\n        const results = data.results.filter(r => (r.media_type === 'movie' || r.media_type === 'tv') && r.poster_path).slice(0, 6);\r\n\r\n        if (suggestions) {\r\n            suggestions.innerHTML = results.map(item => `\r\n                <div class=\"suggestion-item\" onclick=\"handleSuggestionClick(${item.id}, '${item.media_type}')\">\r\n                    <img src=\"${IMG_BASE}${item.poster_path}\">\r\n                    <div class=\"suggestion-info\">\r\n                        <div class=\"suggestion-title\">${item.title || item.name}</div>\r\n                        <div class=\"suggestion-meta\">${item.media_type.toUpperCase()}  ${(item.release_date || item.first_air_date || '').split('-')[0]}</div>\r\n                    </div>\r\n                </div>\r\n            `).join('');\r\n            suggestions.classList.toggle('show', results.length > 0);\r\n        }\r\n    } catch (e) { }\r\n}\r\n\r\nwindow.handleSuggestionClick = async (id, type) => {\r\n    const res = await fetch(`https://api.themoviedb.org/3/${type}/${id}?api_key=${API_KEY}`);\r\n    const item = await res.json();\r\n    if (type === 'tv') openSeasonExplorer(item);\r\n    else playMedia(item, 'movie');\r\n};\r\n\r\nasync function openSeasonExplorer(show) {\r\n    currentShow = show;\r\n    document.getElementById('show-title').textContent = show.name;\r\n    document.getElementById('seasons-list').innerHTML = '<span>Loading seasons...</span>';\r\n    document.getElementById('episodes-list').innerHTML = '';\r\n    document.getElementById('season-explorer').classList.add('show');\r\n\r\n    try {\r\n        const res = await fetch(`https://api.themoviedb.org/3/tv/${show.id}?api_key=${API_KEY}`);\r\n        const data = await res.json();\r\n        const seasons = data.seasons.filter(s => s.season_number > 0);\r\n\r\n        document.getElementById('seasons-list').innerHTML = seasons.map((s, i) =>\r\n            `<button class=\"season-btn ${i === 0 ? 'active' : ''}\" onclick=\"loadEpisodes(${show.id}, ${s.season_number}, this)\">Season ${s.season_number}</button>`\r\n        ).join('');\r\n\r\n        if (seasons.length) loadEpisodes(show.id, seasons[0].season_number);\r\n    } catch (e) { }\r\n}\r\n\r\nwindow.loadEpisodes = async (showId, season, btn) => {\r\n    if (btn) {\r\n        document.querySelectorAll('.season-btn').forEach(b => b.classList.remove('active'));\r\n        btn.classList.add('active');\r\n    }\r\n    document.getElementById('episodes-list').innerHTML = '<span>Loading episodes...</span>';\r\n\r\n    try {\r\n        const res = await fetch(`https://api.themoviedb.org/3/tv/${showId}/season/${season}?api_key=${API_KEY}`);\r\n        const data = await res.json();\r\n        document.getElementById('episodes-list').innerHTML = data.episodes.map(ep => `\r\n            <button class=\"episode-btn\" onclick=\"playEpisode(${season}, ${ep.episode_number}, '${ep.name}')\">\r\n                <strong>E${ep.episode_number}</strong> ${ep.name}\r\n            </button>\r\n        `).join('');\r\n    } catch (e) { }\r\n};\r\n\r\nwindow.playEpisode = (season, episode, name) => {\r\n    document.getElementById('season-explorer').classList.remove('show');\r\n    playMedia({ ...currentShow, season, episode, episodeName: name }, 'tv');\r\n};\r\n\r\nwindow.closeSeasonExplorer = () => document.getElementById('season-explorer').classList.remove('show');\r\n\n</script>\r\n\r\n    <script>\n// footer\r\n(function () {\r\n    'use strict';\r\n\r\n    let rootPrefix = '';\r\n    const scriptName = 'components/footer.js';\r\n    const scripts = document.getElementsByTagName('script');\r\n    for (let i = 0; i < scripts.length; i++) {\r\n        const src = scripts[i].getAttribute('src');\r\n        if (src && src.includes(scriptName)) {\r\n            rootPrefix = src.split(scriptName)[0];\r\n            break;\r\n        }\r\n    }\r\n\r\n    const config = window.SITE_CONFIG || { name: 'Phantom', version: '1.0.0', discord: { inviteUrl: '#' }, changelog: [], cloakPresets: [] };\r\n    const STORAGE_KEY = 'void_settings';\r\n    let storedSettings = {};\r\n    try { storedSettings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n\r\n    // settings\r\n    let settings = { ...(config.defaults || {}), ...storedSettings };\r\n\r\n    const footer = document.createElement('footer');\r\n    footer.id = 'site-footer';\r\n    footer.innerHTML = `\r\n        <style>\r\n            #site-footer {\r\n                margin-top: 0px;\r\n                padding: 20px;\r\n                border-top: 1px solid var(--border, #1f1f1f);\r\n                text-align: center;\r\n                background: transparent;\r\n            }\r\n            #site-footer .footer-links {\r\n                display: flex;\r\n                gap: 16px;\r\n                justify-content: center;\r\n                margin-bottom: 8px;\r\n                flex-wrap: wrap;\r\n            }\r\n            #site-footer .footer-link {\r\n                font-size: 12px;\r\n                color: var(--text-muted, #71717a);\r\n                text-decoration: none;\r\n                transition: color 0.15s;\r\n                font-family: 'Inter', sans-serif;\r\n                cursor: pointer;\r\n            }\r\n            #site-footer .footer-link:hover {\r\n                color: var(--text, #e4e4e7);\r\n            }\r\n            #site-footer .footer-version {\r\n                font-size: 11px;\r\n                color: var(--text-dim, #52525b);\r\n                cursor: pointer;\r\n                font-family: 'Inter', sans-serif;\r\n            }\r\n            #site-footer .footer-version:hover {\r\n                color: var(--text-muted, #71717a);\r\n            }\r\n        </style>\r\n        <div class=\"footer-links\">\r\n            <a href=\"${rootPrefix}pages/settings.html\" class=\"footer-link\"><i class=\"fa-solid fa-gear\"></i> Settings</a>\r\n            <a id=\"footer-changelog\" class=\"footer-link\"><i class=\"fa-solid fa-clock-rotate-left\"></i> Changelog</a>\r\n            <a href=\"${config.discord?.inviteUrl || '#'}\" target=\"_blank\" class=\"footer-link\"><i class=\"fa-brands fa-discord\"></i> Discord</a>\r\n            <a href=\"${rootPrefix}pages/terms.html\" class=\"footer-link\">Terms</a>\r\n            <a href=\"${rootPrefix}pages/disclaimer.html\" class=\"footer-link\">Disclaimer</a>\r\n            <a href=\"${rootPrefix}pages/extra.html\" class=\"footer-link\">Credits</a>\r\n        </div>\r\n        <span class=\"footer-version\" id=\"footer-version\">${config.name || 'Phantom'} v${config.version || '1.0.0'}</span>\r\n    `;\r\n\r\n    document.body.appendChild(footer);\r\n\r\n\r\n\r\n    // gtm\r\n    // Inject GTM head script if not already present\r\n    if (!document.querySelector('script[src*=\"googletagmanager.com/gtm.js\"]')) {\r\n        window.dataLayer = window.dataLayer || [];\r\n        window.dataLayer.push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' });\r\n        const gtmScript = document.createElement('script');\r\n        gtmScript.async = true;\r\n        gtmScript.src = 'https://www.googletagmanager.com/gtm.js?id=GTM-5LMBC27Z';\r\n        document.head.insertBefore(gtmScript, document.head.firstChild);\r\n    }\r\n\r\n    // Add GTM noscript fallback (for pages that don't have it in HTML)\r\n    if (!document.querySelector('noscript iframe[src*=\"googletagmanager\"]')) {\r\n        const gtmNoscript = document.createElement('noscript');\r\n        gtmNoscript.innerHTML = '<iframe src=\"https://www.googletagmanager.com/ns.html?id=GTM-5LMBC27Z\" height=\"0\" width=\"0\" style=\"display:none;visibility:hidden\"></iframe>';\r\n        document.body.insertBefore(gtmNoscript, document.body.firstChild);\r\n    }\r\n\r\n    const openChangelog = (e, customTitle, customContent) => {\r\n        if (e && e.preventDefault) e.preventDefault();\r\n        const changes = customContent || config.changelog || ['No changes listed'];\r\n\r\n        // Use standard modal structure from main.css\r\n        const overlay = document.createElement('div');\r\n        overlay.className = 'modal-overlay';\r\n\r\n        overlay.innerHTML = `\r\n            <div class=\"modal\" style=\"width: 400px; max-width: 90vw;\">\r\n                <div class=\"modal-header\">\r\n                    <h3 class=\"modal-title\">${customTitle || 'What\\'s New in v' + config.version}</h3>\r\n                    <button class=\"modal-close\"><i class=\"fa-solid fa-xmark\"></i></button>\r\n                </div>\r\n                <div class=\"modal-body\">\r\n                    <ul style=\"margin: 0; padding-left: 20px; color: var(--text-muted); font-size: 0.875rem; line-height: 1.6;\">\r\n                        ${changes.map(c => '<li>' + c + '</li>').join('')}\r\n                    </ul>\r\n                </div>\r\n                <div class=\"modal-footer\">\r\n                    <a href=\"${config.discord?.inviteUrl || '#'}\" target=\"_blank\" style=\"color: #5865F2; text-decoration: none; font-size: 13px; display: inline-flex; align-items: center; gap: 6px;\">\r\n                        <i class=\"fa-brands fa-discord\"></i> Join Discord\r\n                    </a>\r\n                </div>\r\n            </div>\r\n        `;\r\n\r\n        document.body.appendChild(overlay);\r\n\r\n        // Trigger animation\r\n        requestAnimationFrame(() => overlay.classList.add('show'));\r\n\r\n        const close = () => {\r\n            overlay.classList.remove('show');\r\n            setTimeout(() => overlay.remove(), 200);\r\n        };\r\n\r\n        overlay.querySelector('.modal-close').onclick = close;\r\n        overlay.onclick = (e) => { if (e.target === overlay) close(); };\r\n    };\r\n\r\n    // Expose openChangelog globally\r\n    window.openChangelog = openChangelog;\r\n\r\n    const changelogBtn = document.getElementById('footer-changelog');\r\n    if (changelogBtn) changelogBtn.onclick = openChangelog;\r\n\r\n    const versionBtn = document.getElementById('footer-version');\r\n    if (versionBtn) versionBtn.onclick = openChangelog;\r\n\r\n    // sync\r\n    // syncRemoteChangelog removed - using local config\r\n\r\n\r\n    // Initialize Sync\r\n    // syncRemoteChangelog();\r\n\r\n    const currentVersion = config.version;\r\n    const lastVersion = settings.lastVersion;\r\n\r\n    if (settings.showChangelogOnUpdate && lastVersion && lastVersion !== currentVersion) {\r\n        setTimeout(() => {\r\n            openChangelog();\r\n            settings.lastVersion = currentVersion;\r\n            localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n        }, 1000);\r\n    } else if (!lastVersion) {\r\n        settings.lastVersion = currentVersion;\r\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n    }\r\n\r\n    // panic\r\n    if (settings.panicKey) {\r\n        document.addEventListener('keydown', (e) => {\r\n            const keys = settings.panicModifiers || ['ctrl', 'shift'];\r\n            const triggerKey = settings.panicKey.toLowerCase();\r\n            const pressedKey = e.key.toLowerCase();\r\n\r\n            // Check modifiers\r\n            const ctrlMatch = keys.includes('ctrl') === e.ctrlKey;\r\n            const shiftMatch = keys.includes('shift') === e.shiftKey;\r\n            const altMatch = keys.includes('alt') === e.altKey;\r\n\r\n            if (ctrlMatch && shiftMatch && altMatch && pressedKey === triggerKey) {\r\n                e.preventDefault();\r\n\r\n                // Show white screen instantly (if panic-overlay exists in parent)\r\n                const parentOverlay = window.parent?.document?.getElementById('panic-overlay');\r\n                if (parentOverlay) {\r\n                    parentOverlay.style.display = 'block';\r\n                } else {\r\n                    // Create overlay if it doesn't exist\r\n                    const overlay = document.createElement('div');\r\n                    overlay.id = 'panic-overlay';\r\n                    overlay.style.cssText = 'position:fixed;inset:0;background:white;z-index:99999;';\r\n                    document.body.appendChild(overlay);\r\n                }\r\n\r\n                // Redirect immediately\r\n                const url = settings.panicUrl || 'https://classroom.google.com';\r\n                try { window.top.location.href = url; } catch { window.location.href = url; }\r\n            }\r\n        }, true); // Use capture phase for faster response\r\n    }\r\n\r\n    // Cloaking logic has been moved to scripts/cloaking.js for better synchronization.\r\n    // If you need cloaking on a specific page, include that script.\r\n\r\n\r\n    window.addEventListener('beforeunload', (e) => {\r\n        // Reload settings to get latest value\r\n        try { settings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n\r\n        if (window.top === window.self && settings.leaveConfirmation) {\r\n            e.preventDefault();\r\n            e.returnValue = '';\r\n            return '';\r\n        }\r\n    });\r\n\r\n    // discord\r\n    let crateInstance = null;\r\n\r\n    function initDiscord() {\r\n        if (settings.discordWidget && config.discord && config.discord.widgetServer && config.discord.widgetChannel) {\r\n            // Check if already loaded\r\n            if (document.querySelector('script[src*=\"@widgetbot/crate\"]')) {\r\n                if (crateInstance) crateInstance.show();\r\n                return;\r\n            }\r\n\r\n            const crateScript = document.createElement('script');\r\n            crateScript.src = 'https://cdn.jsdelivr.net/npm/@widgetbot/crate@3';\r\n            crateScript.async = true;\r\n            crateScript.defer = true;\r\n            crateScript.onload = () => {\r\n                crateInstance = new Crate({\r\n                    server: config.discord.widgetServer,\r\n                    channel: config.discord.widgetChannel,\r\n                    glyph: ['https://cdn.discordapp.com/embed/avatars/0.png', '100%'],\r\n                    location: ['bottom', 'right']\r\n                });\r\n            };\r\n            document.body.appendChild(crateScript);\r\n        } else {\r\n            // Hide if disabled\r\n            if (crateInstance) crateInstance.hide();\r\n        }\r\n    }\r\n\r\n    // Initialize\r\n    initDiscord();\r\n\r\n    // Listen for settings change to toggle dynamically\r\n    window.addEventListener('storage', (e) => {\r\n        if (e.key === STORAGE_KEY) {\r\n            try { settings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n            initDiscord();\r\n        }\r\n    });\r\n\r\n    // Listen for internal event\r\n    window.addEventListener('settings-changed', (e) => {\r\n        settings = e.detail;\r\n        initDiscord();\r\n    });\r\n\r\n    // counters\r\n    // Only show on home page (index2.html) checking if main-content exists\r\n    const mainContent = document.querySelector('.main-content');\r\n    // Ensure we are on the home page view (search bar checks etc) or just check existence\r\n    if (mainContent && document.querySelector('.featured-section')) {\r\n        const counterContainer = document.createElement('div');\r\n        counterContainer.id = 'supercounters-wrapper';\r\n        counterContainer.style.marginTop = '24px';\r\n        counterContainer.style.textAlign = 'center';\r\n        counterContainer.style.opacity = '0.8';\r\n\r\n        // Use iframe to isolate document.write from the widget\r\n        const iframe = document.createElement('iframe');\r\n        iframe.style.border = 'none';\r\n        iframe.style.width = '150px';\r\n        iframe.style.height = '40px';\r\n        iframe.style.overflow = 'hidden';\r\n\r\n        // Widget code\r\n        const widgetCode = `\r\n            <html>\r\n            <body style=\"margin:0;display:flex;justify-content:center;align-items:center;background:transparent;\">\r\n                <script type=\"text/javascript\" src=\"//widget.supercounters.com/ssl/online_i.js\"><\\/script>\r\n                <script type=\"text/javascript\">sc_online_i(1726449,\"ffffff\",\"000000\");<\\/script>\r\n            </body>\r\n            </html>\r\n        `;\r\n\r\n        iframe.srcdoc = widgetCode;\r\n        counterContainer.appendChild(iframe);\r\n        mainContent.appendChild(counterContainer);\r\n    }\r\n})();\r\n\n</script>\r\n</body>\r\n\r\n</html>","pages/music.html":"<!DOCTYPE html>\r\n<html lang=\"en\">\r\n\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n    <title>Music - Phantom</title>\r\n    <link rel=\"icon\" href=\"../favicon.svg\" type=\"image/svg+xml\">\r\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css\">\r\n    <style>\n/* phantom styling */\r\n\r\n@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');\r\n\r\n/* variables */\r\n:root {\r\n    /* Core colors (can be overridden by user settings) */\r\n    --bg: #0a0a0a;\r\n    --surface: #0f0f0f;\r\n    --surface-hover: #1a1a1a;\r\n    --surface-active: #252525;\r\n    --border: #1f1f1f;\r\n    --border-light: #2a2a2a;\r\n\r\n    /* Text */\r\n    --text: #e4e4e7;\r\n    --text-muted: #71717a;\r\n    --text-dim: #52525b;\r\n\r\n    /* Accent (customizable) */\r\n    --accent: #ffffff;\r\n    --accent-dim: rgba(255, 255, 255, 0.8);\r\n    --accent-glow: rgba(255, 255, 255, 0.1);\r\n\r\n    /* Status colors */\r\n    --success: #22c55e;\r\n    --warning: #f59e0b;\r\n    --error: #ef4444;\r\n    --info: #3b82f6;\r\n\r\n    /* Shadows */\r\n    --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.3);\r\n    --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.4);\r\n    --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.5);\r\n    --shadow-xl: 0 16px 48px rgba(0, 0, 0, 0.6);\r\n\r\n    /* Spacing */\r\n    --space-xs: 4px;\r\n    --space-sm: 8px;\r\n    --space-md: 16px;\r\n    --space-lg: 24px;\r\n    --space-xl: 32px;\r\n    --space-2xl: 48px;\r\n\r\n    /* Border radius */\r\n    --radius-sm: 4px;\r\n    --radius-md: 8px;\r\n    --radius-lg: 12px;\r\n    --radius-xl: 16px;\r\n    --radius-full: 9999px;\r\n\r\n    /* Transitions */\r\n    --transition-fast: 0.1s ease;\r\n    --transition-normal: 0.2s ease;\r\n    --transition-slow: 0.3s ease;\r\n\r\n    /* Z-index layers */\r\n    --z-base: 1;\r\n    --z-dropdown: 100;\r\n    --z-sticky: 500;\r\n    --z-modal: 1000;\r\n    --z-toast: 2000;\r\n    --z-max: 9999;\r\n\r\n    /* Typography */\r\n    --font-sans: 'Inter', system-ui, -apple-system, sans-serif;\r\n    --font-mono: 'JetBrains Mono', 'Fira Code', monospace;\r\n\r\n    /* Background (customizable) */\r\n    --bg-image: none;\r\n}\r\n\r\n/* base */\r\n*,\r\n*::before,\r\n*::after {\r\n    box-sizing: border-box;\r\n    margin: 0;\r\n    padding: 0;\r\n}\r\n\r\nhtml {\r\n    font-size: 16px;\r\n    scroll-behavior: smooth;\r\n    -webkit-font-smoothing: antialiased;\r\n    -moz-osx-font-smoothing: grayscale;\r\n}\r\n\r\nbody {\r\n    font-family: var(--font-sans);\r\n    background: var(--bg);\r\n    background-image: var(--bg-image);\r\n    background-size: cover;\r\n    background-position: var(--bg-image-position, center);\r\n    background-attachment: fixed;\r\n    color: var(--text);\r\n    line-height: 1.5;\r\n    min-height: 100vh;\r\n    overflow-x: hidden;\r\n}\r\n\r\n/* Ensure background manager takes precedence */\r\nhtml.phantom-bg-active body {\r\n    background: transparent !important;\r\n    background-image: none !important;\r\n}\r\n\r\n/* Selection */\r\n::selection {\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n}\r\n\r\n/* Focus states */\r\n:focus-visible {\r\n    outline: 2px solid var(--accent);\r\n    outline-offset: 2px;\r\n}\r\n\r\n/* Links */\r\na {\r\n    color: var(--accent);\r\n    text-decoration: none;\r\n    transition: opacity var(--transition-fast);\r\n}\r\n\r\na:hover {\r\n    opacity: 0.8;\r\n}\r\n\r\n/* Scrollbar */\r\n::-webkit-scrollbar {\r\n    width: 8px;\r\n    height: 8px;\r\n}\r\n\r\n::-webkit-scrollbar-track {\r\n    background: var(--surface);\r\n}\r\n\r\n::-webkit-scrollbar-thumb {\r\n    background: var(--border-light);\r\n    border-radius: var(--radius-full);\r\n}\r\n\r\n::-webkit-scrollbar-thumb:hover {\r\n    background: var(--text-muted);\r\n}\r\n\r\n/* text */\r\nh1,\r\nh2,\r\nh3,\r\nh4,\r\nh5,\r\nh6 {\r\n    font-weight: 600;\r\n    line-height: 1.2;\r\n    color: var(--text);\r\n}\r\n\r\nh1 {\r\n    font-size: 2.5rem;\r\n}\r\n\r\nh2 {\r\n    font-size: 2rem;\r\n}\r\n\r\nh3 {\r\n    font-size: 1.5rem;\r\n}\r\n\r\nh4 {\r\n    font-size: 1.25rem;\r\n}\r\n\r\nh5 {\r\n    font-size: 1rem;\r\n}\r\n\r\nh6 {\r\n    font-size: 0.875rem;\r\n}\r\n\r\np {\r\n    color: var(--text-muted);\r\n    line-height: 1.6;\r\n}\r\n\r\n.text-sm {\r\n    font-size: 0.875rem;\r\n}\r\n\r\n.text-xs {\r\n    font-size: 0.75rem;\r\n}\r\n\r\n.text-lg {\r\n    font-size: 1.125rem;\r\n}\r\n\r\n.text-muted {\r\n    color: var(--text-muted);\r\n}\r\n\r\n.text-dim {\r\n    color: var(--text-dim);\r\n}\r\n\r\n.text-center {\r\n    text-align: center;\r\n}\r\n\r\n/* buttons */\r\n.btn {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    gap: var(--space-sm);\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-family: var(--font-sans);\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-md);\r\n    background: var(--surface);\r\n    color: var(--text);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n    white-space: nowrap;\r\n}\r\n\r\n.btn:hover {\r\n    background: var(--surface-hover);\r\n    border-color: var(--border-light);\r\n}\r\n\r\n.btn:active {\r\n    background: var(--surface-active);\r\n    transform: scale(0.98);\r\n}\r\n\r\n.btn-primary {\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n    border-color: var(--accent);\r\n}\r\n\r\n.btn-primary:hover {\r\n    opacity: 0.9;\r\n    background: var(--accent);\r\n}\r\n\r\n.btn-ghost {\r\n    background: transparent;\r\n    border-color: transparent;\r\n}\r\n\r\n.btn-ghost:hover {\r\n    background: var(--surface-hover);\r\n}\r\n\r\n.btn-icon {\r\n    width: 36px;\r\n    height: 36px;\r\n    padding: 0;\r\n    border-radius: var(--radius-md);\r\n}\r\n\r\n.btn-sm {\r\n    padding: var(--space-xs) var(--space-sm);\r\n    font-size: 0.75rem;\r\n}\r\n\r\n.btn-lg {\r\n    padding: var(--space-md) var(--space-lg);\r\n    font-size: 1rem;\r\n}\r\n\r\n/* inputs */\r\n.input {\r\n    width: 100%;\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-family: var(--font-sans);\r\n    font-size: 0.875rem;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-md);\r\n    color: var(--text);\r\n    transition: border-color var(--transition-fast);\r\n}\r\n\r\n.input:hover {\r\n    border-color: var(--border-light);\r\n}\r\n\r\n.input:focus {\r\n    outline: none;\r\n    border-color: var(--accent);\r\n}\r\n\r\n.input::placeholder {\r\n    color: var(--text-dim);\r\n}\r\n\r\n.input-group {\r\n    display: flex;\r\n    gap: var(--space-sm);\r\n}\r\n\r\n.input-group .input {\r\n    flex: 1;\r\n}\r\n\r\n/* Select */\r\n.select {\r\n    appearance: none;\r\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%2371717a' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E\");\r\n    background-repeat: no-repeat;\r\n    background-position: right 12px center;\r\n    padding-right: 36px;\r\n    cursor: pointer;\r\n}\r\n\r\n/* Checkbox/Toggle */\r\n.toggle {\r\n    position: relative;\r\n    width: 44px;\r\n    height: 24px;\r\n    background: var(--border);\r\n    border-radius: var(--radius-full);\r\n    cursor: pointer;\r\n    transition: background var(--transition-fast);\r\n}\r\n\r\n.toggle::after {\r\n    content: '';\r\n    position: absolute;\r\n    top: 2px;\r\n    left: 2px;\r\n    width: 20px;\r\n    height: 20px;\r\n    background: var(--text);\r\n    border-radius: 50%;\r\n    transition: transform var(--transition-fast);\r\n}\r\n\r\n.toggle.active {\r\n    background: var(--accent);\r\n}\r\n\r\n.toggle.active::after {\r\n    transform: translateX(20px);\r\n    background: var(--bg);\r\n}\r\n\r\n/* cards */\r\n.card {\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-lg);\r\n    overflow: hidden;\r\n    transition: all var(--transition-normal);\r\n}\r\n\r\n.card:hover {\r\n    border-color: var(--border-light);\r\n    box-shadow: var(--shadow-md);\r\n}\r\n\r\n.card-header {\r\n    padding: var(--space-md);\r\n    border-bottom: 1px solid var(--border);\r\n}\r\n\r\n.card-body {\r\n    padding: var(--space-md);\r\n}\r\n\r\n.card-footer {\r\n    padding: var(--space-md);\r\n    border-top: 1px solid var(--border);\r\n}\r\n\r\n\r\n/* Featured badge */\r\n.badge-featured {\r\n    position: absolute;\r\n    top: var(--space-sm);\r\n    left: var(--space-sm);\r\n    padding: var(--space-xs) var(--space-sm);\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n    font-size: 0.625rem;\r\n    font-weight: 700;\r\n    text-transform: uppercase;\r\n    letter-spacing: 0.05em;\r\n    border-radius: var(--radius-sm);\r\n}\r\n\r\n/* Favorite star */\r\n.favorite-btn {\r\n    position: absolute;\r\n    top: var(--space-sm);\r\n    right: var(--space-sm);\r\n    width: 32px;\r\n    height: 32px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background: rgba(0, 0, 0, 0.5);\r\n    border: none;\r\n    border-radius: 50%;\r\n    color: var(--text-muted);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n    opacity: 0;\r\n}\r\n\r\n.media-card:hover .favorite-btn {\r\n    opacity: 1;\r\n}\r\n\r\n.favorite-btn:hover {\r\n    background: rgba(0, 0, 0, 0.7);\r\n    color: var(--text);\r\n}\r\n\r\n.favorite-btn.active {\r\n    color: #fbbf24;\r\n    opacity: 1;\r\n}\r\n\r\n/* grid */\r\n.grid {\r\n    display: grid;\r\n    gap: var(--space-md);\r\n}\r\n\r\n.grid-cols-2 {\r\n    grid-template-columns: repeat(2, 1fr);\r\n}\r\n\r\n.grid-cols-3 {\r\n    grid-template-columns: repeat(3, 1fr);\r\n}\r\n\r\n.grid-cols-4 {\r\n    grid-template-columns: repeat(4, 1fr);\r\n}\r\n\r\n.grid-cols-5 {\r\n    grid-template-columns: repeat(5, 1fr);\r\n}\r\n\r\n.grid-cols-6 {\r\n    grid-template-columns: repeat(6, 1fr);\r\n}\r\n\r\n/* Auto-fit grid for responsive cards */\r\n.grid-auto {\r\n    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));\r\n}\r\n\r\n.grid-auto-lg {\r\n    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\r\n}\r\n\r\n/* flex */\r\n.flex {\r\n    display: flex;\r\n}\r\n\r\n.flex-col {\r\n    flex-direction: column;\r\n}\r\n\r\n.flex-wrap {\r\n    flex-wrap: wrap;\r\n}\r\n\r\n.items-center {\r\n    align-items: center;\r\n}\r\n\r\n.items-start {\r\n    align-items: flex-start;\r\n}\r\n\r\n.items-end {\r\n    align-items: flex-end;\r\n}\r\n\r\n.justify-center {\r\n    justify-content: center;\r\n}\r\n\r\n.justify-between {\r\n    justify-content: space-between;\r\n}\r\n\r\n.justify-end {\r\n    justify-content: flex-end;\r\n}\r\n\r\n.gap-xs {\r\n    gap: var(--space-xs);\r\n}\r\n\r\n.gap-sm {\r\n    gap: var(--space-sm);\r\n}\r\n\r\n.gap-md {\r\n    gap: var(--space-md);\r\n}\r\n\r\n.gap-lg {\r\n    gap: var(--space-lg);\r\n}\r\n\r\n.flex-1 {\r\n    flex: 1;\r\n}\r\n\r\n/* spacing */\r\n.p-xs {\r\n    padding: var(--space-xs);\r\n}\r\n\r\n.p-sm {\r\n    padding: var(--space-sm);\r\n}\r\n\r\n.p-md {\r\n    padding: var(--space-md);\r\n}\r\n\r\n.p-lg {\r\n    padding: var(--space-lg);\r\n}\r\n\r\n.p-xl {\r\n    padding: var(--space-xl);\r\n}\r\n\r\n.m-xs {\r\n    margin: var(--space-xs);\r\n}\r\n\r\n.m-sm {\r\n    margin: var(--space-sm);\r\n}\r\n\r\n.m-md {\r\n    margin: var(--space-md);\r\n}\r\n\r\n.m-lg {\r\n    margin: var(--space-lg);\r\n}\r\n\r\n.mt-sm {\r\n    margin-top: var(--space-sm);\r\n}\r\n\r\n.mt-md {\r\n    margin-top: var(--space-md);\r\n}\r\n\r\n.mt-lg {\r\n    margin-top: var(--space-lg);\r\n}\r\n\r\n.mb-sm {\r\n    margin-bottom: var(--space-sm);\r\n}\r\n\r\n.mb-md {\r\n    margin-bottom: var(--space-md);\r\n}\r\n\r\n.mb-lg {\r\n    margin-bottom: var(--space-lg);\r\n}\r\n\r\n/* modals */\r\n.modal-overlay {\r\n    position: fixed;\r\n    inset: 0;\r\n    background: rgba(0, 0, 0, 0.8);\r\n    backdrop-filter: blur(4px);\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    z-index: var(--z-modal);\r\n    opacity: 0;\r\n    visibility: hidden;\r\n    transition: all var(--transition-normal);\r\n}\r\n\r\n.modal-overlay.show {\r\n    opacity: 1;\r\n    visibility: visible;\r\n}\r\n\r\n.modal {\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-xl);\r\n    max-width: 90vw;\r\n    max-height: 90vh;\r\n    overflow: hidden;\r\n    transform: scale(0.95);\r\n    transition: transform var(--transition-normal);\r\n}\r\n\r\n.modal-overlay.show .modal {\r\n    transform: scale(1);\r\n}\r\n\r\n.modal-header {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    padding: var(--space-md);\r\n    border-bottom: 1px solid var(--border);\r\n}\r\n\r\n.modal-title {\r\n    font-size: 1rem;\r\n    font-weight: 600;\r\n}\r\n\r\n.modal-close {\r\n    width: 32px;\r\n    height: 32px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background: transparent;\r\n    border: none;\r\n    color: var(--text-muted);\r\n    cursor: pointer;\r\n    border-radius: var(--radius-md);\r\n    transition: all var(--transition-fast);\r\n}\r\n\r\n.modal-close:hover {\r\n    background: var(--surface-hover);\r\n    color: var(--text);\r\n}\r\n\r\n.modal-body {\r\n    padding: var(--space-md);\r\n    overflow-y: auto;\r\n}\r\n\r\n.modal-footer {\r\n    display: flex;\r\n    justify-content: flex-end;\r\n    gap: var(--space-sm);\r\n    padding: var(--space-md);\r\n    border-top: 1px solid var(--border);\r\n}\r\n\r\n/* tabs */\r\n.tabs {\r\n    display: flex;\r\n    gap: 2px;\r\n    background: var(--surface);\r\n    padding: var(--space-xs);\r\n    border-radius: var(--radius-md);\r\n    border: 1px solid var(--border);\r\n}\r\n\r\n.tab {\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    color: var(--text-muted);\r\n    background: transparent;\r\n    border: none;\r\n    border-radius: var(--radius-sm);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n}\r\n\r\n.tab:hover {\r\n    color: var(--text);\r\n}\r\n\r\n.tab.active {\r\n    background: var(--surface-hover);\r\n    color: var(--text);\r\n}\r\n\r\n/* search */\r\n\r\n/* ============================================\r\n   OFFLINE INDICATOR\r\n   ============================================ */\r\n.offline-banner {\r\n    position: fixed;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    padding: var(--space-sm) var(--space-md);\r\n    background: var(--warning);\r\n    color: var(--bg);\r\n    text-align: center;\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    z-index: var(--z-toast);\r\n    transform: translateY(-100%);\r\n    transition: transform var(--transition-normal);\r\n}\r\n\r\n.offline-banner.show {\r\n    transform: translateY(0);\r\n}\r\n\r\n.offline-badge {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    gap: var(--space-xs);\r\n    padding: var(--space-xs) var(--space-sm);\r\n    background: var(--warning);\r\n    color: var(--bg);\r\n    font-size: 0.625rem;\r\n    font-weight: 600;\r\n    text-transform: uppercase;\r\n    border-radius: var(--radius-sm);\r\n}\r\n\r\n/* ============================================\r\n   LOADING STATES\r\n   ============================================ */\r\n.skeleton {\r\n    background: linear-gradient(90deg, var(--surface) 0%, var(--surface-hover) 50%, var(--surface) 100%);\r\n    background-size: 200% 100%;\r\n    animation: shimmer 1.5s infinite;\r\n    border-radius: var(--radius-md);\r\n}\r\n\r\n@keyframes shimmer {\r\n    0% {\r\n        background-position: 200% 0;\r\n    }\r\n\r\n    100% {\r\n        background-position: -200% 0;\r\n    }\r\n}\r\n\r\n.spinner {\r\n    width: 24px;\r\n    height: 24px;\r\n    border: 2px solid var(--border);\r\n    border-top-color: var(--accent);\r\n    border-radius: 50%;\r\n    animation: spin 0.8s linear infinite;\r\n}\r\n\r\n@keyframes spin {\r\n    to {\r\n        transform: rotate(360deg);\r\n    }\r\n}\r\n\r\n/* ============================================\r\n   ANIMATIONS\r\n   ============================================ */\r\n@keyframes fadeIn {\r\n    from {\r\n        opacity: 0;\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n    }\r\n}\r\n\r\n@keyframes slideUp {\r\n    from {\r\n        opacity: 0;\r\n        transform: translateY(10px);\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n        transform: translateY(0);\r\n    }\r\n}\r\n\r\n@keyframes scaleIn {\r\n    from {\r\n        opacity: 0;\r\n        transform: scale(0.95);\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n        transform: scale(1);\r\n    }\r\n}\r\n\r\n.animate-fadeIn {\r\n    animation: fadeIn var(--transition-normal) ease;\r\n}\r\n\r\n.animate-slideUp {\r\n    animation: slideUp var(--transition-normal) ease;\r\n}\r\n\r\n.animate-scaleIn {\r\n    animation: scaleIn var(--transition-normal) ease;\r\n}\r\n\r\n/* ============================================\r\n   UTILITIES\r\n   ============================================ */\r\n.hidden {\r\n    display: none !important;\r\n}\r\n\r\n.sr-only {\r\n    position: absolute;\r\n    width: 1px;\r\n    height: 1px;\r\n    padding: 0;\r\n    margin: -1px;\r\n    overflow: hidden;\r\n    clip: rect(0, 0, 0, 0);\r\n    border: 0;\r\n}\r\n\r\n.truncate {\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n}\r\n\r\n.w-full {\r\n    width: 100%;\r\n}\r\n\r\n.h-full {\r\n    height: 100%;\r\n}\r\n\r\n.relative {\r\n    position: relative;\r\n}\r\n\r\n.absolute {\r\n    position: absolute;\r\n}\r\n\r\n.fixed {\r\n    position: fixed;\r\n}\r\n\r\n.inset-0 {\r\n    inset: 0;\r\n}\r\n\r\n/* ============================================\r\n   RESPONSIVE\r\n   ============================================ */\r\n@media (max-width: 768px) {\r\n    h1 {\r\n        font-size: 1.75rem;\r\n    }\r\n\r\n    h2 {\r\n        font-size: 1.5rem;\r\n    }\r\n\r\n    h3 {\r\n        font-size: 1.25rem;\r\n    }\r\n\r\n    .grid-auto {\r\n        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));\r\n    }\r\n\r\n    .hide-mobile {\r\n        display: none !important;\r\n    }\r\n}\r\n\r\n@media (min-width: 769px) {\r\n    .hide-desktop {\r\n        display: none !important;\r\n    }\r\n}\n</style>\r\n    <style>\n/* Topbar Styles - Clean & Dark */\r\n/* Note: Inter font is imported in main.css */\r\n\r\nbody {\r\n    margin: 0;\r\n    padding: 0;\r\n    background-color: var(--bg);\r\n    font-family: 'Inter', sans-serif;\r\n}\r\n\r\n#topbar-container {\r\n    position: fixed;\r\n    top: 11px;\r\n    left: 50%;\r\n    transform: translateX(-50%);\r\n    background-color: var(--surface);\r\n    border-radius: 9999px;\r\n    padding: 8px 14px;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 10px;\r\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);\r\n    z-index: 10000;\r\n    border: 1px solid var(--border);\r\n    height: 48px;\r\n    box-sizing: border-box;\r\n}\r\n\r\n#topbar-container::before {\r\n    content: '';\r\n    position: absolute;\r\n    top: -7px;\r\n    bottom: -7px;\r\n    left: -7px;\r\n    right: -7px;\r\n    z-index: -1;\r\n    border-radius: 9999px;\r\n}\r\n\r\n.logo-section {\r\n    display: flex;\r\n    align-items: center;\r\n    padding-right: 10px;\r\n    border-right: 1px solid var(--border);\r\n    height: 32px;\r\n    text-decoration: none;\r\n    color: inherit;\r\n}\r\n\r\n.logo-placeholder {\r\n    width: 28px;\r\n    height: 28px;\r\n    background-color: var(--surface-hover);\r\n    border-radius: 6px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    color: var(--text-muted);\r\n}\r\n\r\n.logo-placeholder i,\r\n.logo-placeholder svg {\r\n    width: 16px;\r\n    height: 16px;\r\n}\r\n\r\n.nav-buttons {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 4px;\r\n}\r\n\r\n.nav-separator {\r\n    width: 1px;\r\n    height: 20px;\r\n    background-color: var(--border);\r\n    margin: 0 6px;\r\n}\r\n\r\n.nav-btn {\r\n    background: transparent;\r\n    border: none;\r\n    color: var(--text-muted);\r\n    text-decoration: none;\r\n    display: flex;\r\n    align-items: center;\r\n    padding: 6px 10px;\r\n    border-radius: 99px;\r\n    height: 32px;\r\n    box-sizing: border-box;\r\n    transition: color 0.15s, background-color 0.15s;\r\n    position: relative;\r\n}\r\n\r\n.nav-badge-beta {\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n    font-size: 8px;\r\n    font-weight: 700;\r\n    color: var(--text);\r\n    background: var(--secondary);\r\n    padding: 2px 4px;\r\n    border-radius: 4px;\r\n    line-height: 1;\r\n    transform: translate(20%, -20%);\r\n    pointer-events: none;\r\n}\r\n\r\n.nav-btn:hover {\r\n    color: var(--text);\r\n    background-color: var(--surface-hover);\r\n}\r\n\r\n.nav-btn i,\r\n.nav-btn svg {\r\n    width: 18px;\r\n    height: 18px;\r\n    min-width: 18px;\r\n}\r\n\r\n.nav-btn span {\r\n    max-width: 0;\r\n    opacity: 0;\r\n    margin-left: 0;\r\n    overflow: hidden;\r\n    white-space: nowrap;\r\n    font-weight: 500;\r\n    font-size: 13px;\r\n    transition: max-width 0.23s ease, opacity 0.17s ease, margin-left 0.23s ease;\r\n}\r\n\r\n#topbar-container:hover .nav-btn span {\r\n    max-width: 70px;\r\n    opacity: 1;\r\n    margin-left: 8px;\r\n}\n</style>\r\n    <style>\n/* Music Page Styles */\r\n\r\n/* Global resets handled by main.css */\r\n\r\n.app {\r\n    display: flex;\r\n    height: 100vh;\r\n    overflow: hidden;\r\n}\r\n\r\n/* Sidebar */\r\n.sidebar {\r\n    width: 260px;\r\n    background: var(--surface);\r\n    border-right: 1px solid var(--border);\r\n    display: flex;\r\n    flex-direction: column;\r\n    height: 100vh;\r\n    flex-shrink: 0;\r\n    transition: transform 0.3s ease;\r\n    z-index: 100;\r\n}\r\n\r\n@media (max-width: 768px) {\r\n    .sidebar {\r\n        position: fixed;\r\n        transform: translateX(-100%);\r\n        width: 80%;\r\n        max-width: 300px;\r\n        box-shadow: 2px 0 10px rgba(0, 0, 0, 0.5);\r\n    }\r\n\r\n    .sidebar.mobile-open {\r\n        transform: translateX(0);\r\n    }\r\n}\r\n\r\n.sidebar-header {\r\n    padding: 16px 20px;\r\n    border-bottom: 1px solid var(--border);\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n}\r\n\r\n.sidebar-header h2 {\r\n    font-size: 13px;\r\n    font-weight: 600;\r\n    color: var(--text-muted);\r\n    text-transform: uppercase;\r\n    letter-spacing: 0.04em;\r\n}\r\n\r\n.playlist-section {\r\n    flex: 1;\r\n    overflow-y: auto;\r\n    padding: 8px;\r\n}\r\n\r\n.playlist-item {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 12px;\r\n    padding: 10px 12px;\r\n    border-radius: 6px;\r\n    cursor: pointer;\r\n    transition: background .1s;\r\n}\r\n\r\n.playlist-item:hover,\r\n.playlist-item.active {\r\n    background: var(--surface-hover);\r\n}\r\n\r\n.playlist-icon {\r\n    width: 36px;\r\n    height: 36px;\r\n    background: var(--border);\r\n    border-radius: 4px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    color: var(--text-muted);\r\n    font-size: 14px;\r\n}\r\n\r\n.playlist-info {\r\n    flex: 1;\r\n    min-width: 0;\r\n}\r\n\r\n.playlist-name {\r\n    font-size: 13px;\r\n    font-weight: 500;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 6px;\r\n}\r\n\r\n.playlist-count {\r\n    font-size: 11px;\r\n    color: var(--text-muted);\r\n    margin-top: 1px;\r\n}\r\n\r\n.playlist-expand {\r\n    font-size: 10px;\r\n    color: var(--text-muted);\r\n    transition: transform .2s;\r\n}\r\n\r\n.playlist-item.expanded .playlist-expand {\r\n    transform: rotate(180deg);\r\n}\r\n\r\n.playlist-divider {\r\n    height: 1px;\r\n    background: var(--border);\r\n    margin: 8px 12px;\r\n}\r\n\r\n.playlist-songs {\r\n    display: none;\r\n    padding-left: 20px;\r\n}\r\n\r\n.playlist-songs.show {\r\n    display: block;\r\n}\r\n\r\n.playlist-song {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 10px;\r\n    padding: 8px 12px;\r\n    border-radius: 4px;\r\n    cursor: pointer;\r\n    font-size: 12px;\r\n    color: var(--text-muted);\r\n    position: relative;\r\n}\r\n\r\n.playlist-song:hover {\r\n    background: var(--surface-hover);\r\n    color: var(--text);\r\n}\r\n\r\n.playlist-song img {\r\n    width: 32px;\r\n    height: 32px;\r\n    border-radius: 3px;\r\n    object-fit: cover;\r\n    background: var(--surface-active);\r\n}\r\n\r\n.playlist-song-info {\r\n    flex: 1;\r\n    min-width: 0;\r\n}\r\n\r\n.playlist-song-title {\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n}\r\n\r\n.playlist-song-artist {\r\n    font-size: 10px;\r\n    opacity: 0.7;\r\n}\r\n\r\n.playlist-song-remove {\r\n    display: none;\r\n    width: 24px;\r\n    height: 24px;\r\n    background: transparent;\r\n    border: none;\r\n    color: var(--text-muted);\r\n    cursor: pointer;\r\n    border-radius: 3px;\r\n    font-size: 12px;\r\n    align-items: center;\r\n    justify-content: center;\r\n    transition: all 0.2s;\r\n}\r\n\r\n.playlist-song:hover .playlist-song-remove {\r\n    display: flex;\r\n}\r\n\r\n.playlist-song-remove:hover {\r\n    background: rgba(239, 68, 68, 0.1);\r\n    color: var(--error);\r\n}\r\n\r\n.add-playlist-btn {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 10px;\r\n    width: 100%;\r\n    padding: 10px 12px;\r\n    border: none;\r\n    background: transparent;\r\n    color: var(--text-muted);\r\n    font-size: 13px;\r\n    cursor: pointer;\r\n    border-radius: 6px;\r\n    text-align: left;\r\n}\r\n\r\n.add-playlist-btn:hover {\r\n    background: var(--surface-hover);\r\n    color: var(--text);\r\n}\r\n\r\n/* Main - Centered Layout */\r\n.main {\r\n    flex: 1;\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    justify-content: center;\r\n    padding: 20px 40px;\r\n    height: 100vh;\r\n    overflow-y: auto;\r\n    position: relative;\r\n}\r\n\r\n@media (max-width: 768px) {\r\n    .main {\r\n        padding: 20px;\r\n    }\r\n}\r\n\r\n.mobile-menu-btn {\r\n    display: none;\r\n    position: absolute;\r\n    top: 20px;\r\n    left: 20px;\r\n    z-index: 50;\r\n    background: transparent;\r\n    border: none;\r\n    color: var(--text);\r\n    font-size: 20px;\r\n    cursor: pointer;\r\n}\r\n\r\n@media (max-width: 768px) {\r\n    .mobile-menu-btn {\r\n        display: block;\r\n    }\r\n}\r\n\r\n/* Source Tabs */\r\n.source-tabs {\r\n    display: flex;\r\n    gap: 2px;\r\n    background: var(--surface);\r\n    padding: 4px;\r\n    border-radius: 8px;\r\n    margin-bottom: 24px;\r\n    flex-wrap: wrap;\r\n    justify-content: center;\r\n}\r\n\r\n.source-tab {\r\n    padding: 8px 20px;\r\n    border: none;\r\n    background: transparent;\r\n    color: var(--text-muted);\r\n    font-size: 12px;\r\n    font-weight: 500;\r\n    cursor: pointer;\r\n    border-radius: 6px;\r\n    transition: all .1s;\r\n}\r\n\r\n.source-tab:hover {\r\n    color: var(--text);\r\n}\r\n\r\n.source-tab.active {\r\n    background: var(--surface-hover);\r\n    color: var(--text);\r\n}\r\n\r\n/* Search */\r\n.search-container {\r\n    width: 100%;\r\n    max-width: 480px;\r\n    margin-bottom: 40px;\r\n    z-index: 20;\r\n}\r\n\r\n.search-wrapper {\r\n    position: relative;\r\n}\r\n\r\n.search-box {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 12px;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: 10px;\r\n    padding: 12px 16px;\r\n}\r\n\r\n.search-box i {\r\n    color: var(--text-muted);\r\n    font-size: 14px;\r\n}\r\n\r\n.search-box input {\r\n    flex: 1;\r\n    background: transparent;\r\n    border: none;\r\n    outline: none;\r\n    color: var(--text);\r\n    font-size: 14px;\r\n}\r\n\r\n.search-box input::placeholder {\r\n    color: var(--text-muted);\r\n}\r\n\r\n.results {\r\n    display: none;\r\n    position: absolute;\r\n    top: calc(100% + 6px);\r\n    left: 0;\r\n    right: 0;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: 10px;\r\n    max-height: 340px;\r\n    overflow-y: auto;\r\n    z-index: 100;\r\n    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);\r\n}\r\n\r\n.results.show {\r\n    display: block;\r\n}\r\n\r\n.result-item {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 12px;\r\n    padding: 10px 14px;\r\n    cursor: pointer;\r\n    transition: background .1s;\r\n}\r\n\r\n.result-item:hover {\r\n    background: var(--surface-hover);\r\n}\r\n\r\n.result-img {\r\n    width: 44px;\r\n    height: 44px;\r\n    border-radius: 4px;\r\n    object-fit: cover;\r\n    background: var(--border);\r\n}\r\n\r\n.result-info {\r\n    flex: 1;\r\n    min-width: 0;\r\n}\r\n\r\n.result-title {\r\n    font-size: 13px;\r\n    font-weight: 500;\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n}\r\n\r\n.result-artist {\r\n    font-size: 11px;\r\n    color: var(--text-muted);\r\n    margin-top: 2px;\r\n}\r\n\r\n.result-actions {\r\n    display: flex;\r\n    gap: 2px;\r\n}\r\n\r\n.result-action {\r\n    width: 28px;\r\n    height: 28px;\r\n    border: none;\r\n    background: transparent;\r\n    color: var(--text-muted);\r\n    cursor: pointer;\r\n    border-radius: 4px;\r\n    font-size: 12px;\r\n}\r\n\r\n.result-action:hover {\r\n    background: var(--border);\r\n    color: var(--text);\r\n}\r\n\r\n.result-action.liked {\r\n    color: var(--text);\r\n}\r\n\r\n/* Player */\r\n.player-section {\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    width: 100%;\r\n    max-width: 720px;\r\n}\r\n\r\n@media (min-width: 768px) {\r\n    .player-section {\r\n        flex-direction: row;\r\n        gap: 36px;\r\n    }\r\n}\r\n\r\n.album-art {\r\n    width: 200px;\r\n    height: 200px;\r\n    border-radius: 12px;\r\n    overflow: hidden;\r\n    background: var(--surface);\r\n    flex-shrink: 0;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    margin-bottom: 20px;\r\n    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);\r\n}\r\n\r\n@media (min-width: 768px) {\r\n    .album-art {\r\n        width: 240px;\r\n        height: 240px;\r\n        margin-bottom: 0;\r\n    }\r\n}\r\n\r\n.album-art img {\r\n    width: 100%;\r\n    height: 100%;\r\n    object-fit: cover;\r\n}\r\n\r\n.album-art .placeholder {\r\n    font-size: 72px;\r\n    color: var(--surface-active);\r\n}\r\n\r\n.player-info {\r\n    flex: 1;\r\n    width: 100%;\r\n    min-width: 0;\r\n    text-align: center;\r\n}\r\n\r\n@media (min-width: 768px) {\r\n    .player-info {\r\n        text-align: left;\r\n    }\r\n}\r\n\r\n.mode-badges {\r\n    display: flex;\r\n    gap: 8px;\r\n    margin-bottom: 12px;\r\n    justify-content: center;\r\n}\r\n\r\n@media (min-width: 768px) {\r\n    .mode-badges {\r\n        justify-content: flex-start;\r\n    }\r\n}\r\n\r\n.mode-badge {\r\n    display: none;\r\n    align-items: center;\r\n    gap: 5px;\r\n    padding: 4px 10px;\r\n    background: var(--surface-hover);\r\n    border-radius: 12px;\r\n    font-size: 10px;\r\n    color: var(--text-muted);\r\n    border: none;\r\n    cursor: pointer;\r\n}\r\n\r\n.mode-badge.show {\r\n    display: inline-flex;\r\n}\r\n\r\n#proxyBtn {\r\n    display: inline-flex;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    transition: all .15s;\r\n}\r\n\r\n#proxyBtn.active {\r\n    background: var(--surface-hover);\r\n    color: var(--text);\r\n    border-color: var(--text-muted);\r\n}\r\n\r\n.track-title {\r\n    font-size: 20px;\r\n    font-weight: 600;\r\n    margin-bottom: 4px;\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n}\r\n\r\n@media (min-width: 768px) {\r\n    .track-title {\r\n        font-size: 24px;\r\n    }\r\n}\r\n\r\n.track-artist {\r\n    font-size: 14px;\r\n    color: var(--text-muted);\r\n    margin-bottom: 24px;\r\n}\r\n\r\n/* Controls */\r\n.controls {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    gap: 5px;\r\n    margin-bottom: 20px;\r\n}\r\n\r\n@media (min-width: 768px) {\r\n    .controls {\r\n        justify-content: flex-start;\r\n    }\r\n}\r\n\r\n.control-btn {\r\n    background: transparent;\r\n    border: none;\r\n    color: var(--text-muted);\r\n    font-size: 16px;\r\n    cursor: pointer;\r\n    padding: 10px;\r\n    border-radius: 50%;\r\n    transition: all .1s;\r\n}\r\n\r\n.control-btn:hover {\r\n    color: var(--text);\r\n}\r\n\r\n.control-btn.active {\r\n    color: var(--accent);\r\n}\r\n\r\n.play-btn {\r\n    width: 48px;\r\n    height: 48px;\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n    font-size: 18px;\r\n    margin: 0 4px;\r\n}\r\n\r\n.play-btn:hover {\r\n    color: var(--bg);\r\n    transform: scale(1.05);\r\n}\r\n\r\n.control-divider {\r\n    width: 1px;\r\n    height: 20px;\r\n    background: var(--border);\r\n    margin: 0 6px;\r\n}\r\n\r\n/* Progress */\r\n.progress-container {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 10px;\r\n    margin-bottom: 12px;\r\n}\r\n\r\n.time {\r\n    font-size: 11px;\r\n    color: var(--text-muted);\r\n    min-width: 36px;\r\n    font-variant-numeric: tabular-nums;\r\n}\r\n\r\n.progress-bar {\r\n    flex: 1;\r\n    height: 4px;\r\n    background: var(--border);\r\n    border-radius: 2px;\r\n    cursor: pointer;\r\n    position: relative;\r\n}\r\n\r\n.progress-fill {\r\n    height: 100%;\r\n    background: var(--accent);\r\n    border-radius: 2px;\r\n    width: 0%;\r\n}\r\n\r\n/* Volume */\r\n.volume-container {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 6px;\r\n    justify-content: center;\r\n}\r\n\r\n@media (min-width: 768px) {\r\n    .volume-container {\r\n        justify-content: flex-start;\r\n    }\r\n}\r\n\r\n.volume-bar {\r\n    width: 70px;\r\n    height: 3px;\r\n    background: var(--border);\r\n    border-radius: 2px;\r\n    cursor: pointer;\r\n}\r\n\r\n.volume-fill {\r\n    height: 100%;\r\n    background: var(--accent);\r\n    border-radius: 2px;\r\n    width: 100%;\r\n}\r\n\r\n/* Lyrics */\r\n.lyrics-section {\r\n    margin-top: 36px;\r\n    max-width: 500px;\r\n    width: 100%;\r\n    text-align: center;\r\n}\r\n\r\n.lyrics-header {\r\n    font-size: 11px;\r\n    color: var(--text-muted);\r\n    margin-bottom: 12px;\r\n    text-transform: uppercase;\r\n    letter-spacing: 0.04em;\r\n}\r\n\r\n.lyrics-content {\r\n    font-size: 13px;\r\n    line-height: 2;\r\n    max-height: 120px;\r\n    overflow-y: auto;\r\n    mask-image: linear-gradient(to bottom, transparent, black 10%, black 90%, transparent);\r\n    -webkit-mask-image: linear-gradient(to bottom, transparent, black 10%, black 90%, transparent);\r\n}\r\n\r\n.lyrics-line {\r\n    color: var(--text-muted);\r\n    padding: 2px 0;\r\n    transition: all .3s;\r\n    cursor: pointer;\r\n}\r\n\r\n.lyrics-line:hover {\r\n    color: var(--text);\r\n}\r\n\r\n.lyrics-line.active {\r\n    color: var(--accent);\r\n    font-weight: 600;\r\n    transform: scale(1.05);\r\n}\r\n\r\n.lyrics-line.past {\r\n    color: var(--text-dim);\r\n}\r\n\r\n/* Fallback container */\r\n.fallback-container {\r\n    display: none;\r\n    position: fixed;\r\n    bottom: 0;\r\n    left: 50%;\r\n    transform: translateX(-50%);\r\n    width: 440px;\r\n    height: 250px;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: 12px 12px 0 0;\r\n    overflow: hidden;\r\n    z-index: 1000;\r\n    box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.3);\r\n}\r\n\r\n.fallback-container.show {\r\n    display: block;\r\n}\r\n\r\n.fallback-container.audio-only {\r\n    position: fixed;\r\n    top: 0;\r\n    left: -9999px;\r\n    width: 100px;\r\n    height: 100px;\r\n    opacity: 0;\r\n    pointer-events: none;\r\n    z-index: -1;\r\n    border: none;\r\n    box-shadow: none;\r\n    transform: none;\r\n    display: block !important;\r\n}\r\n\r\n.fallback-container iframe {\r\n    width: 100%;\r\n    height: 100%;\r\n    border: none;\r\n}\r\n\r\n.fallback-close {\r\n    position: absolute;\r\n    top: 8px;\r\n    right: 8px;\r\n    width: 24px;\r\n    height: 24px;\r\n    background: rgba(0, 0, 0, 0.5);\r\n    border: none;\r\n    border-radius: 4px;\r\n    color: #fff;\r\n    cursor: pointer;\r\n    z-index: 10;\r\n    font-size: 10px;\r\n}\r\n\r\n/* Modal */\r\n/* Modal styles handled by main.css (or use specific class if needed) */\r\n\r\n\r\n.modal-actions {\r\n    display: flex;\r\n    gap: 8px;\r\n    justify-content: flex-end;\r\n}\r\n\r\n.modal-btn {\r\n    padding: 8px 16px;\r\n    border-radius: 6px;\r\n    border: none;\r\n    font-size: 12px;\r\n    cursor: pointer;\r\n    font-weight: 500;\r\n}\r\n\r\n.modal-btn.cancel {\r\n    background: var(--border);\r\n    color: var(--text);\r\n}\r\n\r\n.modal-btn.confirm {\r\n    background: var(--text);\r\n    color: var(--bg);\r\n}\r\n\r\n/* Add menu - fixed positioning */\r\n.add-menu {\r\n    display: none;\r\n    position: fixed;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: 8px;\r\n    padding: 4px;\r\n    min-width: 160px;\r\n    z-index: 200;\r\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\r\n}\r\n\r\n.add-menu.show {\r\n    display: block;\r\n}\r\n\r\n.add-menu-item {\r\n    display: block;\r\n    width: 100%;\r\n    padding: 8px 12px;\r\n    border: none;\r\n    background: transparent;\r\n    color: var(--text);\r\n    font-size: 12px;\r\n    text-align: left;\r\n    cursor: pointer;\r\n    border-radius: 4px;\r\n}\r\n\r\n.add-menu-item:hover {\r\n    background: var(--surface-hover);\r\n}\r\n\r\n.loading-text {\r\n    padding: 20px;\r\n    text-align: center;\r\n    color: var(--text-muted);\r\n    font-size: 12px;\r\n}\r\n\r\n::-webkit-scrollbar {\r\n    width: 4px;\r\n}\r\n\r\n::-webkit-scrollbar-track {\r\n    background: transparent;\r\n}\r\n\r\n::-webkit-scrollbar-thumb {\r\n    background: var(--surface-active);\r\n    border-radius: 2px;\r\n}\n</style>\r\n    <style>\n/**\r\n * PHANTOM - BACKGROUND STYLES\r\n */\r\n.phantom-background {\r\n    position: fixed;\r\n    inset: 0;\r\n    width: 100vw;\r\n    height: 100vh;\r\n    z-index: -1;\r\n    overflow: hidden;\r\n    background: transparent;\r\n    pointer-events: none;\r\n    opacity: 1;\r\n    transition: background-color 0.3s ease;\r\n}\r\n\r\n.phantom-background.active {\r\n    opacity: 1;\r\n}\r\n\r\n.phantom-background-overlay {\r\n    position: absolute;\r\n    inset: 0;\r\n    z-index: 2;\r\n    background: rgba(0, 0, 0, var(--bg-overlay, 0.4));\r\n    transition: background-color 0.3s ease;\r\n}\r\n\r\n.phantom-background-layer {\r\n    position: absolute;\r\n    inset: 0;\r\n    z-index: 1;\r\n    transition: opacity 0.3s ease-in-out;\r\n}\r\n\r\n.phantom-background-media {\r\n    width: 100%;\r\n    height: 100%;\r\n    object-fit: cover;\r\n    object-position: var(--bg-image-position, center);\r\n    display: block;\r\n    border: none;\r\n}\r\n\r\n/* Video and Iframe positioning for full background cover */\r\n.phantom-background-layer video.phantom-background-media,\r\n.phantom-background-layer iframe.phantom-background-media {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    transform: none;\r\n    pointer-events: none;\r\n    min-width: 100%;\r\n    min-height: 100%;\r\n    max-width: none;\r\n    max-height: none;\r\n    object-position: var(--bg-image-position, center);\r\n}\r\n\r\n/* Ensure iframes cover entire background */\r\n.phantom-background-layer iframe.phantom-background-media {\r\n    border: none;\r\n    object-fit: cover;\r\n}\r\n\r\n/* Ensure content on top remains readable */\r\nhtml {\r\n    background-color: var(--bg);\r\n}\r\n\r\nbody {\r\n    position: relative;\r\n    z-index: 0;\r\n    background: transparent !important;\r\n    /* Allow background to show through */\r\n}\r\n\r\n/* Specific adjustments for transparency if needed */\r\n.main-content,\r\n.home-page {\r\n    background: transparent !important;\r\n}\r\n\r\n/* Glassmorphism for containers when background is active */\r\n.phantom-background.active~.offline-banner,\r\n.phantom-background.active~.home-page .card,\r\n.phantom-background.active~.home-page .featured-card,\r\n.phantom-background.active~.home-page .search-bar,\r\n.phantom-background.active~.settings-panel {\r\n    backdrop-filter: blur(10px);\r\n    -webkit-backdrop-filter: blur(10px);\r\n    background: rgba(15, 15, 15, 0.7) !important;\r\n}\n</style>\r\n    <script>\n// site config\r\n\r\nwindow.SITE_CONFIG = {\r\n    name: \"Phantom\",\r\n    fullName: \"Phantom Unblocked\",\r\n    version: \"1.0.12\",\r\n\r\n    changelog: [\r\n        \"1.0.12: tiny fixxes and changes\",\r\n        \"some code consolidation and fixxes\",\r\n        \"suggest features in the discord server\"\r\n    ],\r\n\r\n    // quotes\r\n    quotes: [\r\n        \"lebron lebron lebronn james\",\r\n        \"so tuff\",\r\n        \"it is what it is\",\r\n        \"do ur work\",\r\n        \"this is what happens when u dont touch grass\",\r\n        \"FULL BOX\",\r\n        \"FULL PIECE\",\r\n        \"200!\",\r\n        \"press esc + refresh + power button for hacks\",\r\n        \"press ctrl+x to hide your screen\",\r\n        \"change the tab title and favicon in settings\",\r\n        \"TEACHERR!\",\r\n        \"1 pump\",\r\n        \"303 headshot\",\r\n        \"bros prolly a 60 ovr\",\r\n        \"take the L lil bro\",  \r\n        \"lebron is OUR goat\",\r\n        \"stop looking at my screen\",\r\n    ],\r\n\r\n    // todo\r\n    // *** for strikethrough\r\n    // ** for bold\r\n    todos: [\r\n        \"***fixxed aboutblank opening while securly is on (previously if popups were off it would load intab instead of clickto launch now it will use clicktolaunch unless popups are blocked)***\",\r\n        \"***fix the proxy***\",\r\n        \"***fix panic panickey, add quote talking about it***\",\r\n        \"***fix theatermode, make it hide buttons after a few seconds and ensure all content is being displayed and move the description to the bottom***\",\r\n        \"***change back player to use old styling, change the surface to use background colors for the bottom part where description is shown, looking just like the background***\",\r\n        \"***add image and video support for backgrounds***\",\r\n        \"***fix aichat, make the title use the same ai request as the users question unless its in image mode where it will use text mode and fix ai chat to remember modes better***\",\r\n        \"***add cloaking to quotes***\",\r\n        \"***add a default cloak and fix it so icons work in aboutblank for whatever reason they only work when you go to settings in aboutblank where it correctly applies***\",\r\n        \"***for search suggestions add highlighting for whatever will happen when you click enter, in search suggestions fix all games not sending you to the games page***\",\r\n        \"***fix games to make multi library the default, put it in config.js***\",\r\n        \"***rename movies shortcut in index2.html to primeshows, add shortcuts to main pages in the topbar and change the current shortcuts to more popular games***\",\r\n        \"***make announcements show even on first visit unlike changelog and allow disabling it via settings***\",\r\n        \"***fix leave comformation asking u to leave each time you click something***\",\r\n        \"***change the shortcuts on the main page to include pages***\",\r\n        \"***add movies to the search bar in main page***\",\r\n        \"***fix background not turning off soon***\",\r\n        \"***fix music page to hide youtube player unless toggled via 3 dot small button, and always shown on proxy mode, fix all the controls for video time, volume***\",\r\n        \"**add singlefile this is lowk so hard i dont really understand it**\",\r\n        \"**advertise phantom (too much work tbh)**\",\r\n        \"**add a watch page for youtube and twitch**\",\r\n        \"**add a miniplayer for music**\",\r\n        \"***shorten some page's code***\",\r\n        \"***fix paths in search autocomplete***\",\r\n        \"***fix markdown in ai not using correct text colors***\",\r\n        \"***make backgrounds show in the loading screen***\",\r\n        \"***fix icons for topbar in code.html***\",\r\n        \"**fix wisp server not notifying or autoswitiching when offline in proxy**\",\r\n        \"***fix code runner open not working at all***\",\r\n        \"***make backgrounds show in player.html***\",\r\n        \"***make backgrounds show in staticsjv2***\",\r\n        \"***make player.html player controls use theme colros not hardcoded***\",\r\n        \"***make ai chat and music sidebar go all the way down and up with borders***\",\r\n        \"**make the only song in music be lebron lebron lebron james**\",\r\n        \"**fix music controls**\",\r\n        \"***finish extra page into credits and make this todo be tucked away somewhere and not the main part of it***\"\r\n    ],\r\n    defaultWisp: \"wss://glseries.net/wisp/\",\r\n    wispServers: [\r\n        { name: \"GLSeries Wisp\", url: \"wss://glseries.net/wisp/\" },\r\n        { name: \"Rhw's Wisp\", url: \"wss://wisp.rhw.one/\" },\r\n    ],\r\n\r\n    discord: {\r\n        inviteUrl: \"https://discord.gg/tHWx9NXp5p\",\r\n        widgetServer: \"1447673724017971324\",\r\n        widgetChannel: \"1447673726228496617\",\r\n    },\r\n\r\n    firstVisitCloak: false, //fake error page\r\n    defaults: {\r\n        cloakMode: \"about:blank\",\r\n        tabTitle: \"You've already responded\",\r\n        tabFavicon: \"https://ssl.gstatic.com/docs/spreadsheets/forms/forms_icon_2023q4.ico\",\r\n        cloakRotation: false,\r\n        cloakInterval: 5000,\r\n        panicKey: \"x\",\r\n        panicModifiers: [\"ctrl\", \"shift\"],\r\n        panicUrl: \"https://classroom.google.com\",\r\n        maxMovieRating: \"R\",\r\n        gameLibrary: \"multi\",\r\n        discordWidget: true,\r\n        miniplayer: true,\r\n        leaveConfirmation: false,\r\n        showChangelogOnUpdate: true,\r\n        themeRotation: true,\r\n        lastThemeRotation: 0,\r\n        backgroundRotation: true,\r\n        lastBackgroundRotation: 0,\r\n        lastSeenFeatured: 'none',\r\n        background: { type: 'color', value: '#0a0a0a' },\r\n        customBackground: { id: 'none', type: 'none' },\r\n        accentColor: '#ffffff',\r\n        surfaceColor: '#0f0f0f',\r\n        secondaryColor: '#2e2e33',\r\n        textColor: '#e4e4e7',\r\n    },\r\n\r\n    themePresets: {\r\n        dark: { name: 'Dark (Default)', bg: { type: 'color', value: '#0a0a0a' }, surface: '#0f0f0f', surfaceHover: '#1a1a1a', surfaceActive: '#252525', secondary: '#2e2e33', border: '#2a2a2a', borderLight: '#2a2a2a', text: '#e4e4e7', textSec: '#71717a', textDim: '#52525b', accent: '#ffffff' },\r\n        midnight: { name: 'Midnight', bg: { type: 'color', value: '#000000' }, surface: '#050505', surfaceHover: '#111111', surfaceActive: '#1a1a1a', secondary: '#111111', border: '#1a1a1a', borderLight: '#111111', text: '#ededed', textSec: '#a3a3a3', textDim: '#737373', accent: '#d4d4d4' },\r\n        abyss: { name: 'Abyss', bg: { type: 'color', value: '#020617' }, surface: '#0f172a', surfaceHover: '#1e293b', surfaceActive: '#334155', secondary: '#1e293b', border: '#1e293b', borderLight: '#1e293b', text: '#f1f5f9', textSec: '#94a3b8', textDim: '#64748b', accent: '#38bdf8' },\r\n        phantom: { name: 'Phantom', bg: { type: 'color', value: '#0f0a14' }, surface: '#1a0f24', surfaceHover: '#2e1a40', surfaceActive: '#4c2a5c', secondary: '#2e1a40', border: '#2e1a40', borderLight: '#2e1a40', text: '#f3e8ff', textSec: '#d8b4fe', textDim: '#c084fc', accent: '#c084fc' },\r\n        rosepine: { name: 'Rose Pine', bg: { type: 'color', value: '#191724' }, surface: '#1f1d2e', surfaceHover: '#26233a', surfaceActive: '#524f67', secondary: '#26233a', border: '#26233a', borderLight: '#1f1d2e', text: '#e0def4', textSec: '#908caa', textDim: '#6e6a86', accent: '#ebbcba' },\r\n        ocean: { name: 'Oceanic', bg: { type: 'color', value: '#011627' }, surface: '#0b2942', surfaceHover: '#1d3b53', surfaceActive: '#2d4b63', secondary: '#0b2942', border: '#1d3b53', borderLight: '#0b2942', text: '#d6deeb', textSec: '#5f7e97', textDim: '#011627', accent: '#7fdbca' },\r\n        forest: { name: 'Forest', bg: { type: 'color', value: '#020d06' }, surface: '#051a0d', surfaceHover: '#0a2e17', surfaceActive: '#0f4221', secondary: '#051a0d', border: '#0a2e17', borderLight: '#051a0d', text: '#ecfdf5', textSec: '#6ee7b7', textDim: '#064e3b', accent: '#10b981' },\r\n        crimson: { name: 'Crimson', bg: { type: 'color', value: '#1a0505' }, surface: '#230a0a', surfaceHover: '#7b0a0aff', surfaceActive: '#7f1d1d', secondary: '#230a0a', border: '#480f0fff', borderLight: '#230a0a', text: '#fef2f2', textSec: '#fecaca', textDim: '#450a0a', accent: '#ef4444' },\r\n        flame: { name: 'Flame', bg: { type: 'color', value: '#0c0202' }, surface: '#1c0a0a', surfaceHover: '#451a03', surfaceActive: '#9a3412', secondary: '#1c0a0a', border: '#451a03', borderLight: '#9a3412', text: '#fff7ed', textSec: '#fdba74', textDim: '#ea580c', accent: '#f59e0b' }\r\n    },\r\n\r\n    backgroundPresets: [\r\n        { id: 'none', name: 'None (Theme Default)', type: 'none' },\r\n        { id: 'Night sky', name: 'Night sky', type: 'image', url: 'https://images.pexels.com/photos/5675745/pexels-photo-5675745.jpeg', overlay: 0.3 },\r\n        { id: 'winter-mountains', name: 'Winter mountains', type: 'image', url: 'https://images.pexels.com/photos/1287145/pexels-photo-1287145.jpeg', overlay: 0.3 },\r\n        { id: 'f1 car', name: 'F1 Car', type: 'image', url: 'https://images.pexels.com/photos/14401632/pexels-photo-14401632.jpeg', overlay: 0.3 },\r\n        { id: 'moon-landing', name: 'Moon Landing', type: 'image', url: 'https://images.pexels.com/photos/41162/moon-landing-apollo-11-nasa-buzz-aldrin-41162.jpeg', overlay: 0.3, objectPosition: 'top left', active: true },\r\n        { id: 'turtle', name: 'Turtle', type: 'image', url: 'https://images.unsplash.com/photo-1501791187590-9ef2612ba1eb?q=80&w=1932&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D', overlay: 0.3 },\r\n        { id: 'road', name: 'Road', type: 'image', url: 'https://images.unsplash.com/photo-1508233620467-f79f1e317a05', overlay: 0.3 },\r\n        { id: 'railroad', name: 'Railroad', type: 'image', url: 'https://images.unsplash.com/photo-1505832018823-50331d70d237', overlay: 0.3 },\r\n        { id: 'mountain', name: 'Mountain', type: 'image', url: 'https://raw.githubusercontent.com/evanhnry/brave-wallpapers/refs/heads/main/Brave/clay-banks-u27Rrbs9Dwc-unsplash.jpg', overlay: 0.3 },\r\n    ],\r\n\r\n    cloakPresets: [\r\n        { name: \"Phantom\", icon: \"/favicon.svg\", title: \"Phantom Unblocked\" },\r\n        { name: \"Edpuzzle\", icon: \"https://edpuzzle.imgix.net/favicons/favicon-32.png\", title: \"Edpuzzle\" },\r\n        { name: \"Google Docs\", icon: \"https://ssl.gstatic.com/docs/documents/images/kix-favicon7.ico\", title: \"Untitled document - Google Docs\" },\r\n        { name: \"Canvas\", icon: \"https://du11hjcvx0uqb.cloudfront.net/dist/images/favicon-e10d657a73.ico\", title: \"Dashboard\" },\r\n        { name: \"Desmos\", icon: \"https://www.desmos.com/favicon.ico\", title: \"Desmos | Graphing Calculator\" },\r\n        { name: \"Khan Academy\", icon: \"https://cdn.kastatic.org/images/favicon.ico\", title: \"Khan Academy\" },\r\n        { name: \"Wikipedia\", icon: \"https://en.wikipedia.org/favicon.ico\", title: \"World War II - Wikipedia\" },\r\n        { name: \"Classroom\", icon: \"https://ssl.gstatic.com/classroom/favicon.png\", title: \"Home - Classroom\" },\r\n        { name: \"Canva\", icon: \"https://static.canva.com/static/images/android-192x192-2.png\", title: \"Home - Canva\" },\r\n        { name: \"Quiz\", icon: \"https://ssl.gstatic.com/docs/spreadsheets/forms/forms_icon_2023q4.ico\", title: \"You've already responded\" },\r\n        { name: \"Blooket\", icon: \"https://play.blooket.com/favicon.ico\", title: \"Play Blooket | Blooket\" },\r\n        { name: \"Gmail\", icon: \"https://ssl.gstatic.com/ui/v1/icons/mail/rfr/gmail.ico\", title: \"Gmail\" },\r\n        { name: \"YouTube\", icon: \"https://www.youtube.com/favicon.ico\", title: \"YouTube\" },\r\n        { name: \"Powerschool\", icon: \"https://waverlyk12.powerschool.com/favicon.ico\", title: \"Grades and Attendance\" },\r\n        { name: \"nothing\", icon: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=\", title: \"\\u200B\" },\r\n    ]\r\n}\r\n\r\n\r\n\n</script>\r\n    <script>\n// settings handler\r\n(function () {\r\n    'use strict';\r\n\r\n    const STORAGE_KEY = 'void_settings';\r\n\r\n    const getDefaults = () => {\r\n        return window.SITE_CONFIG?.defaults || {\r\n            cloakMode: 'none',\r\n            cloakRotation: false,\r\n            cloakInterval: 5000,\r\n            panicKey: 'x',\r\n            panicModifiers: ['ctrl', 'shift'],\r\n            panicUrl: 'https://classroom.google.com',\r\n            maxMovieRating: 'R',\r\n            offlineGames: [],\r\n            gameLibrary: 'multi',\r\n            leaveConfirmation: false\r\n        };\r\n    };\r\n\r\n    const load = () => {\r\n        try {\r\n            const stored = localStorage.getItem(STORAGE_KEY);\r\n            if (stored) {\r\n                return { ...getDefaults(), ...JSON.parse(stored) };\r\n            }\r\n        } catch (e) {\r\n            console.warn('Failed to load settings:', e);\r\n        }\r\n        return getDefaults();\r\n    };\r\n\r\n    const save = (settings) => {\r\n        try {\r\n            localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n            window.dispatchEvent(new CustomEvent('settings-changed', { detail: settings }));\r\n            if (window.parent !== window) {\r\n                window.parent.postMessage({ type: 'settings-update' }, '*');\r\n            }\r\n        } catch (e) {\r\n            console.warn('Failed to save settings:', e);\r\n        }\r\n    };\r\n\r\n    let _settings = load();\r\n\r\n    window.Settings = {\r\n        get(key) { return _settings[key]; },\r\n\r\n        getAll() { return { ..._settings }; },\r\n\r\n        set(key, value) {\r\n            _settings[key] = value;\r\n            save(_settings);\r\n            this.apply();\r\n            return value;\r\n        },\r\n\r\n        update(partial) {\r\n            _settings = { ..._settings, ...partial };\r\n            save(_settings);\r\n            this.apply();\r\n        },\r\n\r\n        reset() {\r\n            _settings = getDefaults();\r\n            save(_settings);\r\n            this.apply();\r\n        },\r\n\r\n        apply() {\r\n            const root = document.documentElement;\r\n            const s = _settings;\r\n            const d = window.SITE_CONFIG?.defaults || {};\r\n\r\n            const vars = {\r\n                '--accent': s.accentColor || d.accentColor || '#ffffff',\r\n                '--surface': s.surfaceColor || d.surfaceColor || '#0f0f0f',\r\n                '--surface-hover': s.surfaceHoverColor || d.surfaceHoverColor || '#1a1a1a',\r\n                '--surface-active': s.surfaceActiveColor || d.surfaceActiveColor || '#252525',\r\n                '--secondary': s.secondaryColor || d.secondaryColor || '#2e2e33',\r\n                '--border': s.borderColor || d.borderColor || '#1f1f1f',\r\n                '--border-light': s.borderLightColor || d.borderLightColor || '#2a2a2a',\r\n                '--text': s.textColor || d.textColor || '#e4e4e7',\r\n                '--text-muted': s.textSecondaryColor || d.textSecondaryColor || '#71717a',\r\n                '--text-dim': s.textDimColor || d.textDimColor || '#52525b',\r\n                '--toggle': s.toggleColor || d.toggleColor,\r\n                '--toggle-knob': s.toggleKnobColor || d.toggleKnobColor\r\n            };\r\n\r\n            Object.entries(vars).forEach(([key, val]) => {\r\n                if (val) root.style.setProperty(key, val);\r\n            });\r\n\r\n            const themeBg = s.background || d.background || { type: 'color', value: '#0a0a0a' };\r\n            const customBg = s.customBackground;\r\n            const isCustomActive = customBg && customBg.type !== 'none';\r\n\r\n            if (themeBg.type === 'color') {\r\n                root.style.setProperty('--bg', themeBg.value);\r\n            }\r\n\r\n            if (isCustomActive && customBg.url) {\r\n                root.style.setProperty('--bg-image', `url(${customBg.url})`);\r\n\r\n                let position = customBg.objectPosition;\r\n                if (customBg.id && customBg.id !== 'custom') {\r\n                    const preset = window.SITE_CONFIG?.backgroundPresets?.find(b => b.id === customBg.id);\r\n                    if (preset?.objectPosition) position = preset.objectPosition;\r\n                }\r\n\r\n                root.style.setProperty('--bg-image-position', position || 'center');\r\n            } else if (themeBg.type === 'image' || themeBg.type === 'video') {\r\n                root.style.setProperty('--bg-image', `url(${themeBg.value || themeBg.url})`);\r\n                root.style.setProperty('--bg-image-position', themeBg.objectPosition || 'center');\r\n            } else if (themeBg.type === 'gradient') {\r\n                root.style.setProperty('--bg-image', themeBg.value || themeBg.url);\r\n                root.style.setProperty('--bg-image-position', 'center');\r\n            } else {\r\n                root.style.setProperty('--bg-image', 'none');\r\n            }\r\n        },\r\n\r\n        onChange(callback) {\r\n            window.addEventListener('settings-changed', (e) => callback(e.detail));\r\n        },\r\n\r\n        isRatingAllowed(rating) {\r\n            if (!rating || rating === 'NR' || rating === 'NC-17') return false;\r\n            const ratingOrder = ['G', 'PG', 'PG-13', 'R'];\r\n            const maxIndex = ratingOrder.indexOf(_settings.maxMovieRating);\r\n            const ratingIndex = ratingOrder.indexOf(rating);\r\n            return maxIndex !== -1 && ratingIndex !== -1 && ratingIndex <= maxIndex;\r\n        }\r\n    };\r\n\r\n    // panic button go brr\r\n    const handlePanic = (e) => {\r\n        const mods = _settings.panicModifiers || [];\r\n        const key = _settings.panicKey || 'x';\r\n\r\n        if (mods.includes('ctrl') !== e.ctrlKey) return;\r\n        if (mods.includes('shift') !== e.shiftKey) return;\r\n        if (mods.includes('alt') !== e.altKey) return;\r\n\r\n        if (e.key.toLowerCase() === key.toLowerCase()) {\r\n            e.preventDefault();\r\n            const overlayId = 'panic-overlay';\r\n            let overlay = window.parent?.document?.getElementById(overlayId) || document.getElementById(overlayId);\r\n\r\n            if (!overlay) {\r\n                overlay = document.createElement('div');\r\n                overlay.id = overlayId;\r\n                overlay.style.cssText = 'position:fixed;inset:0;background:white;z-index:99999;';\r\n                document.body.appendChild(overlay);\r\n            } else {\r\n                overlay.style.display = 'block';\r\n            }\r\n\r\n            window.location.replace(_settings.panicUrl || 'https://classroom.google.com');\r\n        }\r\n    };\r\n\r\n    const init = () => {\r\n        Settings.apply();\r\n\r\n        const featured = window.SITE_CONFIG?.featuredBackground;\r\n        const activePreset = window.SITE_CONFIG?.backgroundPresets?.find(p => p.active);\r\n\r\n        const target = activePreset || featured;\r\n\r\n        if (target?.id && target.id !== _settings.lastSeenFeatured) {\r\n            Settings.update({\r\n                customBackground: target,\r\n                lastSeenFeatured: target.id,\r\n                backgroundRotation: false\r\n            });\r\n        }\r\n\r\n        document.addEventListener('keydown', handlePanic, true);\r\n\r\n        window.addEventListener('storage', (e) => {\r\n            if (e.key === STORAGE_KEY) {\r\n                _settings = load();\r\n                Settings.apply();\r\n                window.dispatchEvent(new CustomEvent('settings-changed', { detail: _settings }));\r\n            }\r\n        });\r\n\r\n        window.addEventListener('message', (e) => {\r\n            if (e.data?.type === 'settings-update' || e.data === 'updateCloak') {\r\n                _settings = load();\r\n                Settings.apply();\r\n                window.dispatchEvent(new CustomEvent('settings-changed', { detail: _settings }));\r\n            }\r\n        });\r\n\r\n        window.addEventListener('beforeunload', (e) => {\r\n            if (document.getElementById('main-frame') && _settings.leaveConfirmation) {\r\n                e.preventDefault();\r\n                return e.returnValue = '';\r\n            }\r\n        });\r\n    };\r\n\r\n    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', init);\r\n    else init();\r\n})();\r\n\n</script>\r\n    <script>\n// background stuff\r\n(function () {\r\n    'use strict';\r\n\r\n    if (window.BackgroundManager) return;\r\n\r\n    const YOUTUBE_REGEX = /(?:youtube\\.com\\/watch\\?v=|youtu\\.be\\/|youtube\\.com\\/embed\\/)([a-zA-Z0-9_-]{11})/;\r\n\r\n    const BackgroundManager = {\r\n        container: null,\r\n        mediaLayer: null,\r\n        elements: { video: null, image: null, iframe: null },\r\n        current: { type: null, url: null },\r\n        cacheName: 'phantom-bg-cache-v2',\r\n\r\n        init() {\r\n            this.container = document.createElement('div');\r\n            this.container.className = 'phantom-background';\r\n            this.container.innerHTML = '<div class=\"phantom-background-overlay\"></div><div class=\"phantom-background-layer\"></div>';\r\n            this.mediaLayer = this.container.querySelector('.phantom-background-layer');\r\n            document.body.insertBefore(this.container, document.body.firstChild);\r\n\r\n            const apply = () => this.applyBackground();\r\n            window.addEventListener('settings-changed', apply);\r\n            window.addEventListener('storage', apply);\r\n            window.addEventListener('beforeunload', () => this.cleanup());\r\n            window.addEventListener('pagehide', () => this.cleanup());\r\n\r\n            document.addEventListener('visibilitychange', () => {\r\n                const video = this.elements.video;\r\n                if (!video) return;\r\n                if (document.hidden) video.pause();\r\n                else if (this.current.type === 'video') video.play().catch(() => { });\r\n            });\r\n\r\n            this.applyBackground();\r\n        },\r\n\r\n        applyBackground() {\r\n            if (!this.container) return; // Wait for init() to create the container\r\n\r\n            const s = window.Settings?.getAll() || {};\r\n            const custom = s.customBackground;\r\n            const theme = s.background || {};\r\n\r\n            let type = null, url = null, pos = null, overlay = 0.4;\r\n\r\n            if (custom && custom.type !== 'none') {\r\n                // Refresh from config if possible to get latest props like objectPosition\r\n                if (custom.id && custom.id !== 'custom') {\r\n                    const preset = window.SITE_CONFIG?.backgroundPresets?.find(b => b.id === custom.id);\r\n                    if (preset) Object.assign(custom, preset);\r\n                }\r\n                ({ type, url, objectPosition: pos, overlay = 0.4 } = custom);\r\n            } else if (theme.type === 'image' || theme.type === 'video' || theme.type === 'youtube') {\r\n                type = theme.type;\r\n                url = theme.value || theme.url;\r\n                pos = theme.objectPosition;\r\n                overlay = theme.overlay || 0.4;\r\n            }\r\n\r\n            document.documentElement.style.setProperty('--bg-overlay', overlay);\r\n\r\n            // Handle common positioning typos and normalize\r\n            if (pos && typeof pos === 'string') {\r\n                pos = pos.toLowerCase().trim()\r\n                    .replace(/\\s+/g, ' ') // Normalize multiple spaces\r\n                    .replace('topleft', 'top left')\r\n                    .replace('topright', 'top right')\r\n                    .replace('bottomleft', 'bottom left')\r\n                    .replace('bottomright', 'bottom right')\r\n                    .replace('centercenter', 'center')\r\n                    .replace('centerleft', 'center left')\r\n                    .replace('centerright', 'center right');\r\n            }\r\n\r\n            document.documentElement.style.setProperty('--bg-image-position', pos || 'center');\r\n\r\n            if (!type || !url) {\r\n                this.clear();\r\n                document.documentElement.style.backgroundColor = 'var(--bg)';\r\n                document.documentElement.style.setProperty('--bg-image-position', 'center');\r\n                return;\r\n            }\r\n            if (this.current.type === type && this.current.url === url) return;\r\n\r\n            this.current = { type, url };\r\n\r\n            if (type === 'video' || url.match(/\\.(mp4|webm|ogg|mov|m4v)$/i)) {\r\n                this.clearMedia();\r\n                this.createVideo(url, pos);\r\n                this.container.classList.add('active');\r\n                document.documentElement.classList.add('phantom-bg-active');\r\n                document.body.classList.add('phantom-bg-active');\r\n            } else if (type === 'youtube' || YOUTUBE_REGEX.test(url)) {\r\n                this.clearMedia();\r\n                this.createYouTube(url, pos);\r\n                this.container.classList.add('active');\r\n                document.documentElement.classList.add('phantom-bg-active');\r\n                document.body.classList.add('phantom-bg-active');\r\n            } else if (type === 'image') {\r\n                this.handleImageBackground(url, pos);\r\n            }\r\n        },\r\n\r\n        async getProxiedCachedUrl(url) {\r\n            // Local images don't need proxying\r\n            if (!url.startsWith('http') || url.includes(location.hostname)) return url;\r\n\r\n            // Try direct load first (faster)\r\n            try {\r\n                const directTest = await fetch(url, { method: 'HEAD', mode: 'cors' });\r\n                if (directTest.ok) return url;\r\n            } catch (e) {\r\n                // CORS blocked, need to proxy\r\n            }\r\n\r\n            // Wait for BareMux (max 500ms)\r\n            let retries = 0;\r\n            while (!window.BareMux && retries < 5) {\r\n                await new Promise(r => setTimeout(r, 100));\r\n                retries++;\r\n            }\r\n\r\n            if (!window.BareMux) {\r\n                console.warn(\"Background: BareMux not found, trying direct URL.\");\r\n                return url; // Try direct anyway\r\n            }\r\n\r\n            try {\r\n                const client = new window.BareMux.BareClient();\r\n                const response = await client.fetch(url);\r\n                if (!response.ok) throw new Error('Proxy fetch failed');\r\n\r\n                const blob = await response.blob();\r\n                return URL.createObjectURL(blob);\r\n            } catch (error) {\r\n                console.error(\"Background proxy failed:\", error);\r\n                return url; // Fallback to direct URL\r\n            }\r\n        },\r\n\r\n        async handleImageBackground(url, pos) {\r\n            // Pre-load the image (proxied/cached or direct)\r\n            const finalUrl = await this.getProxiedCachedUrl(url);\r\n\r\n            // Check if this is still the current background after async fetch\r\n            if (this.current.url !== url) {\r\n                if (finalUrl && finalUrl.startsWith('blob:')) URL.revokeObjectURL(finalUrl);\r\n                return;\r\n            }\r\n\r\n            this.clearMedia();\r\n            this.createImage(finalUrl, pos);\r\n        },\r\n\r\n        createVideo(url, pos) {\r\n            const el = Object.assign(document.createElement('video'), {\r\n                className: 'phantom-background-media', src: url, autoplay: true, loop: true, muted: true, playsInline: true, volume: 0\r\n            });\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n            el.onerror = () => (this.elements.video = null);\r\n            this.elements.video = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        createImage(url, pos) {\r\n            const el = Object.assign(document.createElement('img'), {\r\n                className: 'phantom-background-media',\r\n                src: url\r\n            });\r\n\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n\r\n            el.onload = () => {\r\n                if (this.current.url === url || url.startsWith('blob:')) {\r\n                    this.container.classList.add('active');\r\n                    document.documentElement.classList.add('phantom-bg-active');\r\n                    document.body.classList.add('phantom-bg-active');\r\n                }\r\n            };\r\n            el.onerror = () => {\r\n                console.warn(\"Background image failed to load:\", url);\r\n                if (this.elements.image === el) this.elements.image = null;\r\n            };\r\n\r\n            this.elements.image = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        // youtube logic\r\n        createYouTube(url, pos) {\r\n            const id = url.match(YOUTUBE_REGEX)?.[1];\r\n            if (!id) return;\r\n            const el = Object.assign(document.createElement('iframe'), {\r\n                className: 'phantom-background-media',\r\n                src: `https://www.youtube.com/embed/${id}?autoplay=1&loop=1&playlist=${id}&controls=0&modestbranding=1&rel=0&mute=1&enablejsapi=1`,\r\n                allow: 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture'\r\n            });\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n            this.elements.iframe = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        clearMedia() {\r\n            Object.entries(this.elements).forEach(([key, el]) => {\r\n                if (!el) return;\r\n                if (key === 'video') { el.pause(); el.src = ''; }\r\n                if (key === 'iframe') el.src = 'about:blank';\r\n                if (key === 'image' && el.src.startsWith('blob:')) {\r\n                    URL.revokeObjectURL(el.src);\r\n                }\r\n                el.remove();\r\n                this.elements[key] = null;\r\n            });\r\n        },\r\n\r\n        clear() {\r\n            this.clearMedia();\r\n            this.current = { type: null, url: null };\r\n            document.documentElement.classList.remove('phantom-bg-active');\r\n            document.body.classList.remove('phantom-bg-active');\r\n            document.documentElement.style.backgroundColor = '';\r\n            if (this.container) this.container.classList.remove('active');\r\n        },\r\n\r\n        cleanup() {\r\n            this.clearMedia();\r\n        }\r\n    };\r\n\r\n    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', () => BackgroundManager.init());\r\n    else BackgroundManager.init();\r\n\r\n    window.BackgroundManager = BackgroundManager;\r\n})();\r\n\n</script>\r\n    <script>\n(function () {\r\n    const style = document.createElement('style');\r\n    style.textContent = `\r\n        .notify-container { position: fixed; top: 16px; right: 16px; z-index: 99999; display: flex; flex-direction: column; gap: 8px; pointer-events: none; font-family: 'Inter', sans-serif; }\r\n        .notify-toast { display: flex; align-items: center; gap: 12px; padding: 12px 16px; background: rgba(15, 15, 15, 0.9); backdrop-filter: blur(10px); border: 1px solid var(--border, #1f1f1f); border-radius: 10px; color: #e4e4e7; font-size: 13px; min-width: 280px; max-width: 380px; box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4); pointer-events: auto; transform: translateX(120%); opacity: 0; transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1), opacity 0.3s ease; position: relative; overflow: hidden; }\r\n        .notify-toast.show { transform: translateX(0); opacity: 1; }\r\n        .notify-toast.hiding { transform: translateX(120%); opacity: 0; }\r\n        .notify-icon { width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }\r\n        .notify-icon svg { width: 18px; height: 18px; }\r\n        .notify-content { flex: 1; line-height: 1.4; }\r\n        .notify-title { font-weight: 600; margin-bottom: 2px; }\r\n        .notify-message { color: #a1a1aa; font-size: 12px; }\r\n        .notify-close { background: none; border: none; color: #52525b; cursor: pointer; padding: 4px; border-radius: 4px; display: flex; align-items: center; justify-content: center; }\r\n        .notify-close:hover { background: rgba(255,255,255,0.1); color: #fff; }\r\n        .notify-close svg { width: 14px; height: 14px; }\r\n        .notify-toast.success { border-left: 3px solid #22c55e; } .notify-toast.success .notify-icon { color: #22c55e; }\r\n        .notify-toast.error { border-left: 3px solid #ef4444; } .notify-toast.error .notify-icon { color: #ef4444; }\r\n        .notify-toast.warning { border-left: 3px solid #f59e0b; } .notify-toast.warning .notify-icon { color: #f59e0b; }\r\n        .notify-toast.info { border-left: 3px solid #3b82f6; } .notify-toast.info .notify-icon { color: #3b82f6; }\r\n        .notify-progress { position: absolute; bottom: 0; left: 0; height: 2px; background: rgba(255, 255, 255, 0.2); transition: width linear; }\r\n    `;\r\n    document.head.appendChild(style);\r\n\r\n    let container = null;\r\n    const getContainer = () => container || (container = document.body.appendChild(Object.assign(document.createElement('div'), { className: 'notify-container' })));\r\n\r\n    const icons = {\r\n        success: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"20 6 9 17 4 12\"></polyline></svg>`,\r\n        error: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"15\" y1=\"9\" x2=\"9\" y2=\"15\"></line><line x1=\"9\" y1=\"9\" x2=\"15\" y2=\"15\"></line></svg>`,\r\n        warning: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\"></path><line x1=\"12\" y1=\"9\" x2=\"12\" y2=\"13\"></line><line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\"></line></svg>`,\r\n        info: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"12\" y1=\"16\" x2=\"12\" y2=\"12\"></line><line x1=\"12\" y1=\"8\" x2=\"12.01\" y2=\"8\"></line></svg>`,\r\n        close: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line><line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line></svg>`\r\n    };\r\n\r\n    function notify(type, title, msg = '', dur = 4000) {\r\n        const t = document.createElement('div');\r\n        t.className = `notify-toast ${type}`;\r\n        t.innerHTML = `<div class=\"notify-icon\">${icons[type]}</div><div class=\"notify-content\"><div class=\"notify-title\">${title}</div><div class=\"notify-message\">${msg}</div></div><button class=\"notify-close\">${icons.close}</button><div class=\"notify-progress\"></div>`;\r\n        const p = t.querySelector('.notify-progress');\r\n        const dismiss = () => { t.classList.add('hiding'); setTimeout(() => t.remove(), 300); };\r\n        t.querySelector('.notify-close').onclick = dismiss;\r\n        p.style.width = '100%';\r\n        setTimeout(() => { p.style.transition = `width ${dur}ms linear`; p.style.width = '0%'; }, 50);\r\n        let timer = setTimeout(dismiss, dur);\r\n        t.onmouseenter = () => { clearTimeout(timer); p.style.transition = 'none'; };\r\n        t.onmouseleave = () => {\r\n            const rem = (parseFloat(getComputedStyle(p).width) / t.offsetWidth) * dur;\r\n            p.style.transition = `width ${rem}ms linear`; p.style.width = '0%';\r\n            timer = setTimeout(dismiss, rem);\r\n        };\r\n        getContainer().appendChild(t);\r\n        requestAnimationFrame(() => t.classList.add('show'));\r\n    }\r\n\r\n    window.Notify = {\r\n        success: (a, b, c) => notify('success', a, b, c),\r\n        error: (a, b, c) => notify('error', a, b, c),\r\n        warning: (a, b, c) => notify('warning', a, b, c),\r\n        info: (a, b, c) => notify('info', a, b, c)\r\n    };\r\n})();\r\n\n</script>\r\n\r\n\r\n</head>\r\n\r\n<body>\r\n    <div class=\"app\">\r\n        <!-- Mobile Menu Toggle -->\r\n        <button class=\"mobile-menu-btn\" id=\"mobileMenuBtn\"><i class=\"fa-solid fa-bars\"></i></button>\r\n\r\n        <aside class=\"sidebar\" id=\"sidebar\">\r\n            <div class=\"sidebar-header\">\r\n                <h2>Library</h2>\r\n                <button id=\"closeSidebar\"\r\n                    style=\"background:none; border:none; color:var(--text-muted); cursor:pointer; display:none;\"><i\r\n                        class=\"fa-solid fa-xmark\"></i></button>\r\n            </div>\r\n            <div class=\"playlist-section\">\r\n                <div class=\"playlist-item\" data-playlist=\"liked\" id=\"likedPlaylist\">\r\n                    <div class=\"playlist-icon\"><i class=\"fa-solid fa-heart\"></i></div>\r\n                    <div class=\"playlist-info\">\r\n                        <div class=\"playlist-name\">Liked Songs <i class=\"fa-solid fa-chevron-down playlist-expand\"></i>\r\n                        </div>\r\n                        <div class=\"playlist-count\" id=\"likedCount\">0 songs</div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"playlist-songs\" id=\"likedSongs\"></div>\r\n                <div class=\"playlist-item\" data-playlist=\"recent\" id=\"recentPlaylist\">\r\n                    <div class=\"playlist-icon\"><i class=\"fa-solid fa-clock-rotate-left\"></i></div>\r\n                    <div class=\"playlist-info\">\r\n                        <div class=\"playlist-name\">Recently Played <i\r\n                                class=\"fa-solid fa-chevron-down playlist-expand\"></i></div>\r\n                        <div class=\"playlist-count\" id=\"recentCount\">0 songs</div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"playlist-songs\" id=\"recentSongs\"></div>\r\n                <div class=\"playlist-divider\"></div>\r\n                <div id=\"customPlaylists\"></div>\r\n                <button class=\"add-playlist-btn\" id=\"addPlaylistBtn\"><i class=\"fa-solid fa-plus\"></i><span>New\r\n                        Playlist</span></button>\r\n            </div>\r\n        </aside>\r\n        <main class=\"main\">\r\n            <!-- Source Tabs - Controls both SEARCH and PLAYBACK -->\r\n            <div class=\"source-tabs\">\r\n                <button class=\"source-tab\" data-source=\"itunes\">iTunes (30s Preview)</button>\r\n                <button class=\"source-tab active\" data-source=\"youtube\">YouTube</button>\r\n            </div>\r\n\r\n            <div class=\"search-container\">\r\n                <div class=\"search-wrapper\">\r\n                    <div class=\"search-box\">\r\n                        <i class=\"fa-solid fa-magnifying-glass\"></i>\r\n                        <input type=\"text\" id=\"searchInput\" placeholder=\"Search or paste YouTube/Itunes URL...\">\r\n                    </div>\r\n                    <div class=\"results\" id=\"searchResults\"></div>\r\n                </div>\r\n            </div>\r\n\r\n            <div class=\"add-menu\" id=\"addMenu\"></div>\r\n\r\n            <!-- Player -->\r\n            <section class=\"player-section\">\r\n                <div class=\"album-art\" id=\"albumArt\">\r\n                    <i class=\"fa-solid fa-music placeholder\" id=\"albumPlaceholder\"></i>\r\n                    <img id=\"albumCover\" src=\"\" alt=\"\" style=\"display:none;\">\r\n                </div>\r\n                <div class=\"player-info\">\r\n                    <div class=\"mode-badges\">\r\n                        <div class=\"mode-badge\" id=\"radioBadge\"><i class=\"fa-solid fa-radio\"></i> Radio</div>\r\n                        <button class=\"mode-badge\" id=\"proxyBtn\" title=\"Use Proxy for embedded content\"><i\r\n                                class=\"fa-solid fa-shield-halved\"></i> Proxy</button>\r\n                    </div>\r\n                    <div class=\"track-title\" id=\"trackTitle\">No track selected</div>\r\n                    <div class=\"track-artist\" id=\"trackArtist\">Select a source and search</div>\r\n                    <div class=\"controls\">\r\n                        <button class=\"control-btn\" id=\"shuffleBtn\" title=\"Shuffle\"><i\r\n                                class=\"fa-solid fa-shuffle\"></i></button>\r\n                        <button class=\"control-btn\" id=\"prevBtn\" title=\"Previous\"><i\r\n                                class=\"fa-solid fa-backward-step\"></i></button>\r\n                        <button class=\"control-btn play-btn\" id=\"playPauseBtn\" title=\"Play\"><i\r\n                                class=\"fa-solid fa-play\"></i></button>\r\n                        <button class=\"control-btn\" id=\"nextBtn\" title=\"Next\"><i\r\n                                class=\"fa-solid fa-forward-step\"></i></button>\r\n                        <button class=\"control-btn\" id=\"repeatBtn\" title=\"Repeat\"><i\r\n                                class=\"fa-solid fa-repeat\"></i></button>\r\n                        <div class=\"control-divider\"></div>\r\n                        <button class=\"control-btn\" id=\"likeBtn\" title=\"Like\"><i\r\n                                class=\"fa-regular fa-heart\"></i></button>\r\n                        <button class=\"control-btn\" id=\"radioBtn\" title=\"Radio Mode\"><i\r\n                                class=\"fa-solid fa-radio\"></i></button>\r\n                        <button class=\"control-btn\" id=\"addToPlaylistBtn\" title=\"Add to Playlist\"><i\r\n                                class=\"fa-solid fa-plus\"></i></button>\r\n                    </div>\r\n                    <div class=\"progress-container\">\r\n                        <span class=\"time\" id=\"currentTime\">0:00</span>\r\n                        <div class=\"progress-bar\" id=\"progressBar\">\r\n                            <div class=\"progress-fill\" id=\"progressFill\"></div>\r\n                        </div>\r\n                        <span class=\"time\" id=\"totalTime\">0:00</span>\r\n                    </div>\r\n                    <div class=\"volume-container\">\r\n                        <button class=\"control-btn\" id=\"volumeBtn\" style=\"padding:6px;\"><i\r\n                                class=\"fa-solid fa-volume-high\"></i></button>\r\n                        <div class=\"volume-bar\" id=\"volumeBar\">\r\n                            <div class=\"volume-fill\" id=\"volumeFill\"></div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </section>\r\n\r\n            <section class=\"lyrics-section\">\r\n                <div class=\"lyrics-header\">Lyrics</div>\r\n                <div class=\"lyrics-content\" id=\"lyricsContent\">\r\n                    <div class=\"lyrics-line\">Play a song to see lyrics</div>\r\n                </div>\r\n            </section>\r\n        </main>\r\n    </div>\r\n\r\n    <div class=\"fallback-container\" id=\"fallbackContainer\">\r\n        <button class=\"fallback-close\" id=\"fallbackClose\"><i class=\"fa-solid fa-xmark\"></i></button>\r\n        <iframe id=\"fallbackFrame\" allow=\"autoplay; encrypted-media; picture-in-picture\"></iframe>\r\n    </div>\r\n\r\n    <div class=\"modal-overlay\" id=\"playlistModal\">\r\n        <div class=\"modal\">\r\n            <div class=\"modal-title\">New Playlist</div>\r\n            <input type=\"text\" class=\"modal-input\" id=\"playlistNameInput\" placeholder=\"Playlist name\">\r\n            <div class=\"modal-actions\">\r\n                <button class=\"modal-btn cancel\" id=\"cancelPlaylist\">Cancel</button>\r\n                <button class=\"modal-btn confirm\" id=\"confirmPlaylist\">Create</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <!-- Audio elements for crossfading -->\r\n    <audio id=\"audio1\" crossorigin=\"anonymous\"></audio>\r\n    <audio id=\"audio2\" crossorigin=\"anonymous\"></audio>\r\n\r\n    <script>\n// topbar\r\n(function () {\r\n    let rootPrefix = '';\r\n    const scriptName = 'components/topbar.js';\r\n    const scripts = document.getElementsByTagName('script');\r\n    for (let i = 0; i < scripts.length; i++) {\r\n        const src = scripts[i].getAttribute('src');\r\n        if (src && src.includes(scriptName)) {\r\n            rootPrefix = src.split(scriptName)[0];\r\n            break;\r\n        }\r\n    }\r\n\r\n    if (!window.lucide && !document.querySelector('script[src*=\"lucide\"]')) {\r\n        const script = document.createElement('script');\r\n        script.src = 'https://unpkg.com/lucide@latest';\r\n        script.onload = () => {\r\n            if (window.lucide) lucide.createIcons();\r\n        };\r\n        document.head.appendChild(script);\r\n    }\r\n\r\n    initTopbar();\r\n\r\n    function createTopbar() {\r\n        const topbarContainer = document.createElement('div');\r\n        topbarContainer.id = 'topbar-container';\r\n\r\n        const logoSection = document.createElement('a');\r\n        logoSection.className = 'logo-section';\r\n        logoSection.href = rootPrefix + 'index2.html';\r\n        logoSection.innerHTML = '<div class=\"logo-placeholder\"><i data-lucide=\"zap\"></i></div>';\r\n        topbarContainer.appendChild(logoSection);\r\n\r\n        const navButtons = document.createElement('div');\r\n        navButtons.className = 'nav-buttons';\r\n\r\n        const buttons = [\r\n            { name: 'Music', icon: 'music', link: 'pages/music.html', badge: 'BETA' },\r\n            { name: 'Movies', icon: 'film', link: 'pages/movies.html' },\r\n            { name: 'Games', icon: 'gamepad-2', link: 'pages/games.html' },\r\n            { name: 'Watch', icon: 'play', link: 'pages/watch.html' },\r\n            { name: 'Search', icon: 'search', link: 'staticsjv2/index.html' },\r\n            { name: 'AI Chat', icon: 'bot', link: 'pages/chat.html' },\r\n            { separator: true },\r\n            { name: 'Settings', icon: 'settings', link: 'pages/settings.html' }\r\n        ];\r\n\r\n        buttons.forEach(btn => {\r\n            if (btn.separator) {\r\n                const separator = document.createElement('div');\r\n                separator.className = 'nav-separator';\r\n                navButtons.appendChild(separator);\r\n                return;\r\n            }\r\n\r\n            const link = document.createElement('a');   \r\n            link.href = rootPrefix + btn.link;\r\n            link.className = 'nav-btn';\r\n\r\n            const icon = document.createElement('i');\r\n            icon.setAttribute('data-lucide', btn.icon);\r\n            link.appendChild(icon);\r\n\r\n            const span = document.createElement('span');\r\n            span.textContent = btn.name;\r\n            link.appendChild(span);\r\n\r\n            if (btn.badge) {\r\n                const badge = document.createElement('div');\r\n                badge.className = 'nav-badge-beta';\r\n                badge.textContent = btn.badge;\r\n                link.appendChild(badge);\r\n            }\r\n\r\n            navButtons.appendChild(link);\r\n        });\r\n\r\n        topbarContainer.appendChild(navButtons);\r\n        document.body.prepend(topbarContainer);\r\n\r\n        if (window.lucide) {\r\n            lucide.createIcons();\r\n        }\r\n    }\r\n\r\n    function initTopbar() {\r\n        if (document.readyState === 'loading') {\r\n            document.addEventListener('DOMContentLoaded', createTopbar);\r\n        } else {\r\n            createTopbar();\r\n        }\r\n    }\r\n})();\r\n\n</script>\r\n    <script>\n\r\n\r\nconst YT_KEYS = [\r\n    \"AIzaSyBMhadsGk2S2B9bP46EycgI2y8yCWLLdAs\",\r\n    \"AIzaSyCOeLUcSlLDWAbKDUc-LUx8hdsenY-97rU\",\r\n    \"AIzaSyC3Z3jpYx5bw9M_Hih4sxF8iuiYZ4m3Qis\",\r\n    \"AIzaSyCWl9hmr-a0dVHKeUmUP5P7boAWJ3h48fs\"\r\n];\r\nconst LRC_LYRIC_EP = \"https://lrclib.net/api/get\";\r\nconst PLAIN_LYRIC_EP = \"https://api.lyrics.ovh/v1/\";\r\nconst SEARCH_EP = \"https://itunes.apple.com/search?term=\";\r\nconst PROXY_BASE = \"../staticsjv2/embed.html?skip#\"; // proxy fsallback\r\n\r\n//  state Management \r\nlet player;\r\nlet playerReady = false;\r\nlet commandQueue = [];\r\nlet isPlaying = false;\r\nlet keyIndex = 0;\r\nlet currentTrack = null;\r\nlet currentPlaylist = [];\r\nlet originalPlaylist = [];\r\nlet currentIndex = -1;\r\nlet isShuffled = false;\r\nlet isRadioMode = false;\r\nlet isProxyMode = false;\r\nlet isRepeat = false;\r\nlet activeSource = 'youtube'; // 'youtube' or 'itunes'\r\nlet audioPlayer = null; // Current active 30s preview player\r\nlet audio1, audio2; // DOM Audio elements for fading\r\nlet playlists = JSON.parse(localStorage.getItem('arcora_playlists')) || [{ name: 'Favorites', songs: [] }];\r\nlet searchTimeout;\r\nlet searchAutoHideTimeout;\r\nlet isMuted = false;\r\nlet lastVolume = parseInt(localStorage.getItem('arcora_last_volume')) || 100;\r\n\r\n// --- DOM Elements ---\r\nconst $ = id => document.getElementById(id);\r\nconst searchInput = $('searchInput');\r\nconst searchResults = $('searchResults');\r\nconst trackTitle = $('trackTitle');\r\nconst trackArtist = $('trackArtist');\r\nconst albumCover = $('albumCover');\r\nconst albumPlaceholder = $('albumPlaceholder');\r\nconst playPauseBtn = $('playPauseBtn');\r\nconst progressBar = $('progressBar');\r\nconst progressFill = $('progressFill');\r\nconst currentTimeEl = $('currentTime');\r\nconst totalTimeEl = $('totalTime');\r\nconst volumeBar = $('volumeBar');\r\nconst volumeFill = $('volumeFill');\r\nconst volumeBtn = $('volumeBtn');\r\nconst shuffleBtn = $('shuffleBtn');\r\nconst repeatBtn = $('repeatBtn');\r\nconst likeBtn = $('likeBtn');\r\nconst radioBtn = $('radioBtn');\r\nconst radioBadge = $('radioBadge');\r\nconst proxyBtn = $('proxyBtn');\r\nconst lyricsContent = $('lyricsContent');\r\nconst sidebar = $('sidebar');\r\nconst mobileMenuBtn = $('mobileMenuBtn');\r\nconst closeSidebar = $('closeSidebar');\r\nconst fallbackContainer = $('fallbackContainer');\r\nconst fallbackFrame = $('fallbackFrame');\r\nconst likedCount = $('likedCount');\r\nconst recentCount = $('recentCount');\r\n\r\n// --- Initialization ---\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n    // Load Persisted State\r\n    isRadioMode = localStorage.getItem('arcora_radio_mode') === 'true';\r\n    isProxyMode = localStorage.getItem('arcora_proxy_mode') === 'true';\r\n\r\n    // UI Init\r\n    updateRadioUI();\r\n    updateProxyUI();\r\n    loadPlaylists();\r\n    renderLibrarySongs();\r\n\r\n    // Event Listeners\r\n    searchInput.addEventListener('input', handleSearchInput);\r\n    playPauseBtn.addEventListener('click', togglePlayback);\r\n    $('nextBtn').addEventListener('click', playNext);\r\n    $('prevBtn').addEventListener('click', playPrev);\r\n    shuffleBtn.addEventListener('click', toggleShuffle);\r\n    repeatBtn.addEventListener('click', toggleRepeat);\r\n    radioBtn.addEventListener('click', toggleRadioMode);\r\n    proxyBtn.addEventListener('click', toggleProxyMode);\r\n    likeBtn.addEventListener('click', () => { if (currentTrack) toggleFavorite(currentTrack); });\r\n\r\n    volumeBar.addEventListener('click', handleVolumeClick);\r\n    volumeBtn.addEventListener('click', toggleMute);\r\n    progressBar.addEventListener('click', handleSeek);\r\n\r\n    // Source Tabs\r\n    document.querySelectorAll('.source-tab').forEach(tab => {\r\n        tab.addEventListener('click', () => {\r\n            document.querySelectorAll('.source-tab').forEach(t => t.classList.remove('active'));\r\n            tab.classList.add('active');\r\n            activeSource = tab.dataset.source;\r\n            notify('info', 'Source Switched', `Now using ${activeSource === 'youtube' ? 'YouTube' : 'iTunes previews'}`);\r\n        });\r\n    });\r\n\r\n    // Audio elements for iTunes\r\n    audio1 = $('audio1');\r\n    audio2 = $('audio2');\r\n\r\n    // Add to Playlist (Player Control)\r\n    $('addToPlaylistBtn').addEventListener('click', (e) => {\r\n        if (currentTrack) {\r\n            const data = {\r\n                trackName: currentTrack.title,\r\n                artistName: currentTrack.artist,\r\n                artworkUrl100: currentTrack.artwork,\r\n                genre: currentTrack.genre || '',\r\n                previewUrl: currentTrack.previewUrl || ''\r\n            };\r\n            addToPlaylistMenu(e.currentTarget, JSON.stringify(data));\r\n        }\r\n    });\r\n\r\n    // Mobile Menu\r\n    mobileMenuBtn.addEventListener('click', () => sidebar.classList.add('mobile-open'));\r\n    closeSidebar.addEventListener('click', () => sidebar.classList.remove('mobile-open'));\r\n\r\n\r\n    setVolumeUI(lastVolume);\r\n\r\n    // Add Playlist\r\n    $('addPlaylistBtn').addEventListener('click', () => $('playlistModal').classList.add('show'));\r\n    $('cancelPlaylist').addEventListener('click', () => $('playlistModal').classList.remove('show'));\r\n    $('confirmPlaylist').addEventListener('click', createNewPlaylist);\r\n\r\n    // Load YouTube API\r\n    if (!window.YT) {\r\n        const tag = document.createElement('script');\r\n        tag.src = \"https://www.youtube.com/iframe_api\";\r\n        const firstScriptTag = document.getElementsByTagName('script')[0];\r\n        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);\r\n    }\r\n});\r\n\r\n// --- Search Logic (iTunes) ---\r\nfunction handleSearchInput() {\r\n    clearTimeout(searchTimeout);\r\n    clearTimeout(searchAutoHideTimeout);\r\n    const query = searchInput.value.trim();\r\n\r\n    if (query.length < 2) {\r\n        searchResults.classList.remove('show');\r\n        return;\r\n    }\r\n\r\n    searchResults.innerHTML = '<div class=\"loading-text\"><i class=\"fa-solid fa-spinner fa-spin\"></i> Searching...</div>';\r\n    searchResults.classList.add('show');\r\n\r\n    searchTimeout = setTimeout(() => {\r\n        const url = `${SEARCH_EP}${encodeURIComponent(query)}&media=music&limit=20`;\r\n        fetch(url)\r\n            .then(res => res.json())\r\n            .then(data => displayResults(data.results || []))\r\n            .catch(err => {\r\n                console.error(\"Search failed:\", err);\r\n                searchResults.innerHTML = '<div class=\"loading-text\">Search failed.</div>';\r\n            });\r\n    }, 500);\r\n}\r\n\r\nfunction displayResults(results) {\r\n    if (!results.length) {\r\n        searchResults.innerHTML = '<div class=\"loading-text\">No results found.</div>';\r\n        return;\r\n    }\r\n\r\n    const favs = getPlaylist('Favorites')?.songs || [];\r\n    const isFav = (item) => favs.some(f => f.trackName === item.trackName && f.artistName === item.artistName);\r\n\r\n    searchResults.innerHTML = results.map(item => {\r\n        const art = item.artworkUrl100?.replace('100x100', '300x300') || '';\r\n        const liked = isFav(item);\r\n\r\n        // Encode data for click handling\r\n        const songData = JSON.stringify({\r\n            trackName: item.trackName,\r\n            artistName: item.artistName,\r\n            artworkUrl100: item.artworkUrl100,\r\n            genre: item.primaryGenreName,\r\n            previewUrl: item.previewUrl\r\n        }).replace(/\"/g, '&quot;');\r\n\r\n        return `\r\n            <div class=\"result-item\" onclick=\"handleResultClick(this)\" data-song=\"${songData}\">\r\n                <img class=\"result-img\" src=\"${art}\" onerror=\"this.style.display='none'\">\r\n                <div class=\"result-info\">\r\n                    <div class=\"result-title\">${esc(item.trackName)}</div>\r\n                    <div class=\"result-artist\">${esc(item.artistName)}</div>\r\n                </div>\r\n                <div class=\"result-actions\">\r\n                    <button class=\"result-action\" onclick=\"event.stopPropagation(); addToPlaylistMenu(this, '${songData}')\"><i class=\"fa-solid fa-plus\"></i></button>\r\n                    <button class=\"result-action\" onclick=\"event.stopPropagation(); toggleFavoriteFromSearch(this, '${songData}')\">\r\n                        <i class=\"fa-${liked ? 'solid' : 'regular'} fa-heart ${liked ? 'liked' : ''}\"></i>\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        `;\r\n    }).join('');\r\n}\r\n\r\nwindow.handleResultClick = (el) => {\r\n    const data = JSON.parse(el.dataset.song);\r\n    playSongWithContext(data, [data], 0);\r\n    searchResults.classList.remove('show');\r\n    searchInput.value = '';\r\n};\r\n\r\n// --- Playback Logic ---\r\nfunction playSongWithContext(song, playlist, index) {\r\n    currentPlaylist = [...playlist];\r\n    originalPlaylist = [...playlist];\r\n    // Ensure we capture genre and previewUrl if available\r\n    playSong(song.trackName, song.artistName, song.artworkUrl100, song.genre, song.previewUrl, index);\r\n}\r\n\r\nfunction playSong(title, artist, artwork, genre = '', previewUrl = '', index = -1) {\r\n    // Stop existing players\r\n    if (audioPlayer) {\r\n        audioPlayer.pause();\r\n        audioPlayer.src = '';\r\n    }\r\n    if (player && typeof player.stopVideo === 'function') {\r\n        player.stopVideo();\r\n    }\r\n\r\n    // Update UI\r\n    trackTitle.textContent = title;\r\n    trackArtist.textContent = artist;\r\n\r\n    if (artwork) {\r\n        albumCover.src = artwork.replace('100x100', '600x600');\r\n        albumCover.style.display = 'block';\r\n        albumPlaceholder.style.display = 'none';\r\n    } else {\r\n        albumCover.style.display = 'none';\r\n        albumPlaceholder.style.display = 'block';\r\n    }\r\n\r\n    currentTrack = { title, artist, artwork, genre, previewUrl };\r\n    updateLikeBtn();\r\n    fetchLyrics(artist, title);\r\n\r\n    if (index !== -1) currentIndex = index;\r\n\r\n    isPlaying = true;\r\n    updatePlayBtn();\r\n\r\n    if (activeSource === 'itunes' && previewUrl) {\r\n        // Play iTunes Preview\r\n        console.log(\"Playing iTunes preview:\", previewUrl);\r\n        audioPlayer = audio1;\r\n        audioPlayer.src = previewUrl;\r\n        audioPlayer.volume = isMuted ? 0 : lastVolume / 100;\r\n\r\n        const playPromise = audioPlayer.play();\r\n        if (playPromise !== undefined) {\r\n            playPromise.then(() => {\r\n                console.log(\"iTunes audio playing\");\r\n                isPlaying = true;\r\n                updatePlayBtn();\r\n            }).catch(e => {\r\n                console.warn(\"iTunes audio failed, falling back to YT:\", e);\r\n                const searchQuery = `${title} ${artist} audio`;\r\n                getYT(searchQuery);\r\n            });\r\n        }\r\n\r\n        audioPlayer.onended = () => playNext();\r\n        hideFallback();\r\n    } else {\r\n        // Play YouTube\r\n        const searchQuery = `${title} ${artist} audio`;\r\n        getYT(searchQuery);\r\n    }\r\n}\r\n\r\n// Global cache for video IDs to prevent easy quota limits\r\nconst videoCache = JSON.parse(localStorage.getItem('arcora_video_cache')) || {};\r\n\r\nfunction getYT(query, retryCount = 0) {\r\n    if (videoCache[query]) {\r\n        console.log(`CACHE HIT: ${query} -> ${videoCache[query]}`);\r\n        loadVid(videoCache[query]);\r\n        return;\r\n    }\r\n\r\n    // If we've exhausted all keys, stop.\r\n    if (retryCount >= YT_KEYS.length) {\r\n        console.error(\"All YouTube API keys exhausted or failed.\");\r\n        notify('error', 'Limit Reached', 'Music service currently unavailable.');\r\n        // Try next song if in radio/playlist\r\n        if (isRadioMode || currentPlaylist.length > 1) {\r\n            setTimeout(playNext, 2000);\r\n        }\r\n        return;\r\n    }\r\n\r\n    const currentKey = YT_KEYS[keyIndex];\r\n    // Rotate key for next time immediately to spread load\r\n    keyIndex = (keyIndex + 1) % YT_KEYS.length;\r\n\r\n    const url = `https://www.googleapis.com/youtube/v3/search?part=snippet&q=${encodeURIComponent(query)}&type=video&key=${currentKey}&maxResults=1&videoEmbeddable=true`;\r\n\r\n    fetch(url)\r\n        .then(res => {\r\n            if (!res.ok) throw new Error(res.status); // Will catch 403/429\r\n            return res.json();\r\n        })\r\n        .then(data => {\r\n            if (data.items?.[0]?.id?.videoId) {\r\n                const id = data.items[0].id.videoId;\r\n                videoCache[query] = id;\r\n                localStorage.setItem('arcora_video_cache', JSON.stringify(videoCache));\r\n                loadVid(id);\r\n            } else {\r\n                console.warn(\"No video found for:\", query);\r\n                // If strict search failed, try looser search\r\n                if (!query.includes('official audio')) {\r\n                    // actually we query with 'audio', maybe try just title-artist\r\n                    // Avoiding infinite loop by checking query format\r\n                    notify('error', 'Not Found', 'Song not found on YouTube');\r\n                }\r\n            }\r\n        })\r\n        .catch(err => {\r\n            console.warn(`Key failed (Attempt ${retryCount + 1}):`, err);\r\n            // Recursive retry with next key\r\n            getYT(query, retryCount + 1);\r\n        });\r\n}\r\n\r\nfunction loadVid(videoId) {\r\n    lastAttemptedVideoId = videoId;\r\n\r\n    if (isProxyMode) {\r\n        useFallbackPlayer(videoId);\r\n        return;\r\n    }\r\n\r\n    // Command pattern for robust player loading\r\n    const startAction = () => {\r\n        if (player && typeof player.loadVideoById === 'function') {\r\n            player.loadVideoById(videoId);\r\n            player.playVideo();\r\n            hideFallback();\r\n        }\r\n    };\r\n\r\n    if (playerReady && player) {\r\n        startAction();\r\n    } else {\r\n        // Queue the command, replacing any pending load commands\r\n        // We filter out old load commands to avoid playing multiple things\r\n        commandQueue = commandQueue.filter(cmd => !cmd.isLoadCmd);\r\n        startAction.isLoadCmd = true;\r\n        commandQueue.push(startAction);\r\n\r\n        // Ensure fallback container is ready for the API to inject into if not already\r\n        if (!player) {\r\n            // YT API might be loading\r\n        }\r\n    }\r\n}\r\n\r\n// --- Player Implementation ---\r\nwindow.onYouTubeIframeAPIReady = () => {\r\n    player = new YT.Player('fallbackContainer', { // We use fallbackContainer as a holder first, but mapped to a specific div usually\r\n        height: '100%',\r\n        width: '100%',\r\n        videoId: '',\r\n        playerVars: {\r\n            'autoplay': 1,\r\n            'controls': 0,\r\n            'disablekb': 1,\r\n            'fs': 0,\r\n            'rel': 0,\r\n            'origin': window.location.origin\r\n        },\r\n        events: {\r\n            'onReady': onPlayerReady,\r\n            'onStateChange': onPlayerStateChange,\r\n            'onError': onPlayerError\r\n        }\r\n    });\r\n};\r\n\r\nfunction onPlayerReady(event) {\r\n    console.log(\"Player Ready\");\r\n    playerReady = true;\r\n    player.setVolume(lastVolume);\r\n\r\n    // Execute queued commands\r\n    while (commandQueue.length > 0) {\r\n        const cmd = commandQueue.shift();\r\n        try { cmd(); } catch (e) { console.error(\"Queue exec error\", e); }\r\n    }\r\n\r\n    startSyncTimer();\r\n}\r\n\r\nfunction onPlayerStateChange(event) {\r\n    if (event.data === YT.PlayerState.PLAYING) {\r\n        isPlaying = true;\r\n    } else if (event.data === YT.PlayerState.PAUSED) {\r\n        isPlaying = false;\r\n    } else if (event.data === YT.PlayerState.ENDED) {\r\n        playNext();\r\n    }\r\n    updatePlayBtn();\r\n}\r\n\r\nfunction onPlayerError(event) {\r\n    console.warn(\"YouTube Player Error:\", event.data);\r\n    if (lastAttemptedVideoId) useFallbackPlayer(lastAttemptedVideoId);\r\n}\r\n\r\n// --- Fallback / Proxy Player ---\r\nfunction useFallbackPlayer(videoId) {\r\n    // Destroy YT Player if exists to free up container\r\n    if (player && player.destroy) {\r\n        try { player.destroy(); player = null; } catch (e) { }\r\n    }\r\n\r\n    fallbackContainer.innerHTML = '';\r\n    const frame = document.createElement('iframe');\r\n    frame.id = 'fallbackFrame';\r\n    frame.style.width = '100%';\r\n    frame.style.height = '100%';\r\n    frame.allow = \"autoplay; encrypted-media; picture-in-picture\";\r\n    frame.src = PROXY_BASE + videoId;\r\n\r\n    fallbackContainer.appendChild(frame);\r\n    fallbackContainer.classList.add('show');\r\n\r\n    // We lose direct control via API, but we gain proxy capability\r\n}\r\n\r\nfunction hideFallback() {\r\n    // If not in proxy mode, we might want to ensure standard player is visible\r\n    // But since we are reusing the container for standard player (via API), we manage visibility via CSS classes if needed\r\n    // In this specific implementation, standard YT player replaces the innerHTML of fallbackContainer anyway?\r\n    // Wait, onYouTubeIframeAPIReady targets 'fallbackContainer'.\r\n    // So 'fallbackContainer' IS the player container.\r\n    // The CSS .fallback-container might have .show .audio-only rules.\r\n    fallbackContainer.classList.add('show'); // Make sure it's visible so standard player shows\r\n    if (!isProxyMode) fallbackContainer.classList.add('audio-only'); // Hide video by default unless proxy or toggled?\r\n    else fallbackContainer.classList.remove('audio-only');\r\n\r\n    // Wait, music.html has videoToggleBtn? User removed it.\r\n    // So default behavior: Audio Only (hidden) unless Proxy or Fallback.\r\n}\r\n\r\nfunction togglePlayback() {\r\n    if (!currentTrack) return;\r\n\r\n    if (isProxyMode) {\r\n        notify('info', 'Proxy Mode', 'Use player controls');\r\n        return;\r\n    }\r\n\r\n    if (activeSource === 'itunes' && audioPlayer) {\r\n        if (isPlaying) audioPlayer.pause();\r\n        else audioPlayer.play();\r\n        isPlaying = !isPlaying;\r\n    } else if (player && typeof player.pauseVideo === 'function') {\r\n        if (isPlaying) player.pauseVideo();\r\n        else player.playVideo();\r\n        // we don't set isPlaying here, we wait for onPlayerStateChange\r\n    }\r\n    updatePlayBtn();\r\n}\r\n\r\nfunction playNext() {\r\n    if (currentPlaylist.length === 0) return;\r\n\r\n    // Handle single track\r\n    if (currentPlaylist.length === 1) {\r\n        if (isRepeat || isShuffled) {\r\n            const next = currentPlaylist[0];\r\n            playSong(next.trackName, next.artistName, next.artworkUrl100, next.genre || '', next.previewUrl || '', 0);\r\n        }\r\n        return;\r\n    }\r\n\r\n    // End of playlist logic (ignored if shuffled)\r\n    if (!isShuffled && currentIndex >= currentPlaylist.length - 1) {\r\n        if (isRadioMode) {\r\n            startRadio();\r\n        } else if (isRepeat) {\r\n            currentIndex = 0;\r\n            const next = currentPlaylist[0];\r\n            playSong(next.trackName, next.artistName, next.artworkUrl100, next.genre || '', next.previewUrl || '', 0);\r\n        }\r\n        return;\r\n    }\r\n\r\n    let nextIndex;\r\n    if (isShuffled) {\r\n        do { nextIndex = Math.floor(Math.random() * currentPlaylist.length); }\r\n        while (nextIndex === currentIndex);\r\n    } else {\r\n        nextIndex = currentIndex + 1;\r\n    }\r\n\r\n    const next = currentPlaylist[nextIndex];\r\n    playSong(next.trackName, next.artistName, next.artworkUrl100, next.genre || '', next.previewUrl || '', nextIndex);\r\n}\r\n\r\nfunction playPrev() {\r\n    if (currentIndex > 0) {\r\n        const prevIndex = currentIndex - 1;\r\n        const prev = currentPlaylist[prevIndex];\r\n        playSong(prev.trackName, prev.artistName, prev.artworkUrl100, prev.genre || '', prev.previewUrl || '', prevIndex);\r\n    } else {\r\n        if (activeSource === 'itunes' && audioPlayer) audioPlayer.currentTime = 0;\r\n        else if (player && player.seekTo) player.seekTo(0);\r\n    }\r\n}\r\n\r\n// --- Radio Mode ---\r\nasync function startRadio() {\r\n    if (!currentTrack) { toggleRadioMode(); return; }\r\n\r\n    notify('info', 'Radio', `Tuning station...`);\r\n\r\n    // We'll search for the Artist AND the Genre to get a mix\r\n    const queries = [];\r\n    queries.push(`${SEARCH_EP}${encodeURIComponent(currentTrack.artist)}&media=music&entity=song&limit=30`);\r\n\r\n    if (currentTrack.genre) {\r\n        queries.push(`${SEARCH_EP}${encodeURIComponent(currentTrack.genre)}&media=music&entity=song&limit=30`);\r\n    }\r\n\r\n    try {\r\n        const responses = await Promise.all(queries.map(q => fetch(q).then(r => r.json()).catch(e => ({ results: [] }))));\r\n\r\n        let pool = [];\r\n        responses.forEach(data => {\r\n            if (data.results) pool = pool.concat(data.results);\r\n        });\r\n\r\n        // Dedup and Filter\r\n        const unique = new Map();\r\n        pool.forEach(s => {\r\n            // Avoid duplicates by track name (simple fuzzy check)\r\n            const key = s.trackName.toLowerCase().trim();\r\n            // Don't add if already in playlist\r\n            if (!currentPlaylist.some(existing => existing.trackName.toLowerCase() === key)) {\r\n                unique.set(key, s);\r\n            }\r\n        });\r\n\r\n        let newSongs = Array.from(unique.values()).map(s => ({\r\n            trackName: s.trackName,\r\n            artistName: s.artistName,\r\n            artworkUrl100: s.artworkUrl100,\r\n            genre: s.primaryGenreName,\r\n            previewUrl: s.previewUrl\r\n        }));\r\n\r\n        // Shuffle the pool\r\n        for (let i = newSongs.length - 1; i > 0; i--) {\r\n            const j = Math.floor(Math.random() * (i + 1));\r\n            [newSongs[i], newSongs[j]] = [newSongs[j], newSongs[i]];\r\n        }\r\n\r\n        // Take top 10\r\n        newSongs = newSongs.slice(0, 10);\r\n\r\n        if (newSongs.length > 0) {\r\n            currentPlaylist.push(...newSongs);\r\n            // We don't necessarily need to add to originalPlaylist if radio creates a temporary queue, \r\n            // but for UI consistency let's add it.\r\n            originalPlaylist.push(...newSongs);\r\n            notify('success', 'Radio', `Added ${newSongs.length} tracks`);\r\n            playNext();\r\n        } else {\r\n            notify('warning', 'Radio', 'Station offline (No songs found)');\r\n            toggleRadioMode();\r\n        }\r\n    } catch (e) {\r\n        console.error(\"Radio Error\", e);\r\n        toggleRadioMode();\r\n    }\r\n}\r\n\r\nfunction toggleRadioMode() {\r\n    isRadioMode = !isRadioMode;\r\n    localStorage.setItem('arcora_radio_mode', isRadioMode);\r\n    updateRadioUI();\r\n}\r\n\r\nfunction updateRadioUI() {\r\n    radioBtn.classList.toggle('active', isRadioMode);\r\n    radioBadge.classList.toggle('show', isRadioMode);\r\n}\r\n\r\n// --- Proxy Mode ---\r\nfunction toggleProxyMode() {\r\n    isProxyMode = !isProxyMode;\r\n    localStorage.setItem('arcora_proxy_mode', isProxyMode);\r\n    updateProxyUI();\r\n    // If playing, reload\r\n    if (currentTrack) {\r\n        loadVid(lastAttemptedVideoId);\r\n    }\r\n}\r\n\r\nfunction updateProxyUI() {\r\n    proxyBtn.classList.toggle('active', isProxyMode);\r\n    if (isProxyMode) notify('info', 'Proxy Mode', 'Enabled');\r\n}\r\n\r\n// --- Lyrics ---\r\nfunction fetchLyrics(artist, title) {\r\n    lyricsContent.innerHTML = '<div class=\"lyrics-line\">Loading...</div>';\r\n\r\n    // Check Cache first\r\n    const cacheKey = `lyrics_v1_${artist}_${title}`.toLowerCase();\r\n    const cached = localStorage.getItem(cacheKey);\r\n    if (cached) {\r\n        try {\r\n            renderLyrics(JSON.parse(cached));\r\n            return;\r\n        } catch (e) { localStorage.removeItem(cacheKey); }\r\n    }\r\n\r\n    const url = `${LRC_LYRIC_EP}?artist_name=${encodeURIComponent(artist)}&track_name=${encodeURIComponent(title)}`;\r\n\r\n    const controller = new AbortController();\r\n    const timeoutId = setTimeout(() => controller.abort(), 6000); // 6s timeout\r\n\r\n    fetch(url, { signal: controller.signal })\r\n        .then(r => r.json())\r\n        .then(data => {\r\n            clearTimeout(timeoutId);\r\n            if (data.syncedLyrics) {\r\n                const parsed = parseLRC(data.syncedLyrics);\r\n                localStorage.setItem(cacheKey, JSON.stringify(parsed));\r\n                renderLyrics(parsed);\r\n            }\r\n            else if (data.plainLyrics) {\r\n                // We can't easily sync plain lyrics to time, so we just show text. \r\n                // Wrapper to match structure or just HTML.\r\n                // For consistenty with cache, we might want to store it special, but for now:\r\n                lyricsContent.innerHTML = data.plainLyrics.replace(/\\n/g, '<br>');\r\n            }\r\n            else throw new Error(\"No lyrics\");\r\n        })\r\n        .catch((err) => {\r\n            clearTimeout(timeoutId);\r\n            // Second Attempt: OVH\r\n            // Note: OVH is often down or slow, but worth a shot if logic requires perfection.\r\n            // Simplified fallback for now\r\n            lyricsContent.innerHTML = '<div class=\"lyrics-line\" style=\"opacity:0.5; font-style:italic\">Lyrics not found</div>';\r\n        });\r\n}\r\n\r\nfunction parseLRC(lrc) {\r\n    const lines = [];\r\n    const rx = /\\[(\\d{2}):(\\d{2})\\.(\\d{2,3})\\](.*)/g;\r\n    let m;\r\n    while ((m = rx.exec(lrc)) !== null) {\r\n        const time = parseInt(m[1]) * 60 + parseInt(m[2]) + parseInt(m[3].padEnd(3, '0')) / 1000;\r\n        lines.push({ time, text: m[4].trim() });\r\n    }\r\n    return lines;\r\n}\r\n\r\nfunction renderLyrics(lines) {\r\n    lyricsContent.innerHTML = lines.map((l, i) =>\r\n        `<div class=\"lyrics-line\" data-time=\"${l.time}\" onclick=\"seekTo(${l.time})\">${esc(l.text)}</div>`\r\n    ).join('');\r\n}\r\n\r\nwindow.seekTo = (time) => {\r\n    if (player && player.seekTo) player.seekTo(time, true);\r\n};\r\n\r\n// --- Sync Timer (Progress & Lyrics) ---\r\nfunction startSyncTimer() {\r\n    if (syncTimer) clearInterval(syncTimer);\r\n    syncTimer = setInterval(updateProgress, 250);\r\n}\r\n\r\nfunction updateProgress() {\r\n    let curr = 0;\r\n    let dur = 0;\r\n\r\n    if (activeSource === 'itunes' && audioPlayer) {\r\n        curr = audioPlayer.currentTime;\r\n        dur = audioPlayer.duration;\r\n    } else if (player && player.getCurrentTime) {\r\n        curr = player.getCurrentTime();\r\n        dur = player.getDuration();\r\n    }\r\n\r\n    if (dur > 0) {\r\n        const pct = (curr / dur) * 100;\r\n        progressFill.style.width = `${pct}%`;\r\n        currentTimeEl.textContent = formatTime(curr);\r\n        totalTimeEl.textContent = formatTime(dur);\r\n\r\n        // Sync Lyrics\r\n        const lines = document.querySelectorAll('.lyrics-line[data-time]');\r\n        let activeIdx = -1;\r\n        lines.forEach((l, i) => {\r\n            const t = parseFloat(l.dataset.time);\r\n            if (curr >= t) activeIdx = i;\r\n            l.classList.remove('active');\r\n        });\r\n\r\n        if (activeIdx !== -1) {\r\n            lines[activeIdx].classList.add('active');\r\n            lines[activeIdx].scrollIntoView({ behavior: 'smooth', block: 'center' });\r\n        }\r\n    }\r\n}\r\n\r\n// --- Controls ---\r\nfunction toggleShuffle() {\r\n    isShuffled = !isShuffled;\r\n    shuffleBtn.classList.toggle('active', isShuffled);\r\n    notify('info', 'Shuffle', isShuffled ? 'On' : 'Off');\r\n}\r\n\r\nfunction toggleRepeat() {\r\n    isRepeat = !isRepeat;\r\n    repeatBtn.classList.toggle('active', isRepeat);\r\n    notify('info', 'Repeat', isRepeat ? 'On' : 'Off');\r\n}\r\n\r\nfunction handleSeek(e) {\r\n    const rect = progressBar.getBoundingClientRect();\r\n    const pct = (e.clientX - rect.left) / rect.width;\r\n\r\n    if (activeSource === 'itunes' && audioPlayer) {\r\n        audioPlayer.currentTime = pct * audioPlayer.duration;\r\n    } else if (player && player.getDuration) {\r\n        player.seekTo(pct * player.getDuration(), true);\r\n    }\r\n}\r\n\r\nfunction toggleMute() {\r\n    isMuted = !isMuted;\r\n    const volToSet = isMuted ? 0 : lastVolume;\r\n\r\n    // Apply to YouTube\r\n    if (player && typeof player.setVolume === 'function') {\r\n        if (isMuted) player.mute();\r\n        else { player.unMute(); player.setVolume(volToSet); }\r\n    }\r\n\r\n    // Apply to Audio\r\n    if (audioPlayer) {\r\n        audioPlayer.volume = volToSet / 100;\r\n    }\r\n\r\n    setVolumeUI(volToSet);\r\n}\r\n\r\nfunction handleVolumeClick(e) {\r\n    const rect = volumeBar.getBoundingClientRect();\r\n    const pct = Math.max(0, Math.min(1, (e.clientX - rect.left) / rect.width));\r\n    const vol = Math.round(pct * 100);\r\n\r\n    if (vol > 0) {\r\n        lastVolume = vol;\r\n        isMuted = false;\r\n    } else {\r\n        isMuted = true;\r\n    }\r\n\r\n    localStorage.setItem('arcora_last_volume', lastVolume);\r\n    setVolumeUI(vol);\r\n\r\n    if (player && typeof player.setVolume === 'function') {\r\n        player.setVolume(vol);\r\n        if (vol > 0) player.unMute();\r\n        else player.mute();\r\n    }\r\n\r\n    if (audioPlayer) {\r\n        audioPlayer.volume = vol / 100;\r\n    }\r\n}\r\n\r\nfunction setVolumeUI(vol) {\r\n    volumeFill.style.width = `${vol}%`;\r\n    volumeBtn.querySelector('i').className = vol === 0 ? 'fa-solid fa-volume-xmark' : vol < 50 ? 'fa-solid fa-volume-low' : 'fa-solid fa-volume-high';\r\n}\r\n\r\nfunction updatePlayBtn() {\r\n    playPauseBtn.querySelector('i').className = isPlaying ? 'fa-solid fa-pause' : 'fa-solid fa-play';\r\n}\r\n\r\n// --- Playlist Management ---\r\nfunction getPlaylist(name) {\r\n    return playlists.find(p => p.name === name);\r\n}\r\n\r\nfunction loadPlaylists() {\r\n    const fav = getPlaylist('Favorites');\r\n\r\n    // Render Liked (Favorites)\r\n    if (fav) {\r\n        $('likedSongs').innerHTML = fav.songs.slice(0, 50).map((s, i) => renderMiniSong(s, 'Favorites', i)).join('');\r\n        likedCount.textContent = `${fav.songs.length} songs`;\r\n    }\r\n\r\n    // Render Custom\r\n    const customHTML = playlists.filter(p => p.name !== 'Favorites').map((p, pIdx) => `\r\n        <div class=\"playlist-item\" onclick=\"toggleCustomPlaylist('${p.name}')\">\r\n            <div class=\"playlist-icon\"><i class=\"fa-solid fa-list\"></i></div>\r\n            <div class=\"playlist-info\">\r\n                <div class=\"playlist-name\">${esc(p.name)}</div>\r\n                <div class=\"playlist-count\">${p.songs.length} songs</div>\r\n            </div>\r\n            <i class=\"fa-solid fa-trash\" style=\"margin-left:auto; opacity:0.5; cursor:pointer\" onclick=\"deletePlaylist('${p.name}', event)\"></i>\r\n        </div>\r\n        <div class=\"playlist-songs\" id=\"pl-${esc(p.name)}\" style=\"display:none\">\r\n            ${p.songs.map((s, i) => renderMiniSong(s, p.name, i)).join('')}\r\n        </div>\r\n    `).join('');\r\n    $('customPlaylists').innerHTML = customHTML;\r\n}\r\n\r\nwindow.toggleCustomPlaylist = (name) => {\r\n    const el = document.getElementById(`pl-${name}`);\r\n    if (el) el.style.display = el.style.display === 'none' ? 'block' : 'none';\r\n};\r\n\r\nwindow.deletePlaylist = (name, e) => {\r\n    e.stopPropagation();\r\n    if (confirm(`Delete ${name}?`)) {\r\n        playlists = playlists.filter(p => p.name !== name);\r\n        savePlaylists();\r\n        loadPlaylists();\r\n    }\r\n};\r\n\r\nfunction renderMiniSong(s, playlistName, index) {\r\n    const data = JSON.stringify({\r\n        trackName: s.trackName,\r\n        artistName: s.artistName,\r\n        artworkUrl100: s.artworkUrl100,\r\n        genre: s.genre || '',\r\n        previewUrl: s.previewUrl || ''\r\n    }).replace(/\"/g, '&quot;');\r\n\r\n    return `\r\n        <div class=\"playlist-song\" onclick='playPlaylistSong(\"${playlistName}\", ${index})'>\r\n             <img src=\"${s.artworkUrl100}\" onerror=\"this.style.display='none'\">\r\n             <div class=\"playlist-song-info\">\r\n                <div class=\"playlist-song-title\">${esc(s.trackName)}</div>\r\n                <div class=\"playlist-song-artist\">${esc(s.artistName)}</div>\r\n             </div>\r\n        </div>\r\n    `;\r\n}\r\n\r\nwindow.playPlaylistSong = (plName, index) => {\r\n    const pl = getPlaylist(plName);\r\n    if (pl) playSongWithContext(pl.songs[index], pl.songs, index);\r\n};\r\n\r\nfunction toggleFavorite(song) {\r\n    const fav = getPlaylist('Favorites');\r\n    const idx = fav.songs.findIndex(s => s.trackName === song.trackName && s.artistName === song.artistName);\r\n\r\n    if (idx >= 0) {\r\n        fav.songs.splice(idx, 1);\r\n        notify('info', 'Favorites', 'Removed');\r\n    } else {\r\n        fav.songs.push({\r\n            trackName: song.trackName || song.title,\r\n            artistName: song.artistName || song.artist,\r\n            artworkUrl100: song.artworkUrl100 || song.artwork,\r\n            genre: song.genre || '',\r\n            previewUrl: song.previewUrl || ''\r\n        });\r\n        notify('success', 'Favorites', 'Added');\r\n    }\r\n    savePlaylists();\r\n    loadPlaylists();\r\n    updateLikeBtn();\r\n}\r\n\r\nwindow.toggleFavoriteFromSearch = (btn, json) => {\r\n    const data = JSON.parse(json);\r\n    toggleFavorite(data);\r\n    const fav = getPlaylist('Favorites');\r\n    const isNowFav = fav.songs.some(s => s.trackName.toLowerCase() === data.trackName.toLowerCase() && s.artistName.toLowerCase() === data.artistName.toLowerCase());\r\n    btn.innerHTML = `<i class=\"fa-${isNowFav ? 'solid' : 'regular'} fa-heart ${isNowFav ? 'liked' : ''}\"></i>`;\r\n};\r\n\r\nwindow.addToPlaylistMenu = (btn, json) => {\r\n    const data = JSON.parse(json);\r\n    const menu = $('addMenu');\r\n    menu.innerHTML = playlists.filter(p => p.name !== 'Favorites').map(p => `\r\n        <button class=\"add-menu-item\" onclick=\"addSongToPlaylist('${p.name}', '${json.replace(/'/g, \"\\\\'\")}')\">\r\n            <i class=\"fa-solid fa-list\"></i> ${esc(p.name)}\r\n        </button>\r\n    `).join('');\r\n\r\n    // Position menu\r\n    const rect = btn.getBoundingClientRect();\r\n    menu.style.top = `${rect.bottom}px`;\r\n    menu.style.left = `${rect.left - 100}px`;\r\n    menu.classList.add('show');\r\n\r\n    // Close on click outside\r\n    const close = (e) => {\r\n        if (!menu.contains(e.target)) {\r\n            menu.classList.remove('show');\r\n            document.removeEventListener('click', close);\r\n        }\r\n    };\r\n    setTimeout(() => document.addEventListener('click', close), 0);\r\n};\r\n\r\nwindow.addSongToPlaylist = (plName, json) => {\r\n    const data = JSON.parse(json);\r\n    const pl = getPlaylist(plName);\r\n    if (pl && !pl.songs.some(s => s.trackName === data.trackName)) {\r\n        pl.songs.push(data);\r\n        savePlaylists();\r\n        loadPlaylists();\r\n        notify('success', 'Added', `Added to ${plName}`);\r\n    } else {\r\n        notify('warning', 'Exists', 'Song already in playlist');\r\n    }\r\n    $('addMenu').classList.remove('show');\r\n};\r\n\r\nfunction savePlaylists() {\r\n    localStorage.setItem('arcora_playlists', JSON.stringify(playlists));\r\n}\r\n\r\nfunction createNewPlaylist() {\r\n    const name = $('playlistNameInput').value.trim();\r\n    if (name && !getPlaylist(name)) {\r\n        playlists.push({ name, songs: [] });\r\n        savePlaylists();\r\n        loadPlaylists();\r\n        notify('success', 'Created', name);\r\n    }\r\n    $('playlistModal').classList.remove('show');\r\n    $('playlistNameInput').value = '';\r\n}\r\n\r\nfunction updateLikeBtn() {\r\n    if (!currentTrack) return;\r\n    const fav = getPlaylist('Favorites');\r\n    const isFav = fav.songs.some(s =>\r\n        s.trackName.toLowerCase() === currentTrack.title.toLowerCase() &&\r\n        s.artistName.toLowerCase() === currentTrack.artist.toLowerCase()\r\n    );\r\n    likeBtn.querySelector('i').className = `fa-${isFav ? 'solid' : 'regular'} fa-heart`;\r\n    likeBtn.classList.toggle('active', isFav);\r\n}\r\n\r\nfunction renderLibrarySongs() {\r\n    // Already handled by loadPlaylists for the most part\r\n    // The original music.js had separate renderLibrarySongs for recent/liked\r\n    // We integrated it into loadPlaylists which renders sidebar\r\n}\r\n\r\nfunction renderResults(results) { displayResults(results); }\r\n\r\n// Helper\r\nconst esc = s => (s || '').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;');\r\nconst formatTime = s => isNaN(s) ? '0:00' : `${Math.floor(s / 60)}:${Math.floor(s % 60).toString().padStart(2, '0')}`;\r\nconst notify = (type, title, msg) => typeof Notify !== 'undefined' ? Notify[type](title, msg) : console.log(title, msg);\r\n\n</script>\r\n    <script>\n// footer\r\n(function () {\r\n    'use strict';\r\n\r\n    let rootPrefix = '';\r\n    const scriptName = 'components/footer.js';\r\n    const scripts = document.getElementsByTagName('script');\r\n    for (let i = 0; i < scripts.length; i++) {\r\n        const src = scripts[i].getAttribute('src');\r\n        if (src && src.includes(scriptName)) {\r\n            rootPrefix = src.split(scriptName)[0];\r\n            break;\r\n        }\r\n    }\r\n\r\n    const config = window.SITE_CONFIG || { name: 'Phantom', version: '1.0.0', discord: { inviteUrl: '#' }, changelog: [], cloakPresets: [] };\r\n    const STORAGE_KEY = 'void_settings';\r\n    let storedSettings = {};\r\n    try { storedSettings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n\r\n    // settings\r\n    let settings = { ...(config.defaults || {}), ...storedSettings };\r\n\r\n    const footer = document.createElement('footer');\r\n    footer.id = 'site-footer';\r\n    footer.innerHTML = `\r\n        <style>\r\n            #site-footer {\r\n                margin-top: 0px;\r\n                padding: 20px;\r\n                border-top: 1px solid var(--border, #1f1f1f);\r\n                text-align: center;\r\n                background: transparent;\r\n            }\r\n            #site-footer .footer-links {\r\n                display: flex;\r\n                gap: 16px;\r\n                justify-content: center;\r\n                margin-bottom: 8px;\r\n                flex-wrap: wrap;\r\n            }\r\n            #site-footer .footer-link {\r\n                font-size: 12px;\r\n                color: var(--text-muted, #71717a);\r\n                text-decoration: none;\r\n                transition: color 0.15s;\r\n                font-family: 'Inter', sans-serif;\r\n                cursor: pointer;\r\n            }\r\n            #site-footer .footer-link:hover {\r\n                color: var(--text, #e4e4e7);\r\n            }\r\n            #site-footer .footer-version {\r\n                font-size: 11px;\r\n                color: var(--text-dim, #52525b);\r\n                cursor: pointer;\r\n                font-family: 'Inter', sans-serif;\r\n            }\r\n            #site-footer .footer-version:hover {\r\n                color: var(--text-muted, #71717a);\r\n            }\r\n        </style>\r\n        <div class=\"footer-links\">\r\n            <a href=\"${rootPrefix}pages/settings.html\" class=\"footer-link\"><i class=\"fa-solid fa-gear\"></i> Settings</a>\r\n            <a id=\"footer-changelog\" class=\"footer-link\"><i class=\"fa-solid fa-clock-rotate-left\"></i> Changelog</a>\r\n            <a href=\"${config.discord?.inviteUrl || '#'}\" target=\"_blank\" class=\"footer-link\"><i class=\"fa-brands fa-discord\"></i> Discord</a>\r\n            <a href=\"${rootPrefix}pages/terms.html\" class=\"footer-link\">Terms</a>\r\n            <a href=\"${rootPrefix}pages/disclaimer.html\" class=\"footer-link\">Disclaimer</a>\r\n            <a href=\"${rootPrefix}pages/extra.html\" class=\"footer-link\">Credits</a>\r\n        </div>\r\n        <span class=\"footer-version\" id=\"footer-version\">${config.name || 'Phantom'} v${config.version || '1.0.0'}</span>\r\n    `;\r\n\r\n    document.body.appendChild(footer);\r\n\r\n\r\n\r\n    // gtm\r\n    // Inject GTM head script if not already present\r\n    if (!document.querySelector('script[src*=\"googletagmanager.com/gtm.js\"]')) {\r\n        window.dataLayer = window.dataLayer || [];\r\n        window.dataLayer.push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' });\r\n        const gtmScript = document.createElement('script');\r\n        gtmScript.async = true;\r\n        gtmScript.src = 'https://www.googletagmanager.com/gtm.js?id=GTM-5LMBC27Z';\r\n        document.head.insertBefore(gtmScript, document.head.firstChild);\r\n    }\r\n\r\n    // Add GTM noscript fallback (for pages that don't have it in HTML)\r\n    if (!document.querySelector('noscript iframe[src*=\"googletagmanager\"]')) {\r\n        const gtmNoscript = document.createElement('noscript');\r\n        gtmNoscript.innerHTML = '<iframe src=\"https://www.googletagmanager.com/ns.html?id=GTM-5LMBC27Z\" height=\"0\" width=\"0\" style=\"display:none;visibility:hidden\"></iframe>';\r\n        document.body.insertBefore(gtmNoscript, document.body.firstChild);\r\n    }\r\n\r\n    const openChangelog = (e, customTitle, customContent) => {\r\n        if (e && e.preventDefault) e.preventDefault();\r\n        const changes = customContent || config.changelog || ['No changes listed'];\r\n\r\n        // Use standard modal structure from main.css\r\n        const overlay = document.createElement('div');\r\n        overlay.className = 'modal-overlay';\r\n\r\n        overlay.innerHTML = `\r\n            <div class=\"modal\" style=\"width: 400px; max-width: 90vw;\">\r\n                <div class=\"modal-header\">\r\n                    <h3 class=\"modal-title\">${customTitle || 'What\\'s New in v' + config.version}</h3>\r\n                    <button class=\"modal-close\"><i class=\"fa-solid fa-xmark\"></i></button>\r\n                </div>\r\n                <div class=\"modal-body\">\r\n                    <ul style=\"margin: 0; padding-left: 20px; color: var(--text-muted); font-size: 0.875rem; line-height: 1.6;\">\r\n                        ${changes.map(c => '<li>' + c + '</li>').join('')}\r\n                    </ul>\r\n                </div>\r\n                <div class=\"modal-footer\">\r\n                    <a href=\"${config.discord?.inviteUrl || '#'}\" target=\"_blank\" style=\"color: #5865F2; text-decoration: none; font-size: 13px; display: inline-flex; align-items: center; gap: 6px;\">\r\n                        <i class=\"fa-brands fa-discord\"></i> Join Discord\r\n                    </a>\r\n                </div>\r\n            </div>\r\n        `;\r\n\r\n        document.body.appendChild(overlay);\r\n\r\n        // Trigger animation\r\n        requestAnimationFrame(() => overlay.classList.add('show'));\r\n\r\n        const close = () => {\r\n            overlay.classList.remove('show');\r\n            setTimeout(() => overlay.remove(), 200);\r\n        };\r\n\r\n        overlay.querySelector('.modal-close').onclick = close;\r\n        overlay.onclick = (e) => { if (e.target === overlay) close(); };\r\n    };\r\n\r\n    // Expose openChangelog globally\r\n    window.openChangelog = openChangelog;\r\n\r\n    const changelogBtn = document.getElementById('footer-changelog');\r\n    if (changelogBtn) changelogBtn.onclick = openChangelog;\r\n\r\n    const versionBtn = document.getElementById('footer-version');\r\n    if (versionBtn) versionBtn.onclick = openChangelog;\r\n\r\n    // sync\r\n    // syncRemoteChangelog removed - using local config\r\n\r\n\r\n    // Initialize Sync\r\n    // syncRemoteChangelog();\r\n\r\n    const currentVersion = config.version;\r\n    const lastVersion = settings.lastVersion;\r\n\r\n    if (settings.showChangelogOnUpdate && lastVersion && lastVersion !== currentVersion) {\r\n        setTimeout(() => {\r\n            openChangelog();\r\n            settings.lastVersion = currentVersion;\r\n            localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n        }, 1000);\r\n    } else if (!lastVersion) {\r\n        settings.lastVersion = currentVersion;\r\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n    }\r\n\r\n    // panic\r\n    if (settings.panicKey) {\r\n        document.addEventListener('keydown', (e) => {\r\n            const keys = settings.panicModifiers || ['ctrl', 'shift'];\r\n            const triggerKey = settings.panicKey.toLowerCase();\r\n            const pressedKey = e.key.toLowerCase();\r\n\r\n            // Check modifiers\r\n            const ctrlMatch = keys.includes('ctrl') === e.ctrlKey;\r\n            const shiftMatch = keys.includes('shift') === e.shiftKey;\r\n            const altMatch = keys.includes('alt') === e.altKey;\r\n\r\n            if (ctrlMatch && shiftMatch && altMatch && pressedKey === triggerKey) {\r\n                e.preventDefault();\r\n\r\n                // Show white screen instantly (if panic-overlay exists in parent)\r\n                const parentOverlay = window.parent?.document?.getElementById('panic-overlay');\r\n                if (parentOverlay) {\r\n                    parentOverlay.style.display = 'block';\r\n                } else {\r\n                    // Create overlay if it doesn't exist\r\n                    const overlay = document.createElement('div');\r\n                    overlay.id = 'panic-overlay';\r\n                    overlay.style.cssText = 'position:fixed;inset:0;background:white;z-index:99999;';\r\n                    document.body.appendChild(overlay);\r\n                }\r\n\r\n                // Redirect immediately\r\n                const url = settings.panicUrl || 'https://classroom.google.com';\r\n                try { window.top.location.href = url; } catch { window.location.href = url; }\r\n            }\r\n        }, true); // Use capture phase for faster response\r\n    }\r\n\r\n    // Cloaking logic has been moved to scripts/cloaking.js for better synchronization.\r\n    // If you need cloaking on a specific page, include that script.\r\n\r\n\r\n    window.addEventListener('beforeunload', (e) => {\r\n        // Reload settings to get latest value\r\n        try { settings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n\r\n        if (window.top === window.self && settings.leaveConfirmation) {\r\n            e.preventDefault();\r\n            e.returnValue = '';\r\n            return '';\r\n        }\r\n    });\r\n\r\n    // discord\r\n    let crateInstance = null;\r\n\r\n    function initDiscord() {\r\n        if (settings.discordWidget && config.discord && config.discord.widgetServer && config.discord.widgetChannel) {\r\n            // Check if already loaded\r\n            if (document.querySelector('script[src*=\"@widgetbot/crate\"]')) {\r\n                if (crateInstance) crateInstance.show();\r\n                return;\r\n            }\r\n\r\n            const crateScript = document.createElement('script');\r\n            crateScript.src = 'https://cdn.jsdelivr.net/npm/@widgetbot/crate@3';\r\n            crateScript.async = true;\r\n            crateScript.defer = true;\r\n            crateScript.onload = () => {\r\n                crateInstance = new Crate({\r\n                    server: config.discord.widgetServer,\r\n                    channel: config.discord.widgetChannel,\r\n                    glyph: ['https://cdn.discordapp.com/embed/avatars/0.png', '100%'],\r\n                    location: ['bottom', 'right']\r\n                });\r\n            };\r\n            document.body.appendChild(crateScript);\r\n        } else {\r\n            // Hide if disabled\r\n            if (crateInstance) crateInstance.hide();\r\n        }\r\n    }\r\n\r\n    // Initialize\r\n    initDiscord();\r\n\r\n    // Listen for settings change to toggle dynamically\r\n    window.addEventListener('storage', (e) => {\r\n        if (e.key === STORAGE_KEY) {\r\n            try { settings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n            initDiscord();\r\n        }\r\n    });\r\n\r\n    // Listen for internal event\r\n    window.addEventListener('settings-changed', (e) => {\r\n        settings = e.detail;\r\n        initDiscord();\r\n    });\r\n\r\n    // counters\r\n    // Only show on home page (index2.html) checking if main-content exists\r\n    const mainContent = document.querySelector('.main-content');\r\n    // Ensure we are on the home page view (search bar checks etc) or just check existence\r\n    if (mainContent && document.querySelector('.featured-section')) {\r\n        const counterContainer = document.createElement('div');\r\n        counterContainer.id = 'supercounters-wrapper';\r\n        counterContainer.style.marginTop = '24px';\r\n        counterContainer.style.textAlign = 'center';\r\n        counterContainer.style.opacity = '0.8';\r\n\r\n        // Use iframe to isolate document.write from the widget\r\n        const iframe = document.createElement('iframe');\r\n        iframe.style.border = 'none';\r\n        iframe.style.width = '150px';\r\n        iframe.style.height = '40px';\r\n        iframe.style.overflow = 'hidden';\r\n\r\n        // Widget code\r\n        const widgetCode = `\r\n            <html>\r\n            <body style=\"margin:0;display:flex;justify-content:center;align-items:center;background:transparent;\">\r\n                <script type=\"text/javascript\" src=\"//widget.supercounters.com/ssl/online_i.js\"><\\/script>\r\n                <script type=\"text/javascript\">sc_online_i(1726449,\"ffffff\",\"000000\");<\\/script>\r\n            </body>\r\n            </html>\r\n        `;\r\n\r\n        iframe.srcdoc = widgetCode;\r\n        counterContainer.appendChild(iframe);\r\n        mainContent.appendChild(counterContainer);\r\n    }\r\n})();\r\n\n</script>\r\n</body>\r\n\r\n</html>","pages/player.html":"<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Player - Phantom</title>\n    <link rel=\"icon\" href=\"../favicon.svg\" type=\"image/svg+xml\">\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css\">\n    <style>\n/* phantom styling */\r\n\r\n@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');\r\n\r\n/* variables */\r\n:root {\r\n    /* Core colors (can be overridden by user settings) */\r\n    --bg: #0a0a0a;\r\n    --surface: #0f0f0f;\r\n    --surface-hover: #1a1a1a;\r\n    --surface-active: #252525;\r\n    --border: #1f1f1f;\r\n    --border-light: #2a2a2a;\r\n\r\n    /* Text */\r\n    --text: #e4e4e7;\r\n    --text-muted: #71717a;\r\n    --text-dim: #52525b;\r\n\r\n    /* Accent (customizable) */\r\n    --accent: #ffffff;\r\n    --accent-dim: rgba(255, 255, 255, 0.8);\r\n    --accent-glow: rgba(255, 255, 255, 0.1);\r\n\r\n    /* Status colors */\r\n    --success: #22c55e;\r\n    --warning: #f59e0b;\r\n    --error: #ef4444;\r\n    --info: #3b82f6;\r\n\r\n    /* Shadows */\r\n    --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.3);\r\n    --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.4);\r\n    --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.5);\r\n    --shadow-xl: 0 16px 48px rgba(0, 0, 0, 0.6);\r\n\r\n    /* Spacing */\r\n    --space-xs: 4px;\r\n    --space-sm: 8px;\r\n    --space-md: 16px;\r\n    --space-lg: 24px;\r\n    --space-xl: 32px;\r\n    --space-2xl: 48px;\r\n\r\n    /* Border radius */\r\n    --radius-sm: 4px;\r\n    --radius-md: 8px;\r\n    --radius-lg: 12px;\r\n    --radius-xl: 16px;\r\n    --radius-full: 9999px;\r\n\r\n    /* Transitions */\r\n    --transition-fast: 0.1s ease;\r\n    --transition-normal: 0.2s ease;\r\n    --transition-slow: 0.3s ease;\r\n\r\n    /* Z-index layers */\r\n    --z-base: 1;\r\n    --z-dropdown: 100;\r\n    --z-sticky: 500;\r\n    --z-modal: 1000;\r\n    --z-toast: 2000;\r\n    --z-max: 9999;\r\n\r\n    /* Typography */\r\n    --font-sans: 'Inter', system-ui, -apple-system, sans-serif;\r\n    --font-mono: 'JetBrains Mono', 'Fira Code', monospace;\r\n\r\n    /* Background (customizable) */\r\n    --bg-image: none;\r\n}\r\n\r\n/* base */\r\n*,\r\n*::before,\r\n*::after {\r\n    box-sizing: border-box;\r\n    margin: 0;\r\n    padding: 0;\r\n}\r\n\r\nhtml {\r\n    font-size: 16px;\r\n    scroll-behavior: smooth;\r\n    -webkit-font-smoothing: antialiased;\r\n    -moz-osx-font-smoothing: grayscale;\r\n}\r\n\r\nbody {\r\n    font-family: var(--font-sans);\r\n    background: var(--bg);\r\n    background-image: var(--bg-image);\r\n    background-size: cover;\r\n    background-position: var(--bg-image-position, center);\r\n    background-attachment: fixed;\r\n    color: var(--text);\r\n    line-height: 1.5;\r\n    min-height: 100vh;\r\n    overflow-x: hidden;\r\n}\r\n\r\n/* Ensure background manager takes precedence */\r\nhtml.phantom-bg-active body {\r\n    background: transparent !important;\r\n    background-image: none !important;\r\n}\r\n\r\n/* Selection */\r\n::selection {\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n}\r\n\r\n/* Focus states */\r\n:focus-visible {\r\n    outline: 2px solid var(--accent);\r\n    outline-offset: 2px;\r\n}\r\n\r\n/* Links */\r\na {\r\n    color: var(--accent);\r\n    text-decoration: none;\r\n    transition: opacity var(--transition-fast);\r\n}\r\n\r\na:hover {\r\n    opacity: 0.8;\r\n}\r\n\r\n/* Scrollbar */\r\n::-webkit-scrollbar {\r\n    width: 8px;\r\n    height: 8px;\r\n}\r\n\r\n::-webkit-scrollbar-track {\r\n    background: var(--surface);\r\n}\r\n\r\n::-webkit-scrollbar-thumb {\r\n    background: var(--border-light);\r\n    border-radius: var(--radius-full);\r\n}\r\n\r\n::-webkit-scrollbar-thumb:hover {\r\n    background: var(--text-muted);\r\n}\r\n\r\n/* text */\r\nh1,\r\nh2,\r\nh3,\r\nh4,\r\nh5,\r\nh6 {\r\n    font-weight: 600;\r\n    line-height: 1.2;\r\n    color: var(--text);\r\n}\r\n\r\nh1 {\r\n    font-size: 2.5rem;\r\n}\r\n\r\nh2 {\r\n    font-size: 2rem;\r\n}\r\n\r\nh3 {\r\n    font-size: 1.5rem;\r\n}\r\n\r\nh4 {\r\n    font-size: 1.25rem;\r\n}\r\n\r\nh5 {\r\n    font-size: 1rem;\r\n}\r\n\r\nh6 {\r\n    font-size: 0.875rem;\r\n}\r\n\r\np {\r\n    color: var(--text-muted);\r\n    line-height: 1.6;\r\n}\r\n\r\n.text-sm {\r\n    font-size: 0.875rem;\r\n}\r\n\r\n.text-xs {\r\n    font-size: 0.75rem;\r\n}\r\n\r\n.text-lg {\r\n    font-size: 1.125rem;\r\n}\r\n\r\n.text-muted {\r\n    color: var(--text-muted);\r\n}\r\n\r\n.text-dim {\r\n    color: var(--text-dim);\r\n}\r\n\r\n.text-center {\r\n    text-align: center;\r\n}\r\n\r\n/* buttons */\r\n.btn {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    gap: var(--space-sm);\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-family: var(--font-sans);\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-md);\r\n    background: var(--surface);\r\n    color: var(--text);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n    white-space: nowrap;\r\n}\r\n\r\n.btn:hover {\r\n    background: var(--surface-hover);\r\n    border-color: var(--border-light);\r\n}\r\n\r\n.btn:active {\r\n    background: var(--surface-active);\r\n    transform: scale(0.98);\r\n}\r\n\r\n.btn-primary {\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n    border-color: var(--accent);\r\n}\r\n\r\n.btn-primary:hover {\r\n    opacity: 0.9;\r\n    background: var(--accent);\r\n}\r\n\r\n.btn-ghost {\r\n    background: transparent;\r\n    border-color: transparent;\r\n}\r\n\r\n.btn-ghost:hover {\r\n    background: var(--surface-hover);\r\n}\r\n\r\n.btn-icon {\r\n    width: 36px;\r\n    height: 36px;\r\n    padding: 0;\r\n    border-radius: var(--radius-md);\r\n}\r\n\r\n.btn-sm {\r\n    padding: var(--space-xs) var(--space-sm);\r\n    font-size: 0.75rem;\r\n}\r\n\r\n.btn-lg {\r\n    padding: var(--space-md) var(--space-lg);\r\n    font-size: 1rem;\r\n}\r\n\r\n/* inputs */\r\n.input {\r\n    width: 100%;\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-family: var(--font-sans);\r\n    font-size: 0.875rem;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-md);\r\n    color: var(--text);\r\n    transition: border-color var(--transition-fast);\r\n}\r\n\r\n.input:hover {\r\n    border-color: var(--border-light);\r\n}\r\n\r\n.input:focus {\r\n    outline: none;\r\n    border-color: var(--accent);\r\n}\r\n\r\n.input::placeholder {\r\n    color: var(--text-dim);\r\n}\r\n\r\n.input-group {\r\n    display: flex;\r\n    gap: var(--space-sm);\r\n}\r\n\r\n.input-group .input {\r\n    flex: 1;\r\n}\r\n\r\n/* Select */\r\n.select {\r\n    appearance: none;\r\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%2371717a' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E\");\r\n    background-repeat: no-repeat;\r\n    background-position: right 12px center;\r\n    padding-right: 36px;\r\n    cursor: pointer;\r\n}\r\n\r\n/* Checkbox/Toggle */\r\n.toggle {\r\n    position: relative;\r\n    width: 44px;\r\n    height: 24px;\r\n    background: var(--border);\r\n    border-radius: var(--radius-full);\r\n    cursor: pointer;\r\n    transition: background var(--transition-fast);\r\n}\r\n\r\n.toggle::after {\r\n    content: '';\r\n    position: absolute;\r\n    top: 2px;\r\n    left: 2px;\r\n    width: 20px;\r\n    height: 20px;\r\n    background: var(--text);\r\n    border-radius: 50%;\r\n    transition: transform var(--transition-fast);\r\n}\r\n\r\n.toggle.active {\r\n    background: var(--accent);\r\n}\r\n\r\n.toggle.active::after {\r\n    transform: translateX(20px);\r\n    background: var(--bg);\r\n}\r\n\r\n/* cards */\r\n.card {\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-lg);\r\n    overflow: hidden;\r\n    transition: all var(--transition-normal);\r\n}\r\n\r\n.card:hover {\r\n    border-color: var(--border-light);\r\n    box-shadow: var(--shadow-md);\r\n}\r\n\r\n.card-header {\r\n    padding: var(--space-md);\r\n    border-bottom: 1px solid var(--border);\r\n}\r\n\r\n.card-body {\r\n    padding: var(--space-md);\r\n}\r\n\r\n.card-footer {\r\n    padding: var(--space-md);\r\n    border-top: 1px solid var(--border);\r\n}\r\n\r\n\r\n/* Featured badge */\r\n.badge-featured {\r\n    position: absolute;\r\n    top: var(--space-sm);\r\n    left: var(--space-sm);\r\n    padding: var(--space-xs) var(--space-sm);\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n    font-size: 0.625rem;\r\n    font-weight: 700;\r\n    text-transform: uppercase;\r\n    letter-spacing: 0.05em;\r\n    border-radius: var(--radius-sm);\r\n}\r\n\r\n/* Favorite star */\r\n.favorite-btn {\r\n    position: absolute;\r\n    top: var(--space-sm);\r\n    right: var(--space-sm);\r\n    width: 32px;\r\n    height: 32px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background: rgba(0, 0, 0, 0.5);\r\n    border: none;\r\n    border-radius: 50%;\r\n    color: var(--text-muted);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n    opacity: 0;\r\n}\r\n\r\n.media-card:hover .favorite-btn {\r\n    opacity: 1;\r\n}\r\n\r\n.favorite-btn:hover {\r\n    background: rgba(0, 0, 0, 0.7);\r\n    color: var(--text);\r\n}\r\n\r\n.favorite-btn.active {\r\n    color: #fbbf24;\r\n    opacity: 1;\r\n}\r\n\r\n/* grid */\r\n.grid {\r\n    display: grid;\r\n    gap: var(--space-md);\r\n}\r\n\r\n.grid-cols-2 {\r\n    grid-template-columns: repeat(2, 1fr);\r\n}\r\n\r\n.grid-cols-3 {\r\n    grid-template-columns: repeat(3, 1fr);\r\n}\r\n\r\n.grid-cols-4 {\r\n    grid-template-columns: repeat(4, 1fr);\r\n}\r\n\r\n.grid-cols-5 {\r\n    grid-template-columns: repeat(5, 1fr);\r\n}\r\n\r\n.grid-cols-6 {\r\n    grid-template-columns: repeat(6, 1fr);\r\n}\r\n\r\n/* Auto-fit grid for responsive cards */\r\n.grid-auto {\r\n    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));\r\n}\r\n\r\n.grid-auto-lg {\r\n    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\r\n}\r\n\r\n/* flex */\r\n.flex {\r\n    display: flex;\r\n}\r\n\r\n.flex-col {\r\n    flex-direction: column;\r\n}\r\n\r\n.flex-wrap {\r\n    flex-wrap: wrap;\r\n}\r\n\r\n.items-center {\r\n    align-items: center;\r\n}\r\n\r\n.items-start {\r\n    align-items: flex-start;\r\n}\r\n\r\n.items-end {\r\n    align-items: flex-end;\r\n}\r\n\r\n.justify-center {\r\n    justify-content: center;\r\n}\r\n\r\n.justify-between {\r\n    justify-content: space-between;\r\n}\r\n\r\n.justify-end {\r\n    justify-content: flex-end;\r\n}\r\n\r\n.gap-xs {\r\n    gap: var(--space-xs);\r\n}\r\n\r\n.gap-sm {\r\n    gap: var(--space-sm);\r\n}\r\n\r\n.gap-md {\r\n    gap: var(--space-md);\r\n}\r\n\r\n.gap-lg {\r\n    gap: var(--space-lg);\r\n}\r\n\r\n.flex-1 {\r\n    flex: 1;\r\n}\r\n\r\n/* spacing */\r\n.p-xs {\r\n    padding: var(--space-xs);\r\n}\r\n\r\n.p-sm {\r\n    padding: var(--space-sm);\r\n}\r\n\r\n.p-md {\r\n    padding: var(--space-md);\r\n}\r\n\r\n.p-lg {\r\n    padding: var(--space-lg);\r\n}\r\n\r\n.p-xl {\r\n    padding: var(--space-xl);\r\n}\r\n\r\n.m-xs {\r\n    margin: var(--space-xs);\r\n}\r\n\r\n.m-sm {\r\n    margin: var(--space-sm);\r\n}\r\n\r\n.m-md {\r\n    margin: var(--space-md);\r\n}\r\n\r\n.m-lg {\r\n    margin: var(--space-lg);\r\n}\r\n\r\n.mt-sm {\r\n    margin-top: var(--space-sm);\r\n}\r\n\r\n.mt-md {\r\n    margin-top: var(--space-md);\r\n}\r\n\r\n.mt-lg {\r\n    margin-top: var(--space-lg);\r\n}\r\n\r\n.mb-sm {\r\n    margin-bottom: var(--space-sm);\r\n}\r\n\r\n.mb-md {\r\n    margin-bottom: var(--space-md);\r\n}\r\n\r\n.mb-lg {\r\n    margin-bottom: var(--space-lg);\r\n}\r\n\r\n/* modals */\r\n.modal-overlay {\r\n    position: fixed;\r\n    inset: 0;\r\n    background: rgba(0, 0, 0, 0.8);\r\n    backdrop-filter: blur(4px);\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    z-index: var(--z-modal);\r\n    opacity: 0;\r\n    visibility: hidden;\r\n    transition: all var(--transition-normal);\r\n}\r\n\r\n.modal-overlay.show {\r\n    opacity: 1;\r\n    visibility: visible;\r\n}\r\n\r\n.modal {\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-xl);\r\n    max-width: 90vw;\r\n    max-height: 90vh;\r\n    overflow: hidden;\r\n    transform: scale(0.95);\r\n    transition: transform var(--transition-normal);\r\n}\r\n\r\n.modal-overlay.show .modal {\r\n    transform: scale(1);\r\n}\r\n\r\n.modal-header {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    padding: var(--space-md);\r\n    border-bottom: 1px solid var(--border);\r\n}\r\n\r\n.modal-title {\r\n    font-size: 1rem;\r\n    font-weight: 600;\r\n}\r\n\r\n.modal-close {\r\n    width: 32px;\r\n    height: 32px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background: transparent;\r\n    border: none;\r\n    color: var(--text-muted);\r\n    cursor: pointer;\r\n    border-radius: var(--radius-md);\r\n    transition: all var(--transition-fast);\r\n}\r\n\r\n.modal-close:hover {\r\n    background: var(--surface-hover);\r\n    color: var(--text);\r\n}\r\n\r\n.modal-body {\r\n    padding: var(--space-md);\r\n    overflow-y: auto;\r\n}\r\n\r\n.modal-footer {\r\n    display: flex;\r\n    justify-content: flex-end;\r\n    gap: var(--space-sm);\r\n    padding: var(--space-md);\r\n    border-top: 1px solid var(--border);\r\n}\r\n\r\n/* tabs */\r\n.tabs {\r\n    display: flex;\r\n    gap: 2px;\r\n    background: var(--surface);\r\n    padding: var(--space-xs);\r\n    border-radius: var(--radius-md);\r\n    border: 1px solid var(--border);\r\n}\r\n\r\n.tab {\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    color: var(--text-muted);\r\n    background: transparent;\r\n    border: none;\r\n    border-radius: var(--radius-sm);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n}\r\n\r\n.tab:hover {\r\n    color: var(--text);\r\n}\r\n\r\n.tab.active {\r\n    background: var(--surface-hover);\r\n    color: var(--text);\r\n}\r\n\r\n/* search */\r\n\r\n/* ============================================\r\n   OFFLINE INDICATOR\r\n   ============================================ */\r\n.offline-banner {\r\n    position: fixed;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    padding: var(--space-sm) var(--space-md);\r\n    background: var(--warning);\r\n    color: var(--bg);\r\n    text-align: center;\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    z-index: var(--z-toast);\r\n    transform: translateY(-100%);\r\n    transition: transform var(--transition-normal);\r\n}\r\n\r\n.offline-banner.show {\r\n    transform: translateY(0);\r\n}\r\n\r\n.offline-badge {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    gap: var(--space-xs);\r\n    padding: var(--space-xs) var(--space-sm);\r\n    background: var(--warning);\r\n    color: var(--bg);\r\n    font-size: 0.625rem;\r\n    font-weight: 600;\r\n    text-transform: uppercase;\r\n    border-radius: var(--radius-sm);\r\n}\r\n\r\n/* ============================================\r\n   LOADING STATES\r\n   ============================================ */\r\n.skeleton {\r\n    background: linear-gradient(90deg, var(--surface) 0%, var(--surface-hover) 50%, var(--surface) 100%);\r\n    background-size: 200% 100%;\r\n    animation: shimmer 1.5s infinite;\r\n    border-radius: var(--radius-md);\r\n}\r\n\r\n@keyframes shimmer {\r\n    0% {\r\n        background-position: 200% 0;\r\n    }\r\n\r\n    100% {\r\n        background-position: -200% 0;\r\n    }\r\n}\r\n\r\n.spinner {\r\n    width: 24px;\r\n    height: 24px;\r\n    border: 2px solid var(--border);\r\n    border-top-color: var(--accent);\r\n    border-radius: 50%;\r\n    animation: spin 0.8s linear infinite;\r\n}\r\n\r\n@keyframes spin {\r\n    to {\r\n        transform: rotate(360deg);\r\n    }\r\n}\r\n\r\n/* ============================================\r\n   ANIMATIONS\r\n   ============================================ */\r\n@keyframes fadeIn {\r\n    from {\r\n        opacity: 0;\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n    }\r\n}\r\n\r\n@keyframes slideUp {\r\n    from {\r\n        opacity: 0;\r\n        transform: translateY(10px);\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n        transform: translateY(0);\r\n    }\r\n}\r\n\r\n@keyframes scaleIn {\r\n    from {\r\n        opacity: 0;\r\n        transform: scale(0.95);\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n        transform: scale(1);\r\n    }\r\n}\r\n\r\n.animate-fadeIn {\r\n    animation: fadeIn var(--transition-normal) ease;\r\n}\r\n\r\n.animate-slideUp {\r\n    animation: slideUp var(--transition-normal) ease;\r\n}\r\n\r\n.animate-scaleIn {\r\n    animation: scaleIn var(--transition-normal) ease;\r\n}\r\n\r\n/* ============================================\r\n   UTILITIES\r\n   ============================================ */\r\n.hidden {\r\n    display: none !important;\r\n}\r\n\r\n.sr-only {\r\n    position: absolute;\r\n    width: 1px;\r\n    height: 1px;\r\n    padding: 0;\r\n    margin: -1px;\r\n    overflow: hidden;\r\n    clip: rect(0, 0, 0, 0);\r\n    border: 0;\r\n}\r\n\r\n.truncate {\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n}\r\n\r\n.w-full {\r\n    width: 100%;\r\n}\r\n\r\n.h-full {\r\n    height: 100%;\r\n}\r\n\r\n.relative {\r\n    position: relative;\r\n}\r\n\r\n.absolute {\r\n    position: absolute;\r\n}\r\n\r\n.fixed {\r\n    position: fixed;\r\n}\r\n\r\n.inset-0 {\r\n    inset: 0;\r\n}\r\n\r\n/* ============================================\r\n   RESPONSIVE\r\n   ============================================ */\r\n@media (max-width: 768px) {\r\n    h1 {\r\n        font-size: 1.75rem;\r\n    }\r\n\r\n    h2 {\r\n        font-size: 1.5rem;\r\n    }\r\n\r\n    h3 {\r\n        font-size: 1.25rem;\r\n    }\r\n\r\n    .grid-auto {\r\n        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));\r\n    }\r\n\r\n    .hide-mobile {\r\n        display: none !important;\r\n    }\r\n}\r\n\r\n@media (min-width: 769px) {\r\n    .hide-desktop {\r\n        display: none !important;\r\n    }\r\n}\n</style>\n    <style>\n/* Topbar Styles - Clean & Dark */\r\n/* Note: Inter font is imported in main.css */\r\n\r\nbody {\r\n    margin: 0;\r\n    padding: 0;\r\n    background-color: var(--bg);\r\n    font-family: 'Inter', sans-serif;\r\n}\r\n\r\n#topbar-container {\r\n    position: fixed;\r\n    top: 11px;\r\n    left: 50%;\r\n    transform: translateX(-50%);\r\n    background-color: var(--surface);\r\n    border-radius: 9999px;\r\n    padding: 8px 14px;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 10px;\r\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);\r\n    z-index: 10000;\r\n    border: 1px solid var(--border);\r\n    height: 48px;\r\n    box-sizing: border-box;\r\n}\r\n\r\n#topbar-container::before {\r\n    content: '';\r\n    position: absolute;\r\n    top: -7px;\r\n    bottom: -7px;\r\n    left: -7px;\r\n    right: -7px;\r\n    z-index: -1;\r\n    border-radius: 9999px;\r\n}\r\n\r\n.logo-section {\r\n    display: flex;\r\n    align-items: center;\r\n    padding-right: 10px;\r\n    border-right: 1px solid var(--border);\r\n    height: 32px;\r\n    text-decoration: none;\r\n    color: inherit;\r\n}\r\n\r\n.logo-placeholder {\r\n    width: 28px;\r\n    height: 28px;\r\n    background-color: var(--surface-hover);\r\n    border-radius: 6px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    color: var(--text-muted);\r\n}\r\n\r\n.logo-placeholder i,\r\n.logo-placeholder svg {\r\n    width: 16px;\r\n    height: 16px;\r\n}\r\n\r\n.nav-buttons {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 4px;\r\n}\r\n\r\n.nav-separator {\r\n    width: 1px;\r\n    height: 20px;\r\n    background-color: var(--border);\r\n    margin: 0 6px;\r\n}\r\n\r\n.nav-btn {\r\n    background: transparent;\r\n    border: none;\r\n    color: var(--text-muted);\r\n    text-decoration: none;\r\n    display: flex;\r\n    align-items: center;\r\n    padding: 6px 10px;\r\n    border-radius: 99px;\r\n    height: 32px;\r\n    box-sizing: border-box;\r\n    transition: color 0.15s, background-color 0.15s;\r\n    position: relative;\r\n}\r\n\r\n.nav-badge-beta {\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n    font-size: 8px;\r\n    font-weight: 700;\r\n    color: var(--text);\r\n    background: var(--secondary);\r\n    padding: 2px 4px;\r\n    border-radius: 4px;\r\n    line-height: 1;\r\n    transform: translate(20%, -20%);\r\n    pointer-events: none;\r\n}\r\n\r\n.nav-btn:hover {\r\n    color: var(--text);\r\n    background-color: var(--surface-hover);\r\n}\r\n\r\n.nav-btn i,\r\n.nav-btn svg {\r\n    width: 18px;\r\n    height: 18px;\r\n    min-width: 18px;\r\n}\r\n\r\n.nav-btn span {\r\n    max-width: 0;\r\n    opacity: 0;\r\n    margin-left: 0;\r\n    overflow: hidden;\r\n    white-space: nowrap;\r\n    font-weight: 500;\r\n    font-size: 13px;\r\n    transition: max-width 0.23s ease, opacity 0.17s ease, margin-left 0.23s ease;\r\n}\r\n\r\n#topbar-container:hover .nav-btn span {\r\n    max-width: 70px;\r\n    opacity: 1;\r\n    margin-left: 8px;\r\n}\n</style>\n    <link rel=\"stylesheet\" href=\"../styles/player.css?v=2\">\n    <style>\n/**\r\n * PHANTOM - BACKGROUND STYLES\r\n */\r\n.phantom-background {\r\n    position: fixed;\r\n    inset: 0;\r\n    width: 100vw;\r\n    height: 100vh;\r\n    z-index: -1;\r\n    overflow: hidden;\r\n    background: transparent;\r\n    pointer-events: none;\r\n    opacity: 1;\r\n    transition: background-color 0.3s ease;\r\n}\r\n\r\n.phantom-background.active {\r\n    opacity: 1;\r\n}\r\n\r\n.phantom-background-overlay {\r\n    position: absolute;\r\n    inset: 0;\r\n    z-index: 2;\r\n    background: rgba(0, 0, 0, var(--bg-overlay, 0.4));\r\n    transition: background-color 0.3s ease;\r\n}\r\n\r\n.phantom-background-layer {\r\n    position: absolute;\r\n    inset: 0;\r\n    z-index: 1;\r\n    transition: opacity 0.3s ease-in-out;\r\n}\r\n\r\n.phantom-background-media {\r\n    width: 100%;\r\n    height: 100%;\r\n    object-fit: cover;\r\n    object-position: var(--bg-image-position, center);\r\n    display: block;\r\n    border: none;\r\n}\r\n\r\n/* Video and Iframe positioning for full background cover */\r\n.phantom-background-layer video.phantom-background-media,\r\n.phantom-background-layer iframe.phantom-background-media {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    transform: none;\r\n    pointer-events: none;\r\n    min-width: 100%;\r\n    min-height: 100%;\r\n    max-width: none;\r\n    max-height: none;\r\n    object-position: var(--bg-image-position, center);\r\n}\r\n\r\n/* Ensure iframes cover entire background */\r\n.phantom-background-layer iframe.phantom-background-media {\r\n    border: none;\r\n    object-fit: cover;\r\n}\r\n\r\n/* Ensure content on top remains readable */\r\nhtml {\r\n    background-color: var(--bg);\r\n}\r\n\r\nbody {\r\n    position: relative;\r\n    z-index: 0;\r\n    background: transparent !important;\r\n    /* Allow background to show through */\r\n}\r\n\r\n/* Specific adjustments for transparency if needed */\r\n.main-content,\r\n.home-page {\r\n    background: transparent !important;\r\n}\r\n\r\n/* Glassmorphism for containers when background is active */\r\n.phantom-background.active~.offline-banner,\r\n.phantom-background.active~.home-page .card,\r\n.phantom-background.active~.home-page .featured-card,\r\n.phantom-background.active~.home-page .search-bar,\r\n.phantom-background.active~.settings-panel {\r\n    backdrop-filter: blur(10px);\r\n    -webkit-backdrop-filter: blur(10px);\r\n    background: rgba(15, 15, 15, 0.7) !important;\r\n}\n</style>\n    <script>\n// site config\r\n\r\nwindow.SITE_CONFIG = {\r\n    name: \"Phantom\",\r\n    fullName: \"Phantom Unblocked\",\r\n    version: \"1.0.12\",\r\n\r\n    changelog: [\r\n        \"1.0.12: tiny fixxes and changes\",\r\n        \"some code consolidation and fixxes\",\r\n        \"suggest features in the discord server\"\r\n    ],\r\n\r\n    // quotes\r\n    quotes: [\r\n        \"lebron lebron lebronn james\",\r\n        \"so tuff\",\r\n        \"it is what it is\",\r\n        \"do ur work\",\r\n        \"this is what happens when u dont touch grass\",\r\n        \"FULL BOX\",\r\n        \"FULL PIECE\",\r\n        \"200!\",\r\n        \"press esc + refresh + power button for hacks\",\r\n        \"press ctrl+x to hide your screen\",\r\n        \"change the tab title and favicon in settings\",\r\n        \"TEACHERR!\",\r\n        \"1 pump\",\r\n        \"303 headshot\",\r\n        \"bros prolly a 60 ovr\",\r\n        \"take the L lil bro\",  \r\n        \"lebron is OUR goat\",\r\n        \"stop looking at my screen\",\r\n    ],\r\n\r\n    // todo\r\n    // *** for strikethrough\r\n    // ** for bold\r\n    todos: [\r\n        \"***fixxed aboutblank opening while securly is on (previously if popups were off it would load intab instead of clickto launch now it will use clicktolaunch unless popups are blocked)***\",\r\n        \"***fix the proxy***\",\r\n        \"***fix panic panickey, add quote talking about it***\",\r\n        \"***fix theatermode, make it hide buttons after a few seconds and ensure all content is being displayed and move the description to the bottom***\",\r\n        \"***change back player to use old styling, change the surface to use background colors for the bottom part where description is shown, looking just like the background***\",\r\n        \"***add image and video support for backgrounds***\",\r\n        \"***fix aichat, make the title use the same ai request as the users question unless its in image mode where it will use text mode and fix ai chat to remember modes better***\",\r\n        \"***add cloaking to quotes***\",\r\n        \"***add a default cloak and fix it so icons work in aboutblank for whatever reason they only work when you go to settings in aboutblank where it correctly applies***\",\r\n        \"***for search suggestions add highlighting for whatever will happen when you click enter, in search suggestions fix all games not sending you to the games page***\",\r\n        \"***fix games to make multi library the default, put it in config.js***\",\r\n        \"***rename movies shortcut in index2.html to primeshows, add shortcuts to main pages in the topbar and change the current shortcuts to more popular games***\",\r\n        \"***make announcements show even on first visit unlike changelog and allow disabling it via settings***\",\r\n        \"***fix leave comformation asking u to leave each time you click something***\",\r\n        \"***change the shortcuts on the main page to include pages***\",\r\n        \"***add movies to the search bar in main page***\",\r\n        \"***fix background not turning off soon***\",\r\n        \"***fix music page to hide youtube player unless toggled via 3 dot small button, and always shown on proxy mode, fix all the controls for video time, volume***\",\r\n        \"**add singlefile this is lowk so hard i dont really understand it**\",\r\n        \"**advertise phantom (too much work tbh)**\",\r\n        \"**add a watch page for youtube and twitch**\",\r\n        \"**add a miniplayer for music**\",\r\n        \"***shorten some page's code***\",\r\n        \"***fix paths in search autocomplete***\",\r\n        \"***fix markdown in ai not using correct text colors***\",\r\n        \"***make backgrounds show in the loading screen***\",\r\n        \"***fix icons for topbar in code.html***\",\r\n        \"**fix wisp server not notifying or autoswitiching when offline in proxy**\",\r\n        \"***fix code runner open not working at all***\",\r\n        \"***make backgrounds show in player.html***\",\r\n        \"***make backgrounds show in staticsjv2***\",\r\n        \"***make player.html player controls use theme colros not hardcoded***\",\r\n        \"***make ai chat and music sidebar go all the way down and up with borders***\",\r\n        \"**make the only song in music be lebron lebron lebron james**\",\r\n        \"**fix music controls**\",\r\n        \"***finish extra page into credits and make this todo be tucked away somewhere and not the main part of it***\"\r\n    ],\r\n    defaultWisp: \"wss://glseries.net/wisp/\",\r\n    wispServers: [\r\n        { name: \"GLSeries Wisp\", url: \"wss://glseries.net/wisp/\" },\r\n        { name: \"Rhw's Wisp\", url: \"wss://wisp.rhw.one/\" },\r\n    ],\r\n\r\n    discord: {\r\n        inviteUrl: \"https://discord.gg/tHWx9NXp5p\",\r\n        widgetServer: \"1447673724017971324\",\r\n        widgetChannel: \"1447673726228496617\",\r\n    },\r\n\r\n    firstVisitCloak: false, //fake error page\r\n    defaults: {\r\n        cloakMode: \"about:blank\",\r\n        tabTitle: \"You've already responded\",\r\n        tabFavicon: \"https://ssl.gstatic.com/docs/spreadsheets/forms/forms_icon_2023q4.ico\",\r\n        cloakRotation: false,\r\n        cloakInterval: 5000,\r\n        panicKey: \"x\",\r\n        panicModifiers: [\"ctrl\", \"shift\"],\r\n        panicUrl: \"https://classroom.google.com\",\r\n        maxMovieRating: \"R\",\r\n        gameLibrary: \"multi\",\r\n        discordWidget: true,\r\n        miniplayer: true,\r\n        leaveConfirmation: false,\r\n        showChangelogOnUpdate: true,\r\n        themeRotation: true,\r\n        lastThemeRotation: 0,\r\n        backgroundRotation: true,\r\n        lastBackgroundRotation: 0,\r\n        lastSeenFeatured: 'none',\r\n        background: { type: 'color', value: '#0a0a0a' },\r\n        customBackground: { id: 'none', type: 'none' },\r\n        accentColor: '#ffffff',\r\n        surfaceColor: '#0f0f0f',\r\n        secondaryColor: '#2e2e33',\r\n        textColor: '#e4e4e7',\r\n    },\r\n\r\n    themePresets: {\r\n        dark: { name: 'Dark (Default)', bg: { type: 'color', value: '#0a0a0a' }, surface: '#0f0f0f', surfaceHover: '#1a1a1a', surfaceActive: '#252525', secondary: '#2e2e33', border: '#2a2a2a', borderLight: '#2a2a2a', text: '#e4e4e7', textSec: '#71717a', textDim: '#52525b', accent: '#ffffff' },\r\n        midnight: { name: 'Midnight', bg: { type: 'color', value: '#000000' }, surface: '#050505', surfaceHover: '#111111', surfaceActive: '#1a1a1a', secondary: '#111111', border: '#1a1a1a', borderLight: '#111111', text: '#ededed', textSec: '#a3a3a3', textDim: '#737373', accent: '#d4d4d4' },\r\n        abyss: { name: 'Abyss', bg: { type: 'color', value: '#020617' }, surface: '#0f172a', surfaceHover: '#1e293b', surfaceActive: '#334155', secondary: '#1e293b', border: '#1e293b', borderLight: '#1e293b', text: '#f1f5f9', textSec: '#94a3b8', textDim: '#64748b', accent: '#38bdf8' },\r\n        phantom: { name: 'Phantom', bg: { type: 'color', value: '#0f0a14' }, surface: '#1a0f24', surfaceHover: '#2e1a40', surfaceActive: '#4c2a5c', secondary: '#2e1a40', border: '#2e1a40', borderLight: '#2e1a40', text: '#f3e8ff', textSec: '#d8b4fe', textDim: '#c084fc', accent: '#c084fc' },\r\n        rosepine: { name: 'Rose Pine', bg: { type: 'color', value: '#191724' }, surface: '#1f1d2e', surfaceHover: '#26233a', surfaceActive: '#524f67', secondary: '#26233a', border: '#26233a', borderLight: '#1f1d2e', text: '#e0def4', textSec: '#908caa', textDim: '#6e6a86', accent: '#ebbcba' },\r\n        ocean: { name: 'Oceanic', bg: { type: 'color', value: '#011627' }, surface: '#0b2942', surfaceHover: '#1d3b53', surfaceActive: '#2d4b63', secondary: '#0b2942', border: '#1d3b53', borderLight: '#0b2942', text: '#d6deeb', textSec: '#5f7e97', textDim: '#011627', accent: '#7fdbca' },\r\n        forest: { name: 'Forest', bg: { type: 'color', value: '#020d06' }, surface: '#051a0d', surfaceHover: '#0a2e17', surfaceActive: '#0f4221', secondary: '#051a0d', border: '#0a2e17', borderLight: '#051a0d', text: '#ecfdf5', textSec: '#6ee7b7', textDim: '#064e3b', accent: '#10b981' },\r\n        crimson: { name: 'Crimson', bg: { type: 'color', value: '#1a0505' }, surface: '#230a0a', surfaceHover: '#7b0a0aff', surfaceActive: '#7f1d1d', secondary: '#230a0a', border: '#480f0fff', borderLight: '#230a0a', text: '#fef2f2', textSec: '#fecaca', textDim: '#450a0a', accent: '#ef4444' },\r\n        flame: { name: 'Flame', bg: { type: 'color', value: '#0c0202' }, surface: '#1c0a0a', surfaceHover: '#451a03', surfaceActive: '#9a3412', secondary: '#1c0a0a', border: '#451a03', borderLight: '#9a3412', text: '#fff7ed', textSec: '#fdba74', textDim: '#ea580c', accent: '#f59e0b' }\r\n    },\r\n\r\n    backgroundPresets: [\r\n        { id: 'none', name: 'None (Theme Default)', type: 'none' },\r\n        { id: 'Night sky', name: 'Night sky', type: 'image', url: 'https://images.pexels.com/photos/5675745/pexels-photo-5675745.jpeg', overlay: 0.3 },\r\n        { id: 'winter-mountains', name: 'Winter mountains', type: 'image', url: 'https://images.pexels.com/photos/1287145/pexels-photo-1287145.jpeg', overlay: 0.3 },\r\n        { id: 'f1 car', name: 'F1 Car', type: 'image', url: 'https://images.pexels.com/photos/14401632/pexels-photo-14401632.jpeg', overlay: 0.3 },\r\n        { id: 'moon-landing', name: 'Moon Landing', type: 'image', url: 'https://images.pexels.com/photos/41162/moon-landing-apollo-11-nasa-buzz-aldrin-41162.jpeg', overlay: 0.3, objectPosition: 'top left', active: true },\r\n        { id: 'turtle', name: 'Turtle', type: 'image', url: 'https://images.unsplash.com/photo-1501791187590-9ef2612ba1eb?q=80&w=1932&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D', overlay: 0.3 },\r\n        { id: 'road', name: 'Road', type: 'image', url: 'https://images.unsplash.com/photo-1508233620467-f79f1e317a05', overlay: 0.3 },\r\n        { id: 'railroad', name: 'Railroad', type: 'image', url: 'https://images.unsplash.com/photo-1505832018823-50331d70d237', overlay: 0.3 },\r\n        { id: 'mountain', name: 'Mountain', type: 'image', url: 'https://raw.githubusercontent.com/evanhnry/brave-wallpapers/refs/heads/main/Brave/clay-banks-u27Rrbs9Dwc-unsplash.jpg', overlay: 0.3 },\r\n    ],\r\n\r\n    cloakPresets: [\r\n        { name: \"Phantom\", icon: \"/favicon.svg\", title: \"Phantom Unblocked\" },\r\n        { name: \"Edpuzzle\", icon: \"https://edpuzzle.imgix.net/favicons/favicon-32.png\", title: \"Edpuzzle\" },\r\n        { name: \"Google Docs\", icon: \"https://ssl.gstatic.com/docs/documents/images/kix-favicon7.ico\", title: \"Untitled document - Google Docs\" },\r\n        { name: \"Canvas\", icon: \"https://du11hjcvx0uqb.cloudfront.net/dist/images/favicon-e10d657a73.ico\", title: \"Dashboard\" },\r\n        { name: \"Desmos\", icon: \"https://www.desmos.com/favicon.ico\", title: \"Desmos | Graphing Calculator\" },\r\n        { name: \"Khan Academy\", icon: \"https://cdn.kastatic.org/images/favicon.ico\", title: \"Khan Academy\" },\r\n        { name: \"Wikipedia\", icon: \"https://en.wikipedia.org/favicon.ico\", title: \"World War II - Wikipedia\" },\r\n        { name: \"Classroom\", icon: \"https://ssl.gstatic.com/classroom/favicon.png\", title: \"Home - Classroom\" },\r\n        { name: \"Canva\", icon: \"https://static.canva.com/static/images/android-192x192-2.png\", title: \"Home - Canva\" },\r\n        { name: \"Quiz\", icon: \"https://ssl.gstatic.com/docs/spreadsheets/forms/forms_icon_2023q4.ico\", title: \"You've already responded\" },\r\n        { name: \"Blooket\", icon: \"https://play.blooket.com/favicon.ico\", title: \"Play Blooket | Blooket\" },\r\n        { name: \"Gmail\", icon: \"https://ssl.gstatic.com/ui/v1/icons/mail/rfr/gmail.ico\", title: \"Gmail\" },\r\n        { name: \"YouTube\", icon: \"https://www.youtube.com/favicon.ico\", title: \"YouTube\" },\r\n        { name: \"Powerschool\", icon: \"https://waverlyk12.powerschool.com/favicon.ico\", title: \"Grades and Attendance\" },\r\n        { name: \"nothing\", icon: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=\", title: \"\\u200B\" },\r\n    ]\r\n}\r\n\r\n\r\n\n</script>\n    <script>\n// settings handler\r\n(function () {\r\n    'use strict';\r\n\r\n    const STORAGE_KEY = 'void_settings';\r\n\r\n    const getDefaults = () => {\r\n        return window.SITE_CONFIG?.defaults || {\r\n            cloakMode: 'none',\r\n            cloakRotation: false,\r\n            cloakInterval: 5000,\r\n            panicKey: 'x',\r\n            panicModifiers: ['ctrl', 'shift'],\r\n            panicUrl: 'https://classroom.google.com',\r\n            maxMovieRating: 'R',\r\n            offlineGames: [],\r\n            gameLibrary: 'multi',\r\n            leaveConfirmation: false\r\n        };\r\n    };\r\n\r\n    const load = () => {\r\n        try {\r\n            const stored = localStorage.getItem(STORAGE_KEY);\r\n            if (stored) {\r\n                return { ...getDefaults(), ...JSON.parse(stored) };\r\n            }\r\n        } catch (e) {\r\n            console.warn('Failed to load settings:', e);\r\n        }\r\n        return getDefaults();\r\n    };\r\n\r\n    const save = (settings) => {\r\n        try {\r\n            localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n            window.dispatchEvent(new CustomEvent('settings-changed', { detail: settings }));\r\n            if (window.parent !== window) {\r\n                window.parent.postMessage({ type: 'settings-update' }, '*');\r\n            }\r\n        } catch (e) {\r\n            console.warn('Failed to save settings:', e);\r\n        }\r\n    };\r\n\r\n    let _settings = load();\r\n\r\n    window.Settings = {\r\n        get(key) { return _settings[key]; },\r\n\r\n        getAll() { return { ..._settings }; },\r\n\r\n        set(key, value) {\r\n            _settings[key] = value;\r\n            save(_settings);\r\n            this.apply();\r\n            return value;\r\n        },\r\n\r\n        update(partial) {\r\n            _settings = { ..._settings, ...partial };\r\n            save(_settings);\r\n            this.apply();\r\n        },\r\n\r\n        reset() {\r\n            _settings = getDefaults();\r\n            save(_settings);\r\n            this.apply();\r\n        },\r\n\r\n        apply() {\r\n            const root = document.documentElement;\r\n            const s = _settings;\r\n            const d = window.SITE_CONFIG?.defaults || {};\r\n\r\n            const vars = {\r\n                '--accent': s.accentColor || d.accentColor || '#ffffff',\r\n                '--surface': s.surfaceColor || d.surfaceColor || '#0f0f0f',\r\n                '--surface-hover': s.surfaceHoverColor || d.surfaceHoverColor || '#1a1a1a',\r\n                '--surface-active': s.surfaceActiveColor || d.surfaceActiveColor || '#252525',\r\n                '--secondary': s.secondaryColor || d.secondaryColor || '#2e2e33',\r\n                '--border': s.borderColor || d.borderColor || '#1f1f1f',\r\n                '--border-light': s.borderLightColor || d.borderLightColor || '#2a2a2a',\r\n                '--text': s.textColor || d.textColor || '#e4e4e7',\r\n                '--text-muted': s.textSecondaryColor || d.textSecondaryColor || '#71717a',\r\n                '--text-dim': s.textDimColor || d.textDimColor || '#52525b',\r\n                '--toggle': s.toggleColor || d.toggleColor,\r\n                '--toggle-knob': s.toggleKnobColor || d.toggleKnobColor\r\n            };\r\n\r\n            Object.entries(vars).forEach(([key, val]) => {\r\n                if (val) root.style.setProperty(key, val);\r\n            });\r\n\r\n            const themeBg = s.background || d.background || { type: 'color', value: '#0a0a0a' };\r\n            const customBg = s.customBackground;\r\n            const isCustomActive = customBg && customBg.type !== 'none';\r\n\r\n            if (themeBg.type === 'color') {\r\n                root.style.setProperty('--bg', themeBg.value);\r\n            }\r\n\r\n            if (isCustomActive && customBg.url) {\r\n                root.style.setProperty('--bg-image', `url(${customBg.url})`);\r\n\r\n                let position = customBg.objectPosition;\r\n                if (customBg.id && customBg.id !== 'custom') {\r\n                    const preset = window.SITE_CONFIG?.backgroundPresets?.find(b => b.id === customBg.id);\r\n                    if (preset?.objectPosition) position = preset.objectPosition;\r\n                }\r\n\r\n                root.style.setProperty('--bg-image-position', position || 'center');\r\n            } else if (themeBg.type === 'image' || themeBg.type === 'video') {\r\n                root.style.setProperty('--bg-image', `url(${themeBg.value || themeBg.url})`);\r\n                root.style.setProperty('--bg-image-position', themeBg.objectPosition || 'center');\r\n            } else if (themeBg.type === 'gradient') {\r\n                root.style.setProperty('--bg-image', themeBg.value || themeBg.url);\r\n                root.style.setProperty('--bg-image-position', 'center');\r\n            } else {\r\n                root.style.setProperty('--bg-image', 'none');\r\n            }\r\n        },\r\n\r\n        onChange(callback) {\r\n            window.addEventListener('settings-changed', (e) => callback(e.detail));\r\n        },\r\n\r\n        isRatingAllowed(rating) {\r\n            if (!rating || rating === 'NR' || rating === 'NC-17') return false;\r\n            const ratingOrder = ['G', 'PG', 'PG-13', 'R'];\r\n            const maxIndex = ratingOrder.indexOf(_settings.maxMovieRating);\r\n            const ratingIndex = ratingOrder.indexOf(rating);\r\n            return maxIndex !== -1 && ratingIndex !== -1 && ratingIndex <= maxIndex;\r\n        }\r\n    };\r\n\r\n    // panic button go brr\r\n    const handlePanic = (e) => {\r\n        const mods = _settings.panicModifiers || [];\r\n        const key = _settings.panicKey || 'x';\r\n\r\n        if (mods.includes('ctrl') !== e.ctrlKey) return;\r\n        if (mods.includes('shift') !== e.shiftKey) return;\r\n        if (mods.includes('alt') !== e.altKey) return;\r\n\r\n        if (e.key.toLowerCase() === key.toLowerCase()) {\r\n            e.preventDefault();\r\n            const overlayId = 'panic-overlay';\r\n            let overlay = window.parent?.document?.getElementById(overlayId) || document.getElementById(overlayId);\r\n\r\n            if (!overlay) {\r\n                overlay = document.createElement('div');\r\n                overlay.id = overlayId;\r\n                overlay.style.cssText = 'position:fixed;inset:0;background:white;z-index:99999;';\r\n                document.body.appendChild(overlay);\r\n            } else {\r\n                overlay.style.display = 'block';\r\n            }\r\n\r\n            window.location.replace(_settings.panicUrl || 'https://classroom.google.com');\r\n        }\r\n    };\r\n\r\n    const init = () => {\r\n        Settings.apply();\r\n\r\n        const featured = window.SITE_CONFIG?.featuredBackground;\r\n        const activePreset = window.SITE_CONFIG?.backgroundPresets?.find(p => p.active);\r\n\r\n        const target = activePreset || featured;\r\n\r\n        if (target?.id && target.id !== _settings.lastSeenFeatured) {\r\n            Settings.update({\r\n                customBackground: target,\r\n                lastSeenFeatured: target.id,\r\n                backgroundRotation: false\r\n            });\r\n        }\r\n\r\n        document.addEventListener('keydown', handlePanic, true);\r\n\r\n        window.addEventListener('storage', (e) => {\r\n            if (e.key === STORAGE_KEY) {\r\n                _settings = load();\r\n                Settings.apply();\r\n                window.dispatchEvent(new CustomEvent('settings-changed', { detail: _settings }));\r\n            }\r\n        });\r\n\r\n        window.addEventListener('message', (e) => {\r\n            if (e.data?.type === 'settings-update' || e.data === 'updateCloak') {\r\n                _settings = load();\r\n                Settings.apply();\r\n                window.dispatchEvent(new CustomEvent('settings-changed', { detail: _settings }));\r\n            }\r\n        });\r\n\r\n        window.addEventListener('beforeunload', (e) => {\r\n            if (document.getElementById('main-frame') && _settings.leaveConfirmation) {\r\n                e.preventDefault();\r\n                return e.returnValue = '';\r\n            }\r\n        });\r\n    };\r\n\r\n    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', init);\r\n    else init();\r\n})();\r\n\n</script>\n    <script>Settings.apply();</script>\n    <script src=\"https://cdn.jsdelivr.net/npm/hls.js@latest\"></script>\n</head>\n\n<body>\n    <script>\n// topbar\r\n(function () {\r\n    let rootPrefix = '';\r\n    const scriptName = 'components/topbar.js';\r\n    const scripts = document.getElementsByTagName('script');\r\n    for (let i = 0; i < scripts.length; i++) {\r\n        const src = scripts[i].getAttribute('src');\r\n        if (src && src.includes(scriptName)) {\r\n            rootPrefix = src.split(scriptName)[0];\r\n            break;\r\n        }\r\n    }\r\n\r\n    if (!window.lucide && !document.querySelector('script[src*=\"lucide\"]')) {\r\n        const script = document.createElement('script');\r\n        script.src = 'https://unpkg.com/lucide@latest';\r\n        script.onload = () => {\r\n            if (window.lucide) lucide.createIcons();\r\n        };\r\n        document.head.appendChild(script);\r\n    }\r\n\r\n    initTopbar();\r\n\r\n    function createTopbar() {\r\n        const topbarContainer = document.createElement('div');\r\n        topbarContainer.id = 'topbar-container';\r\n\r\n        const logoSection = document.createElement('a');\r\n        logoSection.className = 'logo-section';\r\n        logoSection.href = rootPrefix + 'index2.html';\r\n        logoSection.innerHTML = '<div class=\"logo-placeholder\"><i data-lucide=\"zap\"></i></div>';\r\n        topbarContainer.appendChild(logoSection);\r\n\r\n        const navButtons = document.createElement('div');\r\n        navButtons.className = 'nav-buttons';\r\n\r\n        const buttons = [\r\n            { name: 'Music', icon: 'music', link: 'pages/music.html', badge: 'BETA' },\r\n            { name: 'Movies', icon: 'film', link: 'pages/movies.html' },\r\n            { name: 'Games', icon: 'gamepad-2', link: 'pages/games.html' },\r\n            { name: 'Watch', icon: 'play', link: 'pages/watch.html' },\r\n            { name: 'Search', icon: 'search', link: 'staticsjv2/index.html' },\r\n            { name: 'AI Chat', icon: 'bot', link: 'pages/chat.html' },\r\n            { separator: true },\r\n            { name: 'Settings', icon: 'settings', link: 'pages/settings.html' }\r\n        ];\r\n\r\n        buttons.forEach(btn => {\r\n            if (btn.separator) {\r\n                const separator = document.createElement('div');\r\n                separator.className = 'nav-separator';\r\n                navButtons.appendChild(separator);\r\n                return;\r\n            }\r\n\r\n            const link = document.createElement('a');   \r\n            link.href = rootPrefix + btn.link;\r\n            link.className = 'nav-btn';\r\n\r\n            const icon = document.createElement('i');\r\n            icon.setAttribute('data-lucide', btn.icon);\r\n            link.appendChild(icon);\r\n\r\n            const span = document.createElement('span');\r\n            span.textContent = btn.name;\r\n            link.appendChild(span);\r\n\r\n            if (btn.badge) {\r\n                const badge = document.createElement('div');\r\n                badge.className = 'nav-badge-beta';\r\n                badge.textContent = btn.badge;\r\n                link.appendChild(badge);\r\n            }\r\n\r\n            navButtons.appendChild(link);\r\n        });\r\n\r\n        topbarContainer.appendChild(navButtons);\r\n        document.body.prepend(topbarContainer);\r\n\r\n        if (window.lucide) {\r\n            lucide.createIcons();\r\n        }\r\n    }\r\n\r\n    function initTopbar() {\r\n        if (document.readyState === 'loading') {\r\n            document.addEventListener('DOMContentLoaded', createTopbar);\r\n        } else {\r\n            createTopbar();\r\n        }\r\n    }\r\n})();\r\n\n</script>\n\n    <div class=\"player-page\">\n\n\n        <div class=\"player-container\">\n            <div class=\"player-frame-wrapper\" id=\"frame-wrapper\">\n                <iframe class=\"player-frame\" id=\"game-frame\" allowfullscreen></iframe>\n                <video class=\"player-frame\" id=\"video-frame\" style=\"display:none;\" controls autoplay\n                    playsinline></video>\n            </div>\n\n            <div class=\"player-controls\" id=\"controls\">\n                <!-- Dynamic Controls -->\n                <div id=\"movie-controls\" class=\"player-movie-controls\" style=\"display:none;\">\n                    <div class=\"player-control-group\">\n                        <span class=\"player-control-label\">Provider</span>\n                        <select id=\"provider-select\" class=\"provider-select\"></select>\n                    </div>\n\n                    <label class=\"player-proxy-toggle\" title=\"Toggle Proxy\">\n                        <div class=\"switch\">\n                            <input type=\"checkbox\" id=\"proxy-toggle\">\n                            <span class=\"slider\"></span>\n                        </div>\n                        <span class=\"player-control-label\">Proxy</span>\n                    </label>\n                </div>\n\n                <button class=\"btn btn-secondary\" id=\"btn-download\" style=\"display:none;\">\n                    <i class=\"fa-solid fa-download\"></i> Download\n                </button>\n\n                <button class=\"btn btn-secondary\" id=\"btn-reload\">\n                    <i class=\"fa-solid fa-rotate-right\"></i> Reload\n                </button>\n                <button class=\"btn btn-secondary\" id=\"btn-newtab\">\n                    <i class=\"fa-solid fa-up-right-from-square\"></i> Open in New Tab\n                </button>\n                <button class=\"btn btn-secondary\" id=\"btn-theater\">\n                    <i class=\"fa-solid fa-masks-theater\"></i> Theater Mode\n                </button>\n                <button class=\"btn btn-secondary\" id=\"btn-fullscreen\">\n                    <i class=\"fa-solid fa-expand\"></i> Fullscreen\n                </button>\n            </div>\n\n            <div class=\"player-info\">\n                <h1 class=\"player-title\" id=\"player-title\">Loading...</h1>\n                <p class=\"player-desc\" id=\"player-desc\"></p>\n                <p class=\"player-quote\" id=\"player-quote\"></p>\n                <p class=\"theater-message\" id=\"theater-message\"\n                    style=\"display:none; text-align: center; color: var(--text-muted); font-size: 1.125rem; margin-top: 16px;\">\n                    Enjoy your movie!</p>\n            </div>\n        </div>\n    </div>\n\n    <script>\n// background stuff\r\n(function () {\r\n    'use strict';\r\n\r\n    if (window.BackgroundManager) return;\r\n\r\n    const YOUTUBE_REGEX = /(?:youtube\\.com\\/watch\\?v=|youtu\\.be\\/|youtube\\.com\\/embed\\/)([a-zA-Z0-9_-]{11})/;\r\n\r\n    const BackgroundManager = {\r\n        container: null,\r\n        mediaLayer: null,\r\n        elements: { video: null, image: null, iframe: null },\r\n        current: { type: null, url: null },\r\n        cacheName: 'phantom-bg-cache-v2',\r\n\r\n        init() {\r\n            this.container = document.createElement('div');\r\n            this.container.className = 'phantom-background';\r\n            this.container.innerHTML = '<div class=\"phantom-background-overlay\"></div><div class=\"phantom-background-layer\"></div>';\r\n            this.mediaLayer = this.container.querySelector('.phantom-background-layer');\r\n            document.body.insertBefore(this.container, document.body.firstChild);\r\n\r\n            const apply = () => this.applyBackground();\r\n            window.addEventListener('settings-changed', apply);\r\n            window.addEventListener('storage', apply);\r\n            window.addEventListener('beforeunload', () => this.cleanup());\r\n            window.addEventListener('pagehide', () => this.cleanup());\r\n\r\n            document.addEventListener('visibilitychange', () => {\r\n                const video = this.elements.video;\r\n                if (!video) return;\r\n                if (document.hidden) video.pause();\r\n                else if (this.current.type === 'video') video.play().catch(() => { });\r\n            });\r\n\r\n            this.applyBackground();\r\n        },\r\n\r\n        applyBackground() {\r\n            if (!this.container) return; // Wait for init() to create the container\r\n\r\n            const s = window.Settings?.getAll() || {};\r\n            const custom = s.customBackground;\r\n            const theme = s.background || {};\r\n\r\n            let type = null, url = null, pos = null, overlay = 0.4;\r\n\r\n            if (custom && custom.type !== 'none') {\r\n                // Refresh from config if possible to get latest props like objectPosition\r\n                if (custom.id && custom.id !== 'custom') {\r\n                    const preset = window.SITE_CONFIG?.backgroundPresets?.find(b => b.id === custom.id);\r\n                    if (preset) Object.assign(custom, preset);\r\n                }\r\n                ({ type, url, objectPosition: pos, overlay = 0.4 } = custom);\r\n            } else if (theme.type === 'image' || theme.type === 'video' || theme.type === 'youtube') {\r\n                type = theme.type;\r\n                url = theme.value || theme.url;\r\n                pos = theme.objectPosition;\r\n                overlay = theme.overlay || 0.4;\r\n            }\r\n\r\n            document.documentElement.style.setProperty('--bg-overlay', overlay);\r\n\r\n            // Handle common positioning typos and normalize\r\n            if (pos && typeof pos === 'string') {\r\n                pos = pos.toLowerCase().trim()\r\n                    .replace(/\\s+/g, ' ') // Normalize multiple spaces\r\n                    .replace('topleft', 'top left')\r\n                    .replace('topright', 'top right')\r\n                    .replace('bottomleft', 'bottom left')\r\n                    .replace('bottomright', 'bottom right')\r\n                    .replace('centercenter', 'center')\r\n                    .replace('centerleft', 'center left')\r\n                    .replace('centerright', 'center right');\r\n            }\r\n\r\n            document.documentElement.style.setProperty('--bg-image-position', pos || 'center');\r\n\r\n            if (!type || !url) {\r\n                this.clear();\r\n                document.documentElement.style.backgroundColor = 'var(--bg)';\r\n                document.documentElement.style.setProperty('--bg-image-position', 'center');\r\n                return;\r\n            }\r\n            if (this.current.type === type && this.current.url === url) return;\r\n\r\n            this.current = { type, url };\r\n\r\n            if (type === 'video' || url.match(/\\.(mp4|webm|ogg|mov|m4v)$/i)) {\r\n                this.clearMedia();\r\n                this.createVideo(url, pos);\r\n                this.container.classList.add('active');\r\n                document.documentElement.classList.add('phantom-bg-active');\r\n                document.body.classList.add('phantom-bg-active');\r\n            } else if (type === 'youtube' || YOUTUBE_REGEX.test(url)) {\r\n                this.clearMedia();\r\n                this.createYouTube(url, pos);\r\n                this.container.classList.add('active');\r\n                document.documentElement.classList.add('phantom-bg-active');\r\n                document.body.classList.add('phantom-bg-active');\r\n            } else if (type === 'image') {\r\n                this.handleImageBackground(url, pos);\r\n            }\r\n        },\r\n\r\n        async getProxiedCachedUrl(url) {\r\n            // Local images don't need proxying\r\n            if (!url.startsWith('http') || url.includes(location.hostname)) return url;\r\n\r\n            // Try direct load first (faster)\r\n            try {\r\n                const directTest = await fetch(url, { method: 'HEAD', mode: 'cors' });\r\n                if (directTest.ok) return url;\r\n            } catch (e) {\r\n                // CORS blocked, need to proxy\r\n            }\r\n\r\n            // Wait for BareMux (max 500ms)\r\n            let retries = 0;\r\n            while (!window.BareMux && retries < 5) {\r\n                await new Promise(r => setTimeout(r, 100));\r\n                retries++;\r\n            }\r\n\r\n            if (!window.BareMux) {\r\n                console.warn(\"Background: BareMux not found, trying direct URL.\");\r\n                return url; // Try direct anyway\r\n            }\r\n\r\n            try {\r\n                const client = new window.BareMux.BareClient();\r\n                const response = await client.fetch(url);\r\n                if (!response.ok) throw new Error('Proxy fetch failed');\r\n\r\n                const blob = await response.blob();\r\n                return URL.createObjectURL(blob);\r\n            } catch (error) {\r\n                console.error(\"Background proxy failed:\", error);\r\n                return url; // Fallback to direct URL\r\n            }\r\n        },\r\n\r\n        async handleImageBackground(url, pos) {\r\n            // Pre-load the image (proxied/cached or direct)\r\n            const finalUrl = await this.getProxiedCachedUrl(url);\r\n\r\n            // Check if this is still the current background after async fetch\r\n            if (this.current.url !== url) {\r\n                if (finalUrl && finalUrl.startsWith('blob:')) URL.revokeObjectURL(finalUrl);\r\n                return;\r\n            }\r\n\r\n            this.clearMedia();\r\n            this.createImage(finalUrl, pos);\r\n        },\r\n\r\n        createVideo(url, pos) {\r\n            const el = Object.assign(document.createElement('video'), {\r\n                className: 'phantom-background-media', src: url, autoplay: true, loop: true, muted: true, playsInline: true, volume: 0\r\n            });\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n            el.onerror = () => (this.elements.video = null);\r\n            this.elements.video = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        createImage(url, pos) {\r\n            const el = Object.assign(document.createElement('img'), {\r\n                className: 'phantom-background-media',\r\n                src: url\r\n            });\r\n\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n\r\n            el.onload = () => {\r\n                if (this.current.url === url || url.startsWith('blob:')) {\r\n                    this.container.classList.add('active');\r\n                    document.documentElement.classList.add('phantom-bg-active');\r\n                    document.body.classList.add('phantom-bg-active');\r\n                }\r\n            };\r\n            el.onerror = () => {\r\n                console.warn(\"Background image failed to load:\", url);\r\n                if (this.elements.image === el) this.elements.image = null;\r\n            };\r\n\r\n            this.elements.image = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        // youtube logic\r\n        createYouTube(url, pos) {\r\n            const id = url.match(YOUTUBE_REGEX)?.[1];\r\n            if (!id) return;\r\n            const el = Object.assign(document.createElement('iframe'), {\r\n                className: 'phantom-background-media',\r\n                src: `https://www.youtube.com/embed/${id}?autoplay=1&loop=1&playlist=${id}&controls=0&modestbranding=1&rel=0&mute=1&enablejsapi=1`,\r\n                allow: 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture'\r\n            });\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n            this.elements.iframe = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        clearMedia() {\r\n            Object.entries(this.elements).forEach(([key, el]) => {\r\n                if (!el) return;\r\n                if (key === 'video') { el.pause(); el.src = ''; }\r\n                if (key === 'iframe') el.src = 'about:blank';\r\n                if (key === 'image' && el.src.startsWith('blob:')) {\r\n                    URL.revokeObjectURL(el.src);\r\n                }\r\n                el.remove();\r\n                this.elements[key] = null;\r\n            });\r\n        },\r\n\r\n        clear() {\r\n            this.clearMedia();\r\n            this.current = { type: null, url: null };\r\n            document.documentElement.classList.remove('phantom-bg-active');\r\n            document.body.classList.remove('phantom-bg-active');\r\n            document.documentElement.style.backgroundColor = '';\r\n            if (this.container) this.container.classList.remove('active');\r\n        },\r\n\r\n        cleanup() {\r\n            this.clearMedia();\r\n        }\r\n    };\r\n\r\n    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', () => BackgroundManager.init());\r\n    else BackgroundManager.init();\r\n\r\n    window.BackgroundManager = BackgroundManager;\r\n})();\r\n\n</script>\n    <script>\n(function () {\r\n    const style = document.createElement('style');\r\n    style.textContent = `\r\n        .notify-container { position: fixed; top: 16px; right: 16px; z-index: 99999; display: flex; flex-direction: column; gap: 8px; pointer-events: none; font-family: 'Inter', sans-serif; }\r\n        .notify-toast { display: flex; align-items: center; gap: 12px; padding: 12px 16px; background: rgba(15, 15, 15, 0.9); backdrop-filter: blur(10px); border: 1px solid var(--border, #1f1f1f); border-radius: 10px; color: #e4e4e7; font-size: 13px; min-width: 280px; max-width: 380px; box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4); pointer-events: auto; transform: translateX(120%); opacity: 0; transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1), opacity 0.3s ease; position: relative; overflow: hidden; }\r\n        .notify-toast.show { transform: translateX(0); opacity: 1; }\r\n        .notify-toast.hiding { transform: translateX(120%); opacity: 0; }\r\n        .notify-icon { width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }\r\n        .notify-icon svg { width: 18px; height: 18px; }\r\n        .notify-content { flex: 1; line-height: 1.4; }\r\n        .notify-title { font-weight: 600; margin-bottom: 2px; }\r\n        .notify-message { color: #a1a1aa; font-size: 12px; }\r\n        .notify-close { background: none; border: none; color: #52525b; cursor: pointer; padding: 4px; border-radius: 4px; display: flex; align-items: center; justify-content: center; }\r\n        .notify-close:hover { background: rgba(255,255,255,0.1); color: #fff; }\r\n        .notify-close svg { width: 14px; height: 14px; }\r\n        .notify-toast.success { border-left: 3px solid #22c55e; } .notify-toast.success .notify-icon { color: #22c55e; }\r\n        .notify-toast.error { border-left: 3px solid #ef4444; } .notify-toast.error .notify-icon { color: #ef4444; }\r\n        .notify-toast.warning { border-left: 3px solid #f59e0b; } .notify-toast.warning .notify-icon { color: #f59e0b; }\r\n        .notify-toast.info { border-left: 3px solid #3b82f6; } .notify-toast.info .notify-icon { color: #3b82f6; }\r\n        .notify-progress { position: absolute; bottom: 0; left: 0; height: 2px; background: rgba(255, 255, 255, 0.2); transition: width linear; }\r\n    `;\r\n    document.head.appendChild(style);\r\n\r\n    let container = null;\r\n    const getContainer = () => container || (container = document.body.appendChild(Object.assign(document.createElement('div'), { className: 'notify-container' })));\r\n\r\n    const icons = {\r\n        success: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"20 6 9 17 4 12\"></polyline></svg>`,\r\n        error: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"15\" y1=\"9\" x2=\"9\" y2=\"15\"></line><line x1=\"9\" y1=\"9\" x2=\"15\" y2=\"15\"></line></svg>`,\r\n        warning: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\"></path><line x1=\"12\" y1=\"9\" x2=\"12\" y2=\"13\"></line><line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\"></line></svg>`,\r\n        info: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"12\" y1=\"16\" x2=\"12\" y2=\"12\"></line><line x1=\"12\" y1=\"8\" x2=\"12.01\" y2=\"8\"></line></svg>`,\r\n        close: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line><line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line></svg>`\r\n    };\r\n\r\n    function notify(type, title, msg = '', dur = 4000) {\r\n        const t = document.createElement('div');\r\n        t.className = `notify-toast ${type}`;\r\n        t.innerHTML = `<div class=\"notify-icon\">${icons[type]}</div><div class=\"notify-content\"><div class=\"notify-title\">${title}</div><div class=\"notify-message\">${msg}</div></div><button class=\"notify-close\">${icons.close}</button><div class=\"notify-progress\"></div>`;\r\n        const p = t.querySelector('.notify-progress');\r\n        const dismiss = () => { t.classList.add('hiding'); setTimeout(() => t.remove(), 300); };\r\n        t.querySelector('.notify-close').onclick = dismiss;\r\n        p.style.width = '100%';\r\n        setTimeout(() => { p.style.transition = `width ${dur}ms linear`; p.style.width = '0%'; }, 50);\r\n        let timer = setTimeout(dismiss, dur);\r\n        t.onmouseenter = () => { clearTimeout(timer); p.style.transition = 'none'; };\r\n        t.onmouseleave = () => {\r\n            const rem = (parseFloat(getComputedStyle(p).width) / t.offsetWidth) * dur;\r\n            p.style.transition = `width ${rem}ms linear`; p.style.width = '0%';\r\n            timer = setTimeout(dismiss, rem);\r\n        };\r\n        getContainer().appendChild(t);\r\n        requestAnimationFrame(() => t.classList.add('show'));\r\n    }\r\n\r\n    window.Notify = {\r\n        success: (a, b, c) => notify('success', a, b, c),\r\n        error: (a, b, c) => notify('error', a, b, c),\r\n        warning: (a, b, c) => notify('warning', a, b, c),\r\n        info: (a, b, c) => notify('info', a, b, c)\r\n    };\r\n})();\r\n\n</script>\n    <script>\nwindow.Quotes = {\r\n    // Use data from config, fallback to empty array if not found\r\n    getData() {\r\n        return (window.SITE_CONFIG && window.SITE_CONFIG.quotes) || [];\r\n    },\r\n\r\n    getRandom() {\r\n        const data = this.getData();\r\n        if (!data.length) return null; // Return null if no quotes\r\n        return data[Math.floor(Math.random() * data.length)];\r\n    },\r\n    init(force = false) {\r\n        const quote = this.getRandom();\r\n        if (!quote) return; // Do nothing if no quotes\r\n\r\n        const targets = [\r\n            '#quote',\r\n            '#quote-display',\r\n            '#subtitle',\r\n            '.page-subtitle',\r\n            '.extra-hero p',\r\n            '.loading-text'\r\n        ];\r\n\r\n        targets.forEach(selector => {\r\n            document.querySelectorAll(selector).forEach(el => {\r\n                // Only update if force is true, or it's empty, or has placeholder text\r\n                const text = el.textContent.trim();\r\n                if (force || !text || text === 'Loading...' || text.includes('Stream movies') || text.includes('Customize your')) {\r\n                    el.textContent = quote;\r\n                }\r\n            });\r\n        });\r\n    }\r\n};\r\n\r\nwindow.QUOTES = window.Quotes.getData();\r\n\r\n// Run automatically on load\r\nif (document.readyState === 'loading') {\r\n    document.addEventListener('DOMContentLoaded', () => window.Quotes.init());\r\n} else {\r\n    window.Quotes.init();\r\n}\r\n\n</script>\n    <script>\n// footer\r\n(function () {\r\n    'use strict';\r\n\r\n    let rootPrefix = '';\r\n    const scriptName = 'components/footer.js';\r\n    const scripts = document.getElementsByTagName('script');\r\n    for (let i = 0; i < scripts.length; i++) {\r\n        const src = scripts[i].getAttribute('src');\r\n        if (src && src.includes(scriptName)) {\r\n            rootPrefix = src.split(scriptName)[0];\r\n            break;\r\n        }\r\n    }\r\n\r\n    const config = window.SITE_CONFIG || { name: 'Phantom', version: '1.0.0', discord: { inviteUrl: '#' }, changelog: [], cloakPresets: [] };\r\n    const STORAGE_KEY = 'void_settings';\r\n    let storedSettings = {};\r\n    try { storedSettings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n\r\n    // settings\r\n    let settings = { ...(config.defaults || {}), ...storedSettings };\r\n\r\n    const footer = document.createElement('footer');\r\n    footer.id = 'site-footer';\r\n    footer.innerHTML = `\r\n        <style>\r\n            #site-footer {\r\n                margin-top: 0px;\r\n                padding: 20px;\r\n                border-top: 1px solid var(--border, #1f1f1f);\r\n                text-align: center;\r\n                background: transparent;\r\n            }\r\n            #site-footer .footer-links {\r\n                display: flex;\r\n                gap: 16px;\r\n                justify-content: center;\r\n                margin-bottom: 8px;\r\n                flex-wrap: wrap;\r\n            }\r\n            #site-footer .footer-link {\r\n                font-size: 12px;\r\n                color: var(--text-muted, #71717a);\r\n                text-decoration: none;\r\n                transition: color 0.15s;\r\n                font-family: 'Inter', sans-serif;\r\n                cursor: pointer;\r\n            }\r\n            #site-footer .footer-link:hover {\r\n                color: var(--text, #e4e4e7);\r\n            }\r\n            #site-footer .footer-version {\r\n                font-size: 11px;\r\n                color: var(--text-dim, #52525b);\r\n                cursor: pointer;\r\n                font-family: 'Inter', sans-serif;\r\n            }\r\n            #site-footer .footer-version:hover {\r\n                color: var(--text-muted, #71717a);\r\n            }\r\n        </style>\r\n        <div class=\"footer-links\">\r\n            <a href=\"${rootPrefix}pages/settings.html\" class=\"footer-link\"><i class=\"fa-solid fa-gear\"></i> Settings</a>\r\n            <a id=\"footer-changelog\" class=\"footer-link\"><i class=\"fa-solid fa-clock-rotate-left\"></i> Changelog</a>\r\n            <a href=\"${config.discord?.inviteUrl || '#'}\" target=\"_blank\" class=\"footer-link\"><i class=\"fa-brands fa-discord\"></i> Discord</a>\r\n            <a href=\"${rootPrefix}pages/terms.html\" class=\"footer-link\">Terms</a>\r\n            <a href=\"${rootPrefix}pages/disclaimer.html\" class=\"footer-link\">Disclaimer</a>\r\n            <a href=\"${rootPrefix}pages/extra.html\" class=\"footer-link\">Credits</a>\r\n        </div>\r\n        <span class=\"footer-version\" id=\"footer-version\">${config.name || 'Phantom'} v${config.version || '1.0.0'}</span>\r\n    `;\r\n\r\n    document.body.appendChild(footer);\r\n\r\n\r\n\r\n    // gtm\r\n    // Inject GTM head script if not already present\r\n    if (!document.querySelector('script[src*=\"googletagmanager.com/gtm.js\"]')) {\r\n        window.dataLayer = window.dataLayer || [];\r\n        window.dataLayer.push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' });\r\n        const gtmScript = document.createElement('script');\r\n        gtmScript.async = true;\r\n        gtmScript.src = 'https://www.googletagmanager.com/gtm.js?id=GTM-5LMBC27Z';\r\n        document.head.insertBefore(gtmScript, document.head.firstChild);\r\n    }\r\n\r\n    // Add GTM noscript fallback (for pages that don't have it in HTML)\r\n    if (!document.querySelector('noscript iframe[src*=\"googletagmanager\"]')) {\r\n        const gtmNoscript = document.createElement('noscript');\r\n        gtmNoscript.innerHTML = '<iframe src=\"https://www.googletagmanager.com/ns.html?id=GTM-5LMBC27Z\" height=\"0\" width=\"0\" style=\"display:none;visibility:hidden\"></iframe>';\r\n        document.body.insertBefore(gtmNoscript, document.body.firstChild);\r\n    }\r\n\r\n    const openChangelog = (e, customTitle, customContent) => {\r\n        if (e && e.preventDefault) e.preventDefault();\r\n        const changes = customContent || config.changelog || ['No changes listed'];\r\n\r\n        // Use standard modal structure from main.css\r\n        const overlay = document.createElement('div');\r\n        overlay.className = 'modal-overlay';\r\n\r\n        overlay.innerHTML = `\r\n            <div class=\"modal\" style=\"width: 400px; max-width: 90vw;\">\r\n                <div class=\"modal-header\">\r\n                    <h3 class=\"modal-title\">${customTitle || 'What\\'s New in v' + config.version}</h3>\r\n                    <button class=\"modal-close\"><i class=\"fa-solid fa-xmark\"></i></button>\r\n                </div>\r\n                <div class=\"modal-body\">\r\n                    <ul style=\"margin: 0; padding-left: 20px; color: var(--text-muted); font-size: 0.875rem; line-height: 1.6;\">\r\n                        ${changes.map(c => '<li>' + c + '</li>').join('')}\r\n                    </ul>\r\n                </div>\r\n                <div class=\"modal-footer\">\r\n                    <a href=\"${config.discord?.inviteUrl || '#'}\" target=\"_blank\" style=\"color: #5865F2; text-decoration: none; font-size: 13px; display: inline-flex; align-items: center; gap: 6px;\">\r\n                        <i class=\"fa-brands fa-discord\"></i> Join Discord\r\n                    </a>\r\n                </div>\r\n            </div>\r\n        `;\r\n\r\n        document.body.appendChild(overlay);\r\n\r\n        // Trigger animation\r\n        requestAnimationFrame(() => overlay.classList.add('show'));\r\n\r\n        const close = () => {\r\n            overlay.classList.remove('show');\r\n            setTimeout(() => overlay.remove(), 200);\r\n        };\r\n\r\n        overlay.querySelector('.modal-close').onclick = close;\r\n        overlay.onclick = (e) => { if (e.target === overlay) close(); };\r\n    };\r\n\r\n    // Expose openChangelog globally\r\n    window.openChangelog = openChangelog;\r\n\r\n    const changelogBtn = document.getElementById('footer-changelog');\r\n    if (changelogBtn) changelogBtn.onclick = openChangelog;\r\n\r\n    const versionBtn = document.getElementById('footer-version');\r\n    if (versionBtn) versionBtn.onclick = openChangelog;\r\n\r\n    // sync\r\n    // syncRemoteChangelog removed - using local config\r\n\r\n\r\n    // Initialize Sync\r\n    // syncRemoteChangelog();\r\n\r\n    const currentVersion = config.version;\r\n    const lastVersion = settings.lastVersion;\r\n\r\n    if (settings.showChangelogOnUpdate && lastVersion && lastVersion !== currentVersion) {\r\n        setTimeout(() => {\r\n            openChangelog();\r\n            settings.lastVersion = currentVersion;\r\n            localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n        }, 1000);\r\n    } else if (!lastVersion) {\r\n        settings.lastVersion = currentVersion;\r\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n    }\r\n\r\n    // panic\r\n    if (settings.panicKey) {\r\n        document.addEventListener('keydown', (e) => {\r\n            const keys = settings.panicModifiers || ['ctrl', 'shift'];\r\n            const triggerKey = settings.panicKey.toLowerCase();\r\n            const pressedKey = e.key.toLowerCase();\r\n\r\n            // Check modifiers\r\n            const ctrlMatch = keys.includes('ctrl') === e.ctrlKey;\r\n            const shiftMatch = keys.includes('shift') === e.shiftKey;\r\n            const altMatch = keys.includes('alt') === e.altKey;\r\n\r\n            if (ctrlMatch && shiftMatch && altMatch && pressedKey === triggerKey) {\r\n                e.preventDefault();\r\n\r\n                // Show white screen instantly (if panic-overlay exists in parent)\r\n                const parentOverlay = window.parent?.document?.getElementById('panic-overlay');\r\n                if (parentOverlay) {\r\n                    parentOverlay.style.display = 'block';\r\n                } else {\r\n                    // Create overlay if it doesn't exist\r\n                    const overlay = document.createElement('div');\r\n                    overlay.id = 'panic-overlay';\r\n                    overlay.style.cssText = 'position:fixed;inset:0;background:white;z-index:99999;';\r\n                    document.body.appendChild(overlay);\r\n                }\r\n\r\n                // Redirect immediately\r\n                const url = settings.panicUrl || 'https://classroom.google.com';\r\n                try { window.top.location.href = url; } catch { window.location.href = url; }\r\n            }\r\n        }, true); // Use capture phase for faster response\r\n    }\r\n\r\n    // Cloaking logic has been moved to scripts/cloaking.js for better synchronization.\r\n    // If you need cloaking on a specific page, include that script.\r\n\r\n\r\n    window.addEventListener('beforeunload', (e) => {\r\n        // Reload settings to get latest value\r\n        try { settings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n\r\n        if (window.top === window.self && settings.leaveConfirmation) {\r\n            e.preventDefault();\r\n            e.returnValue = '';\r\n            return '';\r\n        }\r\n    });\r\n\r\n    // discord\r\n    let crateInstance = null;\r\n\r\n    function initDiscord() {\r\n        if (settings.discordWidget && config.discord && config.discord.widgetServer && config.discord.widgetChannel) {\r\n            // Check if already loaded\r\n            if (document.querySelector('script[src*=\"@widgetbot/crate\"]')) {\r\n                if (crateInstance) crateInstance.show();\r\n                return;\r\n            }\r\n\r\n            const crateScript = document.createElement('script');\r\n            crateScript.src = 'https://cdn.jsdelivr.net/npm/@widgetbot/crate@3';\r\n            crateScript.async = true;\r\n            crateScript.defer = true;\r\n            crateScript.onload = () => {\r\n                crateInstance = new Crate({\r\n                    server: config.discord.widgetServer,\r\n                    channel: config.discord.widgetChannel,\r\n                    glyph: ['https://cdn.discordapp.com/embed/avatars/0.png', '100%'],\r\n                    location: ['bottom', 'right']\r\n                });\r\n            };\r\n            document.body.appendChild(crateScript);\r\n        } else {\r\n            // Hide if disabled\r\n            if (crateInstance) crateInstance.hide();\r\n        }\r\n    }\r\n\r\n    // Initialize\r\n    initDiscord();\r\n\r\n    // Listen for settings change to toggle dynamically\r\n    window.addEventListener('storage', (e) => {\r\n        if (e.key === STORAGE_KEY) {\r\n            try { settings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n            initDiscord();\r\n        }\r\n    });\r\n\r\n    // Listen for internal event\r\n    window.addEventListener('settings-changed', (e) => {\r\n        settings = e.detail;\r\n        initDiscord();\r\n    });\r\n\r\n    // counters\r\n    // Only show on home page (index2.html) checking if main-content exists\r\n    const mainContent = document.querySelector('.main-content');\r\n    // Ensure we are on the home page view (search bar checks etc) or just check existence\r\n    if (mainContent && document.querySelector('.featured-section')) {\r\n        const counterContainer = document.createElement('div');\r\n        counterContainer.id = 'supercounters-wrapper';\r\n        counterContainer.style.marginTop = '24px';\r\n        counterContainer.style.textAlign = 'center';\r\n        counterContainer.style.opacity = '0.8';\r\n\r\n        // Use iframe to isolate document.write from the widget\r\n        const iframe = document.createElement('iframe');\r\n        iframe.style.border = 'none';\r\n        iframe.style.width = '150px';\r\n        iframe.style.height = '40px';\r\n        iframe.style.overflow = 'hidden';\r\n\r\n        // Widget code\r\n        const widgetCode = `\r\n            <html>\r\n            <body style=\"margin:0;display:flex;justify-content:center;align-items:center;background:transparent;\">\r\n                <script type=\"text/javascript\" src=\"//widget.supercounters.com/ssl/online_i.js\"><\\/script>\r\n                <script type=\"text/javascript\">sc_online_i(1726449,\"ffffff\",\"000000\");<\\/script>\r\n            </body>\r\n            </html>\r\n        `;\r\n\r\n        iframe.srcdoc = widgetCode;\r\n        counterContainer.appendChild(iframe);\r\n        mainContent.appendChild(counterContainer);\r\n    }\r\n})();\r\n\n</script>\n\n    <script>\nconst params = new URLSearchParams(window.location.search);\r\nconst type = params.get('type'), id = params.get('id'), title = params.get('title'), urlParam = params.get('url'), season = params.get('season'), episode = params.get('episode');\r\nconst frame = document.getElementById('game-frame'), titleEl = document.getElementById('player-title'), descEl = document.getElementById('player-desc'), quoteEl = document.getElementById('player-quote'), proxyToggle = document.getElementById('proxy-toggle');\r\n\r\nconst PROVIDERS = [\r\n    { id: 'vidify', name: 'Vidify', urls: { movie: 'https://player.vidify.top/embed/movie/{id}', tv: 'https://player.vidify.top/embed/tv/{id}&s={season}&e={episode}' } },\r\n    { id: 'vidfast', name: 'Vidfast', urls: { movie: 'https://vidfast.to/embed/movie/{id}', tv: 'https://vidfast.to/embed/tv/{id}&s={season}&e={episode}' } },\r\n    { id: 'vidsrc', name: 'VidSrc', urls: { movie: 'https://vidsrc-embed.su/embed/movie?tmdb={id}', tv: 'https://vidsrc-embed.su/embed/tv?tmdb={id}&s={season}&e={episode}' } }\r\n];\r\n\r\nlet currentUrl = '', curProvIdx = 0;\r\n\r\nclass SmartSwitcher {\r\n    constructor() { this.retry = 0; frame.onload = () => (this.clear(), console.log('Loaded')); }\r\n    clear() { clearTimeout(this.tm); this.tm = null; }\r\n    start() { this.clear(); this.tm = setTimeout(() => this.fail(), 15000); }\r\n    fail() {\r\n        if (++this.retry >= 3) return window.Notify?.error('Error', 'All providers failed');\r\n        window.Notify?.info('Switching', 'Slow source, trying next...');\r\n        if (type === 'game') this.toggleProxy(); else this.next();\r\n    }\r\n    next() { curProvIdx = (curProvIdx + 1) % PROVIDERS.length; const s = document.getElementById('provider-select'); if (s) s.value = PROVIDERS[curProvIdx].id; loadProvider(PROVIDERS[curProvIdx].id, true); }\r\n    toggleProxy() { if (proxyToggle) { proxyToggle.checked = !proxyToggle.checked; type === 'game' ? loadGame(currentUrl, true) : loadProvider(PROVIDERS[curProvIdx].id, true); } }\r\n}\r\nconst switcher = new SmartSwitcher();\r\n\r\nfunction init() {\r\n    titleEl.textContent = title || (type === 'tv' ? `S${season} E${episode}` : (type === 'game' ? 'Game' : 'Movie'));\r\n    if (type === 'game') {\r\n        document.getElementById('btn-download').style.display = 'flex';\r\n        if (urlParam) loadGame(urlParam);\r\n    } else {\r\n        document.getElementById('movie-controls').style.display = 'flex';\r\n        const sel = document.getElementById('provider-select');\r\n        PROVIDERS.forEach(p => sel.add(new Option(p.name, p.id)));\r\n        sel.onchange = () => (switcher.retry = 0, loadProvider(sel.value));\r\n        if (proxyToggle) proxyToggle.onchange = () => (switcher.retry = 0, loadProvider(PROVIDERS[curProvIdx].id));\r\n        loadProvider(PROVIDERS[0].id);\r\n    }\r\n    const q = window.Quotes ? window.Quotes.getRandom() : '';\r\n    descEl.textContent = (type !== 'game' ? (JSON.parse(sessionStorage.getItem('currentMovie') || '{}').overview || 'No description') : '');\r\n    if (quoteEl) quoteEl.textContent = q;\r\n}\r\n\r\nconst videoFrame = document.getElementById('video-frame');\r\nlet hlsPlayer = null;\r\n\r\nasync function loadGame(url, silent = false) {\r\n    currentUrl = url;\r\n    if (!silent) switcher.retry = 0;\r\n    switcher.start();\r\n\r\n    // Reset visibility\r\n    frame.style.display = 'block';\r\n    videoFrame.style.display = 'none';\r\n    if (hlsPlayer) { hlsPlayer.destroy(); hlsPlayer = null; }\r\n\r\n    // Check if it's an HLS stream (m3u8 or Twitch proxy)\r\n    const isHLS = url.includes('.m3u8') || url.includes('twitch.leelive2021.workers.dev');\r\n\r\n    if (isHLS) {\r\n        frame.style.display = 'none';\r\n        videoFrame.style.display = 'block';\r\n        if (Hls.isSupported()) {\r\n            hlsPlayer = new Hls();\r\n            hlsPlayer.loadSource(url);\r\n            hlsPlayer.attachMedia(videoFrame);\r\n            hlsPlayer.on(Hls.Events.MANIFEST_PARSED, () => videoFrame.play());\r\n        } else if (videoFrame.canPlayType('application/vnd.apple.mpegurl')) {\r\n            videoFrame.src = url;\r\n            videoFrame.addEventListener('loadedmetadata', () => videoFrame.play());\r\n        }\r\n    } else if (url.includes('#') || url.includes('staticsjv2/') || url.includes('youtube.com') || url.includes('youtube-nocookie.com')) {\r\n        frame.src = url;\r\n    } else {\r\n        try {\r\n            const h = await (await fetch(url)).text();\r\n            const d = frame.contentDocument || frame.contentWindow.document;\r\n            d.open(); d.write(h); d.close();\r\n        } catch (e) { frame.src = url; }\r\n    }\r\n}\r\n\r\nfunction loadProvider(pid, silent = false) {\r\n    const p = PROVIDERS.find(x => x.id === pid);\r\n    if (!p) return;\r\n    if (!silent) switcher.retry = 0;\r\n    switcher.start();\r\n    let u = (type === 'movie' ? p.urls.movie : p.urls.tv).replace('{id}', id).replace('{tmdb_id}', id).replace('{season}', season).replace('{episode}', episode);\r\n    if (proxyToggle?.checked) u = `../staticsjv2/embed.html#${u}`;\r\n    currentUrl = u; frame.src = u;\r\n}\r\n\r\ndocument.getElementById('btn-reload').onclick = () => {\r\n    window.Notify?.info('Reloading', 'Refreshing content...');\r\n    switcher.retry = 0;\r\n    type === 'game' ? loadGame(currentUrl) : loadProvider(PROVIDERS[curProvIdx].id);\r\n};\r\ndocument.getElementById('btn-theater').onclick = () => {\r\n    const b = document.body;\r\n    const isTheater = b.classList.toggle('theater-active');\r\n    const btn = document.getElementById('btn-theater');\r\n    btn.innerHTML = isTheater ? '<i class=\"fa-solid fa-compress\"></i> Exit Theater' : '<i class=\"fa-solid fa-masks-theater\"></i> Theater Mode';\r\n\r\n    // Scroll to top to prevent footer from showing\r\n    window.scrollTo(0, 0);\r\n\r\n    if (isTheater) {\r\n        window.Notify?.success('Theater Mode', 'Enjoy your movie!');\r\n    }\r\n};\r\ndocument.getElementById('btn-fullscreen').onclick = () => {\r\n    window.Notify?.info('Fullscreen', 'Entering fullscreen mode...');\r\n    const target = (videoFrame.style.display === 'block') ? videoFrame : frame;\r\n    target.requestFullscreen?.() || target.webkitRequestFullscreen?.() || document.getElementById('frame-wrapper').requestFullscreen();\r\n};\r\ndocument.getElementById('btn-newtab').onclick = async () => {\r\n    window.Notify?.info('Opening', 'Opening in new tab...');\r\n    const win = window.open('about:blank', '_blank');\r\n    if (!win) return;\r\n    let html = type === 'game' && !currentUrl.includes('staticsjv2/') ? await (await fetch(currentUrl)).text() : `<!DOCTYPE html><html><head><title>${title || 'Phantom'}</title><style>body{margin:0;background:#000;}</style></head><body><iframe src=\"${currentUrl}\" style=\"position:fixed;top:0;left:0;width:100%;height:100%;border:none;\" allowfullscreen></iframe></body></html>`;\r\n    if (window.Settings?.get('openIn') === 'blob') win.location.href = URL.createObjectURL(new Blob([html], { type: 'text/html' }));\r\n    else { win.document.write(html); win.document.close(); }\r\n};\r\ndocument.getElementById('btn-download').onclick = async () => {\r\n    window.Notify?.info('Downloading', 'Preparing download...');\r\n    const b = new Blob([await (await fetch(currentUrl)).text()], { type: 'text/html' });\r\n    const a = document.createElement('a');\r\n    a.href = URL.createObjectURL(b); a.download = `${title || 'game'}.html`.replace(/\\s+/g, '_');\r\n    a.click();\r\n    window.Notify?.success('Download Started', `${title || 'game'}.html`);\r\n};\r\n\r\ninit();\r\n\n</script>\n</body>\n\n</html>","pages/settings.html":"<!DOCTYPE html>\r\n<html lang=\"en\">\r\n\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n    <title>Settings - Phantom</title>\r\n    <link rel=\"icon\" href=\"../favicon.svg\" type=\"image/svg+xml\">\r\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css\">\r\n    <style>\n/* phantom styling */\r\n\r\n@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');\r\n\r\n/* variables */\r\n:root {\r\n    /* Core colors (can be overridden by user settings) */\r\n    --bg: #0a0a0a;\r\n    --surface: #0f0f0f;\r\n    --surface-hover: #1a1a1a;\r\n    --surface-active: #252525;\r\n    --border: #1f1f1f;\r\n    --border-light: #2a2a2a;\r\n\r\n    /* Text */\r\n    --text: #e4e4e7;\r\n    --text-muted: #71717a;\r\n    --text-dim: #52525b;\r\n\r\n    /* Accent (customizable) */\r\n    --accent: #ffffff;\r\n    --accent-dim: rgba(255, 255, 255, 0.8);\r\n    --accent-glow: rgba(255, 255, 255, 0.1);\r\n\r\n    /* Status colors */\r\n    --success: #22c55e;\r\n    --warning: #f59e0b;\r\n    --error: #ef4444;\r\n    --info: #3b82f6;\r\n\r\n    /* Shadows */\r\n    --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.3);\r\n    --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.4);\r\n    --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.5);\r\n    --shadow-xl: 0 16px 48px rgba(0, 0, 0, 0.6);\r\n\r\n    /* Spacing */\r\n    --space-xs: 4px;\r\n    --space-sm: 8px;\r\n    --space-md: 16px;\r\n    --space-lg: 24px;\r\n    --space-xl: 32px;\r\n    --space-2xl: 48px;\r\n\r\n    /* Border radius */\r\n    --radius-sm: 4px;\r\n    --radius-md: 8px;\r\n    --radius-lg: 12px;\r\n    --radius-xl: 16px;\r\n    --radius-full: 9999px;\r\n\r\n    /* Transitions */\r\n    --transition-fast: 0.1s ease;\r\n    --transition-normal: 0.2s ease;\r\n    --transition-slow: 0.3s ease;\r\n\r\n    /* Z-index layers */\r\n    --z-base: 1;\r\n    --z-dropdown: 100;\r\n    --z-sticky: 500;\r\n    --z-modal: 1000;\r\n    --z-toast: 2000;\r\n    --z-max: 9999;\r\n\r\n    /* Typography */\r\n    --font-sans: 'Inter', system-ui, -apple-system, sans-serif;\r\n    --font-mono: 'JetBrains Mono', 'Fira Code', monospace;\r\n\r\n    /* Background (customizable) */\r\n    --bg-image: none;\r\n}\r\n\r\n/* base */\r\n*,\r\n*::before,\r\n*::after {\r\n    box-sizing: border-box;\r\n    margin: 0;\r\n    padding: 0;\r\n}\r\n\r\nhtml {\r\n    font-size: 16px;\r\n    scroll-behavior: smooth;\r\n    -webkit-font-smoothing: antialiased;\r\n    -moz-osx-font-smoothing: grayscale;\r\n}\r\n\r\nbody {\r\n    font-family: var(--font-sans);\r\n    background: var(--bg);\r\n    background-image: var(--bg-image);\r\n    background-size: cover;\r\n    background-position: var(--bg-image-position, center);\r\n    background-attachment: fixed;\r\n    color: var(--text);\r\n    line-height: 1.5;\r\n    min-height: 100vh;\r\n    overflow-x: hidden;\r\n}\r\n\r\n/* Ensure background manager takes precedence */\r\nhtml.phantom-bg-active body {\r\n    background: transparent !important;\r\n    background-image: none !important;\r\n}\r\n\r\n/* Selection */\r\n::selection {\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n}\r\n\r\n/* Focus states */\r\n:focus-visible {\r\n    outline: 2px solid var(--accent);\r\n    outline-offset: 2px;\r\n}\r\n\r\n/* Links */\r\na {\r\n    color: var(--accent);\r\n    text-decoration: none;\r\n    transition: opacity var(--transition-fast);\r\n}\r\n\r\na:hover {\r\n    opacity: 0.8;\r\n}\r\n\r\n/* Scrollbar */\r\n::-webkit-scrollbar {\r\n    width: 8px;\r\n    height: 8px;\r\n}\r\n\r\n::-webkit-scrollbar-track {\r\n    background: var(--surface);\r\n}\r\n\r\n::-webkit-scrollbar-thumb {\r\n    background: var(--border-light);\r\n    border-radius: var(--radius-full);\r\n}\r\n\r\n::-webkit-scrollbar-thumb:hover {\r\n    background: var(--text-muted);\r\n}\r\n\r\n/* text */\r\nh1,\r\nh2,\r\nh3,\r\nh4,\r\nh5,\r\nh6 {\r\n    font-weight: 600;\r\n    line-height: 1.2;\r\n    color: var(--text);\r\n}\r\n\r\nh1 {\r\n    font-size: 2.5rem;\r\n}\r\n\r\nh2 {\r\n    font-size: 2rem;\r\n}\r\n\r\nh3 {\r\n    font-size: 1.5rem;\r\n}\r\n\r\nh4 {\r\n    font-size: 1.25rem;\r\n}\r\n\r\nh5 {\r\n    font-size: 1rem;\r\n}\r\n\r\nh6 {\r\n    font-size: 0.875rem;\r\n}\r\n\r\np {\r\n    color: var(--text-muted);\r\n    line-height: 1.6;\r\n}\r\n\r\n.text-sm {\r\n    font-size: 0.875rem;\r\n}\r\n\r\n.text-xs {\r\n    font-size: 0.75rem;\r\n}\r\n\r\n.text-lg {\r\n    font-size: 1.125rem;\r\n}\r\n\r\n.text-muted {\r\n    color: var(--text-muted);\r\n}\r\n\r\n.text-dim {\r\n    color: var(--text-dim);\r\n}\r\n\r\n.text-center {\r\n    text-align: center;\r\n}\r\n\r\n/* buttons */\r\n.btn {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    gap: var(--space-sm);\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-family: var(--font-sans);\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-md);\r\n    background: var(--surface);\r\n    color: var(--text);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n    white-space: nowrap;\r\n}\r\n\r\n.btn:hover {\r\n    background: var(--surface-hover);\r\n    border-color: var(--border-light);\r\n}\r\n\r\n.btn:active {\r\n    background: var(--surface-active);\r\n    transform: scale(0.98);\r\n}\r\n\r\n.btn-primary {\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n    border-color: var(--accent);\r\n}\r\n\r\n.btn-primary:hover {\r\n    opacity: 0.9;\r\n    background: var(--accent);\r\n}\r\n\r\n.btn-ghost {\r\n    background: transparent;\r\n    border-color: transparent;\r\n}\r\n\r\n.btn-ghost:hover {\r\n    background: var(--surface-hover);\r\n}\r\n\r\n.btn-icon {\r\n    width: 36px;\r\n    height: 36px;\r\n    padding: 0;\r\n    border-radius: var(--radius-md);\r\n}\r\n\r\n.btn-sm {\r\n    padding: var(--space-xs) var(--space-sm);\r\n    font-size: 0.75rem;\r\n}\r\n\r\n.btn-lg {\r\n    padding: var(--space-md) var(--space-lg);\r\n    font-size: 1rem;\r\n}\r\n\r\n/* inputs */\r\n.input {\r\n    width: 100%;\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-family: var(--font-sans);\r\n    font-size: 0.875rem;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-md);\r\n    color: var(--text);\r\n    transition: border-color var(--transition-fast);\r\n}\r\n\r\n.input:hover {\r\n    border-color: var(--border-light);\r\n}\r\n\r\n.input:focus {\r\n    outline: none;\r\n    border-color: var(--accent);\r\n}\r\n\r\n.input::placeholder {\r\n    color: var(--text-dim);\r\n}\r\n\r\n.input-group {\r\n    display: flex;\r\n    gap: var(--space-sm);\r\n}\r\n\r\n.input-group .input {\r\n    flex: 1;\r\n}\r\n\r\n/* Select */\r\n.select {\r\n    appearance: none;\r\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%2371717a' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E\");\r\n    background-repeat: no-repeat;\r\n    background-position: right 12px center;\r\n    padding-right: 36px;\r\n    cursor: pointer;\r\n}\r\n\r\n/* Checkbox/Toggle */\r\n.toggle {\r\n    position: relative;\r\n    width: 44px;\r\n    height: 24px;\r\n    background: var(--border);\r\n    border-radius: var(--radius-full);\r\n    cursor: pointer;\r\n    transition: background var(--transition-fast);\r\n}\r\n\r\n.toggle::after {\r\n    content: '';\r\n    position: absolute;\r\n    top: 2px;\r\n    left: 2px;\r\n    width: 20px;\r\n    height: 20px;\r\n    background: var(--text);\r\n    border-radius: 50%;\r\n    transition: transform var(--transition-fast);\r\n}\r\n\r\n.toggle.active {\r\n    background: var(--accent);\r\n}\r\n\r\n.toggle.active::after {\r\n    transform: translateX(20px);\r\n    background: var(--bg);\r\n}\r\n\r\n/* cards */\r\n.card {\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-lg);\r\n    overflow: hidden;\r\n    transition: all var(--transition-normal);\r\n}\r\n\r\n.card:hover {\r\n    border-color: var(--border-light);\r\n    box-shadow: var(--shadow-md);\r\n}\r\n\r\n.card-header {\r\n    padding: var(--space-md);\r\n    border-bottom: 1px solid var(--border);\r\n}\r\n\r\n.card-body {\r\n    padding: var(--space-md);\r\n}\r\n\r\n.card-footer {\r\n    padding: var(--space-md);\r\n    border-top: 1px solid var(--border);\r\n}\r\n\r\n\r\n/* Featured badge */\r\n.badge-featured {\r\n    position: absolute;\r\n    top: var(--space-sm);\r\n    left: var(--space-sm);\r\n    padding: var(--space-xs) var(--space-sm);\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n    font-size: 0.625rem;\r\n    font-weight: 700;\r\n    text-transform: uppercase;\r\n    letter-spacing: 0.05em;\r\n    border-radius: var(--radius-sm);\r\n}\r\n\r\n/* Favorite star */\r\n.favorite-btn {\r\n    position: absolute;\r\n    top: var(--space-sm);\r\n    right: var(--space-sm);\r\n    width: 32px;\r\n    height: 32px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background: rgba(0, 0, 0, 0.5);\r\n    border: none;\r\n    border-radius: 50%;\r\n    color: var(--text-muted);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n    opacity: 0;\r\n}\r\n\r\n.media-card:hover .favorite-btn {\r\n    opacity: 1;\r\n}\r\n\r\n.favorite-btn:hover {\r\n    background: rgba(0, 0, 0, 0.7);\r\n    color: var(--text);\r\n}\r\n\r\n.favorite-btn.active {\r\n    color: #fbbf24;\r\n    opacity: 1;\r\n}\r\n\r\n/* grid */\r\n.grid {\r\n    display: grid;\r\n    gap: var(--space-md);\r\n}\r\n\r\n.grid-cols-2 {\r\n    grid-template-columns: repeat(2, 1fr);\r\n}\r\n\r\n.grid-cols-3 {\r\n    grid-template-columns: repeat(3, 1fr);\r\n}\r\n\r\n.grid-cols-4 {\r\n    grid-template-columns: repeat(4, 1fr);\r\n}\r\n\r\n.grid-cols-5 {\r\n    grid-template-columns: repeat(5, 1fr);\r\n}\r\n\r\n.grid-cols-6 {\r\n    grid-template-columns: repeat(6, 1fr);\r\n}\r\n\r\n/* Auto-fit grid for responsive cards */\r\n.grid-auto {\r\n    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));\r\n}\r\n\r\n.grid-auto-lg {\r\n    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\r\n}\r\n\r\n/* flex */\r\n.flex {\r\n    display: flex;\r\n}\r\n\r\n.flex-col {\r\n    flex-direction: column;\r\n}\r\n\r\n.flex-wrap {\r\n    flex-wrap: wrap;\r\n}\r\n\r\n.items-center {\r\n    align-items: center;\r\n}\r\n\r\n.items-start {\r\n    align-items: flex-start;\r\n}\r\n\r\n.items-end {\r\n    align-items: flex-end;\r\n}\r\n\r\n.justify-center {\r\n    justify-content: center;\r\n}\r\n\r\n.justify-between {\r\n    justify-content: space-between;\r\n}\r\n\r\n.justify-end {\r\n    justify-content: flex-end;\r\n}\r\n\r\n.gap-xs {\r\n    gap: var(--space-xs);\r\n}\r\n\r\n.gap-sm {\r\n    gap: var(--space-sm);\r\n}\r\n\r\n.gap-md {\r\n    gap: var(--space-md);\r\n}\r\n\r\n.gap-lg {\r\n    gap: var(--space-lg);\r\n}\r\n\r\n.flex-1 {\r\n    flex: 1;\r\n}\r\n\r\n/* spacing */\r\n.p-xs {\r\n    padding: var(--space-xs);\r\n}\r\n\r\n.p-sm {\r\n    padding: var(--space-sm);\r\n}\r\n\r\n.p-md {\r\n    padding: var(--space-md);\r\n}\r\n\r\n.p-lg {\r\n    padding: var(--space-lg);\r\n}\r\n\r\n.p-xl {\r\n    padding: var(--space-xl);\r\n}\r\n\r\n.m-xs {\r\n    margin: var(--space-xs);\r\n}\r\n\r\n.m-sm {\r\n    margin: var(--space-sm);\r\n}\r\n\r\n.m-md {\r\n    margin: var(--space-md);\r\n}\r\n\r\n.m-lg {\r\n    margin: var(--space-lg);\r\n}\r\n\r\n.mt-sm {\r\n    margin-top: var(--space-sm);\r\n}\r\n\r\n.mt-md {\r\n    margin-top: var(--space-md);\r\n}\r\n\r\n.mt-lg {\r\n    margin-top: var(--space-lg);\r\n}\r\n\r\n.mb-sm {\r\n    margin-bottom: var(--space-sm);\r\n}\r\n\r\n.mb-md {\r\n    margin-bottom: var(--space-md);\r\n}\r\n\r\n.mb-lg {\r\n    margin-bottom: var(--space-lg);\r\n}\r\n\r\n/* modals */\r\n.modal-overlay {\r\n    position: fixed;\r\n    inset: 0;\r\n    background: rgba(0, 0, 0, 0.8);\r\n    backdrop-filter: blur(4px);\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    z-index: var(--z-modal);\r\n    opacity: 0;\r\n    visibility: hidden;\r\n    transition: all var(--transition-normal);\r\n}\r\n\r\n.modal-overlay.show {\r\n    opacity: 1;\r\n    visibility: visible;\r\n}\r\n\r\n.modal {\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-xl);\r\n    max-width: 90vw;\r\n    max-height: 90vh;\r\n    overflow: hidden;\r\n    transform: scale(0.95);\r\n    transition: transform var(--transition-normal);\r\n}\r\n\r\n.modal-overlay.show .modal {\r\n    transform: scale(1);\r\n}\r\n\r\n.modal-header {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    padding: var(--space-md);\r\n    border-bottom: 1px solid var(--border);\r\n}\r\n\r\n.modal-title {\r\n    font-size: 1rem;\r\n    font-weight: 600;\r\n}\r\n\r\n.modal-close {\r\n    width: 32px;\r\n    height: 32px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background: transparent;\r\n    border: none;\r\n    color: var(--text-muted);\r\n    cursor: pointer;\r\n    border-radius: var(--radius-md);\r\n    transition: all var(--transition-fast);\r\n}\r\n\r\n.modal-close:hover {\r\n    background: var(--surface-hover);\r\n    color: var(--text);\r\n}\r\n\r\n.modal-body {\r\n    padding: var(--space-md);\r\n    overflow-y: auto;\r\n}\r\n\r\n.modal-footer {\r\n    display: flex;\r\n    justify-content: flex-end;\r\n    gap: var(--space-sm);\r\n    padding: var(--space-md);\r\n    border-top: 1px solid var(--border);\r\n}\r\n\r\n/* tabs */\r\n.tabs {\r\n    display: flex;\r\n    gap: 2px;\r\n    background: var(--surface);\r\n    padding: var(--space-xs);\r\n    border-radius: var(--radius-md);\r\n    border: 1px solid var(--border);\r\n}\r\n\r\n.tab {\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    color: var(--text-muted);\r\n    background: transparent;\r\n    border: none;\r\n    border-radius: var(--radius-sm);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n}\r\n\r\n.tab:hover {\r\n    color: var(--text);\r\n}\r\n\r\n.tab.active {\r\n    background: var(--surface-hover);\r\n    color: var(--text);\r\n}\r\n\r\n/* search */\r\n\r\n/* ============================================\r\n   OFFLINE INDICATOR\r\n   ============================================ */\r\n.offline-banner {\r\n    position: fixed;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    padding: var(--space-sm) var(--space-md);\r\n    background: var(--warning);\r\n    color: var(--bg);\r\n    text-align: center;\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    z-index: var(--z-toast);\r\n    transform: translateY(-100%);\r\n    transition: transform var(--transition-normal);\r\n}\r\n\r\n.offline-banner.show {\r\n    transform: translateY(0);\r\n}\r\n\r\n.offline-badge {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    gap: var(--space-xs);\r\n    padding: var(--space-xs) var(--space-sm);\r\n    background: var(--warning);\r\n    color: var(--bg);\r\n    font-size: 0.625rem;\r\n    font-weight: 600;\r\n    text-transform: uppercase;\r\n    border-radius: var(--radius-sm);\r\n}\r\n\r\n/* ============================================\r\n   LOADING STATES\r\n   ============================================ */\r\n.skeleton {\r\n    background: linear-gradient(90deg, var(--surface) 0%, var(--surface-hover) 50%, var(--surface) 100%);\r\n    background-size: 200% 100%;\r\n    animation: shimmer 1.5s infinite;\r\n    border-radius: var(--radius-md);\r\n}\r\n\r\n@keyframes shimmer {\r\n    0% {\r\n        background-position: 200% 0;\r\n    }\r\n\r\n    100% {\r\n        background-position: -200% 0;\r\n    }\r\n}\r\n\r\n.spinner {\r\n    width: 24px;\r\n    height: 24px;\r\n    border: 2px solid var(--border);\r\n    border-top-color: var(--accent);\r\n    border-radius: 50%;\r\n    animation: spin 0.8s linear infinite;\r\n}\r\n\r\n@keyframes spin {\r\n    to {\r\n        transform: rotate(360deg);\r\n    }\r\n}\r\n\r\n/* ============================================\r\n   ANIMATIONS\r\n   ============================================ */\r\n@keyframes fadeIn {\r\n    from {\r\n        opacity: 0;\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n    }\r\n}\r\n\r\n@keyframes slideUp {\r\n    from {\r\n        opacity: 0;\r\n        transform: translateY(10px);\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n        transform: translateY(0);\r\n    }\r\n}\r\n\r\n@keyframes scaleIn {\r\n    from {\r\n        opacity: 0;\r\n        transform: scale(0.95);\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n        transform: scale(1);\r\n    }\r\n}\r\n\r\n.animate-fadeIn {\r\n    animation: fadeIn var(--transition-normal) ease;\r\n}\r\n\r\n.animate-slideUp {\r\n    animation: slideUp var(--transition-normal) ease;\r\n}\r\n\r\n.animate-scaleIn {\r\n    animation: scaleIn var(--transition-normal) ease;\r\n}\r\n\r\n/* ============================================\r\n   UTILITIES\r\n   ============================================ */\r\n.hidden {\r\n    display: none !important;\r\n}\r\n\r\n.sr-only {\r\n    position: absolute;\r\n    width: 1px;\r\n    height: 1px;\r\n    padding: 0;\r\n    margin: -1px;\r\n    overflow: hidden;\r\n    clip: rect(0, 0, 0, 0);\r\n    border: 0;\r\n}\r\n\r\n.truncate {\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n}\r\n\r\n.w-full {\r\n    width: 100%;\r\n}\r\n\r\n.h-full {\r\n    height: 100%;\r\n}\r\n\r\n.relative {\r\n    position: relative;\r\n}\r\n\r\n.absolute {\r\n    position: absolute;\r\n}\r\n\r\n.fixed {\r\n    position: fixed;\r\n}\r\n\r\n.inset-0 {\r\n    inset: 0;\r\n}\r\n\r\n/* ============================================\r\n   RESPONSIVE\r\n   ============================================ */\r\n@media (max-width: 768px) {\r\n    h1 {\r\n        font-size: 1.75rem;\r\n    }\r\n\r\n    h2 {\r\n        font-size: 1.5rem;\r\n    }\r\n\r\n    h3 {\r\n        font-size: 1.25rem;\r\n    }\r\n\r\n    .grid-auto {\r\n        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));\r\n    }\r\n\r\n    .hide-mobile {\r\n        display: none !important;\r\n    }\r\n}\r\n\r\n@media (min-width: 769px) {\r\n    .hide-desktop {\r\n        display: none !important;\r\n    }\r\n}\n</style>\r\n    <style>\n/* Topbar Styles - Clean & Dark */\r\n/* Note: Inter font is imported in main.css */\r\n\r\nbody {\r\n    margin: 0;\r\n    padding: 0;\r\n    background-color: var(--bg);\r\n    font-family: 'Inter', sans-serif;\r\n}\r\n\r\n#topbar-container {\r\n    position: fixed;\r\n    top: 11px;\r\n    left: 50%;\r\n    transform: translateX(-50%);\r\n    background-color: var(--surface);\r\n    border-radius: 9999px;\r\n    padding: 8px 14px;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 10px;\r\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);\r\n    z-index: 10000;\r\n    border: 1px solid var(--border);\r\n    height: 48px;\r\n    box-sizing: border-box;\r\n}\r\n\r\n#topbar-container::before {\r\n    content: '';\r\n    position: absolute;\r\n    top: -7px;\r\n    bottom: -7px;\r\n    left: -7px;\r\n    right: -7px;\r\n    z-index: -1;\r\n    border-radius: 9999px;\r\n}\r\n\r\n.logo-section {\r\n    display: flex;\r\n    align-items: center;\r\n    padding-right: 10px;\r\n    border-right: 1px solid var(--border);\r\n    height: 32px;\r\n    text-decoration: none;\r\n    color: inherit;\r\n}\r\n\r\n.logo-placeholder {\r\n    width: 28px;\r\n    height: 28px;\r\n    background-color: var(--surface-hover);\r\n    border-radius: 6px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    color: var(--text-muted);\r\n}\r\n\r\n.logo-placeholder i,\r\n.logo-placeholder svg {\r\n    width: 16px;\r\n    height: 16px;\r\n}\r\n\r\n.nav-buttons {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 4px;\r\n}\r\n\r\n.nav-separator {\r\n    width: 1px;\r\n    height: 20px;\r\n    background-color: var(--border);\r\n    margin: 0 6px;\r\n}\r\n\r\n.nav-btn {\r\n    background: transparent;\r\n    border: none;\r\n    color: var(--text-muted);\r\n    text-decoration: none;\r\n    display: flex;\r\n    align-items: center;\r\n    padding: 6px 10px;\r\n    border-radius: 99px;\r\n    height: 32px;\r\n    box-sizing: border-box;\r\n    transition: color 0.15s, background-color 0.15s;\r\n    position: relative;\r\n}\r\n\r\n.nav-badge-beta {\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n    font-size: 8px;\r\n    font-weight: 700;\r\n    color: var(--text);\r\n    background: var(--secondary);\r\n    padding: 2px 4px;\r\n    border-radius: 4px;\r\n    line-height: 1;\r\n    transform: translate(20%, -20%);\r\n    pointer-events: none;\r\n}\r\n\r\n.nav-btn:hover {\r\n    color: var(--text);\r\n    background-color: var(--surface-hover);\r\n}\r\n\r\n.nav-btn i,\r\n.nav-btn svg {\r\n    width: 18px;\r\n    height: 18px;\r\n    min-width: 18px;\r\n}\r\n\r\n.nav-btn span {\r\n    max-width: 0;\r\n    opacity: 0;\r\n    margin-left: 0;\r\n    overflow: hidden;\r\n    white-space: nowrap;\r\n    font-weight: 500;\r\n    font-size: 13px;\r\n    transition: max-width 0.23s ease, opacity 0.17s ease, margin-left 0.23s ease;\r\n}\r\n\r\n#topbar-container:hover .nav-btn span {\r\n    max-width: 70px;\r\n    opacity: 1;\r\n    margin-left: 8px;\r\n}\n</style>\r\n    <style>\n/* ============================================\r\n   SETTINGS PAGE\r\n   ============================================ */\r\n.settings-page {\r\n    min-height: 100vh;\r\n    padding: 80px 24px 40px;\r\n}\r\n\r\n.settings-container {\r\n    max-width: 900px;\r\n    margin: 0 auto;\r\n}\r\n\r\n.settings-header {\r\n    margin-bottom: 32px;\r\n}\r\n\r\n.settings-header h1 {\r\n    font-size: 1.75rem;\r\n    font-weight: 700;\r\n    margin-bottom: 8px;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 12px;\r\n}\r\n\r\n.settings-header p {\r\n    color: var(--text-muted);\r\n    font-size: 1rem;\r\n}\r\n\r\n.settings-nav {\r\n    display: flex;\r\n    gap: 8px;\r\n    margin-bottom: 24px;\r\n    flex-wrap: wrap;\r\n}\r\n\r\n.settings-tab {\r\n    padding: 10px 18px;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: 8px;\r\n    color: var(--text-muted);\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    cursor: pointer;\r\n    transition: all 0.15s;\r\n}\r\n\r\n.settings-tab:hover {\r\n    color: var(--text);\r\n    background: var(--surface-hover);\r\n}\r\n\r\n.settings-tab.active {\r\n    background: var(--text);\r\n    color: var(--bg);\r\n    border-color: var(--text);\r\n}\r\n\r\n.settings-panel {\r\n    display: none;\r\n}\r\n\r\n.settings-panel.active {\r\n    display: block;\r\n}\r\n\r\n.settings-section {\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: 12px;\r\n    padding: 24px;\r\n    margin-bottom: 20px;\r\n}\r\n\r\n.section-title {\r\n    font-size: 1rem;\r\n    font-weight: 600;\r\n    margin-bottom: 16px;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 10px;\r\n}\r\n\r\n.section-title i {\r\n    color: var(--text-muted);\r\n}\r\n\r\n.setting-row {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    gap: 20px;\r\n    padding: 14px 0;\r\n    border-bottom: 1px solid var(--border);\r\n}\r\n\r\n.setting-row:last-child {\r\n    border-bottom: none;\r\n}\r\n\r\n.setting-info {\r\n    flex: 1;\r\n}\r\n\r\n.setting-label {\r\n    font-size: 0.9375rem;\r\n    font-weight: 500;\r\n    margin-bottom: 2px;\r\n}\r\n\r\n.setting-desc {\r\n    font-size: 0.8125rem;\r\n    color: var(--text-muted);\r\n}\r\n\r\n.setting-select {\r\n    padding: 10px 32px 10px 14px;\r\n    background: var(--bg);\r\n    border: 1px solid var(--border);\r\n    border-radius: 8px;\r\n    color: var(--text);\r\n    font-size: 0.875rem;\r\n    cursor: pointer;\r\n    appearance: none;\r\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%2371717a' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E\");\r\n    background-repeat: no-repeat;\r\n    background-position: right 12px center;\r\n}\r\n\r\n.setting-select:focus {\r\n    outline: none;\r\n    border-color: var(--border-light);\r\n}\r\n\r\n.setting-input {\r\n    padding: 10px 14px;\r\n    background: var(--bg);\r\n    border: 1px solid var(--border);\r\n    border-radius: 8px;\r\n    color: var(--text);\r\n    font-size: 0.875rem;\r\n    width: 200px;\r\n}\r\n\r\n.setting-input:focus {\r\n    outline: none;\r\n    border-color: var(--border-light);\r\n}\r\n\r\n/* .toggle handled by main.css */\r\n\r\n.cloaks-grid {\r\n    display: grid;\r\n    grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));\r\n    gap: 10px;\r\n    margin-top: 16px;\r\n}\r\n\r\n.cloak-btn {\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    gap: 8px;\r\n    padding: 14px 10px;\r\n    background: var(--bg);\r\n    border: 1px solid var(--border);\r\n    border-radius: 10px;\r\n    color: var(--text-muted);\r\n    font-size: 0.8125rem;\r\n    text-align: center;\r\n    cursor: pointer;\r\n    transition: all 0.15s;\r\n}\r\n\r\n.cloak-btn:hover {\r\n    border-color: var(--border-light);\r\n    color: var(--text);\r\n    background: var(--surface-hover);\r\n}\r\n\r\n.cloak-btn.active {\r\n    border-color: var(--info);\r\n    color: var(--text);\r\n    background: rgba(59, 130, 246, 0.1);\r\n}\r\n\r\n.cloak-btn img {\r\n    width: 24px;\r\n    height: 24px;\r\n    border-radius: 4px;\r\n}\r\n\r\n.cloak-btn i {\r\n    font-size: 1.25rem;\r\n}\r\n\r\n.add-cloak-form {\r\n    display: none;\r\n    margin-top: 16px;\r\n    padding: 16px;\r\n    background: var(--bg);\r\n    border: 1px solid var(--border);\r\n    border-radius: 10px;\r\n}\r\n\r\n.add-cloak-form.show {\r\n    display: block;\r\n}\r\n\r\n.add-cloak-form input {\r\n    width: 100%;\r\n    margin-bottom: 10px;\r\n}\r\n\r\n.add-cloak-actions {\r\n    display: flex;\r\n    gap: 8px;\r\n    justify-content: flex-end;\r\n}\r\n\r\n.key-capture {\r\n    padding: 10px 16px;\r\n    background: var(--bg);\r\n    border: 1px solid var(--border);\r\n    border-radius: 8px;\r\n    color: var(--text);\r\n    font-size: 0.8125rem;\r\n    font-family: 'Consolas', monospace;\r\n    cursor: pointer;\r\n}\r\n\r\n.key-capture.capturing {\r\n    border-color: var(--info);\r\n    animation: pulse 1s infinite;\r\n}\r\n\r\n@keyframes pulse {\r\n\r\n    0%,\r\n    100% {\r\n        opacity: 1;\r\n    }\r\n\r\n    50% {\r\n        opacity: 0.7;\r\n    }\r\n}\r\n\r\n.presets-grid {\r\n    display: grid;\r\n    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));\r\n    gap: 10px;\r\n    margin-bottom: 20px;\r\n}\r\n\r\n/* .btn handled by main.css */\r\n\r\n/* Background Presets */\r\n.bg-preset-btn {\r\n    position: relative;\r\n    display: flex;\r\n    flex-direction: column;\r\n    background: var(--bg);\r\n    border: 1px solid var(--border);\r\n    border-radius: 12px;\r\n    overflow: hidden;\r\n    cursor: pointer;\r\n    transition: all 0.2s ease;\r\n    padding: 0;\r\n}\r\n\r\n.bg-preset-btn:hover {\r\n    transform: translateY(-2px);\r\n    border-color: var(--border-light);\r\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\r\n}\r\n\r\n.bg-preset-btn.active {\r\n    border-color: var(--info);\r\n    box-shadow: 0 0 0 2px var(--info);\r\n}\r\n\r\n.bg-preset-preview {\r\n    width: 100%;\r\n    aspect-ratio: 16/9;\r\n    background: var(--surface-hover);\r\n    overflow: hidden;\r\n}\r\n\r\n.bg-preset-name {\r\n    padding: 8px;\r\n    font-size: 0.75rem;\r\n    font-weight: 600;\r\n    color: var(--text-muted);\r\n    text-align: center;\r\n    width: 100%;\r\n}\r\n\r\n.bg-preset-btn.active .bg-preset-name {\r\n    color: var(--text);\r\n}\r\n\r\n.bg-preset-badge {\r\n    position: absolute;\r\n    top: 6px;\r\n    right: 6px;\r\n    width: 20px;\r\n    height: 20px;\r\n    background: rgba(0, 0, 0, 0.6);\r\n    backdrop-filter: blur(4px);\r\n    border-radius: 50%;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    color: #fff;\r\n    font-size: 0.625rem;\r\n    z-index: 1;\r\n}\r\n\r\n.bg-preset-delete {\r\n    position: absolute;\r\n    top: 6px;\r\n    left: 6px;\r\n    width: 24px;\r\n    height: 24px;\r\n    background: rgba(239, 68, 68, 0.8);\r\n    backdrop-filter: blur(4px);\r\n    border-radius: 6px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    color: #fff;\r\n    font-size: 0.75rem;\r\n    z-index: 2;\r\n    opacity: 0;\r\n    transition: all 0.2s;\r\n    cursor: pointer;\r\n}\r\n\r\n.bg-preset-btn:hover .bg-preset-delete {\r\n    opacity: 1;\r\n}\r\n\r\n.bg-preset-delete:hover {\r\n    background: #ef4444;\r\n    transform: scale(1.1);\r\n}\n</style>\r\n    <style>\n/**\r\n * PHANTOM - BACKGROUND STYLES\r\n */\r\n.phantom-background {\r\n    position: fixed;\r\n    inset: 0;\r\n    width: 100vw;\r\n    height: 100vh;\r\n    z-index: -1;\r\n    overflow: hidden;\r\n    background: transparent;\r\n    pointer-events: none;\r\n    opacity: 1;\r\n    transition: background-color 0.3s ease;\r\n}\r\n\r\n.phantom-background.active {\r\n    opacity: 1;\r\n}\r\n\r\n.phantom-background-overlay {\r\n    position: absolute;\r\n    inset: 0;\r\n    z-index: 2;\r\n    background: rgba(0, 0, 0, var(--bg-overlay, 0.4));\r\n    transition: background-color 0.3s ease;\r\n}\r\n\r\n.phantom-background-layer {\r\n    position: absolute;\r\n    inset: 0;\r\n    z-index: 1;\r\n    transition: opacity 0.3s ease-in-out;\r\n}\r\n\r\n.phantom-background-media {\r\n    width: 100%;\r\n    height: 100%;\r\n    object-fit: cover;\r\n    object-position: var(--bg-image-position, center);\r\n    display: block;\r\n    border: none;\r\n}\r\n\r\n/* Video and Iframe positioning for full background cover */\r\n.phantom-background-layer video.phantom-background-media,\r\n.phantom-background-layer iframe.phantom-background-media {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    transform: none;\r\n    pointer-events: none;\r\n    min-width: 100%;\r\n    min-height: 100%;\r\n    max-width: none;\r\n    max-height: none;\r\n    object-position: var(--bg-image-position, center);\r\n}\r\n\r\n/* Ensure iframes cover entire background */\r\n.phantom-background-layer iframe.phantom-background-media {\r\n    border: none;\r\n    object-fit: cover;\r\n}\r\n\r\n/* Ensure content on top remains readable */\r\nhtml {\r\n    background-color: var(--bg);\r\n}\r\n\r\nbody {\r\n    position: relative;\r\n    z-index: 0;\r\n    background: transparent !important;\r\n    /* Allow background to show through */\r\n}\r\n\r\n/* Specific adjustments for transparency if needed */\r\n.main-content,\r\n.home-page {\r\n    background: transparent !important;\r\n}\r\n\r\n/* Glassmorphism for containers when background is active */\r\n.phantom-background.active~.offline-banner,\r\n.phantom-background.active~.home-page .card,\r\n.phantom-background.active~.home-page .featured-card,\r\n.phantom-background.active~.home-page .search-bar,\r\n.phantom-background.active~.settings-panel {\r\n    backdrop-filter: blur(10px);\r\n    -webkit-backdrop-filter: blur(10px);\r\n    background: rgba(15, 15, 15, 0.7) !important;\r\n}\n</style>\r\n    <script>\n// site config\r\n\r\nwindow.SITE_CONFIG = {\r\n    name: \"Phantom\",\r\n    fullName: \"Phantom Unblocked\",\r\n    version: \"1.0.12\",\r\n\r\n    changelog: [\r\n        \"1.0.12: tiny fixxes and changes\",\r\n        \"some code consolidation and fixxes\",\r\n        \"suggest features in the discord server\"\r\n    ],\r\n\r\n    // quotes\r\n    quotes: [\r\n        \"lebron lebron lebronn james\",\r\n        \"so tuff\",\r\n        \"it is what it is\",\r\n        \"do ur work\",\r\n        \"this is what happens when u dont touch grass\",\r\n        \"FULL BOX\",\r\n        \"FULL PIECE\",\r\n        \"200!\",\r\n        \"press esc + refresh + power button for hacks\",\r\n        \"press ctrl+x to hide your screen\",\r\n        \"change the tab title and favicon in settings\",\r\n        \"TEACHERR!\",\r\n        \"1 pump\",\r\n        \"303 headshot\",\r\n        \"bros prolly a 60 ovr\",\r\n        \"take the L lil bro\",  \r\n        \"lebron is OUR goat\",\r\n        \"stop looking at my screen\",\r\n    ],\r\n\r\n    // todo\r\n    // *** for strikethrough\r\n    // ** for bold\r\n    todos: [\r\n        \"***fixxed aboutblank opening while securly is on (previously if popups were off it would load intab instead of clickto launch now it will use clicktolaunch unless popups are blocked)***\",\r\n        \"***fix the proxy***\",\r\n        \"***fix panic panickey, add quote talking about it***\",\r\n        \"***fix theatermode, make it hide buttons after a few seconds and ensure all content is being displayed and move the description to the bottom***\",\r\n        \"***change back player to use old styling, change the surface to use background colors for the bottom part where description is shown, looking just like the background***\",\r\n        \"***add image and video support for backgrounds***\",\r\n        \"***fix aichat, make the title use the same ai request as the users question unless its in image mode where it will use text mode and fix ai chat to remember modes better***\",\r\n        \"***add cloaking to quotes***\",\r\n        \"***add a default cloak and fix it so icons work in aboutblank for whatever reason they only work when you go to settings in aboutblank where it correctly applies***\",\r\n        \"***for search suggestions add highlighting for whatever will happen when you click enter, in search suggestions fix all games not sending you to the games page***\",\r\n        \"***fix games to make multi library the default, put it in config.js***\",\r\n        \"***rename movies shortcut in index2.html to primeshows, add shortcuts to main pages in the topbar and change the current shortcuts to more popular games***\",\r\n        \"***make announcements show even on first visit unlike changelog and allow disabling it via settings***\",\r\n        \"***fix leave comformation asking u to leave each time you click something***\",\r\n        \"***change the shortcuts on the main page to include pages***\",\r\n        \"***add movies to the search bar in main page***\",\r\n        \"***fix background not turning off soon***\",\r\n        \"***fix music page to hide youtube player unless toggled via 3 dot small button, and always shown on proxy mode, fix all the controls for video time, volume***\",\r\n        \"**add singlefile this is lowk so hard i dont really understand it**\",\r\n        \"**advertise phantom (too much work tbh)**\",\r\n        \"**add a watch page for youtube and twitch**\",\r\n        \"**add a miniplayer for music**\",\r\n        \"***shorten some page's code***\",\r\n        \"***fix paths in search autocomplete***\",\r\n        \"***fix markdown in ai not using correct text colors***\",\r\n        \"***make backgrounds show in the loading screen***\",\r\n        \"***fix icons for topbar in code.html***\",\r\n        \"**fix wisp server not notifying or autoswitiching when offline in proxy**\",\r\n        \"***fix code runner open not working at all***\",\r\n        \"***make backgrounds show in player.html***\",\r\n        \"***make backgrounds show in staticsjv2***\",\r\n        \"***make player.html player controls use theme colros not hardcoded***\",\r\n        \"***make ai chat and music sidebar go all the way down and up with borders***\",\r\n        \"**make the only song in music be lebron lebron lebron james**\",\r\n        \"**fix music controls**\",\r\n        \"***finish extra page into credits and make this todo be tucked away somewhere and not the main part of it***\"\r\n    ],\r\n    defaultWisp: \"wss://glseries.net/wisp/\",\r\n    wispServers: [\r\n        { name: \"GLSeries Wisp\", url: \"wss://glseries.net/wisp/\" },\r\n        { name: \"Rhw's Wisp\", url: \"wss://wisp.rhw.one/\" },\r\n    ],\r\n\r\n    discord: {\r\n        inviteUrl: \"https://discord.gg/tHWx9NXp5p\",\r\n        widgetServer: \"1447673724017971324\",\r\n        widgetChannel: \"1447673726228496617\",\r\n    },\r\n\r\n    firstVisitCloak: false, //fake error page\r\n    defaults: {\r\n        cloakMode: \"about:blank\",\r\n        tabTitle: \"You've already responded\",\r\n        tabFavicon: \"https://ssl.gstatic.com/docs/spreadsheets/forms/forms_icon_2023q4.ico\",\r\n        cloakRotation: false,\r\n        cloakInterval: 5000,\r\n        panicKey: \"x\",\r\n        panicModifiers: [\"ctrl\", \"shift\"],\r\n        panicUrl: \"https://classroom.google.com\",\r\n        maxMovieRating: \"R\",\r\n        gameLibrary: \"multi\",\r\n        discordWidget: true,\r\n        miniplayer: true,\r\n        leaveConfirmation: false,\r\n        showChangelogOnUpdate: true,\r\n        themeRotation: true,\r\n        lastThemeRotation: 0,\r\n        backgroundRotation: true,\r\n        lastBackgroundRotation: 0,\r\n        lastSeenFeatured: 'none',\r\n        background: { type: 'color', value: '#0a0a0a' },\r\n        customBackground: { id: 'none', type: 'none' },\r\n        accentColor: '#ffffff',\r\n        surfaceColor: '#0f0f0f',\r\n        secondaryColor: '#2e2e33',\r\n        textColor: '#e4e4e7',\r\n    },\r\n\r\n    themePresets: {\r\n        dark: { name: 'Dark (Default)', bg: { type: 'color', value: '#0a0a0a' }, surface: '#0f0f0f', surfaceHover: '#1a1a1a', surfaceActive: '#252525', secondary: '#2e2e33', border: '#2a2a2a', borderLight: '#2a2a2a', text: '#e4e4e7', textSec: '#71717a', textDim: '#52525b', accent: '#ffffff' },\r\n        midnight: { name: 'Midnight', bg: { type: 'color', value: '#000000' }, surface: '#050505', surfaceHover: '#111111', surfaceActive: '#1a1a1a', secondary: '#111111', border: '#1a1a1a', borderLight: '#111111', text: '#ededed', textSec: '#a3a3a3', textDim: '#737373', accent: '#d4d4d4' },\r\n        abyss: { name: 'Abyss', bg: { type: 'color', value: '#020617' }, surface: '#0f172a', surfaceHover: '#1e293b', surfaceActive: '#334155', secondary: '#1e293b', border: '#1e293b', borderLight: '#1e293b', text: '#f1f5f9', textSec: '#94a3b8', textDim: '#64748b', accent: '#38bdf8' },\r\n        phantom: { name: 'Phantom', bg: { type: 'color', value: '#0f0a14' }, surface: '#1a0f24', surfaceHover: '#2e1a40', surfaceActive: '#4c2a5c', secondary: '#2e1a40', border: '#2e1a40', borderLight: '#2e1a40', text: '#f3e8ff', textSec: '#d8b4fe', textDim: '#c084fc', accent: '#c084fc' },\r\n        rosepine: { name: 'Rose Pine', bg: { type: 'color', value: '#191724' }, surface: '#1f1d2e', surfaceHover: '#26233a', surfaceActive: '#524f67', secondary: '#26233a', border: '#26233a', borderLight: '#1f1d2e', text: '#e0def4', textSec: '#908caa', textDim: '#6e6a86', accent: '#ebbcba' },\r\n        ocean: { name: 'Oceanic', bg: { type: 'color', value: '#011627' }, surface: '#0b2942', surfaceHover: '#1d3b53', surfaceActive: '#2d4b63', secondary: '#0b2942', border: '#1d3b53', borderLight: '#0b2942', text: '#d6deeb', textSec: '#5f7e97', textDim: '#011627', accent: '#7fdbca' },\r\n        forest: { name: 'Forest', bg: { type: 'color', value: '#020d06' }, surface: '#051a0d', surfaceHover: '#0a2e17', surfaceActive: '#0f4221', secondary: '#051a0d', border: '#0a2e17', borderLight: '#051a0d', text: '#ecfdf5', textSec: '#6ee7b7', textDim: '#064e3b', accent: '#10b981' },\r\n        crimson: { name: 'Crimson', bg: { type: 'color', value: '#1a0505' }, surface: '#230a0a', surfaceHover: '#7b0a0aff', surfaceActive: '#7f1d1d', secondary: '#230a0a', border: '#480f0fff', borderLight: '#230a0a', text: '#fef2f2', textSec: '#fecaca', textDim: '#450a0a', accent: '#ef4444' },\r\n        flame: { name: 'Flame', bg: { type: 'color', value: '#0c0202' }, surface: '#1c0a0a', surfaceHover: '#451a03', surfaceActive: '#9a3412', secondary: '#1c0a0a', border: '#451a03', borderLight: '#9a3412', text: '#fff7ed', textSec: '#fdba74', textDim: '#ea580c', accent: '#f59e0b' }\r\n    },\r\n\r\n    backgroundPresets: [\r\n        { id: 'none', name: 'None (Theme Default)', type: 'none' },\r\n        { id: 'Night sky', name: 'Night sky', type: 'image', url: 'https://images.pexels.com/photos/5675745/pexels-photo-5675745.jpeg', overlay: 0.3 },\r\n        { id: 'winter-mountains', name: 'Winter mountains', type: 'image', url: 'https://images.pexels.com/photos/1287145/pexels-photo-1287145.jpeg', overlay: 0.3 },\r\n        { id: 'f1 car', name: 'F1 Car', type: 'image', url: 'https://images.pexels.com/photos/14401632/pexels-photo-14401632.jpeg', overlay: 0.3 },\r\n        { id: 'moon-landing', name: 'Moon Landing', type: 'image', url: 'https://images.pexels.com/photos/41162/moon-landing-apollo-11-nasa-buzz-aldrin-41162.jpeg', overlay: 0.3, objectPosition: 'top left', active: true },\r\n        { id: 'turtle', name: 'Turtle', type: 'image', url: 'https://images.unsplash.com/photo-1501791187590-9ef2612ba1eb?q=80&w=1932&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D', overlay: 0.3 },\r\n        { id: 'road', name: 'Road', type: 'image', url: 'https://images.unsplash.com/photo-1508233620467-f79f1e317a05', overlay: 0.3 },\r\n        { id: 'railroad', name: 'Railroad', type: 'image', url: 'https://images.unsplash.com/photo-1505832018823-50331d70d237', overlay: 0.3 },\r\n        { id: 'mountain', name: 'Mountain', type: 'image', url: 'https://raw.githubusercontent.com/evanhnry/brave-wallpapers/refs/heads/main/Brave/clay-banks-u27Rrbs9Dwc-unsplash.jpg', overlay: 0.3 },\r\n    ],\r\n\r\n    cloakPresets: [\r\n        { name: \"Phantom\", icon: \"/favicon.svg\", title: \"Phantom Unblocked\" },\r\n        { name: \"Edpuzzle\", icon: \"https://edpuzzle.imgix.net/favicons/favicon-32.png\", title: \"Edpuzzle\" },\r\n        { name: \"Google Docs\", icon: \"https://ssl.gstatic.com/docs/documents/images/kix-favicon7.ico\", title: \"Untitled document - Google Docs\" },\r\n        { name: \"Canvas\", icon: \"https://du11hjcvx0uqb.cloudfront.net/dist/images/favicon-e10d657a73.ico\", title: \"Dashboard\" },\r\n        { name: \"Desmos\", icon: \"https://www.desmos.com/favicon.ico\", title: \"Desmos | Graphing Calculator\" },\r\n        { name: \"Khan Academy\", icon: \"https://cdn.kastatic.org/images/favicon.ico\", title: \"Khan Academy\" },\r\n        { name: \"Wikipedia\", icon: \"https://en.wikipedia.org/favicon.ico\", title: \"World War II - Wikipedia\" },\r\n        { name: \"Classroom\", icon: \"https://ssl.gstatic.com/classroom/favicon.png\", title: \"Home - Classroom\" },\r\n        { name: \"Canva\", icon: \"https://static.canva.com/static/images/android-192x192-2.png\", title: \"Home - Canva\" },\r\n        { name: \"Quiz\", icon: \"https://ssl.gstatic.com/docs/spreadsheets/forms/forms_icon_2023q4.ico\", title: \"You've already responded\" },\r\n        { name: \"Blooket\", icon: \"https://play.blooket.com/favicon.ico\", title: \"Play Blooket | Blooket\" },\r\n        { name: \"Gmail\", icon: \"https://ssl.gstatic.com/ui/v1/icons/mail/rfr/gmail.ico\", title: \"Gmail\" },\r\n        { name: \"YouTube\", icon: \"https://www.youtube.com/favicon.ico\", title: \"YouTube\" },\r\n        { name: \"Powerschool\", icon: \"https://waverlyk12.powerschool.com/favicon.ico\", title: \"Grades and Attendance\" },\r\n        { name: \"nothing\", icon: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=\", title: \"\\u200B\" },\r\n    ]\r\n}\r\n\r\n\r\n\n</script>\r\n    <script>\n(function () {\r\n    const style = document.createElement('style');\r\n    style.textContent = `\r\n        .notify-container { position: fixed; top: 16px; right: 16px; z-index: 99999; display: flex; flex-direction: column; gap: 8px; pointer-events: none; font-family: 'Inter', sans-serif; }\r\n        .notify-toast { display: flex; align-items: center; gap: 12px; padding: 12px 16px; background: rgba(15, 15, 15, 0.9); backdrop-filter: blur(10px); border: 1px solid var(--border, #1f1f1f); border-radius: 10px; color: #e4e4e7; font-size: 13px; min-width: 280px; max-width: 380px; box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4); pointer-events: auto; transform: translateX(120%); opacity: 0; transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1), opacity 0.3s ease; position: relative; overflow: hidden; }\r\n        .notify-toast.show { transform: translateX(0); opacity: 1; }\r\n        .notify-toast.hiding { transform: translateX(120%); opacity: 0; }\r\n        .notify-icon { width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }\r\n        .notify-icon svg { width: 18px; height: 18px; }\r\n        .notify-content { flex: 1; line-height: 1.4; }\r\n        .notify-title { font-weight: 600; margin-bottom: 2px; }\r\n        .notify-message { color: #a1a1aa; font-size: 12px; }\r\n        .notify-close { background: none; border: none; color: #52525b; cursor: pointer; padding: 4px; border-radius: 4px; display: flex; align-items: center; justify-content: center; }\r\n        .notify-close:hover { background: rgba(255,255,255,0.1); color: #fff; }\r\n        .notify-close svg { width: 14px; height: 14px; }\r\n        .notify-toast.success { border-left: 3px solid #22c55e; } .notify-toast.success .notify-icon { color: #22c55e; }\r\n        .notify-toast.error { border-left: 3px solid #ef4444; } .notify-toast.error .notify-icon { color: #ef4444; }\r\n        .notify-toast.warning { border-left: 3px solid #f59e0b; } .notify-toast.warning .notify-icon { color: #f59e0b; }\r\n        .notify-toast.info { border-left: 3px solid #3b82f6; } .notify-toast.info .notify-icon { color: #3b82f6; }\r\n        .notify-progress { position: absolute; bottom: 0; left: 0; height: 2px; background: rgba(255, 255, 255, 0.2); transition: width linear; }\r\n    `;\r\n    document.head.appendChild(style);\r\n\r\n    let container = null;\r\n    const getContainer = () => container || (container = document.body.appendChild(Object.assign(document.createElement('div'), { className: 'notify-container' })));\r\n\r\n    const icons = {\r\n        success: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"20 6 9 17 4 12\"></polyline></svg>`,\r\n        error: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"15\" y1=\"9\" x2=\"9\" y2=\"15\"></line><line x1=\"9\" y1=\"9\" x2=\"15\" y2=\"15\"></line></svg>`,\r\n        warning: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\"></path><line x1=\"12\" y1=\"9\" x2=\"12\" y2=\"13\"></line><line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\"></line></svg>`,\r\n        info: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"12\" y1=\"16\" x2=\"12\" y2=\"12\"></line><line x1=\"12\" y1=\"8\" x2=\"12.01\" y2=\"8\"></line></svg>`,\r\n        close: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line><line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line></svg>`\r\n    };\r\n\r\n    function notify(type, title, msg = '', dur = 4000) {\r\n        const t = document.createElement('div');\r\n        t.className = `notify-toast ${type}`;\r\n        t.innerHTML = `<div class=\"notify-icon\">${icons[type]}</div><div class=\"notify-content\"><div class=\"notify-title\">${title}</div><div class=\"notify-message\">${msg}</div></div><button class=\"notify-close\">${icons.close}</button><div class=\"notify-progress\"></div>`;\r\n        const p = t.querySelector('.notify-progress');\r\n        const dismiss = () => { t.classList.add('hiding'); setTimeout(() => t.remove(), 300); };\r\n        t.querySelector('.notify-close').onclick = dismiss;\r\n        p.style.width = '100%';\r\n        setTimeout(() => { p.style.transition = `width ${dur}ms linear`; p.style.width = '0%'; }, 50);\r\n        let timer = setTimeout(dismiss, dur);\r\n        t.onmouseenter = () => { clearTimeout(timer); p.style.transition = 'none'; };\r\n        t.onmouseleave = () => {\r\n            const rem = (parseFloat(getComputedStyle(p).width) / t.offsetWidth) * dur;\r\n            p.style.transition = `width ${rem}ms linear`; p.style.width = '0%';\r\n            timer = setTimeout(dismiss, rem);\r\n        };\r\n        getContainer().appendChild(t);\r\n        requestAnimationFrame(() => t.classList.add('show'));\r\n    }\r\n\r\n    window.Notify = {\r\n        success: (a, b, c) => notify('success', a, b, c),\r\n        error: (a, b, c) => notify('error', a, b, c),\r\n        warning: (a, b, c) => notify('warning', a, b, c),\r\n        info: (a, b, c) => notify('info', a, b, c)\r\n    };\r\n})();\r\n\n</script>\r\n    <script>\n// stealth mode\r\n(function () {\r\n    'use strict';\r\n\r\n    let rotationInterval = null;\r\n    let currentPresetIndex = 0;\r\n    const original = { title: document.title, favicon: document.querySelector('link[rel=\"icon\"]')?.href };\r\n\r\n    const getPresets = () => [...(window.SITE_CONFIG?.cloakPresets || []), ...(window.Settings?.get('customCloaks') || [])];\r\n\r\n    const setTitle = (title) => {\r\n        if (!title) return;\r\n        document.title = title;\r\n        try { if (window.top !== window.self) window.top.document.title = title; } catch { }\r\n    };\r\n\r\n    const setFavicon = (href) => {\r\n        if (!href) return;\r\n        [document, window.top?.document].filter(d => { try { return d; } catch { return false; } }).forEach(doc => {\r\n            doc.querySelectorAll('link[rel*=\"icon\"]').forEach(l => l.remove());\r\n            const link = doc.createElement('link');\r\n            link.rel = 'icon';\r\n            link.href = href;\r\n            doc.head.appendChild(link);\r\n        });\r\n    };\r\n\r\n    const apply = (p) => {\r\n        if (p) {\r\n            setTitle(p.title);\r\n            setFavicon(p.icon || p.favicon);\r\n        } else {\r\n            const s = window.Settings?.getAll() || {};\r\n            setTitle(s.tabTitle || window.SITE_CONFIG?.defaults?.tabTitle);\r\n            setFavicon(s.tabFavicon || window.SITE_CONFIG?.defaults?.tabFavicon);\r\n        }\r\n    };\r\n\r\n    const startRotation = (ms) => {\r\n        stopRotation();\r\n        const presets = getPresets();\r\n        if (presets.length < 2) return apply(presets[0]);\r\n        rotationInterval = setInterval(() => {\r\n            currentPresetIndex = (currentPresetIndex + 1) % presets.length;\r\n            apply(presets[currentPresetIndex]);\r\n        }, ms);\r\n    };\r\n\r\n    const stopRotation = () => { if (rotationInterval) { clearInterval(rotationInterval); rotationInterval = null; } };\r\n\r\n    const redirectOriginal = () => {\r\n        const targets = [\"https://classroom.google.com\", \"https://drive.google.com\", \"https://google.com\", \"https://kahoot.it\", \"https://edpuzzle.com\"];\r\n        window.location.replace(targets[Math.floor(Math.random() * targets.length)]);\r\n    };\r\n\r\n    const getPopupContent = (url) => {\r\n        const s = window.Settings?.getAll() || {};\r\n        const title = s.tabTitle || window.SITE_CONFIG?.defaults?.tabTitle || 'Google';\r\n        const icon = s.tabFavicon || window.SITE_CONFIG?.defaults?.tabFavicon || 'https://www.google.com/favicon.ico';\r\n        return `<!DOCTYPE html><html><head><title>${title}</title><link rel=\"icon\" href=\"${icon}\"><style>* {margin:0;padding:0;height:100%;overflow:hidden;} iframe{width:100%;height:100%;border:none;}</style></head><body><iframe src=\"${url}\"></iframe></body></html>`;\r\n    };\r\n\r\n    // Try to open popup and monitor if it survives for 500ms\r\n    // Returns: { success: true } if popup works and stays open\r\n    // Returns: { success: false, reason: 'blocked' } if window.open returned null\r\n    // Returns: { success: false, reason: 'killed' } if popup was closed by extension (like Securly)\r\n    const tryPopup = (url) => {\r\n        return new Promise((resolve) => {\r\n            const win = window.open('about:blank', '_blank');\r\n\r\n            // Popup completely blocked by browser\r\n            if (!win) {\r\n                resolve({ success: false, reason: 'blocked' });\r\n                return;\r\n            }\r\n\r\n            // Write the actual content to popup\r\n            try {\r\n                win.document.write(getPopupContent(url));\r\n                win.document.close();\r\n            } catch (e) {\r\n                try { win.close(); } catch { }\r\n                resolve({ success: false, reason: 'killed' });\r\n                return;\r\n            }\r\n\r\n            // Use a single timeout to avoid background throttling (which causes a 5s delay).\r\n            // When the original tab loses focus, browsers throttle timers to ~1s minimum.\r\n            // If the timer runs, we check once and redirect immediately.\r\n            const timeoutMs = 200;\r\n\r\n            setTimeout(() => {\r\n                if (win.closed) {\r\n                    resolve({ success: false, reason: 'killed' });\r\n                } else {\r\n                    resolve({ success: true });\r\n                    redirectOriginal(); // Instant redirect\r\n                }\r\n            }, timeoutMs);\r\n        });\r\n    };\r\n\r\n    // Load content in-tab (fallback)\r\n    const loadInTab = () => {\r\n        const iframe = document.getElementById('main-frame');\r\n        if (iframe && !iframe.src) iframe.src = 'index2.html';\r\n        apply();\r\n    };\r\n\r\n    // Show launch screen with callback for when button is clicked\r\n    const showLaunchScreen = (onLaunch) => {\r\n        const ls = document.getElementById('launch-screen');\r\n        if (ls) {\r\n            ls.classList.remove('hidden');\r\n            document.getElementById('launch-button').onclick = onLaunch;\r\n        }\r\n    };\r\n\r\n    // Attempt popup with fallback:\r\n    // 1. Try real popup -> if works (survives 500ms), redirect original tab\r\n    // 2. If blocked (null) -> show click-to-launch (user gesture might help)\r\n    // 3. If killed (closed by Securly) -> load in-tab directly\r\n    // 4. If click-to-launch popup also fails -> load in-tab\r\n    const attemptCloakedLaunch = async (url, hideOverlay = null) => {\r\n        const result = await tryPopup(url);\r\n\r\n        if (result.success) {\r\n            // Popup worked and is still open! redirectOriginal() was already called\r\n            return true;\r\n        }\r\n\r\n        if (result.reason === 'blocked') {\r\n            // Popup was blocked (window.open returned null)\r\n            // Show click-to-launch - user gesture might bypass popup blocker\r\n            if (hideOverlay) hideOverlay();\r\n\r\n            showLaunchScreen(async () => {\r\n                document.getElementById('launch-screen').classList.add('hidden');\r\n\r\n                // Try popup again with user gesture\r\n                const retryResult = await tryPopup(url);\r\n                if (!retryResult.success) {\r\n                    // Even with user click, popup failed - load in-tab\r\n                    loadInTab();\r\n                }\r\n                // If success, redirectOriginal() was called inside tryPopup\r\n            });\r\n            return true; // Handled (showing launch screen)\r\n        }\r\n\r\n        // reason === 'killed' - Securly/extension killed the popup, go straight to in-tab\r\n        if (hideOverlay) hideOverlay();\r\n        loadInTab();\r\n        return false;\r\n    };\r\n\r\n    const init = async () => {\r\n        const s = window.Settings?.getAll() || {};\r\n        const fvKey = 'phantom_fv';\r\n        const urlParams = new URLSearchParams(window.location.search);\r\n\r\n        // Handle fake mode (legacy)\r\n        if (urlParams.has('fake')) {\r\n            showLaunchScreen(async () => {\r\n                document.getElementById('launch-screen').classList.add('hidden');\r\n                if (s.cloakMode === 'about:blank') {\r\n                    const result = await tryPopup(window.location.href.split('?')[0]);\r\n                    if (result.success) return; // redirectOriginal was called\r\n                }\r\n                loadInTab();\r\n            });\r\n            return;\r\n        }\r\n\r\n        // Handle first visit cloak (fake error page)\r\n        if (window.SITE_CONFIG?.firstVisitCloak && !localStorage.getItem(fvKey)) {\r\n            const overlay = document.getElementById('fv-cloak');\r\n            if (overlay) {\r\n                overlay.style.display = 'block';\r\n                document.title = window.location.hostname;\r\n                document.querySelectorAll(\"link[rel*='icon']\").forEach(l => l.remove());\r\n                const link = document.createElement('link');\r\n                link.rel = 'icon';\r\n                link.href = 'data:,';\r\n                document.head.appendChild(link);\r\n\r\n                const onKey = async (e) => {\r\n                    if (e.key.toLowerCase() === 'c') {\r\n                        localStorage.setItem(fvKey, '1');\r\n                        document.removeEventListener('keydown', onKey);\r\n\r\n                        if (s.cloakMode === 'about:blank') {\r\n                            await attemptCloakedLaunch(window.location.href, () => {\r\n                                overlay.style.display = 'none';\r\n                            });\r\n                        } else {\r\n                            overlay.style.display = 'none';\r\n                            apply();\r\n                            loadInTab();\r\n                        }\r\n                    }\r\n                };\r\n                document.addEventListener('keydown', onKey);\r\n            }\r\n            return;\r\n        }\r\n\r\n        // Normal visit - not first time, no fake mode\r\n        if (window.top === window.self && s.cloakMode === 'about:blank') {\r\n            await attemptCloakedLaunch(window.location.href);\r\n            return;\r\n        }\r\n\r\n        loadInTab();\r\n        if (s.rotateCloaks) startRotation((s.rotateInterval || 5) * 1000);\r\n    };\r\n\r\n    window.Cloaking = { init, apply, startRotation, stopRotation, tryPopup, loadInTab };\r\n\r\n    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', () => setTimeout(init, 100));\r\n    else setTimeout(init, 100);\r\n\r\n    window.addEventListener('settings-changed', (e) => {\r\n        apply();\r\n        if (e.detail.rotateCloaks) startRotation((e.detail.rotateInterval || 5) * 1000);\r\n        else stopRotation();\r\n    });\r\n})();\r\n\n</script>\r\n    <script>\n// settings handler\r\n(function () {\r\n    'use strict';\r\n\r\n    const STORAGE_KEY = 'void_settings';\r\n\r\n    const getDefaults = () => {\r\n        return window.SITE_CONFIG?.defaults || {\r\n            cloakMode: 'none',\r\n            cloakRotation: false,\r\n            cloakInterval: 5000,\r\n            panicKey: 'x',\r\n            panicModifiers: ['ctrl', 'shift'],\r\n            panicUrl: 'https://classroom.google.com',\r\n            maxMovieRating: 'R',\r\n            offlineGames: [],\r\n            gameLibrary: 'multi',\r\n            leaveConfirmation: false\r\n        };\r\n    };\r\n\r\n    const load = () => {\r\n        try {\r\n            const stored = localStorage.getItem(STORAGE_KEY);\r\n            if (stored) {\r\n                return { ...getDefaults(), ...JSON.parse(stored) };\r\n            }\r\n        } catch (e) {\r\n            console.warn('Failed to load settings:', e);\r\n        }\r\n        return getDefaults();\r\n    };\r\n\r\n    const save = (settings) => {\r\n        try {\r\n            localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n            window.dispatchEvent(new CustomEvent('settings-changed', { detail: settings }));\r\n            if (window.parent !== window) {\r\n                window.parent.postMessage({ type: 'settings-update' }, '*');\r\n            }\r\n        } catch (e) {\r\n            console.warn('Failed to save settings:', e);\r\n        }\r\n    };\r\n\r\n    let _settings = load();\r\n\r\n    window.Settings = {\r\n        get(key) { return _settings[key]; },\r\n\r\n        getAll() { return { ..._settings }; },\r\n\r\n        set(key, value) {\r\n            _settings[key] = value;\r\n            save(_settings);\r\n            this.apply();\r\n            return value;\r\n        },\r\n\r\n        update(partial) {\r\n            _settings = { ..._settings, ...partial };\r\n            save(_settings);\r\n            this.apply();\r\n        },\r\n\r\n        reset() {\r\n            _settings = getDefaults();\r\n            save(_settings);\r\n            this.apply();\r\n        },\r\n\r\n        apply() {\r\n            const root = document.documentElement;\r\n            const s = _settings;\r\n            const d = window.SITE_CONFIG?.defaults || {};\r\n\r\n            const vars = {\r\n                '--accent': s.accentColor || d.accentColor || '#ffffff',\r\n                '--surface': s.surfaceColor || d.surfaceColor || '#0f0f0f',\r\n                '--surface-hover': s.surfaceHoverColor || d.surfaceHoverColor || '#1a1a1a',\r\n                '--surface-active': s.surfaceActiveColor || d.surfaceActiveColor || '#252525',\r\n                '--secondary': s.secondaryColor || d.secondaryColor || '#2e2e33',\r\n                '--border': s.borderColor || d.borderColor || '#1f1f1f',\r\n                '--border-light': s.borderLightColor || d.borderLightColor || '#2a2a2a',\r\n                '--text': s.textColor || d.textColor || '#e4e4e7',\r\n                '--text-muted': s.textSecondaryColor || d.textSecondaryColor || '#71717a',\r\n                '--text-dim': s.textDimColor || d.textDimColor || '#52525b',\r\n                '--toggle': s.toggleColor || d.toggleColor,\r\n                '--toggle-knob': s.toggleKnobColor || d.toggleKnobColor\r\n            };\r\n\r\n            Object.entries(vars).forEach(([key, val]) => {\r\n                if (val) root.style.setProperty(key, val);\r\n            });\r\n\r\n            const themeBg = s.background || d.background || { type: 'color', value: '#0a0a0a' };\r\n            const customBg = s.customBackground;\r\n            const isCustomActive = customBg && customBg.type !== 'none';\r\n\r\n            if (themeBg.type === 'color') {\r\n                root.style.setProperty('--bg', themeBg.value);\r\n            }\r\n\r\n            if (isCustomActive && customBg.url) {\r\n                root.style.setProperty('--bg-image', `url(${customBg.url})`);\r\n\r\n                let position = customBg.objectPosition;\r\n                if (customBg.id && customBg.id !== 'custom') {\r\n                    const preset = window.SITE_CONFIG?.backgroundPresets?.find(b => b.id === customBg.id);\r\n                    if (preset?.objectPosition) position = preset.objectPosition;\r\n                }\r\n\r\n                root.style.setProperty('--bg-image-position', position || 'center');\r\n            } else if (themeBg.type === 'image' || themeBg.type === 'video') {\r\n                root.style.setProperty('--bg-image', `url(${themeBg.value || themeBg.url})`);\r\n                root.style.setProperty('--bg-image-position', themeBg.objectPosition || 'center');\r\n            } else if (themeBg.type === 'gradient') {\r\n                root.style.setProperty('--bg-image', themeBg.value || themeBg.url);\r\n                root.style.setProperty('--bg-image-position', 'center');\r\n            } else {\r\n                root.style.setProperty('--bg-image', 'none');\r\n            }\r\n        },\r\n\r\n        onChange(callback) {\r\n            window.addEventListener('settings-changed', (e) => callback(e.detail));\r\n        },\r\n\r\n        isRatingAllowed(rating) {\r\n            if (!rating || rating === 'NR' || rating === 'NC-17') return false;\r\n            const ratingOrder = ['G', 'PG', 'PG-13', 'R'];\r\n            const maxIndex = ratingOrder.indexOf(_settings.maxMovieRating);\r\n            const ratingIndex = ratingOrder.indexOf(rating);\r\n            return maxIndex !== -1 && ratingIndex !== -1 && ratingIndex <= maxIndex;\r\n        }\r\n    };\r\n\r\n    // panic button go brr\r\n    const handlePanic = (e) => {\r\n        const mods = _settings.panicModifiers || [];\r\n        const key = _settings.panicKey || 'x';\r\n\r\n        if (mods.includes('ctrl') !== e.ctrlKey) return;\r\n        if (mods.includes('shift') !== e.shiftKey) return;\r\n        if (mods.includes('alt') !== e.altKey) return;\r\n\r\n        if (e.key.toLowerCase() === key.toLowerCase()) {\r\n            e.preventDefault();\r\n            const overlayId = 'panic-overlay';\r\n            let overlay = window.parent?.document?.getElementById(overlayId) || document.getElementById(overlayId);\r\n\r\n            if (!overlay) {\r\n                overlay = document.createElement('div');\r\n                overlay.id = overlayId;\r\n                overlay.style.cssText = 'position:fixed;inset:0;background:white;z-index:99999;';\r\n                document.body.appendChild(overlay);\r\n            } else {\r\n                overlay.style.display = 'block';\r\n            }\r\n\r\n            window.location.replace(_settings.panicUrl || 'https://classroom.google.com');\r\n        }\r\n    };\r\n\r\n    const init = () => {\r\n        Settings.apply();\r\n\r\n        const featured = window.SITE_CONFIG?.featuredBackground;\r\n        const activePreset = window.SITE_CONFIG?.backgroundPresets?.find(p => p.active);\r\n\r\n        const target = activePreset || featured;\r\n\r\n        if (target?.id && target.id !== _settings.lastSeenFeatured) {\r\n            Settings.update({\r\n                customBackground: target,\r\n                lastSeenFeatured: target.id,\r\n                backgroundRotation: false\r\n            });\r\n        }\r\n\r\n        document.addEventListener('keydown', handlePanic, true);\r\n\r\n        window.addEventListener('storage', (e) => {\r\n            if (e.key === STORAGE_KEY) {\r\n                _settings = load();\r\n                Settings.apply();\r\n                window.dispatchEvent(new CustomEvent('settings-changed', { detail: _settings }));\r\n            }\r\n        });\r\n\r\n        window.addEventListener('message', (e) => {\r\n            if (e.data?.type === 'settings-update' || e.data === 'updateCloak') {\r\n                _settings = load();\r\n                Settings.apply();\r\n                window.dispatchEvent(new CustomEvent('settings-changed', { detail: _settings }));\r\n            }\r\n        });\r\n\r\n        window.addEventListener('beforeunload', (e) => {\r\n            if (document.getElementById('main-frame') && _settings.leaveConfirmation) {\r\n                e.preventDefault();\r\n                return e.returnValue = '';\r\n            }\r\n        });\r\n    };\r\n\r\n    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', init);\r\n    else init();\r\n})();\r\n\n</script>\r\n    <script>\n// background stuff\r\n(function () {\r\n    'use strict';\r\n\r\n    if (window.BackgroundManager) return;\r\n\r\n    const YOUTUBE_REGEX = /(?:youtube\\.com\\/watch\\?v=|youtu\\.be\\/|youtube\\.com\\/embed\\/)([a-zA-Z0-9_-]{11})/;\r\n\r\n    const BackgroundManager = {\r\n        container: null,\r\n        mediaLayer: null,\r\n        elements: { video: null, image: null, iframe: null },\r\n        current: { type: null, url: null },\r\n        cacheName: 'phantom-bg-cache-v2',\r\n\r\n        init() {\r\n            this.container = document.createElement('div');\r\n            this.container.className = 'phantom-background';\r\n            this.container.innerHTML = '<div class=\"phantom-background-overlay\"></div><div class=\"phantom-background-layer\"></div>';\r\n            this.mediaLayer = this.container.querySelector('.phantom-background-layer');\r\n            document.body.insertBefore(this.container, document.body.firstChild);\r\n\r\n            const apply = () => this.applyBackground();\r\n            window.addEventListener('settings-changed', apply);\r\n            window.addEventListener('storage', apply);\r\n            window.addEventListener('beforeunload', () => this.cleanup());\r\n            window.addEventListener('pagehide', () => this.cleanup());\r\n\r\n            document.addEventListener('visibilitychange', () => {\r\n                const video = this.elements.video;\r\n                if (!video) return;\r\n                if (document.hidden) video.pause();\r\n                else if (this.current.type === 'video') video.play().catch(() => { });\r\n            });\r\n\r\n            this.applyBackground();\r\n        },\r\n\r\n        applyBackground() {\r\n            if (!this.container) return; // Wait for init() to create the container\r\n\r\n            const s = window.Settings?.getAll() || {};\r\n            const custom = s.customBackground;\r\n            const theme = s.background || {};\r\n\r\n            let type = null, url = null, pos = null, overlay = 0.4;\r\n\r\n            if (custom && custom.type !== 'none') {\r\n                // Refresh from config if possible to get latest props like objectPosition\r\n                if (custom.id && custom.id !== 'custom') {\r\n                    const preset = window.SITE_CONFIG?.backgroundPresets?.find(b => b.id === custom.id);\r\n                    if (preset) Object.assign(custom, preset);\r\n                }\r\n                ({ type, url, objectPosition: pos, overlay = 0.4 } = custom);\r\n            } else if (theme.type === 'image' || theme.type === 'video' || theme.type === 'youtube') {\r\n                type = theme.type;\r\n                url = theme.value || theme.url;\r\n                pos = theme.objectPosition;\r\n                overlay = theme.overlay || 0.4;\r\n            }\r\n\r\n            document.documentElement.style.setProperty('--bg-overlay', overlay);\r\n\r\n            // Handle common positioning typos and normalize\r\n            if (pos && typeof pos === 'string') {\r\n                pos = pos.toLowerCase().trim()\r\n                    .replace(/\\s+/g, ' ') // Normalize multiple spaces\r\n                    .replace('topleft', 'top left')\r\n                    .replace('topright', 'top right')\r\n                    .replace('bottomleft', 'bottom left')\r\n                    .replace('bottomright', 'bottom right')\r\n                    .replace('centercenter', 'center')\r\n                    .replace('centerleft', 'center left')\r\n                    .replace('centerright', 'center right');\r\n            }\r\n\r\n            document.documentElement.style.setProperty('--bg-image-position', pos || 'center');\r\n\r\n            if (!type || !url) {\r\n                this.clear();\r\n                document.documentElement.style.backgroundColor = 'var(--bg)';\r\n                document.documentElement.style.setProperty('--bg-image-position', 'center');\r\n                return;\r\n            }\r\n            if (this.current.type === type && this.current.url === url) return;\r\n\r\n            this.current = { type, url };\r\n\r\n            if (type === 'video' || url.match(/\\.(mp4|webm|ogg|mov|m4v)$/i)) {\r\n                this.clearMedia();\r\n                this.createVideo(url, pos);\r\n                this.container.classList.add('active');\r\n                document.documentElement.classList.add('phantom-bg-active');\r\n                document.body.classList.add('phantom-bg-active');\r\n            } else if (type === 'youtube' || YOUTUBE_REGEX.test(url)) {\r\n                this.clearMedia();\r\n                this.createYouTube(url, pos);\r\n                this.container.classList.add('active');\r\n                document.documentElement.classList.add('phantom-bg-active');\r\n                document.body.classList.add('phantom-bg-active');\r\n            } else if (type === 'image') {\r\n                this.handleImageBackground(url, pos);\r\n            }\r\n        },\r\n\r\n        async getProxiedCachedUrl(url) {\r\n            // Local images don't need proxying\r\n            if (!url.startsWith('http') || url.includes(location.hostname)) return url;\r\n\r\n            // Try direct load first (faster)\r\n            try {\r\n                const directTest = await fetch(url, { method: 'HEAD', mode: 'cors' });\r\n                if (directTest.ok) return url;\r\n            } catch (e) {\r\n                // CORS blocked, need to proxy\r\n            }\r\n\r\n            // Wait for BareMux (max 500ms)\r\n            let retries = 0;\r\n            while (!window.BareMux && retries < 5) {\r\n                await new Promise(r => setTimeout(r, 100));\r\n                retries++;\r\n            }\r\n\r\n            if (!window.BareMux) {\r\n                console.warn(\"Background: BareMux not found, trying direct URL.\");\r\n                return url; // Try direct anyway\r\n            }\r\n\r\n            try {\r\n                const client = new window.BareMux.BareClient();\r\n                const response = await client.fetch(url);\r\n                if (!response.ok) throw new Error('Proxy fetch failed');\r\n\r\n                const blob = await response.blob();\r\n                return URL.createObjectURL(blob);\r\n            } catch (error) {\r\n                console.error(\"Background proxy failed:\", error);\r\n                return url; // Fallback to direct URL\r\n            }\r\n        },\r\n\r\n        async handleImageBackground(url, pos) {\r\n            // Pre-load the image (proxied/cached or direct)\r\n            const finalUrl = await this.getProxiedCachedUrl(url);\r\n\r\n            // Check if this is still the current background after async fetch\r\n            if (this.current.url !== url) {\r\n                if (finalUrl && finalUrl.startsWith('blob:')) URL.revokeObjectURL(finalUrl);\r\n                return;\r\n            }\r\n\r\n            this.clearMedia();\r\n            this.createImage(finalUrl, pos);\r\n        },\r\n\r\n        createVideo(url, pos) {\r\n            const el = Object.assign(document.createElement('video'), {\r\n                className: 'phantom-background-media', src: url, autoplay: true, loop: true, muted: true, playsInline: true, volume: 0\r\n            });\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n            el.onerror = () => (this.elements.video = null);\r\n            this.elements.video = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        createImage(url, pos) {\r\n            const el = Object.assign(document.createElement('img'), {\r\n                className: 'phantom-background-media',\r\n                src: url\r\n            });\r\n\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n\r\n            el.onload = () => {\r\n                if (this.current.url === url || url.startsWith('blob:')) {\r\n                    this.container.classList.add('active');\r\n                    document.documentElement.classList.add('phantom-bg-active');\r\n                    document.body.classList.add('phantom-bg-active');\r\n                }\r\n            };\r\n            el.onerror = () => {\r\n                console.warn(\"Background image failed to load:\", url);\r\n                if (this.elements.image === el) this.elements.image = null;\r\n            };\r\n\r\n            this.elements.image = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        // youtube logic\r\n        createYouTube(url, pos) {\r\n            const id = url.match(YOUTUBE_REGEX)?.[1];\r\n            if (!id) return;\r\n            const el = Object.assign(document.createElement('iframe'), {\r\n                className: 'phantom-background-media',\r\n                src: `https://www.youtube.com/embed/${id}?autoplay=1&loop=1&playlist=${id}&controls=0&modestbranding=1&rel=0&mute=1&enablejsapi=1`,\r\n                allow: 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture'\r\n            });\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n            this.elements.iframe = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        clearMedia() {\r\n            Object.entries(this.elements).forEach(([key, el]) => {\r\n                if (!el) return;\r\n                if (key === 'video') { el.pause(); el.src = ''; }\r\n                if (key === 'iframe') el.src = 'about:blank';\r\n                if (key === 'image' && el.src.startsWith('blob:')) {\r\n                    URL.revokeObjectURL(el.src);\r\n                }\r\n                el.remove();\r\n                this.elements[key] = null;\r\n            });\r\n        },\r\n\r\n        clear() {\r\n            this.clearMedia();\r\n            this.current = { type: null, url: null };\r\n            document.documentElement.classList.remove('phantom-bg-active');\r\n            document.body.classList.remove('phantom-bg-active');\r\n            document.documentElement.style.backgroundColor = '';\r\n            if (this.container) this.container.classList.remove('active');\r\n        },\r\n\r\n        cleanup() {\r\n            this.clearMedia();\r\n        }\r\n    };\r\n\r\n    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', () => BackgroundManager.init());\r\n    else BackgroundManager.init();\r\n\r\n    window.BackgroundManager = BackgroundManager;\r\n})();\r\n\n</script>\r\n    <script>\n// topbar\r\n(function () {\r\n    let rootPrefix = '';\r\n    const scriptName = 'components/topbar.js';\r\n    const scripts = document.getElementsByTagName('script');\r\n    for (let i = 0; i < scripts.length; i++) {\r\n        const src = scripts[i].getAttribute('src');\r\n        if (src && src.includes(scriptName)) {\r\n            rootPrefix = src.split(scriptName)[0];\r\n            break;\r\n        }\r\n    }\r\n\r\n    if (!window.lucide && !document.querySelector('script[src*=\"lucide\"]')) {\r\n        const script = document.createElement('script');\r\n        script.src = 'https://unpkg.com/lucide@latest';\r\n        script.onload = () => {\r\n            if (window.lucide) lucide.createIcons();\r\n        };\r\n        document.head.appendChild(script);\r\n    }\r\n\r\n    initTopbar();\r\n\r\n    function createTopbar() {\r\n        const topbarContainer = document.createElement('div');\r\n        topbarContainer.id = 'topbar-container';\r\n\r\n        const logoSection = document.createElement('a');\r\n        logoSection.className = 'logo-section';\r\n        logoSection.href = rootPrefix + 'index2.html';\r\n        logoSection.innerHTML = '<div class=\"logo-placeholder\"><i data-lucide=\"zap\"></i></div>';\r\n        topbarContainer.appendChild(logoSection);\r\n\r\n        const navButtons = document.createElement('div');\r\n        navButtons.className = 'nav-buttons';\r\n\r\n        const buttons = [\r\n            { name: 'Music', icon: 'music', link: 'pages/music.html', badge: 'BETA' },\r\n            { name: 'Movies', icon: 'film', link: 'pages/movies.html' },\r\n            { name: 'Games', icon: 'gamepad-2', link: 'pages/games.html' },\r\n            { name: 'Watch', icon: 'play', link: 'pages/watch.html' },\r\n            { name: 'Search', icon: 'search', link: 'staticsjv2/index.html' },\r\n            { name: 'AI Chat', icon: 'bot', link: 'pages/chat.html' },\r\n            { separator: true },\r\n            { name: 'Settings', icon: 'settings', link: 'pages/settings.html' }\r\n        ];\r\n\r\n        buttons.forEach(btn => {\r\n            if (btn.separator) {\r\n                const separator = document.createElement('div');\r\n                separator.className = 'nav-separator';\r\n                navButtons.appendChild(separator);\r\n                return;\r\n            }\r\n\r\n            const link = document.createElement('a');   \r\n            link.href = rootPrefix + btn.link;\r\n            link.className = 'nav-btn';\r\n\r\n            const icon = document.createElement('i');\r\n            icon.setAttribute('data-lucide', btn.icon);\r\n            link.appendChild(icon);\r\n\r\n            const span = document.createElement('span');\r\n            span.textContent = btn.name;\r\n            link.appendChild(span);\r\n\r\n            if (btn.badge) {\r\n                const badge = document.createElement('div');\r\n                badge.className = 'nav-badge-beta';\r\n                badge.textContent = btn.badge;\r\n                link.appendChild(badge);\r\n            }\r\n\r\n            navButtons.appendChild(link);\r\n        });\r\n\r\n        topbarContainer.appendChild(navButtons);\r\n        document.body.prepend(topbarContainer);\r\n\r\n        if (window.lucide) {\r\n            lucide.createIcons();\r\n        }\r\n    }\r\n\r\n    function initTopbar() {\r\n        if (document.readyState === 'loading') {\r\n            document.addEventListener('DOMContentLoaded', createTopbar);\r\n        } else {\r\n            createTopbar();\r\n        }\r\n    }\r\n})();\r\n\n</script>\r\n</head>\r\n\r\n<body>\r\n    <div class=\"settings-page\">\r\n        <div class=\"settings-container\">\r\n            <div class=\"settings-header\">\r\n                <h1><i class=\"fa-solid fa-gear\"></i> Settings</h1>\r\n                <p>Customize your Phantom experience</p>\r\n            </div>\r\n\r\n            <div class=\"settings-nav\">\r\n                <button class=\"settings-tab active\" data-tab=\"cloak\">Tab Cloak</button>\r\n                <button class=\"settings-tab\" data-tab=\"appearance\">Appearance</button>\r\n                <button class=\"settings-tab\" data-tab=\"content\">Content</button>\r\n                <button class=\"settings-tab\" data-tab=\"widgets\">Widgets</button>\r\n                <button class=\"settings-tab\" data-tab=\"data\">Data</button>\r\n            </div>\r\n\r\n            <div class=\"settings-panel active\" id=\"panel-cloak\">\r\n                <div class=\"settings-section\">\r\n                    <h2 class=\"section-title\"><i class=\"fa-solid fa-mask\"></i> Cloaking Mode</h2>\r\n                    <div class=\"setting-row\">\r\n                        <div class=\"setting-info\">\r\n                            <div class=\"setting-label\">Cloak Mode</div>\r\n                            <div class=\"setting-desc\">How the page should be opened</div>\r\n                        </div>\r\n                        <select class=\"setting-select\" id=\"cloak-mode\">\r\n                            <option value=\"none\">None (Normal)</option>\r\n                            <option value=\"about:blank\">about:blank (Default)</option>\r\n                            <option value=\"blob\">Blob URL</option>\r\n                        </select>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class=\"settings-section\">\r\n                    <h2 class=\"section-title\"><i class=\"fa-solid fa-wand-magic-sparkles\"></i> Tab Cloaks</h2>\r\n                    <p style=\"color: var(--text-muted); font-size: 0.8125rem;\">Choose a preset or add your own:</p>\r\n                    <div class=\"cloaks-grid\" id=\"cloaks-grid\"></div>\r\n\r\n                    <div class=\"setting-row\"\r\n                        style=\"margin-top: 16px; border-top: 1px solid var(--border); padding-top: 16px;\">\r\n                        <div class=\"setting-info\">\r\n                            <div class=\"setting-label\">Rotating Cloaks</div>\r\n                            <div class=\"setting-desc\">Automatically rotate tab title/icon</div>\r\n                        </div>\r\n                        <div class=\"toggle\" id=\"rotate-toggle\"></div>\r\n                    </div>\r\n\r\n                    <div class=\"setting-row\" id=\"rotate-interval-row\" style=\"display:none;\">\r\n                        <div class=\"setting-info\">\r\n                            <div class=\"setting-label\">Rotation Interval (s)</div>\r\n                            <div class=\"setting-desc\">0.1s - 30s</div>\r\n                        </div>\r\n                        <input type=\"number\" class=\"setting-input\" id=\"rotate-interval\" value=\"5\" min=\"0.1\" max=\"30\"\r\n                            step=\"0.1\" style=\"width: 80px;\">\r\n                    </div>\r\n\r\n                    <button class=\"btn btn-secondary\" id=\"add-cloak-btn\" style=\"margin-top: 16px; width: 100%;\"><i\r\n                            class=\"fa-solid fa-plus\"></i> Add Custom Cloak</button>\r\n                    <div class=\"add-cloak-form\" id=\"add-cloak-form\">\r\n                        <input type=\"text\" class=\"setting-input\" id=\"new-cloak-name\" placeholder=\"Name (e.g. Google)\"\r\n                            style=\"width: 100%;\">\r\n                        <input type=\"text\" class=\"setting-input\" id=\"new-cloak-title\" placeholder=\"Tab title\"\r\n                            style=\"width: 100%;\">\r\n                        <input type=\"text\" class=\"setting-input\" id=\"new-cloak-icon\"\r\n                            placeholder=\"Favicon URL (https://...)\" style=\"width: 100%;\">\r\n                        <div class=\"add-cloak-actions\">\r\n                            <button class=\"btn btn-secondary\" id=\"cancel-cloak\">Cancel</button>\r\n                            <button class=\"btn btn-primary\" id=\"save-cloak\">Save Cloak</button>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div class=\"setting-row\">\r\n                        <div class=\"setting-info\">\r\n                            <div class=\"setting-label\">Leave Confirmation</div>\r\n                            <div class=\"setting-desc\">Ask before closing the tab</div>\r\n                        </div>\r\n                        <div class=\"toggle\" id=\"leave-confirm-toggle\"></div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class=\"settings-section\">\r\n                    <h2 class=\"section-title\"><i class=\"fa-solid fa-bolt\"></i> Panic Key</h2>\r\n                    <div class=\"setting-row\">\r\n                        <div class=\"setting-info\">\r\n                            <div class=\"setting-label\">Keyboard Shortcut</div>\r\n                            <div class=\"setting-desc\">Press to quickly exit</div>\r\n                        </div>\r\n                        <button class=\"key-capture\" id=\"panic-key\">Ctrl + Shift + Esc</button>\r\n                    </div>\r\n                    <div class=\"setting-row\">\r\n                        <div class=\"setting-info\">\r\n                            <div class=\"setting-label\">Redirect URL</div>\r\n                        </div>\r\n                        <input type=\"text\" class=\"setting-input\" id=\"panic-url\"\r\n                            placeholder=\"https://classroom.google.com\">\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <div class=\"settings-panel\" id=\"panel-appearance\">\r\n                <div class=\"settings-section\">\r\n                    <h2 class=\"section-title\"><i class=\"fa-solid fa-image\"></i> Backgrounds</h2>\r\n                    <p style=\"color: var(--text-muted); font-size: 0.8125rem; margin-bottom: 12px;\">Choose a\r\n                        high-quality image or video background:</p>\r\n                    <div class=\"presets-grid\" id=\"backgrounds-grid\">\r\n                        <!-- Backgrounds injected by JS -->\r\n                    </div>\r\n\r\n                    <div class=\"custom-bg-form\"\r\n                        style=\"margin-top: 16px; padding: 20px; background: var(--bg); border: 1px solid var(--border); border-radius: 12px; box-shadow: var(--shadow-sm);\">\r\n                        <h3\r\n                            style=\"font-size: 0.875rem; font-weight: 600; margin-bottom: 16px; color: var(--text); display: flex; align-items: center; gap: 8px;\">\r\n                            <i class=\"fa-solid fa-link\" style=\"color: var(--accent);\"></i> Custom Background\r\n                        </h3>\r\n                        <div style=\"display: flex; gap: 10px; flex-wrap: wrap;\">\r\n                            <input type=\"text\" class=\"setting-input\" id=\"custom-bg-url\"\r\n                                placeholder=\"Paste image, video, or YouTube URL...\" style=\"flex: 1; min-width: 250px;\">\r\n                            <button class=\"btn btn-primary\" id=\"apply-custom-bg\" style=\"min-width: 100px;\">\r\n                                <i class=\"fa-solid fa-check\"></i> Apply\r\n                            </button>\r\n                        </div>\r\n                        <div style=\"margin-top: 12px; display: flex; gap: 10px; flex-wrap: wrap;\">\r\n                            <input type=\"text\" class=\"setting-input\" id=\"custom-bg-position\"\r\n                                placeholder=\"Image position (e.g., top left, center, bottom right)\" style=\"flex: 1; min-width: 250px;\">\r\n                        </div>\r\n                        <div style=\"margin-top: 12px; display: flex; gap: 16px; flex-wrap: wrap;\">\r\n                            <span\r\n                                style=\"font-size: 0.75rem; color: var(--text-dim); display: flex; align-items: center; gap: 4px;\">\r\n                                <i class=\"fa-solid fa-image\"></i> Images (JPG, PNG, GIF)\r\n                            </span>\r\n                            <span\r\n                                style=\"font-size: 0.75rem; color: var(--text-dim); display: flex; align-items: center; gap: 4px;\">\r\n                                <i class=\"fa-solid fa-clapperboard\"></i> Direct Video (MP4, WebM)\r\n                            </span>\r\n                            <span\r\n                                style=\"font-size: 0.75rem; color: var(--text-dim); display: flex; align-items: center; gap: 4px;\">\r\n                                <i class=\"fa-brands fa-youtube\"></i> YouTube Links\r\n                            </span>\r\n                        </div>\r\n                        <div class=\"setting-row\"\r\n                            style=\"margin-top: 16px; border-top: 1px solid var(--border); padding-top: 16px;\">\r\n                            <div class=\"setting-info\">\r\n                                <div class=\"setting-label\">Rotate Background</div>\r\n                                <div class=\"setting-desc\">Automatically rotate background every 2 days</div>\r\n                            </div>\r\n                            <div class=\"toggle\" id=\"background-rotation-toggle\"></div>\r\n                        </div>\r\n\r\n                        <h2 class=\"section-title\" style=\"margin-top: 24px;\"><i class=\"fa-solid fa-swatchbook\"></i> Theme\r\n                            Presets</h2>\r\n                        <div class=\"presets-grid\" id=\"themes-grid\">\r\n                            <!-- Themes injected by JS -->\r\n                        </div>\r\n\r\n                        <div class=\"setting-row\"\r\n                            style=\"margin-top: 16px; border-top: 1px solid var(--border); padding-top: 16px;\">\r\n                            <div class=\"setting-info\">\r\n                                <div class=\"setting-label\">Rotate Theme</div>\r\n                                <div class=\"setting-desc\">Automatically rotate theme every 2 days</div>\r\n                            </div>\r\n                            <div class=\"toggle\" id=\"theme-rotation-toggle\"></div>\r\n                        </div>\r\n\r\n                        <h2 class=\"section-title\"><i class=\"fa-solid fa-palette\"></i> Custom Theme</h2>\r\n                        <div class=\"setting-row\">\r\n                            <div class=\"setting-info\">\r\n                                <div class=\"setting-label\">Background Color</div>\r\n                                <div class=\"setting-desc\">Primary background color</div>\r\n                            </div>\r\n                            <input type=\"color\" id=\"bg-color\" value=\"#0a0a0a\"\r\n                                style=\"width:40px;height:40px;border:1px solid var(--border);border-radius:8px;cursor:pointer;\">\r\n                        </div>\r\n                        <div class=\"setting-row\">\r\n                            <div class=\"setting-info\">\r\n                                <div class=\"setting-label\">Accent Color</div>\r\n                                <div class=\"setting-desc\">Primary highlight color</div>\r\n                            </div>\r\n                            <input type=\"color\" id=\"accent-color\" value=\"#ffffff\"\r\n                                style=\"width:40px;height:40px;border:1px solid var(--border);border-radius:8px;cursor:pointer;\">\r\n                        </div>\r\n                        <div class=\"setting-row\">\r\n                            <div class=\"setting-info\">\r\n                                <div class=\"setting-label\">Surface Color</div>\r\n                                <div class=\"setting-desc\">Card/Sidebar background</div>\r\n                            </div>\r\n                            <input type=\"color\" id=\"surface-color\" value=\"#0f0f0f\"\r\n                                style=\"width:40px;height:40px;border:1px solid var(--border);border-radius:8px;cursor:pointer;\">\r\n                        </div>\r\n                        <div class=\"setting-row\">\r\n                            <div class=\"setting-info\">\r\n                                <div class=\"setting-label\">Secondary Color</div>\r\n                                <div class=\"setting-desc\">Secondary elements</div>\r\n                            </div>\r\n                            <input type=\"color\" id=\"secondary-color\" value=\"#2e2e33\"\r\n                                style=\"width:40px;height:40px;border:1px solid var(--border);border-radius:8px;cursor:pointer;\">\r\n                        </div>\r\n                        <div class=\"setting-row\">\r\n                            <div class=\"setting-info\">\r\n                                <div class=\"setting-label\">Text Color</div>\r\n                                <div class=\"setting-desc\">Primary text color</div>\r\n                            </div>\r\n                            <input type=\"color\" id=\"text-color\" value=\"#e4e4e7\"\r\n                                style=\"width:40px;height:40px;border:1px solid var(--border);border-radius:8px;cursor:pointer;\">\r\n                        </div>\r\n                        <div class=\"setting-row\">\r\n                            <div class=\"setting-info\">\r\n                                <div class=\"setting-label\">Secondary Text Color</div>\r\n                                <div class=\"setting-desc\">Muted/Description text color</div>\r\n                            </div>\r\n                            <input type=\"color\" id=\"text-secondary-color\" value=\"#71717a\"\r\n                                style=\"width:40px;height:40px;border:1px solid var(--border);border-radius:8px;cursor:pointer;\">\r\n                        </div>\r\n                        <div class=\"setting-row\">\r\n                            <div class=\"setting-info\">\r\n                                <div class=\"setting-label\">Dim Text</div>\r\n                                <div class=\"setting-desc\">Low priority text</div>\r\n                            </div>\r\n                            <input type=\"color\" id=\"text-dim-color\" value=\"#52525b\"\r\n                                style=\"width:40px;height:40px;border:1px solid var(--border);border-radius:8px;cursor:pointer;\">\r\n                        </div>\r\n\r\n                        <h2 class=\"section-title\" style=\"margin-top: 24px;\"><i class=\"fa-solid fa-sliders\"></i> Advanced\r\n                            Colors</h2>\r\n                        <div class=\"setting-row\">\r\n                            <div class=\"setting-info\">\r\n                                <div class=\"setting-label\">Surface Hover</div>\r\n                            </div>\r\n                            <input type=\"color\" id=\"surface-hover-color\" value=\"#1a1a1a\"\r\n                                style=\"width:40px;height:40px;border:1px solid var(--border);border-radius:8px;cursor:pointer;\">\r\n                        </div>\r\n                        <div class=\"setting-row\">\r\n                            <div class=\"setting-info\">\r\n                                <div class=\"setting-label\">Surface Active</div>\r\n                            </div>\r\n                            <input type=\"color\" id=\"surface-active-color\" value=\"#252525\"\r\n                                style=\"width:40px;height:40px;border:1px solid var(--border);border-radius:8px;cursor:pointer;\">\r\n                        </div>\r\n                        <div class=\"setting-row\">\r\n                            <div class=\"setting-info\">\r\n                                <div class=\"setting-label\">Border</div>\r\n                            </div>\r\n                            <input type=\"color\" id=\"border-color\" value=\"#1f1f1f\"\r\n                                style=\"width:40px;height:40px;border:1px solid var(--border);border-radius:8px;cursor:pointer;\">\r\n                        </div>\r\n                        <div class=\"setting-row\">\r\n                            <div class=\"setting-info\">\r\n                                <div class=\"setting-label\">Border Light</div>\r\n                            </div>\r\n                            <input type=\"color\" id=\"border-light-color\" value=\"#2a2a2a\"\r\n                                style=\"width:40px;height:40px;border:1px solid var(--border);border-radius:8px;cursor:pointer;\">\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <div class=\"settings-panel\" id=\"panel-content\">\r\n                <div class=\"settings-section\">\r\n                    <h2 class=\"section-title\"><i class=\"fa-solid fa-film\"></i> Movies</h2>\r\n                    <div class=\"setting-row\">\r\n                        <div class=\"setting-info\">\r\n                            <div class=\"setting-label\">Maximum Rating</div>\r\n                            <div class=\"setting-desc\">Filter movies by rating</div>\r\n                        </div>\r\n                        <select class=\"setting-select\" id=\"max-rating\">\r\n                            <option value=\"G\">G</option>\r\n                            <option value=\"PG\">PG</option>\r\n                            <option value=\"PG-13\">PG-13</option>\r\n                            <option value=\"R\">R</option>\r\n                        </select>\r\n                    </div>\r\n                    <div class=\"setting-row\">\r\n                        <div class=\"setting-info\">\r\n                            <div class=\"setting-label\">Auto-Switch Providers</div>\r\n                            <div class=\"setting-desc\">Automatically switch if a movie source fails to load</div>\r\n                        </div>\r\n                        <div class=\"toggle\" id=\"autoswitch-toggle\"></div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"settings-section\">\r\n                    <h2 class=\"section-title\"><i class=\"fa-solid fa-gamepad\"></i> Games</h2>\r\n                    <div class=\"setting-row\">\r\n                        <div class=\"setting-info\">\r\n                            <div class=\"setting-label\">Default Library</div>\r\n                        </div>\r\n                        <select class=\"setting-select\" id=\"game-library\">\r\n                            <option value=\"multi\">Multi (Default)</option>\r\n                            <option value=\"gnmath\">Gnmath (With covers)</option>\r\n                            <option value=\"ugs\">UGS (More games)</option>\r\n                        </select>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <div class=\"settings-panel\" id=\"panel-widgets\">\r\n                <div class=\"settings-section\">\r\n                    <h2 class=\"section-title\"><i class=\"fa-brands fa-discord\"></i> Discord</h2>\r\n                    <div class=\"setting-row\">\r\n                        <div class=\"setting-info\">\r\n                            <div class=\"setting-label\">Show Discord Widget</div>\r\n                        </div>\r\n                        <div class=\"toggle active\" id=\"discord-toggle\"></div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"settings-section\">\r\n                    <h2 class=\"section-title\"><i class=\"fa-solid fa-music\"></i> Music</h2>\r\n                    <div class=\"setting-row\">\r\n                        <div class=\"setting-info\">\r\n                            <div class=\"setting-label\">Show Mini Player (SOON) <span style=\"font-size: 0.75rem; color: var(--text-muted);\">cough  never happening lowk cough</span></div>\r\n                        </div>\r\n                        <div class=\"toggle active\" id=\"miniplayer-toggle\"></div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"settings-section\">\r\n                    <h2 class=\"section-title\"><i class=\"fa-solid fa-clock-rotate-left\"></i> Updates</h2>\r\n                    <div class=\"setting-row\">\r\n                        <div class=\"setting-info\">\r\n                            <div class=\"setting-label\">Show Changelog on Update</div>\r\n                            <div class=\"setting-desc\">Automatically show changelog when Phantom is updated</div>\r\n                        </div>\r\n                        <div class=\"toggle active\" id=\"changelog-toggle\"></div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <div class=\"settings-panel\" id=\"panel-data\">\r\n                <div class=\"settings-section\">\r\n                    <h2 class=\"section-title\"><i class=\"fa-solid fa-database\"></i> Storage</h2>\r\n                    <div class=\"setting-row\">\r\n                        <div class=\"setting-info\">\r\n                            <div class=\"setting-label\">Clear Cache</div>\r\n                        </div>\r\n                        <button class=\"btn btn-danger\" id=\"clear-cache\"><i class=\"fa-solid fa-trash\"></i>\r\n                            Clear</button>\r\n                    </div>\r\n                    <div class=\"setting-row\">\r\n                        <div class=\"setting-info\">\r\n                            <div class=\"setting-label\">Reset All Settings</div>\r\n                        </div>\r\n                        <button class=\"btn btn-danger\" id=\"reset-settings\"><i class=\"fa-solid fa-rotate-left\"></i>\r\n                            Reset</button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    </div>\r\n    <script>\n// footer\r\n(function () {\r\n    'use strict';\r\n\r\n    let rootPrefix = '';\r\n    const scriptName = 'components/footer.js';\r\n    const scripts = document.getElementsByTagName('script');\r\n    for (let i = 0; i < scripts.length; i++) {\r\n        const src = scripts[i].getAttribute('src');\r\n        if (src && src.includes(scriptName)) {\r\n            rootPrefix = src.split(scriptName)[0];\r\n            break;\r\n        }\r\n    }\r\n\r\n    const config = window.SITE_CONFIG || { name: 'Phantom', version: '1.0.0', discord: { inviteUrl: '#' }, changelog: [], cloakPresets: [] };\r\n    const STORAGE_KEY = 'void_settings';\r\n    let storedSettings = {};\r\n    try { storedSettings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n\r\n    // settings\r\n    let settings = { ...(config.defaults || {}), ...storedSettings };\r\n\r\n    const footer = document.createElement('footer');\r\n    footer.id = 'site-footer';\r\n    footer.innerHTML = `\r\n        <style>\r\n            #site-footer {\r\n                margin-top: 0px;\r\n                padding: 20px;\r\n                border-top: 1px solid var(--border, #1f1f1f);\r\n                text-align: center;\r\n                background: transparent;\r\n            }\r\n            #site-footer .footer-links {\r\n                display: flex;\r\n                gap: 16px;\r\n                justify-content: center;\r\n                margin-bottom: 8px;\r\n                flex-wrap: wrap;\r\n            }\r\n            #site-footer .footer-link {\r\n                font-size: 12px;\r\n                color: var(--text-muted, #71717a);\r\n                text-decoration: none;\r\n                transition: color 0.15s;\r\n                font-family: 'Inter', sans-serif;\r\n                cursor: pointer;\r\n            }\r\n            #site-footer .footer-link:hover {\r\n                color: var(--text, #e4e4e7);\r\n            }\r\n            #site-footer .footer-version {\r\n                font-size: 11px;\r\n                color: var(--text-dim, #52525b);\r\n                cursor: pointer;\r\n                font-family: 'Inter', sans-serif;\r\n            }\r\n            #site-footer .footer-version:hover {\r\n                color: var(--text-muted, #71717a);\r\n            }\r\n        </style>\r\n        <div class=\"footer-links\">\r\n            <a href=\"${rootPrefix}pages/settings.html\" class=\"footer-link\"><i class=\"fa-solid fa-gear\"></i> Settings</a>\r\n            <a id=\"footer-changelog\" class=\"footer-link\"><i class=\"fa-solid fa-clock-rotate-left\"></i> Changelog</a>\r\n            <a href=\"${config.discord?.inviteUrl || '#'}\" target=\"_blank\" class=\"footer-link\"><i class=\"fa-brands fa-discord\"></i> Discord</a>\r\n            <a href=\"${rootPrefix}pages/terms.html\" class=\"footer-link\">Terms</a>\r\n            <a href=\"${rootPrefix}pages/disclaimer.html\" class=\"footer-link\">Disclaimer</a>\r\n            <a href=\"${rootPrefix}pages/extra.html\" class=\"footer-link\">Credits</a>\r\n        </div>\r\n        <span class=\"footer-version\" id=\"footer-version\">${config.name || 'Phantom'} v${config.version || '1.0.0'}</span>\r\n    `;\r\n\r\n    document.body.appendChild(footer);\r\n\r\n\r\n\r\n    // gtm\r\n    // Inject GTM head script if not already present\r\n    if (!document.querySelector('script[src*=\"googletagmanager.com/gtm.js\"]')) {\r\n        window.dataLayer = window.dataLayer || [];\r\n        window.dataLayer.push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' });\r\n        const gtmScript = document.createElement('script');\r\n        gtmScript.async = true;\r\n        gtmScript.src = 'https://www.googletagmanager.com/gtm.js?id=GTM-5LMBC27Z';\r\n        document.head.insertBefore(gtmScript, document.head.firstChild);\r\n    }\r\n\r\n    // Add GTM noscript fallback (for pages that don't have it in HTML)\r\n    if (!document.querySelector('noscript iframe[src*=\"googletagmanager\"]')) {\r\n        const gtmNoscript = document.createElement('noscript');\r\n        gtmNoscript.innerHTML = '<iframe src=\"https://www.googletagmanager.com/ns.html?id=GTM-5LMBC27Z\" height=\"0\" width=\"0\" style=\"display:none;visibility:hidden\"></iframe>';\r\n        document.body.insertBefore(gtmNoscript, document.body.firstChild);\r\n    }\r\n\r\n    const openChangelog = (e, customTitle, customContent) => {\r\n        if (e && e.preventDefault) e.preventDefault();\r\n        const changes = customContent || config.changelog || ['No changes listed'];\r\n\r\n        // Use standard modal structure from main.css\r\n        const overlay = document.createElement('div');\r\n        overlay.className = 'modal-overlay';\r\n\r\n        overlay.innerHTML = `\r\n            <div class=\"modal\" style=\"width: 400px; max-width: 90vw;\">\r\n                <div class=\"modal-header\">\r\n                    <h3 class=\"modal-title\">${customTitle || 'What\\'s New in v' + config.version}</h3>\r\n                    <button class=\"modal-close\"><i class=\"fa-solid fa-xmark\"></i></button>\r\n                </div>\r\n                <div class=\"modal-body\">\r\n                    <ul style=\"margin: 0; padding-left: 20px; color: var(--text-muted); font-size: 0.875rem; line-height: 1.6;\">\r\n                        ${changes.map(c => '<li>' + c + '</li>').join('')}\r\n                    </ul>\r\n                </div>\r\n                <div class=\"modal-footer\">\r\n                    <a href=\"${config.discord?.inviteUrl || '#'}\" target=\"_blank\" style=\"color: #5865F2; text-decoration: none; font-size: 13px; display: inline-flex; align-items: center; gap: 6px;\">\r\n                        <i class=\"fa-brands fa-discord\"></i> Join Discord\r\n                    </a>\r\n                </div>\r\n            </div>\r\n        `;\r\n\r\n        document.body.appendChild(overlay);\r\n\r\n        // Trigger animation\r\n        requestAnimationFrame(() => overlay.classList.add('show'));\r\n\r\n        const close = () => {\r\n            overlay.classList.remove('show');\r\n            setTimeout(() => overlay.remove(), 200);\r\n        };\r\n\r\n        overlay.querySelector('.modal-close').onclick = close;\r\n        overlay.onclick = (e) => { if (e.target === overlay) close(); };\r\n    };\r\n\r\n    // Expose openChangelog globally\r\n    window.openChangelog = openChangelog;\r\n\r\n    const changelogBtn = document.getElementById('footer-changelog');\r\n    if (changelogBtn) changelogBtn.onclick = openChangelog;\r\n\r\n    const versionBtn = document.getElementById('footer-version');\r\n    if (versionBtn) versionBtn.onclick = openChangelog;\r\n\r\n    // sync\r\n    // syncRemoteChangelog removed - using local config\r\n\r\n\r\n    // Initialize Sync\r\n    // syncRemoteChangelog();\r\n\r\n    const currentVersion = config.version;\r\n    const lastVersion = settings.lastVersion;\r\n\r\n    if (settings.showChangelogOnUpdate && lastVersion && lastVersion !== currentVersion) {\r\n        setTimeout(() => {\r\n            openChangelog();\r\n            settings.lastVersion = currentVersion;\r\n            localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n        }, 1000);\r\n    } else if (!lastVersion) {\r\n        settings.lastVersion = currentVersion;\r\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n    }\r\n\r\n    // panic\r\n    if (settings.panicKey) {\r\n        document.addEventListener('keydown', (e) => {\r\n            const keys = settings.panicModifiers || ['ctrl', 'shift'];\r\n            const triggerKey = settings.panicKey.toLowerCase();\r\n            const pressedKey = e.key.toLowerCase();\r\n\r\n            // Check modifiers\r\n            const ctrlMatch = keys.includes('ctrl') === e.ctrlKey;\r\n            const shiftMatch = keys.includes('shift') === e.shiftKey;\r\n            const altMatch = keys.includes('alt') === e.altKey;\r\n\r\n            if (ctrlMatch && shiftMatch && altMatch && pressedKey === triggerKey) {\r\n                e.preventDefault();\r\n\r\n                // Show white screen instantly (if panic-overlay exists in parent)\r\n                const parentOverlay = window.parent?.document?.getElementById('panic-overlay');\r\n                if (parentOverlay) {\r\n                    parentOverlay.style.display = 'block';\r\n                } else {\r\n                    // Create overlay if it doesn't exist\r\n                    const overlay = document.createElement('div');\r\n                    overlay.id = 'panic-overlay';\r\n                    overlay.style.cssText = 'position:fixed;inset:0;background:white;z-index:99999;';\r\n                    document.body.appendChild(overlay);\r\n                }\r\n\r\n                // Redirect immediately\r\n                const url = settings.panicUrl || 'https://classroom.google.com';\r\n                try { window.top.location.href = url; } catch { window.location.href = url; }\r\n            }\r\n        }, true); // Use capture phase for faster response\r\n    }\r\n\r\n    // Cloaking logic has been moved to scripts/cloaking.js for better synchronization.\r\n    // If you need cloaking on a specific page, include that script.\r\n\r\n\r\n    window.addEventListener('beforeunload', (e) => {\r\n        // Reload settings to get latest value\r\n        try { settings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n\r\n        if (window.top === window.self && settings.leaveConfirmation) {\r\n            e.preventDefault();\r\n            e.returnValue = '';\r\n            return '';\r\n        }\r\n    });\r\n\r\n    // discord\r\n    let crateInstance = null;\r\n\r\n    function initDiscord() {\r\n        if (settings.discordWidget && config.discord && config.discord.widgetServer && config.discord.widgetChannel) {\r\n            // Check if already loaded\r\n            if (document.querySelector('script[src*=\"@widgetbot/crate\"]')) {\r\n                if (crateInstance) crateInstance.show();\r\n                return;\r\n            }\r\n\r\n            const crateScript = document.createElement('script');\r\n            crateScript.src = 'https://cdn.jsdelivr.net/npm/@widgetbot/crate@3';\r\n            crateScript.async = true;\r\n            crateScript.defer = true;\r\n            crateScript.onload = () => {\r\n                crateInstance = new Crate({\r\n                    server: config.discord.widgetServer,\r\n                    channel: config.discord.widgetChannel,\r\n                    glyph: ['https://cdn.discordapp.com/embed/avatars/0.png', '100%'],\r\n                    location: ['bottom', 'right']\r\n                });\r\n            };\r\n            document.body.appendChild(crateScript);\r\n        } else {\r\n            // Hide if disabled\r\n            if (crateInstance) crateInstance.hide();\r\n        }\r\n    }\r\n\r\n    // Initialize\r\n    initDiscord();\r\n\r\n    // Listen for settings change to toggle dynamically\r\n    window.addEventListener('storage', (e) => {\r\n        if (e.key === STORAGE_KEY) {\r\n            try { settings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n            initDiscord();\r\n        }\r\n    });\r\n\r\n    // Listen for internal event\r\n    window.addEventListener('settings-changed', (e) => {\r\n        settings = e.detail;\r\n        initDiscord();\r\n    });\r\n\r\n    // counters\r\n    // Only show on home page (index2.html) checking if main-content exists\r\n    const mainContent = document.querySelector('.main-content');\r\n    // Ensure we are on the home page view (search bar checks etc) or just check existence\r\n    if (mainContent && document.querySelector('.featured-section')) {\r\n        const counterContainer = document.createElement('div');\r\n        counterContainer.id = 'supercounters-wrapper';\r\n        counterContainer.style.marginTop = '24px';\r\n        counterContainer.style.textAlign = 'center';\r\n        counterContainer.style.opacity = '0.8';\r\n\r\n        // Use iframe to isolate document.write from the widget\r\n        const iframe = document.createElement('iframe');\r\n        iframe.style.border = 'none';\r\n        iframe.style.width = '150px';\r\n        iframe.style.height = '40px';\r\n        iframe.style.overflow = 'hidden';\r\n\r\n        // Widget code\r\n        const widgetCode = `\r\n            <html>\r\n            <body style=\"margin:0;display:flex;justify-content:center;align-items:center;background:transparent;\">\r\n                <script type=\"text/javascript\" src=\"//widget.supercounters.com/ssl/online_i.js\"><\\/script>\r\n                <script type=\"text/javascript\">sc_online_i(1726449,\"ffffff\",\"000000\");<\\/script>\r\n            </body>\r\n            </html>\r\n        `;\r\n\r\n        iframe.srcdoc = widgetCode;\r\n        counterContainer.appendChild(iframe);\r\n        mainContent.appendChild(counterContainer);\r\n    }\r\n})();\r\n\n</script>\r\n    <script>\n// Use centralized Settings API\r\nconst config = window.SITE_CONFIG || { cloakPresets: [] };\r\nlet settings = Settings.getAll();\r\nconst saveSettings = (s) => {\r\n    Settings.update(s);\r\n    // Update local ref just in case\r\n    settings = Settings.getAll();\r\n};\r\n\r\n// Tabs\r\ndocument.querySelectorAll('.settings-tab').forEach(tab => {\r\n    tab.onclick = () => {\r\n        document.querySelectorAll('.settings-tab').forEach(t => t.classList.remove('active'));\r\n        document.querySelectorAll('.settings-panel').forEach(p => p.classList.remove('active'));\r\n        tab.classList.add('active');\r\n        document.getElementById('panel-' + tab.dataset.tab).classList.add('active');\r\n    };\r\n});\r\n\r\n// Render cloaks\r\nfunction renderCloaks() {\r\n    const grid = document.getElementById('cloaks-grid');\r\n    const allCloaks = [...(config.cloakPresets || []), ...(settings.customCloaks || [])];\r\n    const activeCloak = settings.tabTitle || '';\r\n    grid.innerHTML = allCloaks.map(c => {\r\n        const isActive = c.title === activeCloak;\r\n        return '<button class=\"cloak-btn ' + (isActive ? 'active' : '') + '\" data-title=\"' + c.title + '\" data-icon=\"' + (c.icon || '') + '\">' +\r\n            (c.icon ? '<img src=\"' + c.icon + '\" onerror=\"this.style.display=\\'none\\'\">' : '<i class=\"fa-solid fa-globe\"></i>') +\r\n            '<span>' + c.name + '</span></button>';\r\n    }).join('');\r\n    grid.querySelectorAll('.cloak-btn').forEach(btn => {\r\n        btn.onclick = () => {\r\n            settings.tabTitle = btn.dataset.title;\r\n            settings.tabFavicon = btn.dataset.icon;\r\n            saveSettings(settings);\r\n            renderCloaks();\r\n            // Instant update via postMessage is handled by Settings.update()\r\n            document.title = settings.tabTitle;\r\n        };\r\n    });\r\n}\r\nrenderCloaks();\r\n\r\n// Add custom cloak\r\ndocument.getElementById('add-cloak-btn').onclick = () => document.getElementById('add-cloak-form').classList.toggle('show');\r\ndocument.getElementById('cancel-cloak').onclick = () => document.getElementById('add-cloak-form').classList.remove('show');\r\ndocument.getElementById('save-cloak').onclick = () => {\r\n    const name = document.getElementById('new-cloak-name').value.trim();\r\n    const title = document.getElementById('new-cloak-title').value.trim();\r\n    const icon = document.getElementById('new-cloak-icon').value.trim();\r\n    if (name && title) {\r\n        settings.customCloaks = settings.customCloaks || [];\r\n        settings.customCloaks.push({ name, title, icon });\r\n        saveSettings(settings);\r\n        renderCloaks();\r\n        document.getElementById('add-cloak-form').classList.remove('show');\r\n        document.getElementById('new-cloak-name').value = '';\r\n        document.getElementById('new-cloak-title').value = '';\r\n        document.getElementById('new-cloak-icon').value = '';\r\n    }\r\n};\r\n\r\n// Load values\r\ndocument.getElementById('bg-color').value = settings.background?.value || '#0a0a0a';\r\ndocument.getElementById('cloak-mode').value = settings.cloakMode || 'about:blank';\r\ndocument.getElementById('panic-url').value = settings.panicUrl || 'https://classroom.google.com';\r\ndocument.getElementById('accent-color').value = settings.accentColor || '#ffffff';\r\ndocument.getElementById('surface-color').value = settings.surfaceColor || '#0f0f0f';\r\ndocument.getElementById('secondary-color').value = settings.secondaryColor || '#2e2e33';\r\ndocument.getElementById('text-color').value = settings.textColor || '#e4e4e7';\r\ndocument.getElementById('text-secondary-color').value = settings.textSecondaryColor || '#71717a';\r\ndocument.getElementById('text-dim-color').value = settings.textDimColor || '#52525b';\r\ndocument.getElementById('surface-hover-color').value = settings.surfaceHoverColor || '#1a1a1a';\r\ndocument.getElementById('surface-active-color').value = settings.surfaceActiveColor || '#252525';\r\ndocument.getElementById('border-color').value = settings.borderColor || '#1f1f1f';\r\ndocument.getElementById('border-light-color').value = settings.borderLightColor || '#2a2a2a';\r\n\r\ndocument.getElementById('max-rating').value = settings.maxMovieRating || 'R';\r\ndocument.getElementById('game-library').value = settings.gameLibrary || 'multi';\r\n\r\n// Background Presets\r\nfunction renderBackgrounds() {\r\n    const grid = document.getElementById('backgrounds-grid');\r\n    if (!grid) return;\r\n\r\n    const bgPresets = window.SITE_CONFIG?.backgroundPresets || [];\r\n    const currentBg = settings.customBackground;\r\n    const currentBgId = currentBg?.id || (currentBg?.url ? 'custom' : 'none');\r\n\r\n    const customBgs = settings.customBackgrounds || [];\r\n    const allBgs = [...bgPresets, ...customBgs];\r\n\r\n    grid.innerHTML = allBgs.map(bg => {\r\n        const isActive = bg.id === currentBgId || (bg.id === 'custom' && bg.url === currentBg?.url);\r\n        let preview = '';\r\n        if (bg.type === 'youtube') {\r\n            const ytId = bg.url.match(/(?:youtube\\.com\\/watch\\?v=|youtu\\.be\\/|youtube\\.com\\/embed\\/)([a-zA-Z0-9_-]{11})/)?.[1];\r\n            preview = ytId ? `<img src=\"https://img.youtube.com/vi/${ytId}/hqdefault.jpg\" style=\"width:100%; height:100%; object-fit:cover;\">` : '';\r\n        } else if (bg.type === 'video') {\r\n            preview = `<video src=\"${bg.url}\" muted loop playsinline volume=\"0\" style=\"width:100%; height:100%; object-fit:cover;\"></video>`;\r\n        } else if (bg.type === 'image') {\r\n            preview = `<img src=\"${bg.url}\" style=\"width:100%; height:100%; object-fit:cover;\">`;\r\n        } else {\r\n            preview = `<div style=\"width:100%; height:100%; background:linear-gradient(45deg, var(--surface), var(--surface-hover)); display:flex; align-items:center; justify-content:center; color:var(--text-dim);\"><i class=\"fa-solid fa-ban\" style=\"font-size: 2.5rem; opacity: 0.5;\"></i></div>`;\r\n        }\r\n\r\n        const isDeletable = customBgs.some(cb => cb.url === bg.url);\r\n\r\n        return `\r\n            <button class=\"bg-preset-btn ${isActive ? 'active' : ''}\" data-id=\"${bg.id}\" data-url=\"${bg.url || ''}\">\r\n                <div class=\"bg-preset-preview\">${preview}</div>\r\n                <div class=\"bg-preset-name\">${bg.name}</div>\r\n                ${(bg.type === 'video' || bg.type === 'youtube') ? '<div class=\"bg-preset-badge\"><i class=\"fa-solid fa-play\"></i></div>' : ''}\r\n                ${isDeletable ? `<div class=\"bg-preset-delete\" data-url=\"${bg.url}\"><i class=\"fa-solid fa-trash\"></i></div>` : ''}\r\n            </button>\r\n        `;\r\n    }).join('');\r\n\r\n    grid.querySelectorAll('.bg-preset-btn').forEach(btn => {\r\n        btn.onclick = (e) => {\r\n            // Don't trigger if clicking delete\r\n            if (e.target.closest('.bg-preset-delete')) return;\r\n\r\n            const bgId = btn.dataset.id;\r\n            const bgUrl = btn.dataset.url;\r\n\r\n            if (bgId === 'none') {\r\n                settings.customBackground = { id: 'none', type: 'none' };\r\n                if (window.Notify) Notify.success('Background Removed', 'Reverted to theme default');\r\n            } else {\r\n                const bg = allBgs.find(b => (bgId !== 'custom' && b.id === bgId) || (bgId === 'custom' && b.url === bgUrl));\r\n                settings.customBackground = bg;\r\n                if (window.Notify) Notify.success('Background Applied', `Switched to ${bg.name}`);\r\n            }\r\n\r\n            saveSettings(settings);\r\n            renderBackgrounds();\r\n\r\n            // Clear custom input when selecting preset\r\n            const urlInput = document.getElementById('custom-bg-url');\r\n            if (urlInput) urlInput.value = '';\r\n        };\r\n\r\n        // Deletion handler\r\n        const deleteBtn = btn.querySelector('.bg-preset-delete');\r\n        if (deleteBtn) {\r\n            deleteBtn.onclick = (e) => {\r\n                e.stopPropagation();\r\n                const url = deleteBtn.dataset.url;\r\n                settings.customBackgrounds = (settings.customBackgrounds || []).filter(bg => bg.url !== url);\r\n\r\n                // If active, remove it\r\n                if (settings.customBackground?.url === url) {\r\n                    settings.customBackground = { id: 'none', type: 'none' };\r\n                }\r\n\r\n                saveSettings(settings);\r\n                renderBackgrounds();\r\n                if (window.Notify) Notify.success('Deleted', 'Custom background removed');\r\n            };\r\n        }\r\n\r\n        // Play video on hover\r\n        const video = btn.querySelector('video');\r\n        if (video) {\r\n            btn.onmouseenter = () => {\r\n                video.muted = true;\r\n                video.volume = 0;\r\n                video.play().catch(() => { }); // Ignore play promise rejection\r\n            };\r\n            btn.onmouseleave = () => {\r\n                video.pause();\r\n                video.currentTime = 0;\r\n            };\r\n        }\r\n    });\r\n}\r\nrenderBackgrounds();\r\n\r\n// Custom Background Handler\r\nconst applyCustomBgBtn = document.getElementById('apply-custom-bg');\r\nif (applyCustomBgBtn) {\r\n    applyCustomBgBtn.onclick = () => {\r\n        const urlInput = document.getElementById('custom-bg-url');\r\n        const url = urlInput?.value?.trim();\r\n\r\n        if (!url) {\r\n            if (window.Notify) Notify.error('Error', 'Please enter a URL');\r\n            return;\r\n        }\r\n\r\n        // Auto-detect type\r\n        let type = 'image';\r\n        const urlLower = url.toLowerCase();\r\n        if (urlLower.match(/\\.(mp4|webm|ogg|mov|m4v)$/)) {\r\n            type = 'video';\r\n        } else if (urlLower.match(/(youtube\\.com|youtu\\.be)/)) {\r\n            type = 'youtube';\r\n        } else if (urlLower.includes('video') || urlLower.includes('stream')) {\r\n            // Heuristic for some video providers\r\n            type = 'video';\r\n        }\r\n\r\n        // Get object-position from input if provided\r\n        const objectPositionInput = document.getElementById('custom-bg-position');\r\n        const objectPosition = objectPositionInput?.value?.trim() || null;\r\n\r\n        // Create custom background object\r\n        const newBg = {\r\n            id: 'custom',\r\n            name: 'Custom',\r\n            type: type,\r\n            url: url,\r\n            overlay: 0.3,\r\n            objectPosition: objectPosition\r\n        };\r\n\r\n        settings.customBackgrounds = settings.customBackgrounds || [];\r\n        // Prevent duplicates\r\n        if (!settings.customBackgrounds.some(b => b.url === url)) {\r\n            settings.customBackgrounds.push(newBg);\r\n        }\r\n\r\n        settings.customBackground = newBg;\r\n        saveSettings(settings);\r\n        renderBackgrounds();\r\n        if (window.Notify) Notify.success('Custom Background Added', 'Background saved to your library');\r\n        urlInput.value = '';\r\n    };\r\n}\r\n\r\n// Theme Presets - use from config.js\r\nconst presets = window.SITE_CONFIG?.themePresets || {};\r\n\r\nconst presetsContainer = document.getElementById('themes-grid');\r\nif (presetsContainer) {\r\n    Object.entries(presets).forEach(([key, theme]) => {\r\n        const btn = document.createElement('button');\r\n        btn.className = 'cloak-btn'; /* Reuse styling */\r\n        btn.style.alignItems = 'flex-start';\r\n        btn.style.padding = '12px';\r\n        btn.innerHTML = `\r\n                    <div style=\"width:100%; height:24px; background:${theme.bg.value}; border-radius:4px; margin-bottom:8px; border:1px solid var(--border)\"></div>\r\n                    <span style=\"font-weight:600\">${theme.name}</span>\r\n                `;\r\n        btn.onclick = () => {\r\n            settings.background = theme.bg;\r\n            settings.surfaceColor = theme.surface;\r\n            settings.surfaceHoverColor = theme.surfaceHover;\r\n            settings.surfaceActiveColor = theme.surfaceActive;\r\n            settings.secondaryColor = theme.secondary;\r\n            settings.borderColor = theme.border;\r\n            settings.borderLightColor = theme.borderLight;\r\n            settings.textColor = theme.text;\r\n            settings.textSecondaryColor = theme.textSec;\r\n            settings.textDimColor = theme.textDim;\r\n            settings.accentColor = theme.accent;\r\n            saveSettings(settings); // This triggers Settings.apply() automatically\r\n\r\n            // Update inputs\r\n            document.getElementById('bg-color').value = theme.bg.value;\r\n            document.getElementById('accent-color').value = theme.accent;\r\n            document.getElementById('surface-color').value = theme.surface;\r\n            document.getElementById('secondary-color').value = theme.secondary;\r\n            document.getElementById('text-color').value = theme.text;\r\n            document.getElementById('text-secondary-color').value = theme.textSec;\r\n            document.getElementById('text-dim-color').value = theme.textDim;\r\n            document.getElementById('surface-hover-color').value = theme.surfaceHover;\r\n            document.getElementById('surface-active-color').value = theme.surfaceActive;\r\n            document.getElementById('border-color').value = theme.border;\r\n            document.getElementById('border-light-color').value = theme.borderLight;\r\n            if (window.Notify) {\r\n                Notify.success('Theme Applied', `Switched to ${theme.name} theme`);\r\n            } else {\r\n                alert('Theme \"' + theme.name + '\" applied!');\r\n            }\r\n        };\r\n        presetsContainer.appendChild(btn);\r\n    });\r\n}\r\n\r\n\r\nconst mods = settings.panicModifiers || window.SITE_CONFIG?.defaults?.panicModifiers || ['ctrl', 'shift'];\r\nconst key = settings.panicKey || window.SITE_CONFIG?.defaults?.panicKey || 'x';\r\ndocument.getElementById('panic-key').textContent = mods.map(m => m.charAt(0).toUpperCase() + m.slice(1)).join(' + ') + ' + ' + key;\r\n\r\nif (settings.discordWidget !== false) document.getElementById('discord-toggle').classList.add('active');\r\nelse document.getElementById('discord-toggle').classList.remove('active');\r\nif (settings.miniplayer !== false) document.getElementById('miniplayer-toggle').classList.add('active');\r\nelse document.getElementById('miniplayer-toggle').classList.remove('active');\r\nif (settings.leaveConfirmation) document.getElementById('leave-confirm-toggle').classList.add('active');\r\nif (settings.showChangelogOnUpdate !== false) document.getElementById('changelog-toggle').classList.add('active');\r\nelse document.getElementById('changelog-toggle').classList.remove('active');\r\nif (settings.themeRotation) document.getElementById('theme-rotation-toggle').classList.add('active');\r\nelse document.getElementById('theme-rotation-toggle').classList.remove('active');\r\nif (settings.autoSwitchProviders !== false) document.getElementById('autoswitch-toggle').classList.add('active');\r\nelse document.getElementById('autoswitch-toggle').classList.remove('active');\r\nif (settings.backgroundRotation) document.getElementById('background-rotation-toggle').classList.add('active');\r\nelse document.getElementById('background-rotation-toggle').classList.remove('active');\r\n\r\n// Rotating Cloaks\r\nif (settings.rotateCloaks) {\r\n    document.getElementById('rotate-toggle').classList.add('active');\r\n    document.getElementById('rotate-interval-row').style.display = 'flex';\r\n}\r\ndocument.getElementById('rotate-interval').value = settings.rotateInterval || 5;\r\n\r\n// Save handlers\r\ndocument.getElementById('cloak-mode').onchange = e => { settings.cloakMode = e.target.value; saveSettings(settings); };\r\n\r\ndocument.getElementById('bg-color').oninput = e => {\r\n    settings.background = { type: 'color', value: e.target.value };\r\n    saveSettings(settings);\r\n};\r\ndocument.getElementById('panic-url').oninput = e => { settings.panicUrl = e.target.value; saveSettings(settings); };\r\ndocument.getElementById('accent-color').oninput = e => { settings.accentColor = e.target.value; saveSettings(settings); };\r\ndocument.getElementById('surface-color').oninput = e => { settings.surfaceColor = e.target.value; saveSettings(settings); };\r\ndocument.getElementById('secondary-color').oninput = e => { settings.secondaryColor = e.target.value; saveSettings(settings); };\r\ndocument.getElementById('text-color').oninput = e => { settings.textColor = e.target.value; saveSettings(settings); };\r\ndocument.getElementById('text-secondary-color').oninput = e => { settings.textSecondaryColor = e.target.value; saveSettings(settings); };\r\ndocument.getElementById('text-dim-color').oninput = e => { settings.textDimColor = e.target.value; saveSettings(settings); };\r\ndocument.getElementById('surface-hover-color').oninput = e => { settings.surfaceHoverColor = e.target.value; saveSettings(settings); };\r\ndocument.getElementById('surface-active-color').oninput = e => { settings.surfaceActiveColor = e.target.value; saveSettings(settings); };\r\ndocument.getElementById('border-color').oninput = e => { settings.borderColor = e.target.value; saveSettings(settings); };\r\ndocument.getElementById('border-light-color').oninput = e => { settings.borderLightColor = e.target.value; saveSettings(settings); };\r\ndocument.getElementById('max-rating').onchange = e => { settings.maxMovieRating = e.target.value; saveSettings(settings); };\r\ndocument.getElementById('game-library').onchange = e => { settings.gameLibrary = e.target.value; saveSettings(settings); };\r\ndocument.getElementById('discord-toggle').onclick = function () { this.classList.toggle('active'); settings.discordWidget = this.classList.contains('active'); saveSettings(settings); };\r\ndocument.getElementById('miniplayer-toggle').onclick = function () { this.classList.toggle('active'); settings.miniplayer = this.classList.contains('active'); saveSettings(settings); };\r\ndocument.getElementById('leave-confirm-toggle').onclick = function () { this.classList.toggle('active'); settings.leaveConfirmation = this.classList.contains('active'); saveSettings(settings); };\r\ndocument.getElementById('changelog-toggle').onclick = function () { this.classList.toggle('active'); settings.showChangelogOnUpdate = this.classList.contains('active'); saveSettings(settings); };\r\ndocument.getElementById('theme-rotation-toggle').onclick = function () { this.classList.toggle('active'); settings.themeRotation = this.classList.contains('active'); saveSettings(settings); };\r\ndocument.getElementById('autoswitch-toggle').onclick = function () { this.classList.toggle('active'); settings.autoSwitchProviders = this.classList.contains('active'); saveSettings(settings); };\r\ndocument.getElementById('background-rotation-toggle').onclick = function () { this.classList.toggle('active'); settings.backgroundRotation = this.classList.contains('active'); saveSettings(settings); };\r\n\r\ndocument.getElementById('rotate-toggle').onclick = function () {\r\n    this.classList.toggle('active');\r\n    settings.rotateCloaks = this.classList.contains('active');\r\n    document.getElementById('rotate-interval-row').style.display = settings.rotateCloaks ? 'flex' : 'none';\r\n    saveSettings(settings);\r\n};\r\ndocument.getElementById('rotate-interval').onchange = e => {\r\n    let val = parseFloat(e.target.value);\r\n    if (val < 0.1) val = 0.1;\r\n    if (val > 30) val = 30;\r\n    settings.rotateInterval = val;\r\n    saveSettings(settings);\r\n};\r\n\r\n// Panic key\r\nlet capturing = false;\r\nconst panicKeyBtn = document.getElementById('panic-key');\r\npanicKeyBtn.onclick = () => { capturing = true; panicKeyBtn.classList.add('capturing'); panicKeyBtn.textContent = 'Press keys...'; };\r\ndocument.addEventListener('keydown', e => {\r\n    if (!capturing) return;\r\n    e.preventDefault();\r\n    const m = [];\r\n    if (e.ctrlKey) m.push('ctrl');\r\n    if (e.shiftKey) m.push('shift');\r\n    if (e.altKey) m.push('alt');\r\n    const k = e.key;\r\n    if (!['Control', 'Shift', 'Alt', 'Meta'].includes(k)) {\r\n        capturing = false;\r\n        panicKeyBtn.classList.remove('capturing');\r\n        panicKeyBtn.textContent = m.map(x => x.charAt(0).toUpperCase() + x.slice(1)).join(' + ') + (m.length ? ' + ' : '') + k;\r\n        settings.panicKey = k;\r\n        settings.panicModifiers = m;\r\n        saveSettings(settings);\r\n    }\r\n});\r\n\r\ndocument.getElementById('clear-cache').onclick = async () => {\r\n    if (!confirm('Clear all cached data? This will unregister service workers and clear secondary storage.')) return;\r\n\r\n    // 1. Clear Cache Storage\r\n    if ('caches' in window) {\r\n        try {\r\n            const keys = await caches.keys();\r\n            await Promise.all(keys.map(k => caches.delete(k)));\r\n        } catch (e) { console.error('Cache clear error:', e); }\r\n    }\r\n\r\n    // 2. Clear IndexedDB (used by proxies and games)\r\n    if ('indexedDB' in window) {\r\n        try {\r\n            if (indexedDB.databases) {\r\n                const dbs = await indexedDB.databases();\r\n                for (const db of dbs) {\r\n                    if (db.name) indexedDB.deleteDatabase(db.name);\r\n                }\r\n            } else {\r\n                ['scramjet-data', 'scrambase', 'ScramjetData', 'uv-data'].forEach(name => indexedDB.deleteDatabase(name));\r\n            }\r\n        } catch (e) { console.error('IDB clear error:', e); }\r\n    }\r\n\r\n    // 3. Unregister Service Workers\r\n    if ('serviceWorker' in navigator) {\r\n        try {\r\n            const regs = await navigator.serviceWorker.getRegistrations();\r\n            for (const reg of regs) {\r\n                await reg.unregister();\r\n            }\r\n        } catch (e) { console.error('SW unregister error:', e); }\r\n    }\r\n\r\n    if (window.Notify) Notify.success('Success', 'Cache cleared! Reloading...');\r\n    else alert('Cache cleared successfully! Reloading...');\r\n\r\n    setTimeout(() => location.reload(), 1000);\r\n};\r\ndocument.getElementById('reset-settings').onclick = () => {\r\n    if (!confirm('Reset all settings?')) return;\r\n    localStorage.removeItem(STORAGE_KEY);\r\n    location.reload();\r\n};\r\n\n</script>\r\n</body>\r\n\r\n</html>","pages/terms.html":"<!DOCTYPE html>\r\n<html lang=\"en\">\r\n\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n    <title>Terms of Service - Phantom</title>\r\n    <link rel=\"icon\" href=\"../favicon.svg\" type=\"image/svg+xml\">\r\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css\">\r\n    <style>\n/* phantom styling */\r\n\r\n@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');\r\n\r\n/* variables */\r\n:root {\r\n    /* Core colors (can be overridden by user settings) */\r\n    --bg: #0a0a0a;\r\n    --surface: #0f0f0f;\r\n    --surface-hover: #1a1a1a;\r\n    --surface-active: #252525;\r\n    --border: #1f1f1f;\r\n    --border-light: #2a2a2a;\r\n\r\n    /* Text */\r\n    --text: #e4e4e7;\r\n    --text-muted: #71717a;\r\n    --text-dim: #52525b;\r\n\r\n    /* Accent (customizable) */\r\n    --accent: #ffffff;\r\n    --accent-dim: rgba(255, 255, 255, 0.8);\r\n    --accent-glow: rgba(255, 255, 255, 0.1);\r\n\r\n    /* Status colors */\r\n    --success: #22c55e;\r\n    --warning: #f59e0b;\r\n    --error: #ef4444;\r\n    --info: #3b82f6;\r\n\r\n    /* Shadows */\r\n    --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.3);\r\n    --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.4);\r\n    --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.5);\r\n    --shadow-xl: 0 16px 48px rgba(0, 0, 0, 0.6);\r\n\r\n    /* Spacing */\r\n    --space-xs: 4px;\r\n    --space-sm: 8px;\r\n    --space-md: 16px;\r\n    --space-lg: 24px;\r\n    --space-xl: 32px;\r\n    --space-2xl: 48px;\r\n\r\n    /* Border radius */\r\n    --radius-sm: 4px;\r\n    --radius-md: 8px;\r\n    --radius-lg: 12px;\r\n    --radius-xl: 16px;\r\n    --radius-full: 9999px;\r\n\r\n    /* Transitions */\r\n    --transition-fast: 0.1s ease;\r\n    --transition-normal: 0.2s ease;\r\n    --transition-slow: 0.3s ease;\r\n\r\n    /* Z-index layers */\r\n    --z-base: 1;\r\n    --z-dropdown: 100;\r\n    --z-sticky: 500;\r\n    --z-modal: 1000;\r\n    --z-toast: 2000;\r\n    --z-max: 9999;\r\n\r\n    /* Typography */\r\n    --font-sans: 'Inter', system-ui, -apple-system, sans-serif;\r\n    --font-mono: 'JetBrains Mono', 'Fira Code', monospace;\r\n\r\n    /* Background (customizable) */\r\n    --bg-image: none;\r\n}\r\n\r\n/* base */\r\n*,\r\n*::before,\r\n*::after {\r\n    box-sizing: border-box;\r\n    margin: 0;\r\n    padding: 0;\r\n}\r\n\r\nhtml {\r\n    font-size: 16px;\r\n    scroll-behavior: smooth;\r\n    -webkit-font-smoothing: antialiased;\r\n    -moz-osx-font-smoothing: grayscale;\r\n}\r\n\r\nbody {\r\n    font-family: var(--font-sans);\r\n    background: var(--bg);\r\n    background-image: var(--bg-image);\r\n    background-size: cover;\r\n    background-position: var(--bg-image-position, center);\r\n    background-attachment: fixed;\r\n    color: var(--text);\r\n    line-height: 1.5;\r\n    min-height: 100vh;\r\n    overflow-x: hidden;\r\n}\r\n\r\n/* Ensure background manager takes precedence */\r\nhtml.phantom-bg-active body {\r\n    background: transparent !important;\r\n    background-image: none !important;\r\n}\r\n\r\n/* Selection */\r\n::selection {\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n}\r\n\r\n/* Focus states */\r\n:focus-visible {\r\n    outline: 2px solid var(--accent);\r\n    outline-offset: 2px;\r\n}\r\n\r\n/* Links */\r\na {\r\n    color: var(--accent);\r\n    text-decoration: none;\r\n    transition: opacity var(--transition-fast);\r\n}\r\n\r\na:hover {\r\n    opacity: 0.8;\r\n}\r\n\r\n/* Scrollbar */\r\n::-webkit-scrollbar {\r\n    width: 8px;\r\n    height: 8px;\r\n}\r\n\r\n::-webkit-scrollbar-track {\r\n    background: var(--surface);\r\n}\r\n\r\n::-webkit-scrollbar-thumb {\r\n    background: var(--border-light);\r\n    border-radius: var(--radius-full);\r\n}\r\n\r\n::-webkit-scrollbar-thumb:hover {\r\n    background: var(--text-muted);\r\n}\r\n\r\n/* text */\r\nh1,\r\nh2,\r\nh3,\r\nh4,\r\nh5,\r\nh6 {\r\n    font-weight: 600;\r\n    line-height: 1.2;\r\n    color: var(--text);\r\n}\r\n\r\nh1 {\r\n    font-size: 2.5rem;\r\n}\r\n\r\nh2 {\r\n    font-size: 2rem;\r\n}\r\n\r\nh3 {\r\n    font-size: 1.5rem;\r\n}\r\n\r\nh4 {\r\n    font-size: 1.25rem;\r\n}\r\n\r\nh5 {\r\n    font-size: 1rem;\r\n}\r\n\r\nh6 {\r\n    font-size: 0.875rem;\r\n}\r\n\r\np {\r\n    color: var(--text-muted);\r\n    line-height: 1.6;\r\n}\r\n\r\n.text-sm {\r\n    font-size: 0.875rem;\r\n}\r\n\r\n.text-xs {\r\n    font-size: 0.75rem;\r\n}\r\n\r\n.text-lg {\r\n    font-size: 1.125rem;\r\n}\r\n\r\n.text-muted {\r\n    color: var(--text-muted);\r\n}\r\n\r\n.text-dim {\r\n    color: var(--text-dim);\r\n}\r\n\r\n.text-center {\r\n    text-align: center;\r\n}\r\n\r\n/* buttons */\r\n.btn {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    gap: var(--space-sm);\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-family: var(--font-sans);\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-md);\r\n    background: var(--surface);\r\n    color: var(--text);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n    white-space: nowrap;\r\n}\r\n\r\n.btn:hover {\r\n    background: var(--surface-hover);\r\n    border-color: var(--border-light);\r\n}\r\n\r\n.btn:active {\r\n    background: var(--surface-active);\r\n    transform: scale(0.98);\r\n}\r\n\r\n.btn-primary {\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n    border-color: var(--accent);\r\n}\r\n\r\n.btn-primary:hover {\r\n    opacity: 0.9;\r\n    background: var(--accent);\r\n}\r\n\r\n.btn-ghost {\r\n    background: transparent;\r\n    border-color: transparent;\r\n}\r\n\r\n.btn-ghost:hover {\r\n    background: var(--surface-hover);\r\n}\r\n\r\n.btn-icon {\r\n    width: 36px;\r\n    height: 36px;\r\n    padding: 0;\r\n    border-radius: var(--radius-md);\r\n}\r\n\r\n.btn-sm {\r\n    padding: var(--space-xs) var(--space-sm);\r\n    font-size: 0.75rem;\r\n}\r\n\r\n.btn-lg {\r\n    padding: var(--space-md) var(--space-lg);\r\n    font-size: 1rem;\r\n}\r\n\r\n/* inputs */\r\n.input {\r\n    width: 100%;\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-family: var(--font-sans);\r\n    font-size: 0.875rem;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-md);\r\n    color: var(--text);\r\n    transition: border-color var(--transition-fast);\r\n}\r\n\r\n.input:hover {\r\n    border-color: var(--border-light);\r\n}\r\n\r\n.input:focus {\r\n    outline: none;\r\n    border-color: var(--accent);\r\n}\r\n\r\n.input::placeholder {\r\n    color: var(--text-dim);\r\n}\r\n\r\n.input-group {\r\n    display: flex;\r\n    gap: var(--space-sm);\r\n}\r\n\r\n.input-group .input {\r\n    flex: 1;\r\n}\r\n\r\n/* Select */\r\n.select {\r\n    appearance: none;\r\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%2371717a' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E\");\r\n    background-repeat: no-repeat;\r\n    background-position: right 12px center;\r\n    padding-right: 36px;\r\n    cursor: pointer;\r\n}\r\n\r\n/* Checkbox/Toggle */\r\n.toggle {\r\n    position: relative;\r\n    width: 44px;\r\n    height: 24px;\r\n    background: var(--border);\r\n    border-radius: var(--radius-full);\r\n    cursor: pointer;\r\n    transition: background var(--transition-fast);\r\n}\r\n\r\n.toggle::after {\r\n    content: '';\r\n    position: absolute;\r\n    top: 2px;\r\n    left: 2px;\r\n    width: 20px;\r\n    height: 20px;\r\n    background: var(--text);\r\n    border-radius: 50%;\r\n    transition: transform var(--transition-fast);\r\n}\r\n\r\n.toggle.active {\r\n    background: var(--accent);\r\n}\r\n\r\n.toggle.active::after {\r\n    transform: translateX(20px);\r\n    background: var(--bg);\r\n}\r\n\r\n/* cards */\r\n.card {\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-lg);\r\n    overflow: hidden;\r\n    transition: all var(--transition-normal);\r\n}\r\n\r\n.card:hover {\r\n    border-color: var(--border-light);\r\n    box-shadow: var(--shadow-md);\r\n}\r\n\r\n.card-header {\r\n    padding: var(--space-md);\r\n    border-bottom: 1px solid var(--border);\r\n}\r\n\r\n.card-body {\r\n    padding: var(--space-md);\r\n}\r\n\r\n.card-footer {\r\n    padding: var(--space-md);\r\n    border-top: 1px solid var(--border);\r\n}\r\n\r\n\r\n/* Featured badge */\r\n.badge-featured {\r\n    position: absolute;\r\n    top: var(--space-sm);\r\n    left: var(--space-sm);\r\n    padding: var(--space-xs) var(--space-sm);\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n    font-size: 0.625rem;\r\n    font-weight: 700;\r\n    text-transform: uppercase;\r\n    letter-spacing: 0.05em;\r\n    border-radius: var(--radius-sm);\r\n}\r\n\r\n/* Favorite star */\r\n.favorite-btn {\r\n    position: absolute;\r\n    top: var(--space-sm);\r\n    right: var(--space-sm);\r\n    width: 32px;\r\n    height: 32px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background: rgba(0, 0, 0, 0.5);\r\n    border: none;\r\n    border-radius: 50%;\r\n    color: var(--text-muted);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n    opacity: 0;\r\n}\r\n\r\n.media-card:hover .favorite-btn {\r\n    opacity: 1;\r\n}\r\n\r\n.favorite-btn:hover {\r\n    background: rgba(0, 0, 0, 0.7);\r\n    color: var(--text);\r\n}\r\n\r\n.favorite-btn.active {\r\n    color: #fbbf24;\r\n    opacity: 1;\r\n}\r\n\r\n/* grid */\r\n.grid {\r\n    display: grid;\r\n    gap: var(--space-md);\r\n}\r\n\r\n.grid-cols-2 {\r\n    grid-template-columns: repeat(2, 1fr);\r\n}\r\n\r\n.grid-cols-3 {\r\n    grid-template-columns: repeat(3, 1fr);\r\n}\r\n\r\n.grid-cols-4 {\r\n    grid-template-columns: repeat(4, 1fr);\r\n}\r\n\r\n.grid-cols-5 {\r\n    grid-template-columns: repeat(5, 1fr);\r\n}\r\n\r\n.grid-cols-6 {\r\n    grid-template-columns: repeat(6, 1fr);\r\n}\r\n\r\n/* Auto-fit grid for responsive cards */\r\n.grid-auto {\r\n    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));\r\n}\r\n\r\n.grid-auto-lg {\r\n    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\r\n}\r\n\r\n/* flex */\r\n.flex {\r\n    display: flex;\r\n}\r\n\r\n.flex-col {\r\n    flex-direction: column;\r\n}\r\n\r\n.flex-wrap {\r\n    flex-wrap: wrap;\r\n}\r\n\r\n.items-center {\r\n    align-items: center;\r\n}\r\n\r\n.items-start {\r\n    align-items: flex-start;\r\n}\r\n\r\n.items-end {\r\n    align-items: flex-end;\r\n}\r\n\r\n.justify-center {\r\n    justify-content: center;\r\n}\r\n\r\n.justify-between {\r\n    justify-content: space-between;\r\n}\r\n\r\n.justify-end {\r\n    justify-content: flex-end;\r\n}\r\n\r\n.gap-xs {\r\n    gap: var(--space-xs);\r\n}\r\n\r\n.gap-sm {\r\n    gap: var(--space-sm);\r\n}\r\n\r\n.gap-md {\r\n    gap: var(--space-md);\r\n}\r\n\r\n.gap-lg {\r\n    gap: var(--space-lg);\r\n}\r\n\r\n.flex-1 {\r\n    flex: 1;\r\n}\r\n\r\n/* spacing */\r\n.p-xs {\r\n    padding: var(--space-xs);\r\n}\r\n\r\n.p-sm {\r\n    padding: var(--space-sm);\r\n}\r\n\r\n.p-md {\r\n    padding: var(--space-md);\r\n}\r\n\r\n.p-lg {\r\n    padding: var(--space-lg);\r\n}\r\n\r\n.p-xl {\r\n    padding: var(--space-xl);\r\n}\r\n\r\n.m-xs {\r\n    margin: var(--space-xs);\r\n}\r\n\r\n.m-sm {\r\n    margin: var(--space-sm);\r\n}\r\n\r\n.m-md {\r\n    margin: var(--space-md);\r\n}\r\n\r\n.m-lg {\r\n    margin: var(--space-lg);\r\n}\r\n\r\n.mt-sm {\r\n    margin-top: var(--space-sm);\r\n}\r\n\r\n.mt-md {\r\n    margin-top: var(--space-md);\r\n}\r\n\r\n.mt-lg {\r\n    margin-top: var(--space-lg);\r\n}\r\n\r\n.mb-sm {\r\n    margin-bottom: var(--space-sm);\r\n}\r\n\r\n.mb-md {\r\n    margin-bottom: var(--space-md);\r\n}\r\n\r\n.mb-lg {\r\n    margin-bottom: var(--space-lg);\r\n}\r\n\r\n/* modals */\r\n.modal-overlay {\r\n    position: fixed;\r\n    inset: 0;\r\n    background: rgba(0, 0, 0, 0.8);\r\n    backdrop-filter: blur(4px);\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    z-index: var(--z-modal);\r\n    opacity: 0;\r\n    visibility: hidden;\r\n    transition: all var(--transition-normal);\r\n}\r\n\r\n.modal-overlay.show {\r\n    opacity: 1;\r\n    visibility: visible;\r\n}\r\n\r\n.modal {\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-xl);\r\n    max-width: 90vw;\r\n    max-height: 90vh;\r\n    overflow: hidden;\r\n    transform: scale(0.95);\r\n    transition: transform var(--transition-normal);\r\n}\r\n\r\n.modal-overlay.show .modal {\r\n    transform: scale(1);\r\n}\r\n\r\n.modal-header {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    padding: var(--space-md);\r\n    border-bottom: 1px solid var(--border);\r\n}\r\n\r\n.modal-title {\r\n    font-size: 1rem;\r\n    font-weight: 600;\r\n}\r\n\r\n.modal-close {\r\n    width: 32px;\r\n    height: 32px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background: transparent;\r\n    border: none;\r\n    color: var(--text-muted);\r\n    cursor: pointer;\r\n    border-radius: var(--radius-md);\r\n    transition: all var(--transition-fast);\r\n}\r\n\r\n.modal-close:hover {\r\n    background: var(--surface-hover);\r\n    color: var(--text);\r\n}\r\n\r\n.modal-body {\r\n    padding: var(--space-md);\r\n    overflow-y: auto;\r\n}\r\n\r\n.modal-footer {\r\n    display: flex;\r\n    justify-content: flex-end;\r\n    gap: var(--space-sm);\r\n    padding: var(--space-md);\r\n    border-top: 1px solid var(--border);\r\n}\r\n\r\n/* tabs */\r\n.tabs {\r\n    display: flex;\r\n    gap: 2px;\r\n    background: var(--surface);\r\n    padding: var(--space-xs);\r\n    border-radius: var(--radius-md);\r\n    border: 1px solid var(--border);\r\n}\r\n\r\n.tab {\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    color: var(--text-muted);\r\n    background: transparent;\r\n    border: none;\r\n    border-radius: var(--radius-sm);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n}\r\n\r\n.tab:hover {\r\n    color: var(--text);\r\n}\r\n\r\n.tab.active {\r\n    background: var(--surface-hover);\r\n    color: var(--text);\r\n}\r\n\r\n/* search */\r\n\r\n/* ============================================\r\n   OFFLINE INDICATOR\r\n   ============================================ */\r\n.offline-banner {\r\n    position: fixed;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    padding: var(--space-sm) var(--space-md);\r\n    background: var(--warning);\r\n    color: var(--bg);\r\n    text-align: center;\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    z-index: var(--z-toast);\r\n    transform: translateY(-100%);\r\n    transition: transform var(--transition-normal);\r\n}\r\n\r\n.offline-banner.show {\r\n    transform: translateY(0);\r\n}\r\n\r\n.offline-badge {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    gap: var(--space-xs);\r\n    padding: var(--space-xs) var(--space-sm);\r\n    background: var(--warning);\r\n    color: var(--bg);\r\n    font-size: 0.625rem;\r\n    font-weight: 600;\r\n    text-transform: uppercase;\r\n    border-radius: var(--radius-sm);\r\n}\r\n\r\n/* ============================================\r\n   LOADING STATES\r\n   ============================================ */\r\n.skeleton {\r\n    background: linear-gradient(90deg, var(--surface) 0%, var(--surface-hover) 50%, var(--surface) 100%);\r\n    background-size: 200% 100%;\r\n    animation: shimmer 1.5s infinite;\r\n    border-radius: var(--radius-md);\r\n}\r\n\r\n@keyframes shimmer {\r\n    0% {\r\n        background-position: 200% 0;\r\n    }\r\n\r\n    100% {\r\n        background-position: -200% 0;\r\n    }\r\n}\r\n\r\n.spinner {\r\n    width: 24px;\r\n    height: 24px;\r\n    border: 2px solid var(--border);\r\n    border-top-color: var(--accent);\r\n    border-radius: 50%;\r\n    animation: spin 0.8s linear infinite;\r\n}\r\n\r\n@keyframes spin {\r\n    to {\r\n        transform: rotate(360deg);\r\n    }\r\n}\r\n\r\n/* ============================================\r\n   ANIMATIONS\r\n   ============================================ */\r\n@keyframes fadeIn {\r\n    from {\r\n        opacity: 0;\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n    }\r\n}\r\n\r\n@keyframes slideUp {\r\n    from {\r\n        opacity: 0;\r\n        transform: translateY(10px);\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n        transform: translateY(0);\r\n    }\r\n}\r\n\r\n@keyframes scaleIn {\r\n    from {\r\n        opacity: 0;\r\n        transform: scale(0.95);\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n        transform: scale(1);\r\n    }\r\n}\r\n\r\n.animate-fadeIn {\r\n    animation: fadeIn var(--transition-normal) ease;\r\n}\r\n\r\n.animate-slideUp {\r\n    animation: slideUp var(--transition-normal) ease;\r\n}\r\n\r\n.animate-scaleIn {\r\n    animation: scaleIn var(--transition-normal) ease;\r\n}\r\n\r\n/* ============================================\r\n   UTILITIES\r\n   ============================================ */\r\n.hidden {\r\n    display: none !important;\r\n}\r\n\r\n.sr-only {\r\n    position: absolute;\r\n    width: 1px;\r\n    height: 1px;\r\n    padding: 0;\r\n    margin: -1px;\r\n    overflow: hidden;\r\n    clip: rect(0, 0, 0, 0);\r\n    border: 0;\r\n}\r\n\r\n.truncate {\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n}\r\n\r\n.w-full {\r\n    width: 100%;\r\n}\r\n\r\n.h-full {\r\n    height: 100%;\r\n}\r\n\r\n.relative {\r\n    position: relative;\r\n}\r\n\r\n.absolute {\r\n    position: absolute;\r\n}\r\n\r\n.fixed {\r\n    position: fixed;\r\n}\r\n\r\n.inset-0 {\r\n    inset: 0;\r\n}\r\n\r\n/* ============================================\r\n   RESPONSIVE\r\n   ============================================ */\r\n@media (max-width: 768px) {\r\n    h1 {\r\n        font-size: 1.75rem;\r\n    }\r\n\r\n    h2 {\r\n        font-size: 1.5rem;\r\n    }\r\n\r\n    h3 {\r\n        font-size: 1.25rem;\r\n    }\r\n\r\n    .grid-auto {\r\n        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));\r\n    }\r\n\r\n    .hide-mobile {\r\n        display: none !important;\r\n    }\r\n}\r\n\r\n@media (min-width: 769px) {\r\n    .hide-desktop {\r\n        display: none !important;\r\n    }\r\n}\n</style>\r\n    <style>\n/* Topbar Styles - Clean & Dark */\r\n/* Note: Inter font is imported in main.css */\r\n\r\nbody {\r\n    margin: 0;\r\n    padding: 0;\r\n    background-color: var(--bg);\r\n    font-family: 'Inter', sans-serif;\r\n}\r\n\r\n#topbar-container {\r\n    position: fixed;\r\n    top: 11px;\r\n    left: 50%;\r\n    transform: translateX(-50%);\r\n    background-color: var(--surface);\r\n    border-radius: 9999px;\r\n    padding: 8px 14px;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 10px;\r\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);\r\n    z-index: 10000;\r\n    border: 1px solid var(--border);\r\n    height: 48px;\r\n    box-sizing: border-box;\r\n}\r\n\r\n#topbar-container::before {\r\n    content: '';\r\n    position: absolute;\r\n    top: -7px;\r\n    bottom: -7px;\r\n    left: -7px;\r\n    right: -7px;\r\n    z-index: -1;\r\n    border-radius: 9999px;\r\n}\r\n\r\n.logo-section {\r\n    display: flex;\r\n    align-items: center;\r\n    padding-right: 10px;\r\n    border-right: 1px solid var(--border);\r\n    height: 32px;\r\n    text-decoration: none;\r\n    color: inherit;\r\n}\r\n\r\n.logo-placeholder {\r\n    width: 28px;\r\n    height: 28px;\r\n    background-color: var(--surface-hover);\r\n    border-radius: 6px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    color: var(--text-muted);\r\n}\r\n\r\n.logo-placeholder i,\r\n.logo-placeholder svg {\r\n    width: 16px;\r\n    height: 16px;\r\n}\r\n\r\n.nav-buttons {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 4px;\r\n}\r\n\r\n.nav-separator {\r\n    width: 1px;\r\n    height: 20px;\r\n    background-color: var(--border);\r\n    margin: 0 6px;\r\n}\r\n\r\n.nav-btn {\r\n    background: transparent;\r\n    border: none;\r\n    color: var(--text-muted);\r\n    text-decoration: none;\r\n    display: flex;\r\n    align-items: center;\r\n    padding: 6px 10px;\r\n    border-radius: 99px;\r\n    height: 32px;\r\n    box-sizing: border-box;\r\n    transition: color 0.15s, background-color 0.15s;\r\n    position: relative;\r\n}\r\n\r\n.nav-badge-beta {\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n    font-size: 8px;\r\n    font-weight: 700;\r\n    color: var(--text);\r\n    background: var(--secondary);\r\n    padding: 2px 4px;\r\n    border-radius: 4px;\r\n    line-height: 1;\r\n    transform: translate(20%, -20%);\r\n    pointer-events: none;\r\n}\r\n\r\n.nav-btn:hover {\r\n    color: var(--text);\r\n    background-color: var(--surface-hover);\r\n}\r\n\r\n.nav-btn i,\r\n.nav-btn svg {\r\n    width: 18px;\r\n    height: 18px;\r\n    min-width: 18px;\r\n}\r\n\r\n.nav-btn span {\r\n    max-width: 0;\r\n    opacity: 0;\r\n    margin-left: 0;\r\n    overflow: hidden;\r\n    white-space: nowrap;\r\n    font-weight: 500;\r\n    font-size: 13px;\r\n    transition: max-width 0.23s ease, opacity 0.17s ease, margin-left 0.23s ease;\r\n}\r\n\r\n#topbar-container:hover .nav-btn span {\r\n    max-width: 70px;\r\n    opacity: 1;\r\n    margin-left: 8px;\r\n}\n</style>\r\n    <style>\n/**\r\n * PHANTOM - BACKGROUND STYLES\r\n */\r\n.phantom-background {\r\n    position: fixed;\r\n    inset: 0;\r\n    width: 100vw;\r\n    height: 100vh;\r\n    z-index: -1;\r\n    overflow: hidden;\r\n    background: transparent;\r\n    pointer-events: none;\r\n    opacity: 1;\r\n    transition: background-color 0.3s ease;\r\n}\r\n\r\n.phantom-background.active {\r\n    opacity: 1;\r\n}\r\n\r\n.phantom-background-overlay {\r\n    position: absolute;\r\n    inset: 0;\r\n    z-index: 2;\r\n    background: rgba(0, 0, 0, var(--bg-overlay, 0.4));\r\n    transition: background-color 0.3s ease;\r\n}\r\n\r\n.phantom-background-layer {\r\n    position: absolute;\r\n    inset: 0;\r\n    z-index: 1;\r\n    transition: opacity 0.3s ease-in-out;\r\n}\r\n\r\n.phantom-background-media {\r\n    width: 100%;\r\n    height: 100%;\r\n    object-fit: cover;\r\n    object-position: var(--bg-image-position, center);\r\n    display: block;\r\n    border: none;\r\n}\r\n\r\n/* Video and Iframe positioning for full background cover */\r\n.phantom-background-layer video.phantom-background-media,\r\n.phantom-background-layer iframe.phantom-background-media {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    transform: none;\r\n    pointer-events: none;\r\n    min-width: 100%;\r\n    min-height: 100%;\r\n    max-width: none;\r\n    max-height: none;\r\n    object-position: var(--bg-image-position, center);\r\n}\r\n\r\n/* Ensure iframes cover entire background */\r\n.phantom-background-layer iframe.phantom-background-media {\r\n    border: none;\r\n    object-fit: cover;\r\n}\r\n\r\n/* Ensure content on top remains readable */\r\nhtml {\r\n    background-color: var(--bg);\r\n}\r\n\r\nbody {\r\n    position: relative;\r\n    z-index: 0;\r\n    background: transparent !important;\r\n    /* Allow background to show through */\r\n}\r\n\r\n/* Specific adjustments for transparency if needed */\r\n.main-content,\r\n.home-page {\r\n    background: transparent !important;\r\n}\r\n\r\n/* Glassmorphism for containers when background is active */\r\n.phantom-background.active~.offline-banner,\r\n.phantom-background.active~.home-page .card,\r\n.phantom-background.active~.home-page .featured-card,\r\n.phantom-background.active~.home-page .search-bar,\r\n.phantom-background.active~.settings-panel {\r\n    backdrop-filter: blur(10px);\r\n    -webkit-backdrop-filter: blur(10px);\r\n    background: rgba(15, 15, 15, 0.7) !important;\r\n}\n</style>\r\n</head>\r\n\r\n<body>\r\n    <script>\n// site config\r\n\r\nwindow.SITE_CONFIG = {\r\n    name: \"Phantom\",\r\n    fullName: \"Phantom Unblocked\",\r\n    version: \"1.0.12\",\r\n\r\n    changelog: [\r\n        \"1.0.12: tiny fixxes and changes\",\r\n        \"some code consolidation and fixxes\",\r\n        \"suggest features in the discord server\"\r\n    ],\r\n\r\n    // quotes\r\n    quotes: [\r\n        \"lebron lebron lebronn james\",\r\n        \"so tuff\",\r\n        \"it is what it is\",\r\n        \"do ur work\",\r\n        \"this is what happens when u dont touch grass\",\r\n        \"FULL BOX\",\r\n        \"FULL PIECE\",\r\n        \"200!\",\r\n        \"press esc + refresh + power button for hacks\",\r\n        \"press ctrl+x to hide your screen\",\r\n        \"change the tab title and favicon in settings\",\r\n        \"TEACHERR!\",\r\n        \"1 pump\",\r\n        \"303 headshot\",\r\n        \"bros prolly a 60 ovr\",\r\n        \"take the L lil bro\",  \r\n        \"lebron is OUR goat\",\r\n        \"stop looking at my screen\",\r\n    ],\r\n\r\n    // todo\r\n    // *** for strikethrough\r\n    // ** for bold\r\n    todos: [\r\n        \"***fixxed aboutblank opening while securly is on (previously if popups were off it would load intab instead of clickto launch now it will use clicktolaunch unless popups are blocked)***\",\r\n        \"***fix the proxy***\",\r\n        \"***fix panic panickey, add quote talking about it***\",\r\n        \"***fix theatermode, make it hide buttons after a few seconds and ensure all content is being displayed and move the description to the bottom***\",\r\n        \"***change back player to use old styling, change the surface to use background colors for the bottom part where description is shown, looking just like the background***\",\r\n        \"***add image and video support for backgrounds***\",\r\n        \"***fix aichat, make the title use the same ai request as the users question unless its in image mode where it will use text mode and fix ai chat to remember modes better***\",\r\n        \"***add cloaking to quotes***\",\r\n        \"***add a default cloak and fix it so icons work in aboutblank for whatever reason they only work when you go to settings in aboutblank where it correctly applies***\",\r\n        \"***for search suggestions add highlighting for whatever will happen when you click enter, in search suggestions fix all games not sending you to the games page***\",\r\n        \"***fix games to make multi library the default, put it in config.js***\",\r\n        \"***rename movies shortcut in index2.html to primeshows, add shortcuts to main pages in the topbar and change the current shortcuts to more popular games***\",\r\n        \"***make announcements show even on first visit unlike changelog and allow disabling it via settings***\",\r\n        \"***fix leave comformation asking u to leave each time you click something***\",\r\n        \"***change the shortcuts on the main page to include pages***\",\r\n        \"***add movies to the search bar in main page***\",\r\n        \"***fix background not turning off soon***\",\r\n        \"***fix music page to hide youtube player unless toggled via 3 dot small button, and always shown on proxy mode, fix all the controls for video time, volume***\",\r\n        \"**add singlefile this is lowk so hard i dont really understand it**\",\r\n        \"**advertise phantom (too much work tbh)**\",\r\n        \"**add a watch page for youtube and twitch**\",\r\n        \"**add a miniplayer for music**\",\r\n        \"***shorten some page's code***\",\r\n        \"***fix paths in search autocomplete***\",\r\n        \"***fix markdown in ai not using correct text colors***\",\r\n        \"***make backgrounds show in the loading screen***\",\r\n        \"***fix icons for topbar in code.html***\",\r\n        \"**fix wisp server not notifying or autoswitiching when offline in proxy**\",\r\n        \"***fix code runner open not working at all***\",\r\n        \"***make backgrounds show in player.html***\",\r\n        \"***make backgrounds show in staticsjv2***\",\r\n        \"***make player.html player controls use theme colros not hardcoded***\",\r\n        \"***make ai chat and music sidebar go all the way down and up with borders***\",\r\n        \"**make the only song in music be lebron lebron lebron james**\",\r\n        \"**fix music controls**\",\r\n        \"***finish extra page into credits and make this todo be tucked away somewhere and not the main part of it***\"\r\n    ],\r\n    defaultWisp: \"wss://glseries.net/wisp/\",\r\n    wispServers: [\r\n        { name: \"GLSeries Wisp\", url: \"wss://glseries.net/wisp/\" },\r\n        { name: \"Rhw's Wisp\", url: \"wss://wisp.rhw.one/\" },\r\n    ],\r\n\r\n    discord: {\r\n        inviteUrl: \"https://discord.gg/tHWx9NXp5p\",\r\n        widgetServer: \"1447673724017971324\",\r\n        widgetChannel: \"1447673726228496617\",\r\n    },\r\n\r\n    firstVisitCloak: false, //fake error page\r\n    defaults: {\r\n        cloakMode: \"about:blank\",\r\n        tabTitle: \"You've already responded\",\r\n        tabFavicon: \"https://ssl.gstatic.com/docs/spreadsheets/forms/forms_icon_2023q4.ico\",\r\n        cloakRotation: false,\r\n        cloakInterval: 5000,\r\n        panicKey: \"x\",\r\n        panicModifiers: [\"ctrl\", \"shift\"],\r\n        panicUrl: \"https://classroom.google.com\",\r\n        maxMovieRating: \"R\",\r\n        gameLibrary: \"multi\",\r\n        discordWidget: true,\r\n        miniplayer: true,\r\n        leaveConfirmation: false,\r\n        showChangelogOnUpdate: true,\r\n        themeRotation: true,\r\n        lastThemeRotation: 0,\r\n        backgroundRotation: true,\r\n        lastBackgroundRotation: 0,\r\n        lastSeenFeatured: 'none',\r\n        background: { type: 'color', value: '#0a0a0a' },\r\n        customBackground: { id: 'none', type: 'none' },\r\n        accentColor: '#ffffff',\r\n        surfaceColor: '#0f0f0f',\r\n        secondaryColor: '#2e2e33',\r\n        textColor: '#e4e4e7',\r\n    },\r\n\r\n    themePresets: {\r\n        dark: { name: 'Dark (Default)', bg: { type: 'color', value: '#0a0a0a' }, surface: '#0f0f0f', surfaceHover: '#1a1a1a', surfaceActive: '#252525', secondary: '#2e2e33', border: '#2a2a2a', borderLight: '#2a2a2a', text: '#e4e4e7', textSec: '#71717a', textDim: '#52525b', accent: '#ffffff' },\r\n        midnight: { name: 'Midnight', bg: { type: 'color', value: '#000000' }, surface: '#050505', surfaceHover: '#111111', surfaceActive: '#1a1a1a', secondary: '#111111', border: '#1a1a1a', borderLight: '#111111', text: '#ededed', textSec: '#a3a3a3', textDim: '#737373', accent: '#d4d4d4' },\r\n        abyss: { name: 'Abyss', bg: { type: 'color', value: '#020617' }, surface: '#0f172a', surfaceHover: '#1e293b', surfaceActive: '#334155', secondary: '#1e293b', border: '#1e293b', borderLight: '#1e293b', text: '#f1f5f9', textSec: '#94a3b8', textDim: '#64748b', accent: '#38bdf8' },\r\n        phantom: { name: 'Phantom', bg: { type: 'color', value: '#0f0a14' }, surface: '#1a0f24', surfaceHover: '#2e1a40', surfaceActive: '#4c2a5c', secondary: '#2e1a40', border: '#2e1a40', borderLight: '#2e1a40', text: '#f3e8ff', textSec: '#d8b4fe', textDim: '#c084fc', accent: '#c084fc' },\r\n        rosepine: { name: 'Rose Pine', bg: { type: 'color', value: '#191724' }, surface: '#1f1d2e', surfaceHover: '#26233a', surfaceActive: '#524f67', secondary: '#26233a', border: '#26233a', borderLight: '#1f1d2e', text: '#e0def4', textSec: '#908caa', textDim: '#6e6a86', accent: '#ebbcba' },\r\n        ocean: { name: 'Oceanic', bg: { type: 'color', value: '#011627' }, surface: '#0b2942', surfaceHover: '#1d3b53', surfaceActive: '#2d4b63', secondary: '#0b2942', border: '#1d3b53', borderLight: '#0b2942', text: '#d6deeb', textSec: '#5f7e97', textDim: '#011627', accent: '#7fdbca' },\r\n        forest: { name: 'Forest', bg: { type: 'color', value: '#020d06' }, surface: '#051a0d', surfaceHover: '#0a2e17', surfaceActive: '#0f4221', secondary: '#051a0d', border: '#0a2e17', borderLight: '#051a0d', text: '#ecfdf5', textSec: '#6ee7b7', textDim: '#064e3b', accent: '#10b981' },\r\n        crimson: { name: 'Crimson', bg: { type: 'color', value: '#1a0505' }, surface: '#230a0a', surfaceHover: '#7b0a0aff', surfaceActive: '#7f1d1d', secondary: '#230a0a', border: '#480f0fff', borderLight: '#230a0a', text: '#fef2f2', textSec: '#fecaca', textDim: '#450a0a', accent: '#ef4444' },\r\n        flame: { name: 'Flame', bg: { type: 'color', value: '#0c0202' }, surface: '#1c0a0a', surfaceHover: '#451a03', surfaceActive: '#9a3412', secondary: '#1c0a0a', border: '#451a03', borderLight: '#9a3412', text: '#fff7ed', textSec: '#fdba74', textDim: '#ea580c', accent: '#f59e0b' }\r\n    },\r\n\r\n    backgroundPresets: [\r\n        { id: 'none', name: 'None (Theme Default)', type: 'none' },\r\n        { id: 'Night sky', name: 'Night sky', type: 'image', url: 'https://images.pexels.com/photos/5675745/pexels-photo-5675745.jpeg', overlay: 0.3 },\r\n        { id: 'winter-mountains', name: 'Winter mountains', type: 'image', url: 'https://images.pexels.com/photos/1287145/pexels-photo-1287145.jpeg', overlay: 0.3 },\r\n        { id: 'f1 car', name: 'F1 Car', type: 'image', url: 'https://images.pexels.com/photos/14401632/pexels-photo-14401632.jpeg', overlay: 0.3 },\r\n        { id: 'moon-landing', name: 'Moon Landing', type: 'image', url: 'https://images.pexels.com/photos/41162/moon-landing-apollo-11-nasa-buzz-aldrin-41162.jpeg', overlay: 0.3, objectPosition: 'top left', active: true },\r\n        { id: 'turtle', name: 'Turtle', type: 'image', url: 'https://images.unsplash.com/photo-1501791187590-9ef2612ba1eb?q=80&w=1932&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D', overlay: 0.3 },\r\n        { id: 'road', name: 'Road', type: 'image', url: 'https://images.unsplash.com/photo-1508233620467-f79f1e317a05', overlay: 0.3 },\r\n        { id: 'railroad', name: 'Railroad', type: 'image', url: 'https://images.unsplash.com/photo-1505832018823-50331d70d237', overlay: 0.3 },\r\n        { id: 'mountain', name: 'Mountain', type: 'image', url: 'https://raw.githubusercontent.com/evanhnry/brave-wallpapers/refs/heads/main/Brave/clay-banks-u27Rrbs9Dwc-unsplash.jpg', overlay: 0.3 },\r\n    ],\r\n\r\n    cloakPresets: [\r\n        { name: \"Phantom\", icon: \"/favicon.svg\", title: \"Phantom Unblocked\" },\r\n        { name: \"Edpuzzle\", icon: \"https://edpuzzle.imgix.net/favicons/favicon-32.png\", title: \"Edpuzzle\" },\r\n        { name: \"Google Docs\", icon: \"https://ssl.gstatic.com/docs/documents/images/kix-favicon7.ico\", title: \"Untitled document - Google Docs\" },\r\n        { name: \"Canvas\", icon: \"https://du11hjcvx0uqb.cloudfront.net/dist/images/favicon-e10d657a73.ico\", title: \"Dashboard\" },\r\n        { name: \"Desmos\", icon: \"https://www.desmos.com/favicon.ico\", title: \"Desmos | Graphing Calculator\" },\r\n        { name: \"Khan Academy\", icon: \"https://cdn.kastatic.org/images/favicon.ico\", title: \"Khan Academy\" },\r\n        { name: \"Wikipedia\", icon: \"https://en.wikipedia.org/favicon.ico\", title: \"World War II - Wikipedia\" },\r\n        { name: \"Classroom\", icon: \"https://ssl.gstatic.com/classroom/favicon.png\", title: \"Home - Classroom\" },\r\n        { name: \"Canva\", icon: \"https://static.canva.com/static/images/android-192x192-2.png\", title: \"Home - Canva\" },\r\n        { name: \"Quiz\", icon: \"https://ssl.gstatic.com/docs/spreadsheets/forms/forms_icon_2023q4.ico\", title: \"You've already responded\" },\r\n        { name: \"Blooket\", icon: \"https://play.blooket.com/favicon.ico\", title: \"Play Blooket | Blooket\" },\r\n        { name: \"Gmail\", icon: \"https://ssl.gstatic.com/ui/v1/icons/mail/rfr/gmail.ico\", title: \"Gmail\" },\r\n        { name: \"YouTube\", icon: \"https://www.youtube.com/favicon.ico\", title: \"YouTube\" },\r\n        { name: \"Powerschool\", icon: \"https://waverlyk12.powerschool.com/favicon.ico\", title: \"Grades and Attendance\" },\r\n        { name: \"nothing\", icon: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=\", title: \"\\u200B\" },\r\n    ]\r\n}\r\n\r\n\r\n\n</script>\r\n    <script>\n// settings handler\r\n(function () {\r\n    'use strict';\r\n\r\n    const STORAGE_KEY = 'void_settings';\r\n\r\n    const getDefaults = () => {\r\n        return window.SITE_CONFIG?.defaults || {\r\n            cloakMode: 'none',\r\n            cloakRotation: false,\r\n            cloakInterval: 5000,\r\n            panicKey: 'x',\r\n            panicModifiers: ['ctrl', 'shift'],\r\n            panicUrl: 'https://classroom.google.com',\r\n            maxMovieRating: 'R',\r\n            offlineGames: [],\r\n            gameLibrary: 'multi',\r\n            leaveConfirmation: false\r\n        };\r\n    };\r\n\r\n    const load = () => {\r\n        try {\r\n            const stored = localStorage.getItem(STORAGE_KEY);\r\n            if (stored) {\r\n                return { ...getDefaults(), ...JSON.parse(stored) };\r\n            }\r\n        } catch (e) {\r\n            console.warn('Failed to load settings:', e);\r\n        }\r\n        return getDefaults();\r\n    };\r\n\r\n    const save = (settings) => {\r\n        try {\r\n            localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n            window.dispatchEvent(new CustomEvent('settings-changed', { detail: settings }));\r\n            if (window.parent !== window) {\r\n                window.parent.postMessage({ type: 'settings-update' }, '*');\r\n            }\r\n        } catch (e) {\r\n            console.warn('Failed to save settings:', e);\r\n        }\r\n    };\r\n\r\n    let _settings = load();\r\n\r\n    window.Settings = {\r\n        get(key) { return _settings[key]; },\r\n\r\n        getAll() { return { ..._settings }; },\r\n\r\n        set(key, value) {\r\n            _settings[key] = value;\r\n            save(_settings);\r\n            this.apply();\r\n            return value;\r\n        },\r\n\r\n        update(partial) {\r\n            _settings = { ..._settings, ...partial };\r\n            save(_settings);\r\n            this.apply();\r\n        },\r\n\r\n        reset() {\r\n            _settings = getDefaults();\r\n            save(_settings);\r\n            this.apply();\r\n        },\r\n\r\n        apply() {\r\n            const root = document.documentElement;\r\n            const s = _settings;\r\n            const d = window.SITE_CONFIG?.defaults || {};\r\n\r\n            const vars = {\r\n                '--accent': s.accentColor || d.accentColor || '#ffffff',\r\n                '--surface': s.surfaceColor || d.surfaceColor || '#0f0f0f',\r\n                '--surface-hover': s.surfaceHoverColor || d.surfaceHoverColor || '#1a1a1a',\r\n                '--surface-active': s.surfaceActiveColor || d.surfaceActiveColor || '#252525',\r\n                '--secondary': s.secondaryColor || d.secondaryColor || '#2e2e33',\r\n                '--border': s.borderColor || d.borderColor || '#1f1f1f',\r\n                '--border-light': s.borderLightColor || d.borderLightColor || '#2a2a2a',\r\n                '--text': s.textColor || d.textColor || '#e4e4e7',\r\n                '--text-muted': s.textSecondaryColor || d.textSecondaryColor || '#71717a',\r\n                '--text-dim': s.textDimColor || d.textDimColor || '#52525b',\r\n                '--toggle': s.toggleColor || d.toggleColor,\r\n                '--toggle-knob': s.toggleKnobColor || d.toggleKnobColor\r\n            };\r\n\r\n            Object.entries(vars).forEach(([key, val]) => {\r\n                if (val) root.style.setProperty(key, val);\r\n            });\r\n\r\n            const themeBg = s.background || d.background || { type: 'color', value: '#0a0a0a' };\r\n            const customBg = s.customBackground;\r\n            const isCustomActive = customBg && customBg.type !== 'none';\r\n\r\n            if (themeBg.type === 'color') {\r\n                root.style.setProperty('--bg', themeBg.value);\r\n            }\r\n\r\n            if (isCustomActive && customBg.url) {\r\n                root.style.setProperty('--bg-image', `url(${customBg.url})`);\r\n\r\n                let position = customBg.objectPosition;\r\n                if (customBg.id && customBg.id !== 'custom') {\r\n                    const preset = window.SITE_CONFIG?.backgroundPresets?.find(b => b.id === customBg.id);\r\n                    if (preset?.objectPosition) position = preset.objectPosition;\r\n                }\r\n\r\n                root.style.setProperty('--bg-image-position', position || 'center');\r\n            } else if (themeBg.type === 'image' || themeBg.type === 'video') {\r\n                root.style.setProperty('--bg-image', `url(${themeBg.value || themeBg.url})`);\r\n                root.style.setProperty('--bg-image-position', themeBg.objectPosition || 'center');\r\n            } else if (themeBg.type === 'gradient') {\r\n                root.style.setProperty('--bg-image', themeBg.value || themeBg.url);\r\n                root.style.setProperty('--bg-image-position', 'center');\r\n            } else {\r\n                root.style.setProperty('--bg-image', 'none');\r\n            }\r\n        },\r\n\r\n        onChange(callback) {\r\n            window.addEventListener('settings-changed', (e) => callback(e.detail));\r\n        },\r\n\r\n        isRatingAllowed(rating) {\r\n            if (!rating || rating === 'NR' || rating === 'NC-17') return false;\r\n            const ratingOrder = ['G', 'PG', 'PG-13', 'R'];\r\n            const maxIndex = ratingOrder.indexOf(_settings.maxMovieRating);\r\n            const ratingIndex = ratingOrder.indexOf(rating);\r\n            return maxIndex !== -1 && ratingIndex !== -1 && ratingIndex <= maxIndex;\r\n        }\r\n    };\r\n\r\n    // panic button go brr\r\n    const handlePanic = (e) => {\r\n        const mods = _settings.panicModifiers || [];\r\n        const key = _settings.panicKey || 'x';\r\n\r\n        if (mods.includes('ctrl') !== e.ctrlKey) return;\r\n        if (mods.includes('shift') !== e.shiftKey) return;\r\n        if (mods.includes('alt') !== e.altKey) return;\r\n\r\n        if (e.key.toLowerCase() === key.toLowerCase()) {\r\n            e.preventDefault();\r\n            const overlayId = 'panic-overlay';\r\n            let overlay = window.parent?.document?.getElementById(overlayId) || document.getElementById(overlayId);\r\n\r\n            if (!overlay) {\r\n                overlay = document.createElement('div');\r\n                overlay.id = overlayId;\r\n                overlay.style.cssText = 'position:fixed;inset:0;background:white;z-index:99999;';\r\n                document.body.appendChild(overlay);\r\n            } else {\r\n                overlay.style.display = 'block';\r\n            }\r\n\r\n            window.location.replace(_settings.panicUrl || 'https://classroom.google.com');\r\n        }\r\n    };\r\n\r\n    const init = () => {\r\n        Settings.apply();\r\n\r\n        const featured = window.SITE_CONFIG?.featuredBackground;\r\n        const activePreset = window.SITE_CONFIG?.backgroundPresets?.find(p => p.active);\r\n\r\n        const target = activePreset || featured;\r\n\r\n        if (target?.id && target.id !== _settings.lastSeenFeatured) {\r\n            Settings.update({\r\n                customBackground: target,\r\n                lastSeenFeatured: target.id,\r\n                backgroundRotation: false\r\n            });\r\n        }\r\n\r\n        document.addEventListener('keydown', handlePanic, true);\r\n\r\n        window.addEventListener('storage', (e) => {\r\n            if (e.key === STORAGE_KEY) {\r\n                _settings = load();\r\n                Settings.apply();\r\n                window.dispatchEvent(new CustomEvent('settings-changed', { detail: _settings }));\r\n            }\r\n        });\r\n\r\n        window.addEventListener('message', (e) => {\r\n            if (e.data?.type === 'settings-update' || e.data === 'updateCloak') {\r\n                _settings = load();\r\n                Settings.apply();\r\n                window.dispatchEvent(new CustomEvent('settings-changed', { detail: _settings }));\r\n            }\r\n        });\r\n\r\n        window.addEventListener('beforeunload', (e) => {\r\n            if (document.getElementById('main-frame') && _settings.leaveConfirmation) {\r\n                e.preventDefault();\r\n                return e.returnValue = '';\r\n            }\r\n        });\r\n    };\r\n\r\n    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', init);\r\n    else init();\r\n})();\r\n\n</script>\r\n    <script>\n// background stuff\r\n(function () {\r\n    'use strict';\r\n\r\n    if (window.BackgroundManager) return;\r\n\r\n    const YOUTUBE_REGEX = /(?:youtube\\.com\\/watch\\?v=|youtu\\.be\\/|youtube\\.com\\/embed\\/)([a-zA-Z0-9_-]{11})/;\r\n\r\n    const BackgroundManager = {\r\n        container: null,\r\n        mediaLayer: null,\r\n        elements: { video: null, image: null, iframe: null },\r\n        current: { type: null, url: null },\r\n        cacheName: 'phantom-bg-cache-v2',\r\n\r\n        init() {\r\n            this.container = document.createElement('div');\r\n            this.container.className = 'phantom-background';\r\n            this.container.innerHTML = '<div class=\"phantom-background-overlay\"></div><div class=\"phantom-background-layer\"></div>';\r\n            this.mediaLayer = this.container.querySelector('.phantom-background-layer');\r\n            document.body.insertBefore(this.container, document.body.firstChild);\r\n\r\n            const apply = () => this.applyBackground();\r\n            window.addEventListener('settings-changed', apply);\r\n            window.addEventListener('storage', apply);\r\n            window.addEventListener('beforeunload', () => this.cleanup());\r\n            window.addEventListener('pagehide', () => this.cleanup());\r\n\r\n            document.addEventListener('visibilitychange', () => {\r\n                const video = this.elements.video;\r\n                if (!video) return;\r\n                if (document.hidden) video.pause();\r\n                else if (this.current.type === 'video') video.play().catch(() => { });\r\n            });\r\n\r\n            this.applyBackground();\r\n        },\r\n\r\n        applyBackground() {\r\n            if (!this.container) return; // Wait for init() to create the container\r\n\r\n            const s = window.Settings?.getAll() || {};\r\n            const custom = s.customBackground;\r\n            const theme = s.background || {};\r\n\r\n            let type = null, url = null, pos = null, overlay = 0.4;\r\n\r\n            if (custom && custom.type !== 'none') {\r\n                // Refresh from config if possible to get latest props like objectPosition\r\n                if (custom.id && custom.id !== 'custom') {\r\n                    const preset = window.SITE_CONFIG?.backgroundPresets?.find(b => b.id === custom.id);\r\n                    if (preset) Object.assign(custom, preset);\r\n                }\r\n                ({ type, url, objectPosition: pos, overlay = 0.4 } = custom);\r\n            } else if (theme.type === 'image' || theme.type === 'video' || theme.type === 'youtube') {\r\n                type = theme.type;\r\n                url = theme.value || theme.url;\r\n                pos = theme.objectPosition;\r\n                overlay = theme.overlay || 0.4;\r\n            }\r\n\r\n            document.documentElement.style.setProperty('--bg-overlay', overlay);\r\n\r\n            // Handle common positioning typos and normalize\r\n            if (pos && typeof pos === 'string') {\r\n                pos = pos.toLowerCase().trim()\r\n                    .replace(/\\s+/g, ' ') // Normalize multiple spaces\r\n                    .replace('topleft', 'top left')\r\n                    .replace('topright', 'top right')\r\n                    .replace('bottomleft', 'bottom left')\r\n                    .replace('bottomright', 'bottom right')\r\n                    .replace('centercenter', 'center')\r\n                    .replace('centerleft', 'center left')\r\n                    .replace('centerright', 'center right');\r\n            }\r\n\r\n            document.documentElement.style.setProperty('--bg-image-position', pos || 'center');\r\n\r\n            if (!type || !url) {\r\n                this.clear();\r\n                document.documentElement.style.backgroundColor = 'var(--bg)';\r\n                document.documentElement.style.setProperty('--bg-image-position', 'center');\r\n                return;\r\n            }\r\n            if (this.current.type === type && this.current.url === url) return;\r\n\r\n            this.current = { type, url };\r\n\r\n            if (type === 'video' || url.match(/\\.(mp4|webm|ogg|mov|m4v)$/i)) {\r\n                this.clearMedia();\r\n                this.createVideo(url, pos);\r\n                this.container.classList.add('active');\r\n                document.documentElement.classList.add('phantom-bg-active');\r\n                document.body.classList.add('phantom-bg-active');\r\n            } else if (type === 'youtube' || YOUTUBE_REGEX.test(url)) {\r\n                this.clearMedia();\r\n                this.createYouTube(url, pos);\r\n                this.container.classList.add('active');\r\n                document.documentElement.classList.add('phantom-bg-active');\r\n                document.body.classList.add('phantom-bg-active');\r\n            } else if (type === 'image') {\r\n                this.handleImageBackground(url, pos);\r\n            }\r\n        },\r\n\r\n        async getProxiedCachedUrl(url) {\r\n            // Local images don't need proxying\r\n            if (!url.startsWith('http') || url.includes(location.hostname)) return url;\r\n\r\n            // Try direct load first (faster)\r\n            try {\r\n                const directTest = await fetch(url, { method: 'HEAD', mode: 'cors' });\r\n                if (directTest.ok) return url;\r\n            } catch (e) {\r\n                // CORS blocked, need to proxy\r\n            }\r\n\r\n            // Wait for BareMux (max 500ms)\r\n            let retries = 0;\r\n            while (!window.BareMux && retries < 5) {\r\n                await new Promise(r => setTimeout(r, 100));\r\n                retries++;\r\n            }\r\n\r\n            if (!window.BareMux) {\r\n                console.warn(\"Background: BareMux not found, trying direct URL.\");\r\n                return url; // Try direct anyway\r\n            }\r\n\r\n            try {\r\n                const client = new window.BareMux.BareClient();\r\n                const response = await client.fetch(url);\r\n                if (!response.ok) throw new Error('Proxy fetch failed');\r\n\r\n                const blob = await response.blob();\r\n                return URL.createObjectURL(blob);\r\n            } catch (error) {\r\n                console.error(\"Background proxy failed:\", error);\r\n                return url; // Fallback to direct URL\r\n            }\r\n        },\r\n\r\n        async handleImageBackground(url, pos) {\r\n            // Pre-load the image (proxied/cached or direct)\r\n            const finalUrl = await this.getProxiedCachedUrl(url);\r\n\r\n            // Check if this is still the current background after async fetch\r\n            if (this.current.url !== url) {\r\n                if (finalUrl && finalUrl.startsWith('blob:')) URL.revokeObjectURL(finalUrl);\r\n                return;\r\n            }\r\n\r\n            this.clearMedia();\r\n            this.createImage(finalUrl, pos);\r\n        },\r\n\r\n        createVideo(url, pos) {\r\n            const el = Object.assign(document.createElement('video'), {\r\n                className: 'phantom-background-media', src: url, autoplay: true, loop: true, muted: true, playsInline: true, volume: 0\r\n            });\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n            el.onerror = () => (this.elements.video = null);\r\n            this.elements.video = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        createImage(url, pos) {\r\n            const el = Object.assign(document.createElement('img'), {\r\n                className: 'phantom-background-media',\r\n                src: url\r\n            });\r\n\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n\r\n            el.onload = () => {\r\n                if (this.current.url === url || url.startsWith('blob:')) {\r\n                    this.container.classList.add('active');\r\n                    document.documentElement.classList.add('phantom-bg-active');\r\n                    document.body.classList.add('phantom-bg-active');\r\n                }\r\n            };\r\n            el.onerror = () => {\r\n                console.warn(\"Background image failed to load:\", url);\r\n                if (this.elements.image === el) this.elements.image = null;\r\n            };\r\n\r\n            this.elements.image = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        // youtube logic\r\n        createYouTube(url, pos) {\r\n            const id = url.match(YOUTUBE_REGEX)?.[1];\r\n            if (!id) return;\r\n            const el = Object.assign(document.createElement('iframe'), {\r\n                className: 'phantom-background-media',\r\n                src: `https://www.youtube.com/embed/${id}?autoplay=1&loop=1&playlist=${id}&controls=0&modestbranding=1&rel=0&mute=1&enablejsapi=1`,\r\n                allow: 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture'\r\n            });\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n            this.elements.iframe = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        clearMedia() {\r\n            Object.entries(this.elements).forEach(([key, el]) => {\r\n                if (!el) return;\r\n                if (key === 'video') { el.pause(); el.src = ''; }\r\n                if (key === 'iframe') el.src = 'about:blank';\r\n                if (key === 'image' && el.src.startsWith('blob:')) {\r\n                    URL.revokeObjectURL(el.src);\r\n                }\r\n                el.remove();\r\n                this.elements[key] = null;\r\n            });\r\n        },\r\n\r\n        clear() {\r\n            this.clearMedia();\r\n            this.current = { type: null, url: null };\r\n            document.documentElement.classList.remove('phantom-bg-active');\r\n            document.body.classList.remove('phantom-bg-active');\r\n            document.documentElement.style.backgroundColor = '';\r\n            if (this.container) this.container.classList.remove('active');\r\n        },\r\n\r\n        cleanup() {\r\n            this.clearMedia();\r\n        }\r\n    };\r\n\r\n    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', () => BackgroundManager.init());\r\n    else BackgroundManager.init();\r\n\r\n    window.BackgroundManager = BackgroundManager;\r\n})();\r\n\n</script>\r\n    <script>\n// topbar\r\n(function () {\r\n    let rootPrefix = '';\r\n    const scriptName = 'components/topbar.js';\r\n    const scripts = document.getElementsByTagName('script');\r\n    for (let i = 0; i < scripts.length; i++) {\r\n        const src = scripts[i].getAttribute('src');\r\n        if (src && src.includes(scriptName)) {\r\n            rootPrefix = src.split(scriptName)[0];\r\n            break;\r\n        }\r\n    }\r\n\r\n    if (!window.lucide && !document.querySelector('script[src*=\"lucide\"]')) {\r\n        const script = document.createElement('script');\r\n        script.src = 'https://unpkg.com/lucide@latest';\r\n        script.onload = () => {\r\n            if (window.lucide) lucide.createIcons();\r\n        };\r\n        document.head.appendChild(script);\r\n    }\r\n\r\n    initTopbar();\r\n\r\n    function createTopbar() {\r\n        const topbarContainer = document.createElement('div');\r\n        topbarContainer.id = 'topbar-container';\r\n\r\n        const logoSection = document.createElement('a');\r\n        logoSection.className = 'logo-section';\r\n        logoSection.href = rootPrefix + 'index2.html';\r\n        logoSection.innerHTML = '<div class=\"logo-placeholder\"><i data-lucide=\"zap\"></i></div>';\r\n        topbarContainer.appendChild(logoSection);\r\n\r\n        const navButtons = document.createElement('div');\r\n        navButtons.className = 'nav-buttons';\r\n\r\n        const buttons = [\r\n            { name: 'Music', icon: 'music', link: 'pages/music.html', badge: 'BETA' },\r\n            { name: 'Movies', icon: 'film', link: 'pages/movies.html' },\r\n            { name: 'Games', icon: 'gamepad-2', link: 'pages/games.html' },\r\n            { name: 'Watch', icon: 'play', link: 'pages/watch.html' },\r\n            { name: 'Search', icon: 'search', link: 'staticsjv2/index.html' },\r\n            { name: 'AI Chat', icon: 'bot', link: 'pages/chat.html' },\r\n            { separator: true },\r\n            { name: 'Settings', icon: 'settings', link: 'pages/settings.html' }\r\n        ];\r\n\r\n        buttons.forEach(btn => {\r\n            if (btn.separator) {\r\n                const separator = document.createElement('div');\r\n                separator.className = 'nav-separator';\r\n                navButtons.appendChild(separator);\r\n                return;\r\n            }\r\n\r\n            const link = document.createElement('a');   \r\n            link.href = rootPrefix + btn.link;\r\n            link.className = 'nav-btn';\r\n\r\n            const icon = document.createElement('i');\r\n            icon.setAttribute('data-lucide', btn.icon);\r\n            link.appendChild(icon);\r\n\r\n            const span = document.createElement('span');\r\n            span.textContent = btn.name;\r\n            link.appendChild(span);\r\n\r\n            if (btn.badge) {\r\n                const badge = document.createElement('div');\r\n                badge.className = 'nav-badge-beta';\r\n                badge.textContent = btn.badge;\r\n                link.appendChild(badge);\r\n            }\r\n\r\n            navButtons.appendChild(link);\r\n        });\r\n\r\n        topbarContainer.appendChild(navButtons);\r\n        document.body.prepend(topbarContainer);\r\n\r\n        if (window.lucide) {\r\n            lucide.createIcons();\r\n        }\r\n    }\r\n\r\n    function initTopbar() {\r\n        if (document.readyState === 'loading') {\r\n            document.addEventListener('DOMContentLoaded', createTopbar);\r\n        } else {\r\n            createTopbar();\r\n        }\r\n    }\r\n})();\r\n\n</script>\r\n\r\n    <style>\r\n        .back-home-btn {\r\n            display: inline-flex;\r\n            align-items: center;\r\n            gap: 8px;\r\n            margin-top: 24px;\r\n            color: var(--text-muted);\r\n            font-size: 0.875rem;\r\n            text-decoration: none;\r\n            transition: color 0.2s ease, transform 0.2s ease;\r\n            cursor: pointer;\r\n        }\r\n\r\n        .back-home-btn:hover {\r\n            color: var(--text);\r\n            transform: translateX(-4px);\r\n        }\r\n    </style>\r\n\r\n    <div style=\"max-width: 700px; margin: 0 auto; padding: 80px 24px 120px;\">\r\n        <h1 style=\"font-size: 1.75rem; margin-bottom: 24px;\">Terms of Service</h1>\r\n\r\n        <div style=\"color: var(--text-muted); line-height: 1.8; font-size: 0.9375rem;\">\r\n            <p style=\"margin-bottom: 16px;\"><strong style=\"color: var(--text);\">Last updated:</strong> December 2025</p>\r\n\r\n            <h2 style=\"font-size: 1.125rem; color: var(--text); margin: 24px 0 12px;\">1. Acceptance of Terms</h2>\r\n            <p style=\"margin-bottom: 16px;\">By accessing and using Phantom Unblocked, you accept and agree to be bound\r\n                by these Terms of Service. If you do not agree to these terms, please do not use this service.</p>\r\n\r\n            <h2 style=\"font-size: 1.125rem; color: var(--text); margin: 24px 0 12px;\">2. Use of Service</h2>\r\n            <p style=\"margin-bottom: 16px;\">This service is provided for educational and entertainment purposes. You\r\n                agree to use this service responsibly and in compliance with all applicable laws and regulations.</p>\r\n\r\n            <h2 style=\"font-size: 1.125rem; color: var(--text); margin: 24px 0 12px;\">3. User Responsibilities</h2>\r\n            <p style=\"margin-bottom: 16px;\">You are solely responsible for your use of this service and any content you\r\n                access through it. You agree not to use this service for any illegal or unauthorized purposes.</p>\r\n\r\n            <h2 style=\"font-size: 1.125rem; color: var(--text); margin: 24px 0 12px;\">4. Third-Party Content</h2>\r\n            <p style=\"margin-bottom: 16px;\">This service may provide access to third-party content. We do not own,\r\n                control, or endorse any third-party content accessed through this service.</p>\r\n\r\n            <h2 style=\"font-size: 1.125rem; color: var(--text); margin: 24px 0 12px;\">5. No Warranty</h2>\r\n            <p style=\"margin-bottom: 16px;\">This service is provided \"as is\" without any warranties, express or implied.\r\n                We do not guarantee the availability, accuracy, or reliability of this service.</p>\r\n\r\n            <h2 style=\"font-size: 1.125rem; color: var(--text); margin: 24px 0 12px;\">6. Limitation of Liability</h2>\r\n            <p style=\"margin-bottom: 16px;\">We shall not be liable for any damages arising from your use of this\r\n                service, including but not limited to direct, indirect, incidental, or consequential damages.</p>\r\n\r\n            <h2 style=\"font-size: 1.125rem; color: var(--text); margin: 24px 0 12px;\">7. Changes to Terms</h2>\r\n            <p style=\"margin-bottom: 16px;\">We reserve the right to modify these terms at any time. Continued use of the\r\n                service after changes constitutes acceptance of the new terms.</p>\r\n        </div>\r\n\r\n        <a href=\"../index.html\" class=\"back-home-btn\">\r\n            <i class=\"fa-solid fa-arrow-left\"></i>\r\n            Back to Home\r\n        </a>\r\n    </div>\r\n\r\n    <script>\n// footer\r\n(function () {\r\n    'use strict';\r\n\r\n    let rootPrefix = '';\r\n    const scriptName = 'components/footer.js';\r\n    const scripts = document.getElementsByTagName('script');\r\n    for (let i = 0; i < scripts.length; i++) {\r\n        const src = scripts[i].getAttribute('src');\r\n        if (src && src.includes(scriptName)) {\r\n            rootPrefix = src.split(scriptName)[0];\r\n            break;\r\n        }\r\n    }\r\n\r\n    const config = window.SITE_CONFIG || { name: 'Phantom', version: '1.0.0', discord: { inviteUrl: '#' }, changelog: [], cloakPresets: [] };\r\n    const STORAGE_KEY = 'void_settings';\r\n    let storedSettings = {};\r\n    try { storedSettings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n\r\n    // settings\r\n    let settings = { ...(config.defaults || {}), ...storedSettings };\r\n\r\n    const footer = document.createElement('footer');\r\n    footer.id = 'site-footer';\r\n    footer.innerHTML = `\r\n        <style>\r\n            #site-footer {\r\n                margin-top: 0px;\r\n                padding: 20px;\r\n                border-top: 1px solid var(--border, #1f1f1f);\r\n                text-align: center;\r\n                background: transparent;\r\n            }\r\n            #site-footer .footer-links {\r\n                display: flex;\r\n                gap: 16px;\r\n                justify-content: center;\r\n                margin-bottom: 8px;\r\n                flex-wrap: wrap;\r\n            }\r\n            #site-footer .footer-link {\r\n                font-size: 12px;\r\n                color: var(--text-muted, #71717a);\r\n                text-decoration: none;\r\n                transition: color 0.15s;\r\n                font-family: 'Inter', sans-serif;\r\n                cursor: pointer;\r\n            }\r\n            #site-footer .footer-link:hover {\r\n                color: var(--text, #e4e4e7);\r\n            }\r\n            #site-footer .footer-version {\r\n                font-size: 11px;\r\n                color: var(--text-dim, #52525b);\r\n                cursor: pointer;\r\n                font-family: 'Inter', sans-serif;\r\n            }\r\n            #site-footer .footer-version:hover {\r\n                color: var(--text-muted, #71717a);\r\n            }\r\n        </style>\r\n        <div class=\"footer-links\">\r\n            <a href=\"${rootPrefix}pages/settings.html\" class=\"footer-link\"><i class=\"fa-solid fa-gear\"></i> Settings</a>\r\n            <a id=\"footer-changelog\" class=\"footer-link\"><i class=\"fa-solid fa-clock-rotate-left\"></i> Changelog</a>\r\n            <a href=\"${config.discord?.inviteUrl || '#'}\" target=\"_blank\" class=\"footer-link\"><i class=\"fa-brands fa-discord\"></i> Discord</a>\r\n            <a href=\"${rootPrefix}pages/terms.html\" class=\"footer-link\">Terms</a>\r\n            <a href=\"${rootPrefix}pages/disclaimer.html\" class=\"footer-link\">Disclaimer</a>\r\n            <a href=\"${rootPrefix}pages/extra.html\" class=\"footer-link\">Credits</a>\r\n        </div>\r\n        <span class=\"footer-version\" id=\"footer-version\">${config.name || 'Phantom'} v${config.version || '1.0.0'}</span>\r\n    `;\r\n\r\n    document.body.appendChild(footer);\r\n\r\n\r\n\r\n    // gtm\r\n    // Inject GTM head script if not already present\r\n    if (!document.querySelector('script[src*=\"googletagmanager.com/gtm.js\"]')) {\r\n        window.dataLayer = window.dataLayer || [];\r\n        window.dataLayer.push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' });\r\n        const gtmScript = document.createElement('script');\r\n        gtmScript.async = true;\r\n        gtmScript.src = 'https://www.googletagmanager.com/gtm.js?id=GTM-5LMBC27Z';\r\n        document.head.insertBefore(gtmScript, document.head.firstChild);\r\n    }\r\n\r\n    // Add GTM noscript fallback (for pages that don't have it in HTML)\r\n    if (!document.querySelector('noscript iframe[src*=\"googletagmanager\"]')) {\r\n        const gtmNoscript = document.createElement('noscript');\r\n        gtmNoscript.innerHTML = '<iframe src=\"https://www.googletagmanager.com/ns.html?id=GTM-5LMBC27Z\" height=\"0\" width=\"0\" style=\"display:none;visibility:hidden\"></iframe>';\r\n        document.body.insertBefore(gtmNoscript, document.body.firstChild);\r\n    }\r\n\r\n    const openChangelog = (e, customTitle, customContent) => {\r\n        if (e && e.preventDefault) e.preventDefault();\r\n        const changes = customContent || config.changelog || ['No changes listed'];\r\n\r\n        // Use standard modal structure from main.css\r\n        const overlay = document.createElement('div');\r\n        overlay.className = 'modal-overlay';\r\n\r\n        overlay.innerHTML = `\r\n            <div class=\"modal\" style=\"width: 400px; max-width: 90vw;\">\r\n                <div class=\"modal-header\">\r\n                    <h3 class=\"modal-title\">${customTitle || 'What\\'s New in v' + config.version}</h3>\r\n                    <button class=\"modal-close\"><i class=\"fa-solid fa-xmark\"></i></button>\r\n                </div>\r\n                <div class=\"modal-body\">\r\n                    <ul style=\"margin: 0; padding-left: 20px; color: var(--text-muted); font-size: 0.875rem; line-height: 1.6;\">\r\n                        ${changes.map(c => '<li>' + c + '</li>').join('')}\r\n                    </ul>\r\n                </div>\r\n                <div class=\"modal-footer\">\r\n                    <a href=\"${config.discord?.inviteUrl || '#'}\" target=\"_blank\" style=\"color: #5865F2; text-decoration: none; font-size: 13px; display: inline-flex; align-items: center; gap: 6px;\">\r\n                        <i class=\"fa-brands fa-discord\"></i> Join Discord\r\n                    </a>\r\n                </div>\r\n            </div>\r\n        `;\r\n\r\n        document.body.appendChild(overlay);\r\n\r\n        // Trigger animation\r\n        requestAnimationFrame(() => overlay.classList.add('show'));\r\n\r\n        const close = () => {\r\n            overlay.classList.remove('show');\r\n            setTimeout(() => overlay.remove(), 200);\r\n        };\r\n\r\n        overlay.querySelector('.modal-close').onclick = close;\r\n        overlay.onclick = (e) => { if (e.target === overlay) close(); };\r\n    };\r\n\r\n    // Expose openChangelog globally\r\n    window.openChangelog = openChangelog;\r\n\r\n    const changelogBtn = document.getElementById('footer-changelog');\r\n    if (changelogBtn) changelogBtn.onclick = openChangelog;\r\n\r\n    const versionBtn = document.getElementById('footer-version');\r\n    if (versionBtn) versionBtn.onclick = openChangelog;\r\n\r\n    // sync\r\n    // syncRemoteChangelog removed - using local config\r\n\r\n\r\n    // Initialize Sync\r\n    // syncRemoteChangelog();\r\n\r\n    const currentVersion = config.version;\r\n    const lastVersion = settings.lastVersion;\r\n\r\n    if (settings.showChangelogOnUpdate && lastVersion && lastVersion !== currentVersion) {\r\n        setTimeout(() => {\r\n            openChangelog();\r\n            settings.lastVersion = currentVersion;\r\n            localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n        }, 1000);\r\n    } else if (!lastVersion) {\r\n        settings.lastVersion = currentVersion;\r\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n    }\r\n\r\n    // panic\r\n    if (settings.panicKey) {\r\n        document.addEventListener('keydown', (e) => {\r\n            const keys = settings.panicModifiers || ['ctrl', 'shift'];\r\n            const triggerKey = settings.panicKey.toLowerCase();\r\n            const pressedKey = e.key.toLowerCase();\r\n\r\n            // Check modifiers\r\n            const ctrlMatch = keys.includes('ctrl') === e.ctrlKey;\r\n            const shiftMatch = keys.includes('shift') === e.shiftKey;\r\n            const altMatch = keys.includes('alt') === e.altKey;\r\n\r\n            if (ctrlMatch && shiftMatch && altMatch && pressedKey === triggerKey) {\r\n                e.preventDefault();\r\n\r\n                // Show white screen instantly (if panic-overlay exists in parent)\r\n                const parentOverlay = window.parent?.document?.getElementById('panic-overlay');\r\n                if (parentOverlay) {\r\n                    parentOverlay.style.display = 'block';\r\n                } else {\r\n                    // Create overlay if it doesn't exist\r\n                    const overlay = document.createElement('div');\r\n                    overlay.id = 'panic-overlay';\r\n                    overlay.style.cssText = 'position:fixed;inset:0;background:white;z-index:99999;';\r\n                    document.body.appendChild(overlay);\r\n                }\r\n\r\n                // Redirect immediately\r\n                const url = settings.panicUrl || 'https://classroom.google.com';\r\n                try { window.top.location.href = url; } catch { window.location.href = url; }\r\n            }\r\n        }, true); // Use capture phase for faster response\r\n    }\r\n\r\n    // Cloaking logic has been moved to scripts/cloaking.js for better synchronization.\r\n    // If you need cloaking on a specific page, include that script.\r\n\r\n\r\n    window.addEventListener('beforeunload', (e) => {\r\n        // Reload settings to get latest value\r\n        try { settings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n\r\n        if (window.top === window.self && settings.leaveConfirmation) {\r\n            e.preventDefault();\r\n            e.returnValue = '';\r\n            return '';\r\n        }\r\n    });\r\n\r\n    // discord\r\n    let crateInstance = null;\r\n\r\n    function initDiscord() {\r\n        if (settings.discordWidget && config.discord && config.discord.widgetServer && config.discord.widgetChannel) {\r\n            // Check if already loaded\r\n            if (document.querySelector('script[src*=\"@widgetbot/crate\"]')) {\r\n                if (crateInstance) crateInstance.show();\r\n                return;\r\n            }\r\n\r\n            const crateScript = document.createElement('script');\r\n            crateScript.src = 'https://cdn.jsdelivr.net/npm/@widgetbot/crate@3';\r\n            crateScript.async = true;\r\n            crateScript.defer = true;\r\n            crateScript.onload = () => {\r\n                crateInstance = new Crate({\r\n                    server: config.discord.widgetServer,\r\n                    channel: config.discord.widgetChannel,\r\n                    glyph: ['https://cdn.discordapp.com/embed/avatars/0.png', '100%'],\r\n                    location: ['bottom', 'right']\r\n                });\r\n            };\r\n            document.body.appendChild(crateScript);\r\n        } else {\r\n            // Hide if disabled\r\n            if (crateInstance) crateInstance.hide();\r\n        }\r\n    }\r\n\r\n    // Initialize\r\n    initDiscord();\r\n\r\n    // Listen for settings change to toggle dynamically\r\n    window.addEventListener('storage', (e) => {\r\n        if (e.key === STORAGE_KEY) {\r\n            try { settings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n            initDiscord();\r\n        }\r\n    });\r\n\r\n    // Listen for internal event\r\n    window.addEventListener('settings-changed', (e) => {\r\n        settings = e.detail;\r\n        initDiscord();\r\n    });\r\n\r\n    // counters\r\n    // Only show on home page (index2.html) checking if main-content exists\r\n    const mainContent = document.querySelector('.main-content');\r\n    // Ensure we are on the home page view (search bar checks etc) or just check existence\r\n    if (mainContent && document.querySelector('.featured-section')) {\r\n        const counterContainer = document.createElement('div');\r\n        counterContainer.id = 'supercounters-wrapper';\r\n        counterContainer.style.marginTop = '24px';\r\n        counterContainer.style.textAlign = 'center';\r\n        counterContainer.style.opacity = '0.8';\r\n\r\n        // Use iframe to isolate document.write from the widget\r\n        const iframe = document.createElement('iframe');\r\n        iframe.style.border = 'none';\r\n        iframe.style.width = '150px';\r\n        iframe.style.height = '40px';\r\n        iframe.style.overflow = 'hidden';\r\n\r\n        // Widget code\r\n        const widgetCode = `\r\n            <html>\r\n            <body style=\"margin:0;display:flex;justify-content:center;align-items:center;background:transparent;\">\r\n                <script type=\"text/javascript\" src=\"//widget.supercounters.com/ssl/online_i.js\"><\\/script>\r\n                <script type=\"text/javascript\">sc_online_i(1726449,\"ffffff\",\"000000\");<\\/script>\r\n            </body>\r\n            </html>\r\n        `;\r\n\r\n        iframe.srcdoc = widgetCode;\r\n        counterContainer.appendChild(iframe);\r\n        mainContent.appendChild(counterContainer);\r\n    }\r\n})();\r\n\n</script>\r\n</body>\r\n\r\n</html>","pages/watch.html":"<!DOCTYPE html>\r\n<html lang=\"en\">\r\n\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n    <title>Watch - Phantom</title>\r\n    <link rel=\"icon\" href=\"../favicon.svg\" type=\"image/svg+xml\">\r\n    <meta name=\"referrer\" content=\"origin\">\r\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css\">\r\n    <style>\n/* phantom styling */\r\n\r\n@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');\r\n\r\n/* variables */\r\n:root {\r\n    /* Core colors (can be overridden by user settings) */\r\n    --bg: #0a0a0a;\r\n    --surface: #0f0f0f;\r\n    --surface-hover: #1a1a1a;\r\n    --surface-active: #252525;\r\n    --border: #1f1f1f;\r\n    --border-light: #2a2a2a;\r\n\r\n    /* Text */\r\n    --text: #e4e4e7;\r\n    --text-muted: #71717a;\r\n    --text-dim: #52525b;\r\n\r\n    /* Accent (customizable) */\r\n    --accent: #ffffff;\r\n    --accent-dim: rgba(255, 255, 255, 0.8);\r\n    --accent-glow: rgba(255, 255, 255, 0.1);\r\n\r\n    /* Status colors */\r\n    --success: #22c55e;\r\n    --warning: #f59e0b;\r\n    --error: #ef4444;\r\n    --info: #3b82f6;\r\n\r\n    /* Shadows */\r\n    --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.3);\r\n    --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.4);\r\n    --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.5);\r\n    --shadow-xl: 0 16px 48px rgba(0, 0, 0, 0.6);\r\n\r\n    /* Spacing */\r\n    --space-xs: 4px;\r\n    --space-sm: 8px;\r\n    --space-md: 16px;\r\n    --space-lg: 24px;\r\n    --space-xl: 32px;\r\n    --space-2xl: 48px;\r\n\r\n    /* Border radius */\r\n    --radius-sm: 4px;\r\n    --radius-md: 8px;\r\n    --radius-lg: 12px;\r\n    --radius-xl: 16px;\r\n    --radius-full: 9999px;\r\n\r\n    /* Transitions */\r\n    --transition-fast: 0.1s ease;\r\n    --transition-normal: 0.2s ease;\r\n    --transition-slow: 0.3s ease;\r\n\r\n    /* Z-index layers */\r\n    --z-base: 1;\r\n    --z-dropdown: 100;\r\n    --z-sticky: 500;\r\n    --z-modal: 1000;\r\n    --z-toast: 2000;\r\n    --z-max: 9999;\r\n\r\n    /* Typography */\r\n    --font-sans: 'Inter', system-ui, -apple-system, sans-serif;\r\n    --font-mono: 'JetBrains Mono', 'Fira Code', monospace;\r\n\r\n    /* Background (customizable) */\r\n    --bg-image: none;\r\n}\r\n\r\n/* base */\r\n*,\r\n*::before,\r\n*::after {\r\n    box-sizing: border-box;\r\n    margin: 0;\r\n    padding: 0;\r\n}\r\n\r\nhtml {\r\n    font-size: 16px;\r\n    scroll-behavior: smooth;\r\n    -webkit-font-smoothing: antialiased;\r\n    -moz-osx-font-smoothing: grayscale;\r\n}\r\n\r\nbody {\r\n    font-family: var(--font-sans);\r\n    background: var(--bg);\r\n    background-image: var(--bg-image);\r\n    background-size: cover;\r\n    background-position: var(--bg-image-position, center);\r\n    background-attachment: fixed;\r\n    color: var(--text);\r\n    line-height: 1.5;\r\n    min-height: 100vh;\r\n    overflow-x: hidden;\r\n}\r\n\r\n/* Ensure background manager takes precedence */\r\nhtml.phantom-bg-active body {\r\n    background: transparent !important;\r\n    background-image: none !important;\r\n}\r\n\r\n/* Selection */\r\n::selection {\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n}\r\n\r\n/* Focus states */\r\n:focus-visible {\r\n    outline: 2px solid var(--accent);\r\n    outline-offset: 2px;\r\n}\r\n\r\n/* Links */\r\na {\r\n    color: var(--accent);\r\n    text-decoration: none;\r\n    transition: opacity var(--transition-fast);\r\n}\r\n\r\na:hover {\r\n    opacity: 0.8;\r\n}\r\n\r\n/* Scrollbar */\r\n::-webkit-scrollbar {\r\n    width: 8px;\r\n    height: 8px;\r\n}\r\n\r\n::-webkit-scrollbar-track {\r\n    background: var(--surface);\r\n}\r\n\r\n::-webkit-scrollbar-thumb {\r\n    background: var(--border-light);\r\n    border-radius: var(--radius-full);\r\n}\r\n\r\n::-webkit-scrollbar-thumb:hover {\r\n    background: var(--text-muted);\r\n}\r\n\r\n/* text */\r\nh1,\r\nh2,\r\nh3,\r\nh4,\r\nh5,\r\nh6 {\r\n    font-weight: 600;\r\n    line-height: 1.2;\r\n    color: var(--text);\r\n}\r\n\r\nh1 {\r\n    font-size: 2.5rem;\r\n}\r\n\r\nh2 {\r\n    font-size: 2rem;\r\n}\r\n\r\nh3 {\r\n    font-size: 1.5rem;\r\n}\r\n\r\nh4 {\r\n    font-size: 1.25rem;\r\n}\r\n\r\nh5 {\r\n    font-size: 1rem;\r\n}\r\n\r\nh6 {\r\n    font-size: 0.875rem;\r\n}\r\n\r\np {\r\n    color: var(--text-muted);\r\n    line-height: 1.6;\r\n}\r\n\r\n.text-sm {\r\n    font-size: 0.875rem;\r\n}\r\n\r\n.text-xs {\r\n    font-size: 0.75rem;\r\n}\r\n\r\n.text-lg {\r\n    font-size: 1.125rem;\r\n}\r\n\r\n.text-muted {\r\n    color: var(--text-muted);\r\n}\r\n\r\n.text-dim {\r\n    color: var(--text-dim);\r\n}\r\n\r\n.text-center {\r\n    text-align: center;\r\n}\r\n\r\n/* buttons */\r\n.btn {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    gap: var(--space-sm);\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-family: var(--font-sans);\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-md);\r\n    background: var(--surface);\r\n    color: var(--text);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n    white-space: nowrap;\r\n}\r\n\r\n.btn:hover {\r\n    background: var(--surface-hover);\r\n    border-color: var(--border-light);\r\n}\r\n\r\n.btn:active {\r\n    background: var(--surface-active);\r\n    transform: scale(0.98);\r\n}\r\n\r\n.btn-primary {\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n    border-color: var(--accent);\r\n}\r\n\r\n.btn-primary:hover {\r\n    opacity: 0.9;\r\n    background: var(--accent);\r\n}\r\n\r\n.btn-ghost {\r\n    background: transparent;\r\n    border-color: transparent;\r\n}\r\n\r\n.btn-ghost:hover {\r\n    background: var(--surface-hover);\r\n}\r\n\r\n.btn-icon {\r\n    width: 36px;\r\n    height: 36px;\r\n    padding: 0;\r\n    border-radius: var(--radius-md);\r\n}\r\n\r\n.btn-sm {\r\n    padding: var(--space-xs) var(--space-sm);\r\n    font-size: 0.75rem;\r\n}\r\n\r\n.btn-lg {\r\n    padding: var(--space-md) var(--space-lg);\r\n    font-size: 1rem;\r\n}\r\n\r\n/* inputs */\r\n.input {\r\n    width: 100%;\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-family: var(--font-sans);\r\n    font-size: 0.875rem;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-md);\r\n    color: var(--text);\r\n    transition: border-color var(--transition-fast);\r\n}\r\n\r\n.input:hover {\r\n    border-color: var(--border-light);\r\n}\r\n\r\n.input:focus {\r\n    outline: none;\r\n    border-color: var(--accent);\r\n}\r\n\r\n.input::placeholder {\r\n    color: var(--text-dim);\r\n}\r\n\r\n.input-group {\r\n    display: flex;\r\n    gap: var(--space-sm);\r\n}\r\n\r\n.input-group .input {\r\n    flex: 1;\r\n}\r\n\r\n/* Select */\r\n.select {\r\n    appearance: none;\r\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%2371717a' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E\");\r\n    background-repeat: no-repeat;\r\n    background-position: right 12px center;\r\n    padding-right: 36px;\r\n    cursor: pointer;\r\n}\r\n\r\n/* Checkbox/Toggle */\r\n.toggle {\r\n    position: relative;\r\n    width: 44px;\r\n    height: 24px;\r\n    background: var(--border);\r\n    border-radius: var(--radius-full);\r\n    cursor: pointer;\r\n    transition: background var(--transition-fast);\r\n}\r\n\r\n.toggle::after {\r\n    content: '';\r\n    position: absolute;\r\n    top: 2px;\r\n    left: 2px;\r\n    width: 20px;\r\n    height: 20px;\r\n    background: var(--text);\r\n    border-radius: 50%;\r\n    transition: transform var(--transition-fast);\r\n}\r\n\r\n.toggle.active {\r\n    background: var(--accent);\r\n}\r\n\r\n.toggle.active::after {\r\n    transform: translateX(20px);\r\n    background: var(--bg);\r\n}\r\n\r\n/* cards */\r\n.card {\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-lg);\r\n    overflow: hidden;\r\n    transition: all var(--transition-normal);\r\n}\r\n\r\n.card:hover {\r\n    border-color: var(--border-light);\r\n    box-shadow: var(--shadow-md);\r\n}\r\n\r\n.card-header {\r\n    padding: var(--space-md);\r\n    border-bottom: 1px solid var(--border);\r\n}\r\n\r\n.card-body {\r\n    padding: var(--space-md);\r\n}\r\n\r\n.card-footer {\r\n    padding: var(--space-md);\r\n    border-top: 1px solid var(--border);\r\n}\r\n\r\n\r\n/* Featured badge */\r\n.badge-featured {\r\n    position: absolute;\r\n    top: var(--space-sm);\r\n    left: var(--space-sm);\r\n    padding: var(--space-xs) var(--space-sm);\r\n    background: var(--accent);\r\n    color: var(--bg);\r\n    font-size: 0.625rem;\r\n    font-weight: 700;\r\n    text-transform: uppercase;\r\n    letter-spacing: 0.05em;\r\n    border-radius: var(--radius-sm);\r\n}\r\n\r\n/* Favorite star */\r\n.favorite-btn {\r\n    position: absolute;\r\n    top: var(--space-sm);\r\n    right: var(--space-sm);\r\n    width: 32px;\r\n    height: 32px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background: rgba(0, 0, 0, 0.5);\r\n    border: none;\r\n    border-radius: 50%;\r\n    color: var(--text-muted);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n    opacity: 0;\r\n}\r\n\r\n.media-card:hover .favorite-btn {\r\n    opacity: 1;\r\n}\r\n\r\n.favorite-btn:hover {\r\n    background: rgba(0, 0, 0, 0.7);\r\n    color: var(--text);\r\n}\r\n\r\n.favorite-btn.active {\r\n    color: #fbbf24;\r\n    opacity: 1;\r\n}\r\n\r\n/* grid */\r\n.grid {\r\n    display: grid;\r\n    gap: var(--space-md);\r\n}\r\n\r\n.grid-cols-2 {\r\n    grid-template-columns: repeat(2, 1fr);\r\n}\r\n\r\n.grid-cols-3 {\r\n    grid-template-columns: repeat(3, 1fr);\r\n}\r\n\r\n.grid-cols-4 {\r\n    grid-template-columns: repeat(4, 1fr);\r\n}\r\n\r\n.grid-cols-5 {\r\n    grid-template-columns: repeat(5, 1fr);\r\n}\r\n\r\n.grid-cols-6 {\r\n    grid-template-columns: repeat(6, 1fr);\r\n}\r\n\r\n/* Auto-fit grid for responsive cards */\r\n.grid-auto {\r\n    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));\r\n}\r\n\r\n.grid-auto-lg {\r\n    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\r\n}\r\n\r\n/* flex */\r\n.flex {\r\n    display: flex;\r\n}\r\n\r\n.flex-col {\r\n    flex-direction: column;\r\n}\r\n\r\n.flex-wrap {\r\n    flex-wrap: wrap;\r\n}\r\n\r\n.items-center {\r\n    align-items: center;\r\n}\r\n\r\n.items-start {\r\n    align-items: flex-start;\r\n}\r\n\r\n.items-end {\r\n    align-items: flex-end;\r\n}\r\n\r\n.justify-center {\r\n    justify-content: center;\r\n}\r\n\r\n.justify-between {\r\n    justify-content: space-between;\r\n}\r\n\r\n.justify-end {\r\n    justify-content: flex-end;\r\n}\r\n\r\n.gap-xs {\r\n    gap: var(--space-xs);\r\n}\r\n\r\n.gap-sm {\r\n    gap: var(--space-sm);\r\n}\r\n\r\n.gap-md {\r\n    gap: var(--space-md);\r\n}\r\n\r\n.gap-lg {\r\n    gap: var(--space-lg);\r\n}\r\n\r\n.flex-1 {\r\n    flex: 1;\r\n}\r\n\r\n/* spacing */\r\n.p-xs {\r\n    padding: var(--space-xs);\r\n}\r\n\r\n.p-sm {\r\n    padding: var(--space-sm);\r\n}\r\n\r\n.p-md {\r\n    padding: var(--space-md);\r\n}\r\n\r\n.p-lg {\r\n    padding: var(--space-lg);\r\n}\r\n\r\n.p-xl {\r\n    padding: var(--space-xl);\r\n}\r\n\r\n.m-xs {\r\n    margin: var(--space-xs);\r\n}\r\n\r\n.m-sm {\r\n    margin: var(--space-sm);\r\n}\r\n\r\n.m-md {\r\n    margin: var(--space-md);\r\n}\r\n\r\n.m-lg {\r\n    margin: var(--space-lg);\r\n}\r\n\r\n.mt-sm {\r\n    margin-top: var(--space-sm);\r\n}\r\n\r\n.mt-md {\r\n    margin-top: var(--space-md);\r\n}\r\n\r\n.mt-lg {\r\n    margin-top: var(--space-lg);\r\n}\r\n\r\n.mb-sm {\r\n    margin-bottom: var(--space-sm);\r\n}\r\n\r\n.mb-md {\r\n    margin-bottom: var(--space-md);\r\n}\r\n\r\n.mb-lg {\r\n    margin-bottom: var(--space-lg);\r\n}\r\n\r\n/* modals */\r\n.modal-overlay {\r\n    position: fixed;\r\n    inset: 0;\r\n    background: rgba(0, 0, 0, 0.8);\r\n    backdrop-filter: blur(4px);\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    z-index: var(--z-modal);\r\n    opacity: 0;\r\n    visibility: hidden;\r\n    transition: all var(--transition-normal);\r\n}\r\n\r\n.modal-overlay.show {\r\n    opacity: 1;\r\n    visibility: visible;\r\n}\r\n\r\n.modal {\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: var(--radius-xl);\r\n    max-width: 90vw;\r\n    max-height: 90vh;\r\n    overflow: hidden;\r\n    transform: scale(0.95);\r\n    transition: transform var(--transition-normal);\r\n}\r\n\r\n.modal-overlay.show .modal {\r\n    transform: scale(1);\r\n}\r\n\r\n.modal-header {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    padding: var(--space-md);\r\n    border-bottom: 1px solid var(--border);\r\n}\r\n\r\n.modal-title {\r\n    font-size: 1rem;\r\n    font-weight: 600;\r\n}\r\n\r\n.modal-close {\r\n    width: 32px;\r\n    height: 32px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background: transparent;\r\n    border: none;\r\n    color: var(--text-muted);\r\n    cursor: pointer;\r\n    border-radius: var(--radius-md);\r\n    transition: all var(--transition-fast);\r\n}\r\n\r\n.modal-close:hover {\r\n    background: var(--surface-hover);\r\n    color: var(--text);\r\n}\r\n\r\n.modal-body {\r\n    padding: var(--space-md);\r\n    overflow-y: auto;\r\n}\r\n\r\n.modal-footer {\r\n    display: flex;\r\n    justify-content: flex-end;\r\n    gap: var(--space-sm);\r\n    padding: var(--space-md);\r\n    border-top: 1px solid var(--border);\r\n}\r\n\r\n/* tabs */\r\n.tabs {\r\n    display: flex;\r\n    gap: 2px;\r\n    background: var(--surface);\r\n    padding: var(--space-xs);\r\n    border-radius: var(--radius-md);\r\n    border: 1px solid var(--border);\r\n}\r\n\r\n.tab {\r\n    padding: var(--space-sm) var(--space-md);\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    color: var(--text-muted);\r\n    background: transparent;\r\n    border: none;\r\n    border-radius: var(--radius-sm);\r\n    cursor: pointer;\r\n    transition: all var(--transition-fast);\r\n}\r\n\r\n.tab:hover {\r\n    color: var(--text);\r\n}\r\n\r\n.tab.active {\r\n    background: var(--surface-hover);\r\n    color: var(--text);\r\n}\r\n\r\n/* search */\r\n\r\n/* ============================================\r\n   OFFLINE INDICATOR\r\n   ============================================ */\r\n.offline-banner {\r\n    position: fixed;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    padding: var(--space-sm) var(--space-md);\r\n    background: var(--warning);\r\n    color: var(--bg);\r\n    text-align: center;\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    z-index: var(--z-toast);\r\n    transform: translateY(-100%);\r\n    transition: transform var(--transition-normal);\r\n}\r\n\r\n.offline-banner.show {\r\n    transform: translateY(0);\r\n}\r\n\r\n.offline-badge {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    gap: var(--space-xs);\r\n    padding: var(--space-xs) var(--space-sm);\r\n    background: var(--warning);\r\n    color: var(--bg);\r\n    font-size: 0.625rem;\r\n    font-weight: 600;\r\n    text-transform: uppercase;\r\n    border-radius: var(--radius-sm);\r\n}\r\n\r\n/* ============================================\r\n   LOADING STATES\r\n   ============================================ */\r\n.skeleton {\r\n    background: linear-gradient(90deg, var(--surface) 0%, var(--surface-hover) 50%, var(--surface) 100%);\r\n    background-size: 200% 100%;\r\n    animation: shimmer 1.5s infinite;\r\n    border-radius: var(--radius-md);\r\n}\r\n\r\n@keyframes shimmer {\r\n    0% {\r\n        background-position: 200% 0;\r\n    }\r\n\r\n    100% {\r\n        background-position: -200% 0;\r\n    }\r\n}\r\n\r\n.spinner {\r\n    width: 24px;\r\n    height: 24px;\r\n    border: 2px solid var(--border);\r\n    border-top-color: var(--accent);\r\n    border-radius: 50%;\r\n    animation: spin 0.8s linear infinite;\r\n}\r\n\r\n@keyframes spin {\r\n    to {\r\n        transform: rotate(360deg);\r\n    }\r\n}\r\n\r\n/* ============================================\r\n   ANIMATIONS\r\n   ============================================ */\r\n@keyframes fadeIn {\r\n    from {\r\n        opacity: 0;\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n    }\r\n}\r\n\r\n@keyframes slideUp {\r\n    from {\r\n        opacity: 0;\r\n        transform: translateY(10px);\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n        transform: translateY(0);\r\n    }\r\n}\r\n\r\n@keyframes scaleIn {\r\n    from {\r\n        opacity: 0;\r\n        transform: scale(0.95);\r\n    }\r\n\r\n    to {\r\n        opacity: 1;\r\n        transform: scale(1);\r\n    }\r\n}\r\n\r\n.animate-fadeIn {\r\n    animation: fadeIn var(--transition-normal) ease;\r\n}\r\n\r\n.animate-slideUp {\r\n    animation: slideUp var(--transition-normal) ease;\r\n}\r\n\r\n.animate-scaleIn {\r\n    animation: scaleIn var(--transition-normal) ease;\r\n}\r\n\r\n/* ============================================\r\n   UTILITIES\r\n   ============================================ */\r\n.hidden {\r\n    display: none !important;\r\n}\r\n\r\n.sr-only {\r\n    position: absolute;\r\n    width: 1px;\r\n    height: 1px;\r\n    padding: 0;\r\n    margin: -1px;\r\n    overflow: hidden;\r\n    clip: rect(0, 0, 0, 0);\r\n    border: 0;\r\n}\r\n\r\n.truncate {\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n}\r\n\r\n.w-full {\r\n    width: 100%;\r\n}\r\n\r\n.h-full {\r\n    height: 100%;\r\n}\r\n\r\n.relative {\r\n    position: relative;\r\n}\r\n\r\n.absolute {\r\n    position: absolute;\r\n}\r\n\r\n.fixed {\r\n    position: fixed;\r\n}\r\n\r\n.inset-0 {\r\n    inset: 0;\r\n}\r\n\r\n/* ============================================\r\n   RESPONSIVE\r\n   ============================================ */\r\n@media (max-width: 768px) {\r\n    h1 {\r\n        font-size: 1.75rem;\r\n    }\r\n\r\n    h2 {\r\n        font-size: 1.5rem;\r\n    }\r\n\r\n    h3 {\r\n        font-size: 1.25rem;\r\n    }\r\n\r\n    .grid-auto {\r\n        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));\r\n    }\r\n\r\n    .hide-mobile {\r\n        display: none !important;\r\n    }\r\n}\r\n\r\n@media (min-width: 769px) {\r\n    .hide-desktop {\r\n        display: none !important;\r\n    }\r\n}\n</style>\r\n    <style>\n/* Topbar Styles - Clean & Dark */\r\n/* Note: Inter font is imported in main.css */\r\n\r\nbody {\r\n    margin: 0;\r\n    padding: 0;\r\n    background-color: var(--bg);\r\n    font-family: 'Inter', sans-serif;\r\n}\r\n\r\n#topbar-container {\r\n    position: fixed;\r\n    top: 11px;\r\n    left: 50%;\r\n    transform: translateX(-50%);\r\n    background-color: var(--surface);\r\n    border-radius: 9999px;\r\n    padding: 8px 14px;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 10px;\r\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);\r\n    z-index: 10000;\r\n    border: 1px solid var(--border);\r\n    height: 48px;\r\n    box-sizing: border-box;\r\n}\r\n\r\n#topbar-container::before {\r\n    content: '';\r\n    position: absolute;\r\n    top: -7px;\r\n    bottom: -7px;\r\n    left: -7px;\r\n    right: -7px;\r\n    z-index: -1;\r\n    border-radius: 9999px;\r\n}\r\n\r\n.logo-section {\r\n    display: flex;\r\n    align-items: center;\r\n    padding-right: 10px;\r\n    border-right: 1px solid var(--border);\r\n    height: 32px;\r\n    text-decoration: none;\r\n    color: inherit;\r\n}\r\n\r\n.logo-placeholder {\r\n    width: 28px;\r\n    height: 28px;\r\n    background-color: var(--surface-hover);\r\n    border-radius: 6px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    color: var(--text-muted);\r\n}\r\n\r\n.logo-placeholder i,\r\n.logo-placeholder svg {\r\n    width: 16px;\r\n    height: 16px;\r\n}\r\n\r\n.nav-buttons {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 4px;\r\n}\r\n\r\n.nav-separator {\r\n    width: 1px;\r\n    height: 20px;\r\n    background-color: var(--border);\r\n    margin: 0 6px;\r\n}\r\n\r\n.nav-btn {\r\n    background: transparent;\r\n    border: none;\r\n    color: var(--text-muted);\r\n    text-decoration: none;\r\n    display: flex;\r\n    align-items: center;\r\n    padding: 6px 10px;\r\n    border-radius: 99px;\r\n    height: 32px;\r\n    box-sizing: border-box;\r\n    transition: color 0.15s, background-color 0.15s;\r\n    position: relative;\r\n}\r\n\r\n.nav-badge-beta {\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n    font-size: 8px;\r\n    font-weight: 700;\r\n    color: var(--text);\r\n    background: var(--secondary);\r\n    padding: 2px 4px;\r\n    border-radius: 4px;\r\n    line-height: 1;\r\n    transform: translate(20%, -20%);\r\n    pointer-events: none;\r\n}\r\n\r\n.nav-btn:hover {\r\n    color: var(--text);\r\n    background-color: var(--surface-hover);\r\n}\r\n\r\n.nav-btn i,\r\n.nav-btn svg {\r\n    width: 18px;\r\n    height: 18px;\r\n    min-width: 18px;\r\n}\r\n\r\n.nav-btn span {\r\n    max-width: 0;\r\n    opacity: 0;\r\n    margin-left: 0;\r\n    overflow: hidden;\r\n    white-space: nowrap;\r\n    font-weight: 500;\r\n    font-size: 13px;\r\n    transition: max-width 0.23s ease, opacity 0.17s ease, margin-left 0.23s ease;\r\n}\r\n\r\n#topbar-container:hover .nav-btn span {\r\n    max-width: 70px;\r\n    opacity: 1;\r\n    margin-left: 8px;\r\n}\n</style>\r\n    <style>\n/* Page Layout - Shared styles for games, movies, and similar pages */\r\n\r\n.page-header {\r\n    text-align: center;\r\n    margin-bottom: 24px;\r\n}\r\n\r\n.page-title {\r\n    font-size: 1.5rem;\r\n    font-weight: 700;\r\n    margin-bottom: 4px;\r\n}\r\n\r\n.page-subtitle {\r\n    color: var(--text-muted);\r\n    font-size: 0.875rem;\r\n    min-height: 1.25em;\r\n}\r\n\r\n/* Controls bar - search + filters */\r\n.controls {\r\n    display: flex;\r\n    gap: 10px;\r\n    justify-content: center;\r\n    flex-wrap: wrap;\r\n    margin-bottom: 24px;\r\n    max-width: 800px;\r\n    margin-left: auto;\r\n    margin-right: auto;\r\n}\r\n\r\n/* Shared search box */\r\n.search-box {\r\n    flex: 1;\r\n    min-width: 300px;\r\n    max-width: 100%;\r\n    width: 100%;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: 9999px;\r\n    padding: 12px 20px;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 12px;\r\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);\r\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\r\n    position: relative;\r\n}\r\n\r\n.search-box i {\r\n    color: var(--text-muted);\r\n    font-size: 14px;\r\n}\r\n\r\n.search-box input {\r\n    flex: 1;\r\n    background: transparent;\r\n    border: none;\r\n    outline: none;\r\n    color: var(--text);\r\n    font-size: 0.9375rem;\r\n}\r\n\r\n.search-box input::placeholder {\r\n    color: var(--text-muted);\r\n}\r\n\r\n/* Control Buttons (restored) */\r\n.ctrl-btn {\r\n    padding: 10px 16px;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: 9999px;\r\n    color: var(--text);\r\n    font-size: 0.8125rem;\r\n    font-weight: 500;\r\n    cursor: pointer;\r\n    transition: all 0.15s;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 8px;\r\n}\r\n\r\n.ctrl-btn:hover {\r\n    background: var(--surface-hover);\r\n    border-color: var(--text);\r\n}\r\n\r\n/* Select wrapper with custom dropdown arrow */\r\n.select-wrapper {\r\n    position: relative;\r\n}\r\n\r\n.select-wrapper select {\r\n    appearance: none;\r\n    padding: 10px 32px 10px 16px;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: 9999px;\r\n    color: var(--text);\r\n    font-size: 0.8125rem;\r\n    font-weight: 500;\r\n    cursor: pointer;\r\n    outline: none;\r\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\r\n}\r\n\r\n.select-wrapper::after {\r\n    content: '\\f078';\r\n    font-family: 'Font Awesome 6 Free';\r\n    font-weight: 900;\r\n    position: absolute;\r\n    right: 12px;\r\n    top: 50%;\r\n    transform: translateY(-50%);\r\n    font-size: 0.75rem;\r\n    color: var(--text-muted);\r\n    pointer-events: none;\r\n}\n</style>\r\n    <style>\n/* Media Card Components - Shared across movies.html and potentially others */\r\n\r\n.media-card {\r\n    position: relative;\r\n    aspect-ratio: 3/4;\r\n    border-radius: var(--radius-lg);\r\n    overflow: hidden;\r\n    cursor: pointer;\r\n    background: var(--surface);\r\n    transition: transform var(--transition-normal), box-shadow var(--transition-normal);\r\n}\r\n\r\n.media-card:hover {\r\n    transform: translateY(-4px) scale(1.02);\r\n    box-shadow: var(--shadow-lg);\r\n}\r\n\r\n.media-card img {\r\n    width: 100%;\r\n    height: 100%;\r\n    object-fit: cover;\r\n}\r\n\r\n.media-card-overlay {\r\n    position: absolute;\r\n    inset: 0;\r\n    background: linear-gradient(to top, rgba(0, 0, 0, 0.9) 0%, transparent 50%);\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: flex-end;\r\n    padding: var(--space-md);\r\n    opacity: 0;\r\n    transition: opacity var(--transition-normal);\r\n}\r\n\r\n.media-card:hover .media-card-overlay {\r\n    opacity: 1;\r\n}\r\n\r\n.media-card-overview {\r\n    color: #ffffff;\r\n    font-size: 0.75rem;\r\n    line-height: 1.4;\r\n    display: -webkit-box;\r\n    -webkit-line-clamp: 4;\r\n    line-clamp: 4;\r\n    -webkit-box-orient: vertical;\r\n    overflow: hidden;\r\n    margin-bottom: var(--space-sm);\r\n    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.8);\r\n    font-weight: 500;\r\n}\r\n\r\n.media-card-title {\r\n    font-size: 0.875rem;\r\n    font-weight: 600;\r\n    color: var(--text);\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n}\r\n\r\n.media-card-meta {\r\n    font-size: 0.75rem;\r\n    color: var(--text-muted);\r\n    margin-top: var(--space-xs);\r\n}\r\n\r\n.media-card-rating {\r\n    position: absolute;\r\n    top: 8px;\r\n    right: 8px;\r\n    background: rgba(0, 0, 0, 0.6);\r\n    color: rgba(255, 255, 255, 0.9);\r\n    padding: 2px 6px;\r\n    border-radius: 4px;\r\n    font-size: 0.75rem;\r\n    font-weight: 600;\r\n    z-index: 20;\r\n    backdrop-filter: blur(4px);\r\n    border: 1px solid rgba(255, 255, 255, 0.1);\r\n    opacity: 0;\r\n    transition: opacity 0.2s;\r\n}\r\n\r\n.media-card:hover .media-card-rating {\r\n    opacity: 1;\r\n    background: rgba(0, 0, 0, 0.8);\r\n}\n</style>\r\n    <style>\n.watch-page {\r\n    min-height: 100vh;\r\n    padding: 70px 20px 20px;\r\n}\r\n\r\n.tab-toggle {\r\n    display: flex;\r\n    background: var(--surface);\r\n    border: 1px solid var(--border);\r\n    border-radius: 9999px;\r\n    overflow: hidden;\r\n}\r\n\r\n.tab-btn {\r\n    padding: 10px 16px;\r\n    background: transparent;\r\n    border: none;\r\n    color: var(--text-muted);\r\n    font-size: 0.8125rem;\r\n    font-weight: 500;\r\n    cursor: pointer;\r\n    transition: all 0.15s;\r\n}\r\n\r\n.tab-btn:hover {\r\n    color: var(--text);\r\n    background: var(--surface-hover);\r\n}\r\n\r\n.tab-btn.active {\r\n    background: var(--text);\r\n    color: var(--bg);\r\n}\r\n\r\n#youtube-tab.active {\r\n    background: #FF0000;\r\n    color: white;\r\n    border-color: #FF0000;\r\n}\r\n\r\n#twitch-tab.active {\r\n    background: #9146FF;\r\n    color: white;\r\n    border-color: #9146FF;\r\n}\r\n\r\n.media-grid {\r\n    display: grid;\r\n    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));\r\n    gap: 20px;\r\n    max-width: 1200px;\r\n    margin: 0 auto;\r\n    padding-top: 20px;\r\n}\r\n\r\n.empty-state {\r\n    grid-column: 1 / -1;\r\n    text-align: center;\r\n    padding: 100px 20px;\r\n    color: var(--text-muted);\r\n}\r\n\r\n.empty-state i {\r\n    font-size: 3rem;\r\n    margin-bottom: 20px;\r\n    opacity: 0.2;\r\n}\r\n\r\n.media-card {\r\n    aspect-ratio: 16 / 9;\r\n}\r\n\r\n.error-msg {\r\n    grid-column: 1 / -1;\r\n    text-align: center;\r\n    padding: 40px;\r\n    color: var(--error);\r\n}\n</style>\r\n    <style>\n/**\r\n * PHANTOM - BACKGROUND STYLES\r\n */\r\n.phantom-background {\r\n    position: fixed;\r\n    inset: 0;\r\n    width: 100vw;\r\n    height: 100vh;\r\n    z-index: -1;\r\n    overflow: hidden;\r\n    background: transparent;\r\n    pointer-events: none;\r\n    opacity: 1;\r\n    transition: background-color 0.3s ease;\r\n}\r\n\r\n.phantom-background.active {\r\n    opacity: 1;\r\n}\r\n\r\n.phantom-background-overlay {\r\n    position: absolute;\r\n    inset: 0;\r\n    z-index: 2;\r\n    background: rgba(0, 0, 0, var(--bg-overlay, 0.4));\r\n    transition: background-color 0.3s ease;\r\n}\r\n\r\n.phantom-background-layer {\r\n    position: absolute;\r\n    inset: 0;\r\n    z-index: 1;\r\n    transition: opacity 0.3s ease-in-out;\r\n}\r\n\r\n.phantom-background-media {\r\n    width: 100%;\r\n    height: 100%;\r\n    object-fit: cover;\r\n    object-position: var(--bg-image-position, center);\r\n    display: block;\r\n    border: none;\r\n}\r\n\r\n/* Video and Iframe positioning for full background cover */\r\n.phantom-background-layer video.phantom-background-media,\r\n.phantom-background-layer iframe.phantom-background-media {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    transform: none;\r\n    pointer-events: none;\r\n    min-width: 100%;\r\n    min-height: 100%;\r\n    max-width: none;\r\n    max-height: none;\r\n    object-position: var(--bg-image-position, center);\r\n}\r\n\r\n/* Ensure iframes cover entire background */\r\n.phantom-background-layer iframe.phantom-background-media {\r\n    border: none;\r\n    object-fit: cover;\r\n}\r\n\r\n/* Ensure content on top remains readable */\r\nhtml {\r\n    background-color: var(--bg);\r\n}\r\n\r\nbody {\r\n    position: relative;\r\n    z-index: 0;\r\n    background: transparent !important;\r\n    /* Allow background to show through */\r\n}\r\n\r\n/* Specific adjustments for transparency if needed */\r\n.main-content,\r\n.home-page {\r\n    background: transparent !important;\r\n}\r\n\r\n/* Glassmorphism for containers when background is active */\r\n.phantom-background.active~.offline-banner,\r\n.phantom-background.active~.home-page .card,\r\n.phantom-background.active~.home-page .featured-card,\r\n.phantom-background.active~.home-page .search-bar,\r\n.phantom-background.active~.settings-panel {\r\n    backdrop-filter: blur(10px);\r\n    -webkit-backdrop-filter: blur(10px);\r\n    background: rgba(15, 15, 15, 0.7) !important;\r\n}\n</style>\r\n</head>\r\n\r\n<body>\r\n    <script>\n// topbar\r\n(function () {\r\n    let rootPrefix = '';\r\n    const scriptName = 'components/topbar.js';\r\n    const scripts = document.getElementsByTagName('script');\r\n    for (let i = 0; i < scripts.length; i++) {\r\n        const src = scripts[i].getAttribute('src');\r\n        if (src && src.includes(scriptName)) {\r\n            rootPrefix = src.split(scriptName)[0];\r\n            break;\r\n        }\r\n    }\r\n\r\n    if (!window.lucide && !document.querySelector('script[src*=\"lucide\"]')) {\r\n        const script = document.createElement('script');\r\n        script.src = 'https://unpkg.com/lucide@latest';\r\n        script.onload = () => {\r\n            if (window.lucide) lucide.createIcons();\r\n        };\r\n        document.head.appendChild(script);\r\n    }\r\n\r\n    initTopbar();\r\n\r\n    function createTopbar() {\r\n        const topbarContainer = document.createElement('div');\r\n        topbarContainer.id = 'topbar-container';\r\n\r\n        const logoSection = document.createElement('a');\r\n        logoSection.className = 'logo-section';\r\n        logoSection.href = rootPrefix + 'index2.html';\r\n        logoSection.innerHTML = '<div class=\"logo-placeholder\"><i data-lucide=\"zap\"></i></div>';\r\n        topbarContainer.appendChild(logoSection);\r\n\r\n        const navButtons = document.createElement('div');\r\n        navButtons.className = 'nav-buttons';\r\n\r\n        const buttons = [\r\n            { name: 'Music', icon: 'music', link: 'pages/music.html', badge: 'BETA' },\r\n            { name: 'Movies', icon: 'film', link: 'pages/movies.html' },\r\n            { name: 'Games', icon: 'gamepad-2', link: 'pages/games.html' },\r\n            { name: 'Watch', icon: 'play', link: 'pages/watch.html' },\r\n            { name: 'Search', icon: 'search', link: 'staticsjv2/index.html' },\r\n            { name: 'AI Chat', icon: 'bot', link: 'pages/chat.html' },\r\n            { separator: true },\r\n            { name: 'Settings', icon: 'settings', link: 'pages/settings.html' }\r\n        ];\r\n\r\n        buttons.forEach(btn => {\r\n            if (btn.separator) {\r\n                const separator = document.createElement('div');\r\n                separator.className = 'nav-separator';\r\n                navButtons.appendChild(separator);\r\n                return;\r\n            }\r\n\r\n            const link = document.createElement('a');   \r\n            link.href = rootPrefix + btn.link;\r\n            link.className = 'nav-btn';\r\n\r\n            const icon = document.createElement('i');\r\n            icon.setAttribute('data-lucide', btn.icon);\r\n            link.appendChild(icon);\r\n\r\n            const span = document.createElement('span');\r\n            span.textContent = btn.name;\r\n            link.appendChild(span);\r\n\r\n            if (btn.badge) {\r\n                const badge = document.createElement('div');\r\n                badge.className = 'nav-badge-beta';\r\n                badge.textContent = btn.badge;\r\n                link.appendChild(badge);\r\n            }\r\n\r\n            navButtons.appendChild(link);\r\n        });\r\n\r\n        topbarContainer.appendChild(navButtons);\r\n        document.body.prepend(topbarContainer);\r\n\r\n        if (window.lucide) {\r\n            lucide.createIcons();\r\n        }\r\n    }\r\n\r\n    function initTopbar() {\r\n        if (document.readyState === 'loading') {\r\n            document.addEventListener('DOMContentLoaded', createTopbar);\r\n        } else {\r\n            createTopbar();\r\n        }\r\n    }\r\n})();\r\n\n</script>\r\n\r\n    <div class=\"watch-page\">\r\n        <header class=\"page-header\">\r\n            <h1 class=\"page-title\">Media Watch</h1>\r\n            <p class=\"page-subtitle\">Stream movies and TV shows</p>\r\n            <div id=\"status\"\r\n                style=\"font-size: 0.7rem; color: var(--text-muted); margin-top: 4px; opacity: 0.6; height: 1em;\"></div>\r\n        </header>\r\n\r\n        <div class=\"controls\">\r\n            <div class=\"search-box\">\r\n                <i class=\"fa-solid fa-search\"></i>\r\n                <input type=\"text\" id=\"search-input\" placeholder=\"Search YouTube...\">\r\n            </div>\r\n            <div class=\"tab-toggle\">\r\n                <button class=\"tab-btn active\" id=\"youtube-tab\" onclick=\"setPlatform('youtube')\">YouTube</button>\r\n                <button class=\"tab-btn\" id=\"twitch-tab\" onclick=\"setPlatform('twitch')\">Twitch</button>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"media-grid\" id=\"media-grid\">\r\n            <!-- Search results will appear here -->\r\n        </div>\r\n    </div>\r\n\r\n    <script>\n(function () {\r\n    const style = document.createElement('style');\r\n    style.textContent = `\r\n        .notify-container { position: fixed; top: 16px; right: 16px; z-index: 99999; display: flex; flex-direction: column; gap: 8px; pointer-events: none; font-family: 'Inter', sans-serif; }\r\n        .notify-toast { display: flex; align-items: center; gap: 12px; padding: 12px 16px; background: rgba(15, 15, 15, 0.9); backdrop-filter: blur(10px); border: 1px solid var(--border, #1f1f1f); border-radius: 10px; color: #e4e4e7; font-size: 13px; min-width: 280px; max-width: 380px; box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4); pointer-events: auto; transform: translateX(120%); opacity: 0; transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1), opacity 0.3s ease; position: relative; overflow: hidden; }\r\n        .notify-toast.show { transform: translateX(0); opacity: 1; }\r\n        .notify-toast.hiding { transform: translateX(120%); opacity: 0; }\r\n        .notify-icon { width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }\r\n        .notify-icon svg { width: 18px; height: 18px; }\r\n        .notify-content { flex: 1; line-height: 1.4; }\r\n        .notify-title { font-weight: 600; margin-bottom: 2px; }\r\n        .notify-message { color: #a1a1aa; font-size: 12px; }\r\n        .notify-close { background: none; border: none; color: #52525b; cursor: pointer; padding: 4px; border-radius: 4px; display: flex; align-items: center; justify-content: center; }\r\n        .notify-close:hover { background: rgba(255,255,255,0.1); color: #fff; }\r\n        .notify-close svg { width: 14px; height: 14px; }\r\n        .notify-toast.success { border-left: 3px solid #22c55e; } .notify-toast.success .notify-icon { color: #22c55e; }\r\n        .notify-toast.error { border-left: 3px solid #ef4444; } .notify-toast.error .notify-icon { color: #ef4444; }\r\n        .notify-toast.warning { border-left: 3px solid #f59e0b; } .notify-toast.warning .notify-icon { color: #f59e0b; }\r\n        .notify-toast.info { border-left: 3px solid #3b82f6; } .notify-toast.info .notify-icon { color: #3b82f6; }\r\n        .notify-progress { position: absolute; bottom: 0; left: 0; height: 2px; background: rgba(255, 255, 255, 0.2); transition: width linear; }\r\n    `;\r\n    document.head.appendChild(style);\r\n\r\n    let container = null;\r\n    const getContainer = () => container || (container = document.body.appendChild(Object.assign(document.createElement('div'), { className: 'notify-container' })));\r\n\r\n    const icons = {\r\n        success: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"20 6 9 17 4 12\"></polyline></svg>`,\r\n        error: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"15\" y1=\"9\" x2=\"9\" y2=\"15\"></line><line x1=\"9\" y1=\"9\" x2=\"15\" y2=\"15\"></line></svg>`,\r\n        warning: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\"></path><line x1=\"12\" y1=\"9\" x2=\"12\" y2=\"13\"></line><line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\"></line></svg>`,\r\n        info: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"12\" y1=\"16\" x2=\"12\" y2=\"12\"></line><line x1=\"12\" y1=\"8\" x2=\"12.01\" y2=\"8\"></line></svg>`,\r\n        close: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line><line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line></svg>`\r\n    };\r\n\r\n    function notify(type, title, msg = '', dur = 4000) {\r\n        const t = document.createElement('div');\r\n        t.className = `notify-toast ${type}`;\r\n        t.innerHTML = `<div class=\"notify-icon\">${icons[type]}</div><div class=\"notify-content\"><div class=\"notify-title\">${title}</div><div class=\"notify-message\">${msg}</div></div><button class=\"notify-close\">${icons.close}</button><div class=\"notify-progress\"></div>`;\r\n        const p = t.querySelector('.notify-progress');\r\n        const dismiss = () => { t.classList.add('hiding'); setTimeout(() => t.remove(), 300); };\r\n        t.querySelector('.notify-close').onclick = dismiss;\r\n        p.style.width = '100%';\r\n        setTimeout(() => { p.style.transition = `width ${dur}ms linear`; p.style.width = '0%'; }, 50);\r\n        let timer = setTimeout(dismiss, dur);\r\n        t.onmouseenter = () => { clearTimeout(timer); p.style.transition = 'none'; };\r\n        t.onmouseleave = () => {\r\n            const rem = (parseFloat(getComputedStyle(p).width) / t.offsetWidth) * dur;\r\n            p.style.transition = `width ${rem}ms linear`; p.style.width = '0%';\r\n            timer = setTimeout(dismiss, rem);\r\n        };\r\n        getContainer().appendChild(t);\r\n        requestAnimationFrame(() => t.classList.add('show'));\r\n    }\r\n\r\n    window.Notify = {\r\n        success: (a, b, c) => notify('success', a, b, c),\r\n        error: (a, b, c) => notify('error', a, b, c),\r\n        warning: (a, b, c) => notify('warning', a, b, c),\r\n        info: (a, b, c) => notify('info', a, b, c)\r\n    };\r\n})();\r\n\n</script>\r\n    <script>\n// site config\r\n\r\nwindow.SITE_CONFIG = {\r\n    name: \"Phantom\",\r\n    fullName: \"Phantom Unblocked\",\r\n    version: \"1.0.12\",\r\n\r\n    changelog: [\r\n        \"1.0.12: tiny fixxes and changes\",\r\n        \"some code consolidation and fixxes\",\r\n        \"suggest features in the discord server\"\r\n    ],\r\n\r\n    // quotes\r\n    quotes: [\r\n        \"lebron lebron lebronn james\",\r\n        \"so tuff\",\r\n        \"it is what it is\",\r\n        \"do ur work\",\r\n        \"this is what happens when u dont touch grass\",\r\n        \"FULL BOX\",\r\n        \"FULL PIECE\",\r\n        \"200!\",\r\n        \"press esc + refresh + power button for hacks\",\r\n        \"press ctrl+x to hide your screen\",\r\n        \"change the tab title and favicon in settings\",\r\n        \"TEACHERR!\",\r\n        \"1 pump\",\r\n        \"303 headshot\",\r\n        \"bros prolly a 60 ovr\",\r\n        \"take the L lil bro\",  \r\n        \"lebron is OUR goat\",\r\n        \"stop looking at my screen\",\r\n    ],\r\n\r\n    // todo\r\n    // *** for strikethrough\r\n    // ** for bold\r\n    todos: [\r\n        \"***fixxed aboutblank opening while securly is on (previously if popups were off it would load intab instead of clickto launch now it will use clicktolaunch unless popups are blocked)***\",\r\n        \"***fix the proxy***\",\r\n        \"***fix panic panickey, add quote talking about it***\",\r\n        \"***fix theatermode, make it hide buttons after a few seconds and ensure all content is being displayed and move the description to the bottom***\",\r\n        \"***change back player to use old styling, change the surface to use background colors for the bottom part where description is shown, looking just like the background***\",\r\n        \"***add image and video support for backgrounds***\",\r\n        \"***fix aichat, make the title use the same ai request as the users question unless its in image mode where it will use text mode and fix ai chat to remember modes better***\",\r\n        \"***add cloaking to quotes***\",\r\n        \"***add a default cloak and fix it so icons work in aboutblank for whatever reason they only work when you go to settings in aboutblank where it correctly applies***\",\r\n        \"***for search suggestions add highlighting for whatever will happen when you click enter, in search suggestions fix all games not sending you to the games page***\",\r\n        \"***fix games to make multi library the default, put it in config.js***\",\r\n        \"***rename movies shortcut in index2.html to primeshows, add shortcuts to main pages in the topbar and change the current shortcuts to more popular games***\",\r\n        \"***make announcements show even on first visit unlike changelog and allow disabling it via settings***\",\r\n        \"***fix leave comformation asking u to leave each time you click something***\",\r\n        \"***change the shortcuts on the main page to include pages***\",\r\n        \"***add movies to the search bar in main page***\",\r\n        \"***fix background not turning off soon***\",\r\n        \"***fix music page to hide youtube player unless toggled via 3 dot small button, and always shown on proxy mode, fix all the controls for video time, volume***\",\r\n        \"**add singlefile this is lowk so hard i dont really understand it**\",\r\n        \"**advertise phantom (too much work tbh)**\",\r\n        \"**add a watch page for youtube and twitch**\",\r\n        \"**add a miniplayer for music**\",\r\n        \"***shorten some page's code***\",\r\n        \"***fix paths in search autocomplete***\",\r\n        \"***fix markdown in ai not using correct text colors***\",\r\n        \"***make backgrounds show in the loading screen***\",\r\n        \"***fix icons for topbar in code.html***\",\r\n        \"**fix wisp server not notifying or autoswitiching when offline in proxy**\",\r\n        \"***fix code runner open not working at all***\",\r\n        \"***make backgrounds show in player.html***\",\r\n        \"***make backgrounds show in staticsjv2***\",\r\n        \"***make player.html player controls use theme colros not hardcoded***\",\r\n        \"***make ai chat and music sidebar go all the way down and up with borders***\",\r\n        \"**make the only song in music be lebron lebron lebron james**\",\r\n        \"**fix music controls**\",\r\n        \"***finish extra page into credits and make this todo be tucked away somewhere and not the main part of it***\"\r\n    ],\r\n    defaultWisp: \"wss://glseries.net/wisp/\",\r\n    wispServers: [\r\n        { name: \"GLSeries Wisp\", url: \"wss://glseries.net/wisp/\" },\r\n        { name: \"Rhw's Wisp\", url: \"wss://wisp.rhw.one/\" },\r\n    ],\r\n\r\n    discord: {\r\n        inviteUrl: \"https://discord.gg/tHWx9NXp5p\",\r\n        widgetServer: \"1447673724017971324\",\r\n        widgetChannel: \"1447673726228496617\",\r\n    },\r\n\r\n    firstVisitCloak: false, //fake error page\r\n    defaults: {\r\n        cloakMode: \"about:blank\",\r\n        tabTitle: \"You've already responded\",\r\n        tabFavicon: \"https://ssl.gstatic.com/docs/spreadsheets/forms/forms_icon_2023q4.ico\",\r\n        cloakRotation: false,\r\n        cloakInterval: 5000,\r\n        panicKey: \"x\",\r\n        panicModifiers: [\"ctrl\", \"shift\"],\r\n        panicUrl: \"https://classroom.google.com\",\r\n        maxMovieRating: \"R\",\r\n        gameLibrary: \"multi\",\r\n        discordWidget: true,\r\n        miniplayer: true,\r\n        leaveConfirmation: false,\r\n        showChangelogOnUpdate: true,\r\n        themeRotation: true,\r\n        lastThemeRotation: 0,\r\n        backgroundRotation: true,\r\n        lastBackgroundRotation: 0,\r\n        lastSeenFeatured: 'none',\r\n        background: { type: 'color', value: '#0a0a0a' },\r\n        customBackground: { id: 'none', type: 'none' },\r\n        accentColor: '#ffffff',\r\n        surfaceColor: '#0f0f0f',\r\n        secondaryColor: '#2e2e33',\r\n        textColor: '#e4e4e7',\r\n    },\r\n\r\n    themePresets: {\r\n        dark: { name: 'Dark (Default)', bg: { type: 'color', value: '#0a0a0a' }, surface: '#0f0f0f', surfaceHover: '#1a1a1a', surfaceActive: '#252525', secondary: '#2e2e33', border: '#2a2a2a', borderLight: '#2a2a2a', text: '#e4e4e7', textSec: '#71717a', textDim: '#52525b', accent: '#ffffff' },\r\n        midnight: { name: 'Midnight', bg: { type: 'color', value: '#000000' }, surface: '#050505', surfaceHover: '#111111', surfaceActive: '#1a1a1a', secondary: '#111111', border: '#1a1a1a', borderLight: '#111111', text: '#ededed', textSec: '#a3a3a3', textDim: '#737373', accent: '#d4d4d4' },\r\n        abyss: { name: 'Abyss', bg: { type: 'color', value: '#020617' }, surface: '#0f172a', surfaceHover: '#1e293b', surfaceActive: '#334155', secondary: '#1e293b', border: '#1e293b', borderLight: '#1e293b', text: '#f1f5f9', textSec: '#94a3b8', textDim: '#64748b', accent: '#38bdf8' },\r\n        phantom: { name: 'Phantom', bg: { type: 'color', value: '#0f0a14' }, surface: '#1a0f24', surfaceHover: '#2e1a40', surfaceActive: '#4c2a5c', secondary: '#2e1a40', border: '#2e1a40', borderLight: '#2e1a40', text: '#f3e8ff', textSec: '#d8b4fe', textDim: '#c084fc', accent: '#c084fc' },\r\n        rosepine: { name: 'Rose Pine', bg: { type: 'color', value: '#191724' }, surface: '#1f1d2e', surfaceHover: '#26233a', surfaceActive: '#524f67', secondary: '#26233a', border: '#26233a', borderLight: '#1f1d2e', text: '#e0def4', textSec: '#908caa', textDim: '#6e6a86', accent: '#ebbcba' },\r\n        ocean: { name: 'Oceanic', bg: { type: 'color', value: '#011627' }, surface: '#0b2942', surfaceHover: '#1d3b53', surfaceActive: '#2d4b63', secondary: '#0b2942', border: '#1d3b53', borderLight: '#0b2942', text: '#d6deeb', textSec: '#5f7e97', textDim: '#011627', accent: '#7fdbca' },\r\n        forest: { name: 'Forest', bg: { type: 'color', value: '#020d06' }, surface: '#051a0d', surfaceHover: '#0a2e17', surfaceActive: '#0f4221', secondary: '#051a0d', border: '#0a2e17', borderLight: '#051a0d', text: '#ecfdf5', textSec: '#6ee7b7', textDim: '#064e3b', accent: '#10b981' },\r\n        crimson: { name: 'Crimson', bg: { type: 'color', value: '#1a0505' }, surface: '#230a0a', surfaceHover: '#7b0a0aff', surfaceActive: '#7f1d1d', secondary: '#230a0a', border: '#480f0fff', borderLight: '#230a0a', text: '#fef2f2', textSec: '#fecaca', textDim: '#450a0a', accent: '#ef4444' },\r\n        flame: { name: 'Flame', bg: { type: 'color', value: '#0c0202' }, surface: '#1c0a0a', surfaceHover: '#451a03', surfaceActive: '#9a3412', secondary: '#1c0a0a', border: '#451a03', borderLight: '#9a3412', text: '#fff7ed', textSec: '#fdba74', textDim: '#ea580c', accent: '#f59e0b' }\r\n    },\r\n\r\n    backgroundPresets: [\r\n        { id: 'none', name: 'None (Theme Default)', type: 'none' },\r\n        { id: 'Night sky', name: 'Night sky', type: 'image', url: 'https://images.pexels.com/photos/5675745/pexels-photo-5675745.jpeg', overlay: 0.3 },\r\n        { id: 'winter-mountains', name: 'Winter mountains', type: 'image', url: 'https://images.pexels.com/photos/1287145/pexels-photo-1287145.jpeg', overlay: 0.3 },\r\n        { id: 'f1 car', name: 'F1 Car', type: 'image', url: 'https://images.pexels.com/photos/14401632/pexels-photo-14401632.jpeg', overlay: 0.3 },\r\n        { id: 'moon-landing', name: 'Moon Landing', type: 'image', url: 'https://images.pexels.com/photos/41162/moon-landing-apollo-11-nasa-buzz-aldrin-41162.jpeg', overlay: 0.3, objectPosition: 'top left', active: true },\r\n        { id: 'turtle', name: 'Turtle', type: 'image', url: 'https://images.unsplash.com/photo-1501791187590-9ef2612ba1eb?q=80&w=1932&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D', overlay: 0.3 },\r\n        { id: 'road', name: 'Road', type: 'image', url: 'https://images.unsplash.com/photo-1508233620467-f79f1e317a05', overlay: 0.3 },\r\n        { id: 'railroad', name: 'Railroad', type: 'image', url: 'https://images.unsplash.com/photo-1505832018823-50331d70d237', overlay: 0.3 },\r\n        { id: 'mountain', name: 'Mountain', type: 'image', url: 'https://raw.githubusercontent.com/evanhnry/brave-wallpapers/refs/heads/main/Brave/clay-banks-u27Rrbs9Dwc-unsplash.jpg', overlay: 0.3 },\r\n    ],\r\n\r\n    cloakPresets: [\r\n        { name: \"Phantom\", icon: \"/favicon.svg\", title: \"Phantom Unblocked\" },\r\n        { name: \"Edpuzzle\", icon: \"https://edpuzzle.imgix.net/favicons/favicon-32.png\", title: \"Edpuzzle\" },\r\n        { name: \"Google Docs\", icon: \"https://ssl.gstatic.com/docs/documents/images/kix-favicon7.ico\", title: \"Untitled document - Google Docs\" },\r\n        { name: \"Canvas\", icon: \"https://du11hjcvx0uqb.cloudfront.net/dist/images/favicon-e10d657a73.ico\", title: \"Dashboard\" },\r\n        { name: \"Desmos\", icon: \"https://www.desmos.com/favicon.ico\", title: \"Desmos | Graphing Calculator\" },\r\n        { name: \"Khan Academy\", icon: \"https://cdn.kastatic.org/images/favicon.ico\", title: \"Khan Academy\" },\r\n        { name: \"Wikipedia\", icon: \"https://en.wikipedia.org/favicon.ico\", title: \"World War II - Wikipedia\" },\r\n        { name: \"Classroom\", icon: \"https://ssl.gstatic.com/classroom/favicon.png\", title: \"Home - Classroom\" },\r\n        { name: \"Canva\", icon: \"https://static.canva.com/static/images/android-192x192-2.png\", title: \"Home - Canva\" },\r\n        { name: \"Quiz\", icon: \"https://ssl.gstatic.com/docs/spreadsheets/forms/forms_icon_2023q4.ico\", title: \"You've already responded\" },\r\n        { name: \"Blooket\", icon: \"https://play.blooket.com/favicon.ico\", title: \"Play Blooket | Blooket\" },\r\n        { name: \"Gmail\", icon: \"https://ssl.gstatic.com/ui/v1/icons/mail/rfr/gmail.ico\", title: \"Gmail\" },\r\n        { name: \"YouTube\", icon: \"https://www.youtube.com/favicon.ico\", title: \"YouTube\" },\r\n        { name: \"Powerschool\", icon: \"https://waverlyk12.powerschool.com/favicon.ico\", title: \"Grades and Attendance\" },\r\n        { name: \"nothing\", icon: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=\", title: \"\\u200B\" },\r\n    ]\r\n}\r\n\r\n\r\n\n</script>\r\n    <script>\n// settings handler\r\n(function () {\r\n    'use strict';\r\n\r\n    const STORAGE_KEY = 'void_settings';\r\n\r\n    const getDefaults = () => {\r\n        return window.SITE_CONFIG?.defaults || {\r\n            cloakMode: 'none',\r\n            cloakRotation: false,\r\n            cloakInterval: 5000,\r\n            panicKey: 'x',\r\n            panicModifiers: ['ctrl', 'shift'],\r\n            panicUrl: 'https://classroom.google.com',\r\n            maxMovieRating: 'R',\r\n            offlineGames: [],\r\n            gameLibrary: 'multi',\r\n            leaveConfirmation: false\r\n        };\r\n    };\r\n\r\n    const load = () => {\r\n        try {\r\n            const stored = localStorage.getItem(STORAGE_KEY);\r\n            if (stored) {\r\n                return { ...getDefaults(), ...JSON.parse(stored) };\r\n            }\r\n        } catch (e) {\r\n            console.warn('Failed to load settings:', e);\r\n        }\r\n        return getDefaults();\r\n    };\r\n\r\n    const save = (settings) => {\r\n        try {\r\n            localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n            window.dispatchEvent(new CustomEvent('settings-changed', { detail: settings }));\r\n            if (window.parent !== window) {\r\n                window.parent.postMessage({ type: 'settings-update' }, '*');\r\n            }\r\n        } catch (e) {\r\n            console.warn('Failed to save settings:', e);\r\n        }\r\n    };\r\n\r\n    let _settings = load();\r\n\r\n    window.Settings = {\r\n        get(key) { return _settings[key]; },\r\n\r\n        getAll() { return { ..._settings }; },\r\n\r\n        set(key, value) {\r\n            _settings[key] = value;\r\n            save(_settings);\r\n            this.apply();\r\n            return value;\r\n        },\r\n\r\n        update(partial) {\r\n            _settings = { ..._settings, ...partial };\r\n            save(_settings);\r\n            this.apply();\r\n        },\r\n\r\n        reset() {\r\n            _settings = getDefaults();\r\n            save(_settings);\r\n            this.apply();\r\n        },\r\n\r\n        apply() {\r\n            const root = document.documentElement;\r\n            const s = _settings;\r\n            const d = window.SITE_CONFIG?.defaults || {};\r\n\r\n            const vars = {\r\n                '--accent': s.accentColor || d.accentColor || '#ffffff',\r\n                '--surface': s.surfaceColor || d.surfaceColor || '#0f0f0f',\r\n                '--surface-hover': s.surfaceHoverColor || d.surfaceHoverColor || '#1a1a1a',\r\n                '--surface-active': s.surfaceActiveColor || d.surfaceActiveColor || '#252525',\r\n                '--secondary': s.secondaryColor || d.secondaryColor || '#2e2e33',\r\n                '--border': s.borderColor || d.borderColor || '#1f1f1f',\r\n                '--border-light': s.borderLightColor || d.borderLightColor || '#2a2a2a',\r\n                '--text': s.textColor || d.textColor || '#e4e4e7',\r\n                '--text-muted': s.textSecondaryColor || d.textSecondaryColor || '#71717a',\r\n                '--text-dim': s.textDimColor || d.textDimColor || '#52525b',\r\n                '--toggle': s.toggleColor || d.toggleColor,\r\n                '--toggle-knob': s.toggleKnobColor || d.toggleKnobColor\r\n            };\r\n\r\n            Object.entries(vars).forEach(([key, val]) => {\r\n                if (val) root.style.setProperty(key, val);\r\n            });\r\n\r\n            const themeBg = s.background || d.background || { type: 'color', value: '#0a0a0a' };\r\n            const customBg = s.customBackground;\r\n            const isCustomActive = customBg && customBg.type !== 'none';\r\n\r\n            if (themeBg.type === 'color') {\r\n                root.style.setProperty('--bg', themeBg.value);\r\n            }\r\n\r\n            if (isCustomActive && customBg.url) {\r\n                root.style.setProperty('--bg-image', `url(${customBg.url})`);\r\n\r\n                let position = customBg.objectPosition;\r\n                if (customBg.id && customBg.id !== 'custom') {\r\n                    const preset = window.SITE_CONFIG?.backgroundPresets?.find(b => b.id === customBg.id);\r\n                    if (preset?.objectPosition) position = preset.objectPosition;\r\n                }\r\n\r\n                root.style.setProperty('--bg-image-position', position || 'center');\r\n            } else if (themeBg.type === 'image' || themeBg.type === 'video') {\r\n                root.style.setProperty('--bg-image', `url(${themeBg.value || themeBg.url})`);\r\n                root.style.setProperty('--bg-image-position', themeBg.objectPosition || 'center');\r\n            } else if (themeBg.type === 'gradient') {\r\n                root.style.setProperty('--bg-image', themeBg.value || themeBg.url);\r\n                root.style.setProperty('--bg-image-position', 'center');\r\n            } else {\r\n                root.style.setProperty('--bg-image', 'none');\r\n            }\r\n        },\r\n\r\n        onChange(callback) {\r\n            window.addEventListener('settings-changed', (e) => callback(e.detail));\r\n        },\r\n\r\n        isRatingAllowed(rating) {\r\n            if (!rating || rating === 'NR' || rating === 'NC-17') return false;\r\n            const ratingOrder = ['G', 'PG', 'PG-13', 'R'];\r\n            const maxIndex = ratingOrder.indexOf(_settings.maxMovieRating);\r\n            const ratingIndex = ratingOrder.indexOf(rating);\r\n            return maxIndex !== -1 && ratingIndex !== -1 && ratingIndex <= maxIndex;\r\n        }\r\n    };\r\n\r\n    // panic button go brr\r\n    const handlePanic = (e) => {\r\n        const mods = _settings.panicModifiers || [];\r\n        const key = _settings.panicKey || 'x';\r\n\r\n        if (mods.includes('ctrl') !== e.ctrlKey) return;\r\n        if (mods.includes('shift') !== e.shiftKey) return;\r\n        if (mods.includes('alt') !== e.altKey) return;\r\n\r\n        if (e.key.toLowerCase() === key.toLowerCase()) {\r\n            e.preventDefault();\r\n            const overlayId = 'panic-overlay';\r\n            let overlay = window.parent?.document?.getElementById(overlayId) || document.getElementById(overlayId);\r\n\r\n            if (!overlay) {\r\n                overlay = document.createElement('div');\r\n                overlay.id = overlayId;\r\n                overlay.style.cssText = 'position:fixed;inset:0;background:white;z-index:99999;';\r\n                document.body.appendChild(overlay);\r\n            } else {\r\n                overlay.style.display = 'block';\r\n            }\r\n\r\n            window.location.replace(_settings.panicUrl || 'https://classroom.google.com');\r\n        }\r\n    };\r\n\r\n    const init = () => {\r\n        Settings.apply();\r\n\r\n        const featured = window.SITE_CONFIG?.featuredBackground;\r\n        const activePreset = window.SITE_CONFIG?.backgroundPresets?.find(p => p.active);\r\n\r\n        const target = activePreset || featured;\r\n\r\n        if (target?.id && target.id !== _settings.lastSeenFeatured) {\r\n            Settings.update({\r\n                customBackground: target,\r\n                lastSeenFeatured: target.id,\r\n                backgroundRotation: false\r\n            });\r\n        }\r\n\r\n        document.addEventListener('keydown', handlePanic, true);\r\n\r\n        window.addEventListener('storage', (e) => {\r\n            if (e.key === STORAGE_KEY) {\r\n                _settings = load();\r\n                Settings.apply();\r\n                window.dispatchEvent(new CustomEvent('settings-changed', { detail: _settings }));\r\n            }\r\n        });\r\n\r\n        window.addEventListener('message', (e) => {\r\n            if (e.data?.type === 'settings-update' || e.data === 'updateCloak') {\r\n                _settings = load();\r\n                Settings.apply();\r\n                window.dispatchEvent(new CustomEvent('settings-changed', { detail: _settings }));\r\n            }\r\n        });\r\n\r\n        window.addEventListener('beforeunload', (e) => {\r\n            if (document.getElementById('main-frame') && _settings.leaveConfirmation) {\r\n                e.preventDefault();\r\n                return e.returnValue = '';\r\n            }\r\n        });\r\n    };\r\n\r\n    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', init);\r\n    else init();\r\n})();\r\n\n</script>\r\n    <script>\n// background stuff\r\n(function () {\r\n    'use strict';\r\n\r\n    if (window.BackgroundManager) return;\r\n\r\n    const YOUTUBE_REGEX = /(?:youtube\\.com\\/watch\\?v=|youtu\\.be\\/|youtube\\.com\\/embed\\/)([a-zA-Z0-9_-]{11})/;\r\n\r\n    const BackgroundManager = {\r\n        container: null,\r\n        mediaLayer: null,\r\n        elements: { video: null, image: null, iframe: null },\r\n        current: { type: null, url: null },\r\n        cacheName: 'phantom-bg-cache-v2',\r\n\r\n        init() {\r\n            this.container = document.createElement('div');\r\n            this.container.className = 'phantom-background';\r\n            this.container.innerHTML = '<div class=\"phantom-background-overlay\"></div><div class=\"phantom-background-layer\"></div>';\r\n            this.mediaLayer = this.container.querySelector('.phantom-background-layer');\r\n            document.body.insertBefore(this.container, document.body.firstChild);\r\n\r\n            const apply = () => this.applyBackground();\r\n            window.addEventListener('settings-changed', apply);\r\n            window.addEventListener('storage', apply);\r\n            window.addEventListener('beforeunload', () => this.cleanup());\r\n            window.addEventListener('pagehide', () => this.cleanup());\r\n\r\n            document.addEventListener('visibilitychange', () => {\r\n                const video = this.elements.video;\r\n                if (!video) return;\r\n                if (document.hidden) video.pause();\r\n                else if (this.current.type === 'video') video.play().catch(() => { });\r\n            });\r\n\r\n            this.applyBackground();\r\n        },\r\n\r\n        applyBackground() {\r\n            if (!this.container) return; // Wait for init() to create the container\r\n\r\n            const s = window.Settings?.getAll() || {};\r\n            const custom = s.customBackground;\r\n            const theme = s.background || {};\r\n\r\n            let type = null, url = null, pos = null, overlay = 0.4;\r\n\r\n            if (custom && custom.type !== 'none') {\r\n                // Refresh from config if possible to get latest props like objectPosition\r\n                if (custom.id && custom.id !== 'custom') {\r\n                    const preset = window.SITE_CONFIG?.backgroundPresets?.find(b => b.id === custom.id);\r\n                    if (preset) Object.assign(custom, preset);\r\n                }\r\n                ({ type, url, objectPosition: pos, overlay = 0.4 } = custom);\r\n            } else if (theme.type === 'image' || theme.type === 'video' || theme.type === 'youtube') {\r\n                type = theme.type;\r\n                url = theme.value || theme.url;\r\n                pos = theme.objectPosition;\r\n                overlay = theme.overlay || 0.4;\r\n            }\r\n\r\n            document.documentElement.style.setProperty('--bg-overlay', overlay);\r\n\r\n            // Handle common positioning typos and normalize\r\n            if (pos && typeof pos === 'string') {\r\n                pos = pos.toLowerCase().trim()\r\n                    .replace(/\\s+/g, ' ') // Normalize multiple spaces\r\n                    .replace('topleft', 'top left')\r\n                    .replace('topright', 'top right')\r\n                    .replace('bottomleft', 'bottom left')\r\n                    .replace('bottomright', 'bottom right')\r\n                    .replace('centercenter', 'center')\r\n                    .replace('centerleft', 'center left')\r\n                    .replace('centerright', 'center right');\r\n            }\r\n\r\n            document.documentElement.style.setProperty('--bg-image-position', pos || 'center');\r\n\r\n            if (!type || !url) {\r\n                this.clear();\r\n                document.documentElement.style.backgroundColor = 'var(--bg)';\r\n                document.documentElement.style.setProperty('--bg-image-position', 'center');\r\n                return;\r\n            }\r\n            if (this.current.type === type && this.current.url === url) return;\r\n\r\n            this.current = { type, url };\r\n\r\n            if (type === 'video' || url.match(/\\.(mp4|webm|ogg|mov|m4v)$/i)) {\r\n                this.clearMedia();\r\n                this.createVideo(url, pos);\r\n                this.container.classList.add('active');\r\n                document.documentElement.classList.add('phantom-bg-active');\r\n                document.body.classList.add('phantom-bg-active');\r\n            } else if (type === 'youtube' || YOUTUBE_REGEX.test(url)) {\r\n                this.clearMedia();\r\n                this.createYouTube(url, pos);\r\n                this.container.classList.add('active');\r\n                document.documentElement.classList.add('phantom-bg-active');\r\n                document.body.classList.add('phantom-bg-active');\r\n            } else if (type === 'image') {\r\n                this.handleImageBackground(url, pos);\r\n            }\r\n        },\r\n\r\n        async getProxiedCachedUrl(url) {\r\n            // Local images don't need proxying\r\n            if (!url.startsWith('http') || url.includes(location.hostname)) return url;\r\n\r\n            // Try direct load first (faster)\r\n            try {\r\n                const directTest = await fetch(url, { method: 'HEAD', mode: 'cors' });\r\n                if (directTest.ok) return url;\r\n            } catch (e) {\r\n                // CORS blocked, need to proxy\r\n            }\r\n\r\n            // Wait for BareMux (max 500ms)\r\n            let retries = 0;\r\n            while (!window.BareMux && retries < 5) {\r\n                await new Promise(r => setTimeout(r, 100));\r\n                retries++;\r\n            }\r\n\r\n            if (!window.BareMux) {\r\n                console.warn(\"Background: BareMux not found, trying direct URL.\");\r\n                return url; // Try direct anyway\r\n            }\r\n\r\n            try {\r\n                const client = new window.BareMux.BareClient();\r\n                const response = await client.fetch(url);\r\n                if (!response.ok) throw new Error('Proxy fetch failed');\r\n\r\n                const blob = await response.blob();\r\n                return URL.createObjectURL(blob);\r\n            } catch (error) {\r\n                console.error(\"Background proxy failed:\", error);\r\n                return url; // Fallback to direct URL\r\n            }\r\n        },\r\n\r\n        async handleImageBackground(url, pos) {\r\n            // Pre-load the image (proxied/cached or direct)\r\n            const finalUrl = await this.getProxiedCachedUrl(url);\r\n\r\n            // Check if this is still the current background after async fetch\r\n            if (this.current.url !== url) {\r\n                if (finalUrl && finalUrl.startsWith('blob:')) URL.revokeObjectURL(finalUrl);\r\n                return;\r\n            }\r\n\r\n            this.clearMedia();\r\n            this.createImage(finalUrl, pos);\r\n        },\r\n\r\n        createVideo(url, pos) {\r\n            const el = Object.assign(document.createElement('video'), {\r\n                className: 'phantom-background-media', src: url, autoplay: true, loop: true, muted: true, playsInline: true, volume: 0\r\n            });\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n            el.onerror = () => (this.elements.video = null);\r\n            this.elements.video = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        createImage(url, pos) {\r\n            const el = Object.assign(document.createElement('img'), {\r\n                className: 'phantom-background-media',\r\n                src: url\r\n            });\r\n\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n\r\n            el.onload = () => {\r\n                if (this.current.url === url || url.startsWith('blob:')) {\r\n                    this.container.classList.add('active');\r\n                    document.documentElement.classList.add('phantom-bg-active');\r\n                    document.body.classList.add('phantom-bg-active');\r\n                }\r\n            };\r\n            el.onerror = () => {\r\n                console.warn(\"Background image failed to load:\", url);\r\n                if (this.elements.image === el) this.elements.image = null;\r\n            };\r\n\r\n            this.elements.image = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        // youtube logic\r\n        createYouTube(url, pos) {\r\n            const id = url.match(YOUTUBE_REGEX)?.[1];\r\n            if (!id) return;\r\n            const el = Object.assign(document.createElement('iframe'), {\r\n                className: 'phantom-background-media',\r\n                src: `https://www.youtube.com/embed/${id}?autoplay=1&loop=1&playlist=${id}&controls=0&modestbranding=1&rel=0&mute=1&enablejsapi=1`,\r\n                allow: 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture'\r\n            });\r\n            // Apply objectPosition from settings/preset\r\n            if (pos) el.style.objectPosition = pos;\r\n            this.elements.iframe = el;\r\n            this.mediaLayer.appendChild(el);\r\n        },\r\n\r\n        clearMedia() {\r\n            Object.entries(this.elements).forEach(([key, el]) => {\r\n                if (!el) return;\r\n                if (key === 'video') { el.pause(); el.src = ''; }\r\n                if (key === 'iframe') el.src = 'about:blank';\r\n                if (key === 'image' && el.src.startsWith('blob:')) {\r\n                    URL.revokeObjectURL(el.src);\r\n                }\r\n                el.remove();\r\n                this.elements[key] = null;\r\n            });\r\n        },\r\n\r\n        clear() {\r\n            this.clearMedia();\r\n            this.current = { type: null, url: null };\r\n            document.documentElement.classList.remove('phantom-bg-active');\r\n            document.body.classList.remove('phantom-bg-active');\r\n            document.documentElement.style.backgroundColor = '';\r\n            if (this.container) this.container.classList.remove('active');\r\n        },\r\n\r\n        cleanup() {\r\n            this.clearMedia();\r\n        }\r\n    };\r\n\r\n    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', () => BackgroundManager.init());\r\n    else BackgroundManager.init();\r\n\r\n    window.BackgroundManager = BackgroundManager;\r\n})();\r\n\n</script>\r\n    <script>\nwindow.Quotes = {\r\n    // Use data from config, fallback to empty array if not found\r\n    getData() {\r\n        return (window.SITE_CONFIG && window.SITE_CONFIG.quotes) || [];\r\n    },\r\n\r\n    getRandom() {\r\n        const data = this.getData();\r\n        if (!data.length) return null; // Return null if no quotes\r\n        return data[Math.floor(Math.random() * data.length)];\r\n    },\r\n    init(force = false) {\r\n        const quote = this.getRandom();\r\n        if (!quote) return; // Do nothing if no quotes\r\n\r\n        const targets = [\r\n            '#quote',\r\n            '#quote-display',\r\n            '#subtitle',\r\n            '.page-subtitle',\r\n            '.extra-hero p',\r\n            '.loading-text'\r\n        ];\r\n\r\n        targets.forEach(selector => {\r\n            document.querySelectorAll(selector).forEach(el => {\r\n                // Only update if force is true, or it's empty, or has placeholder text\r\n                const text = el.textContent.trim();\r\n                if (force || !text || text === 'Loading...' || text.includes('Stream movies') || text.includes('Customize your')) {\r\n                    el.textContent = quote;\r\n                }\r\n            });\r\n        });\r\n    }\r\n};\r\n\r\nwindow.QUOTES = window.Quotes.getData();\r\n\r\n// Run automatically on load\r\nif (document.readyState === 'loading') {\r\n    document.addEventListener('DOMContentLoaded', () => window.Quotes.init());\r\n} else {\r\n    window.Quotes.init();\r\n}\r\n\n</script>\r\n    <script>\nconst YT_KEY = '2c202bc3d7msh4897b5b2a7d3f0cp15a754jsn568117aaec11';\r\nconst TWITCH_PROXY = 'https://twitch.leelive2021.workers.dev/';\r\n\r\nlet currentPlatform = 'youtube';\r\nconst grid = document.getElementById('media-grid');\r\nconst searchInput = document.getElementById('search-input');\r\nconst statusText = document.getElementById('status');\r\n\r\nfunction setPlatform(p) {\r\n    currentPlatform = p;\r\n    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));\r\n    document.getElementById(p + '-tab').classList.add('active');\r\n    searchInput.placeholder = `Search ${p === 'youtube' ? 'YouTube' : 'Twitch Channel'}...`;\r\n    grid.innerHTML = '';\r\n    if (statusText) statusText.textContent = '';\r\n\r\n    // On platform switch, if search is empty, show defaults\r\n    if (!searchInput.value.trim()) {\r\n        if (p === 'youtube') searchYouTube('Fortnite');\r\n        else showDefaultStreamers();\r\n    }\r\n}\r\n\r\nfunction showDefaultStreamers() {\r\n    if (!grid) return;\r\n    grid.innerHTML = \"\";\r\n    const streamers = ['Clix', 'Jynxzi', 'Lacy', 'Flight23White', 'Caseoh_', 'Kaicenat', 'Stableronaldo', 'Marlon', 'PlaqueboyMax', 'Adinross', 'IshowSpeed',];\r\n\r\n    streamers.forEach(channel => {\r\n        const title = `${channel}`;\r\n        const thumb = `https://static-cdn.jtvnw.net/previews-ttv/live_user_${channel}-440x248.jpg`;\r\n        const card = createMediaCard(thumb, title, \"Twitch\", () => {\r\n            const streamUrl = `${TWITCH_PROXY}?channel=${channel}`;\r\n            playMedia(title, streamUrl);\r\n        });\r\n        grid.appendChild(card);\r\n    });\r\n}\r\n\r\nasync function startSearch() {\r\n    const query = searchInput.value;\r\n    if (!query) return;\r\n    currentPlatform === 'youtube' ? searchYouTube(query) : searchTwitch(query);\r\n}\r\n\r\nasync function searchYouTube(query) {\r\n    if (!grid) return;\r\n    if (statusText) statusText.textContent = \"Querying YouTube API...\";\r\n\r\n    // Show skeletons\r\n    grid.innerHTML = Array(12).fill('<div class=\"media-card\"><div class=\"skeleton\" style=\"width:100%;height:100%;\"></div></div>').join('');\r\n\r\n    const url = `https://youtube-api-full.p.rapidapi.com/api/search/videos?query=${encodeURIComponent(query)}&maxResults=20`;\r\n\r\n    try {\r\n        const response = await fetch(url, {\r\n            headers: { 'X-RapidAPI-Key': YT_KEY, 'X-RapidAPI-Host': 'youtube-api-full.p.rapidapi.com' }\r\n        });\r\n        const result = await response.json();\r\n        const videos = result.data?.items || [];\r\n\r\n        grid.innerHTML = \"\";\r\n        videos.forEach(item => {\r\n            const vId = item.id.videoId || item.id;\r\n            const title = item.snippet.title;\r\n            const channel = item.snippet.channelTitle;\r\n            const thumb = item.snippet.thumbnails.high?.url || item.snippet.thumbnails.medium.url;\r\n\r\n            const card = createMediaCard(thumb, title, channel, () => {\r\n                const embedUrl = `https://www.youtube-nocookie.com/embed/${vId}?autoplay=1`;\r\n                playMedia(title, embedUrl);\r\n            });\r\n            grid.appendChild(card);\r\n        });\r\n        if (statusText) statusText.textContent = \"\";\r\n    } catch (e) {\r\n        if (statusText) statusText.textContent = \"Search Error\";\r\n        grid.innerHTML = '<div class=\"error-msg\">Failed to load content.</div>';\r\n    }\r\n}\r\n\r\nfunction searchTwitch(query) {\r\n    if (!grid) return;\r\n    grid.innerHTML = \"\";\r\n    const input = query.toLowerCase().trim();\r\n    if (!input) { showDefaultStreamers(); return; }\r\n\r\n    const channels = input.split(',').map(s => s.trim()).filter(s => s.length > 0);\r\n\r\n    channels.forEach(channel => {\r\n        const title = `${channel} (Live)`;\r\n        const thumb = `https://static-cdn.jtvnw.net/previews-ttv/live_user_${channel}-440x248.jpg`;\r\n        const card = createMediaCard(thumb, title, \"Twitch.tv\", () => {\r\n            const streamUrl = `${TWITCH_PROXY}?channel=${channel}`;\r\n            playMedia(title, streamUrl);\r\n        });\r\n        grid.appendChild(card);\r\n    });\r\n\r\n    if (statusText) statusText.textContent = channels.length > 0 ? \"Channels ready.\" : \"\";\r\n}\r\n\r\nfunction createMediaCard(thumb, title, meta, onClick) {\r\n    const card = document.createElement('div');\r\n    card.className = 'media-card';\r\n    card.innerHTML = `\r\n        <img src=\"${thumb}\" loading=\"lazy\" alt=\"${title}\" onerror=\"this.src='https://via.placeholder.com/440x248?text=Offline'\">\r\n        <div class=\"media-card-overlay\">\r\n            <div class=\"media-card-info\">\r\n                <div class=\"media-card-title\">${title}</div>\r\n                <div class=\"media-card-meta\">${meta}</div>\r\n            </div>\r\n        </div>\r\n    `;\r\n    card.onclick = onClick;\r\n    return card;\r\n}\r\n\r\nfunction playMedia(title, url) {\r\n    const params = new URLSearchParams({\r\n        type: 'game', // Use game type to just load the URL\r\n        title: title,\r\n        url: url\r\n    });\r\n    // Store empty overview or video info if needed\r\n    sessionStorage.setItem('currentMovie', JSON.stringify({ overview: 'Platform Stream' }));\r\n    window.location.href = `player.html?${params.toString()}`;\r\n}\r\n\r\n// Initial load\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n    // Automatically search for Fortnite to populate the grid\r\n    searchYouTube('Fortnite');\r\n});\r\n\r\n// Add event listener for Enter key\r\nif (searchInput) {\r\n    searchInput.addEventListener('keypress', (e) => {\r\n        if (e.key === 'Enter') startSearch();\r\n    });\r\n}\r\n\n</script>\r\n\r\n    <script>\n// footer\r\n(function () {\r\n    'use strict';\r\n\r\n    let rootPrefix = '';\r\n    const scriptName = 'components/footer.js';\r\n    const scripts = document.getElementsByTagName('script');\r\n    for (let i = 0; i < scripts.length; i++) {\r\n        const src = scripts[i].getAttribute('src');\r\n        if (src && src.includes(scriptName)) {\r\n            rootPrefix = src.split(scriptName)[0];\r\n            break;\r\n        }\r\n    }\r\n\r\n    const config = window.SITE_CONFIG || { name: 'Phantom', version: '1.0.0', discord: { inviteUrl: '#' }, changelog: [], cloakPresets: [] };\r\n    const STORAGE_KEY = 'void_settings';\r\n    let storedSettings = {};\r\n    try { storedSettings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n\r\n    // settings\r\n    let settings = { ...(config.defaults || {}), ...storedSettings };\r\n\r\n    const footer = document.createElement('footer');\r\n    footer.id = 'site-footer';\r\n    footer.innerHTML = `\r\n        <style>\r\n            #site-footer {\r\n                margin-top: 0px;\r\n                padding: 20px;\r\n                border-top: 1px solid var(--border, #1f1f1f);\r\n                text-align: center;\r\n                background: transparent;\r\n            }\r\n            #site-footer .footer-links {\r\n                display: flex;\r\n                gap: 16px;\r\n                justify-content: center;\r\n                margin-bottom: 8px;\r\n                flex-wrap: wrap;\r\n            }\r\n            #site-footer .footer-link {\r\n                font-size: 12px;\r\n                color: var(--text-muted, #71717a);\r\n                text-decoration: none;\r\n                transition: color 0.15s;\r\n                font-family: 'Inter', sans-serif;\r\n                cursor: pointer;\r\n            }\r\n            #site-footer .footer-link:hover {\r\n                color: var(--text, #e4e4e7);\r\n            }\r\n            #site-footer .footer-version {\r\n                font-size: 11px;\r\n                color: var(--text-dim, #52525b);\r\n                cursor: pointer;\r\n                font-family: 'Inter', sans-serif;\r\n            }\r\n            #site-footer .footer-version:hover {\r\n                color: var(--text-muted, #71717a);\r\n            }\r\n        </style>\r\n        <div class=\"footer-links\">\r\n            <a href=\"${rootPrefix}pages/settings.html\" class=\"footer-link\"><i class=\"fa-solid fa-gear\"></i> Settings</a>\r\n            <a id=\"footer-changelog\" class=\"footer-link\"><i class=\"fa-solid fa-clock-rotate-left\"></i> Changelog</a>\r\n            <a href=\"${config.discord?.inviteUrl || '#'}\" target=\"_blank\" class=\"footer-link\"><i class=\"fa-brands fa-discord\"></i> Discord</a>\r\n            <a href=\"${rootPrefix}pages/terms.html\" class=\"footer-link\">Terms</a>\r\n            <a href=\"${rootPrefix}pages/disclaimer.html\" class=\"footer-link\">Disclaimer</a>\r\n            <a href=\"${rootPrefix}pages/extra.html\" class=\"footer-link\">Credits</a>\r\n        </div>\r\n        <span class=\"footer-version\" id=\"footer-version\">${config.name || 'Phantom'} v${config.version || '1.0.0'}</span>\r\n    `;\r\n\r\n    document.body.appendChild(footer);\r\n\r\n\r\n\r\n    // gtm\r\n    // Inject GTM head script if not already present\r\n    if (!document.querySelector('script[src*=\"googletagmanager.com/gtm.js\"]')) {\r\n        window.dataLayer = window.dataLayer || [];\r\n        window.dataLayer.push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' });\r\n        const gtmScript = document.createElement('script');\r\n        gtmScript.async = true;\r\n        gtmScript.src = 'https://www.googletagmanager.com/gtm.js?id=GTM-5LMBC27Z';\r\n        document.head.insertBefore(gtmScript, document.head.firstChild);\r\n    }\r\n\r\n    // Add GTM noscript fallback (for pages that don't have it in HTML)\r\n    if (!document.querySelector('noscript iframe[src*=\"googletagmanager\"]')) {\r\n        const gtmNoscript = document.createElement('noscript');\r\n        gtmNoscript.innerHTML = '<iframe src=\"https://www.googletagmanager.com/ns.html?id=GTM-5LMBC27Z\" height=\"0\" width=\"0\" style=\"display:none;visibility:hidden\"></iframe>';\r\n        document.body.insertBefore(gtmNoscript, document.body.firstChild);\r\n    }\r\n\r\n    const openChangelog = (e, customTitle, customContent) => {\r\n        if (e && e.preventDefault) e.preventDefault();\r\n        const changes = customContent || config.changelog || ['No changes listed'];\r\n\r\n        // Use standard modal structure from main.css\r\n        const overlay = document.createElement('div');\r\n        overlay.className = 'modal-overlay';\r\n\r\n        overlay.innerHTML = `\r\n            <div class=\"modal\" style=\"width: 400px; max-width: 90vw;\">\r\n                <div class=\"modal-header\">\r\n                    <h3 class=\"modal-title\">${customTitle || 'What\\'s New in v' + config.version}</h3>\r\n                    <button class=\"modal-close\"><i class=\"fa-solid fa-xmark\"></i></button>\r\n                </div>\r\n                <div class=\"modal-body\">\r\n                    <ul style=\"margin: 0; padding-left: 20px; color: var(--text-muted); font-size: 0.875rem; line-height: 1.6;\">\r\n                        ${changes.map(c => '<li>' + c + '</li>').join('')}\r\n                    </ul>\r\n                </div>\r\n                <div class=\"modal-footer\">\r\n                    <a href=\"${config.discord?.inviteUrl || '#'}\" target=\"_blank\" style=\"color: #5865F2; text-decoration: none; font-size: 13px; display: inline-flex; align-items: center; gap: 6px;\">\r\n                        <i class=\"fa-brands fa-discord\"></i> Join Discord\r\n                    </a>\r\n                </div>\r\n            </div>\r\n        `;\r\n\r\n        document.body.appendChild(overlay);\r\n\r\n        // Trigger animation\r\n        requestAnimationFrame(() => overlay.classList.add('show'));\r\n\r\n        const close = () => {\r\n            overlay.classList.remove('show');\r\n            setTimeout(() => overlay.remove(), 200);\r\n        };\r\n\r\n        overlay.querySelector('.modal-close').onclick = close;\r\n        overlay.onclick = (e) => { if (e.target === overlay) close(); };\r\n    };\r\n\r\n    // Expose openChangelog globally\r\n    window.openChangelog = openChangelog;\r\n\r\n    const changelogBtn = document.getElementById('footer-changelog');\r\n    if (changelogBtn) changelogBtn.onclick = openChangelog;\r\n\r\n    const versionBtn = document.getElementById('footer-version');\r\n    if (versionBtn) versionBtn.onclick = openChangelog;\r\n\r\n    // sync\r\n    // syncRemoteChangelog removed - using local config\r\n\r\n\r\n    // Initialize Sync\r\n    // syncRemoteChangelog();\r\n\r\n    const currentVersion = config.version;\r\n    const lastVersion = settings.lastVersion;\r\n\r\n    if (settings.showChangelogOnUpdate && lastVersion && lastVersion !== currentVersion) {\r\n        setTimeout(() => {\r\n            openChangelog();\r\n            settings.lastVersion = currentVersion;\r\n            localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n        }, 1000);\r\n    } else if (!lastVersion) {\r\n        settings.lastVersion = currentVersion;\r\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));\r\n    }\r\n\r\n    // panic\r\n    if (settings.panicKey) {\r\n        document.addEventListener('keydown', (e) => {\r\n            const keys = settings.panicModifiers || ['ctrl', 'shift'];\r\n            const triggerKey = settings.panicKey.toLowerCase();\r\n            const pressedKey = e.key.toLowerCase();\r\n\r\n            // Check modifiers\r\n            const ctrlMatch = keys.includes('ctrl') === e.ctrlKey;\r\n            const shiftMatch = keys.includes('shift') === e.shiftKey;\r\n            const altMatch = keys.includes('alt') === e.altKey;\r\n\r\n            if (ctrlMatch && shiftMatch && altMatch && pressedKey === triggerKey) {\r\n                e.preventDefault();\r\n\r\n                // Show white screen instantly (if panic-overlay exists in parent)\r\n                const parentOverlay = window.parent?.document?.getElementById('panic-overlay');\r\n                if (parentOverlay) {\r\n                    parentOverlay.style.display = 'block';\r\n                } else {\r\n                    // Create overlay if it doesn't exist\r\n                    const overlay = document.createElement('div');\r\n                    overlay.id = 'panic-overlay';\r\n                    overlay.style.cssText = 'position:fixed;inset:0;background:white;z-index:99999;';\r\n                    document.body.appendChild(overlay);\r\n                }\r\n\r\n                // Redirect immediately\r\n                const url = settings.panicUrl || 'https://classroom.google.com';\r\n                try { window.top.location.href = url; } catch { window.location.href = url; }\r\n            }\r\n        }, true); // Use capture phase for faster response\r\n    }\r\n\r\n    // Cloaking logic has been moved to scripts/cloaking.js for better synchronization.\r\n    // If you need cloaking on a specific page, include that script.\r\n\r\n\r\n    window.addEventListener('beforeunload', (e) => {\r\n        // Reload settings to get latest value\r\n        try { settings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n\r\n        if (window.top === window.self && settings.leaveConfirmation) {\r\n            e.preventDefault();\r\n            e.returnValue = '';\r\n            return '';\r\n        }\r\n    });\r\n\r\n    // discord\r\n    let crateInstance = null;\r\n\r\n    function initDiscord() {\r\n        if (settings.discordWidget && config.discord && config.discord.widgetServer && config.discord.widgetChannel) {\r\n            // Check if already loaded\r\n            if (document.querySelector('script[src*=\"@widgetbot/crate\"]')) {\r\n                if (crateInstance) crateInstance.show();\r\n                return;\r\n            }\r\n\r\n            const crateScript = document.createElement('script');\r\n            crateScript.src = 'https://cdn.jsdelivr.net/npm/@widgetbot/crate@3';\r\n            crateScript.async = true;\r\n            crateScript.defer = true;\r\n            crateScript.onload = () => {\r\n                crateInstance = new Crate({\r\n                    server: config.discord.widgetServer,\r\n                    channel: config.discord.widgetChannel,\r\n                    glyph: ['https://cdn.discordapp.com/embed/avatars/0.png', '100%'],\r\n                    location: ['bottom', 'right']\r\n                });\r\n            };\r\n            document.body.appendChild(crateScript);\r\n        } else {\r\n            // Hide if disabled\r\n            if (crateInstance) crateInstance.hide();\r\n        }\r\n    }\r\n\r\n    // Initialize\r\n    initDiscord();\r\n\r\n    // Listen for settings change to toggle dynamically\r\n    window.addEventListener('storage', (e) => {\r\n        if (e.key === STORAGE_KEY) {\r\n            try { settings = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}'); } catch { }\r\n            initDiscord();\r\n        }\r\n    });\r\n\r\n    // Listen for internal event\r\n    window.addEventListener('settings-changed', (e) => {\r\n        settings = e.detail;\r\n        initDiscord();\r\n    });\r\n\r\n    // counters\r\n    // Only show on home page (index2.html) checking if main-content exists\r\n    const mainContent = document.querySelector('.main-content');\r\n    // Ensure we are on the home page view (search bar checks etc) or just check existence\r\n    if (mainContent && document.querySelector('.featured-section')) {\r\n        const counterContainer = document.createElement('div');\r\n        counterContainer.id = 'supercounters-wrapper';\r\n        counterContainer.style.marginTop = '24px';\r\n        counterContainer.style.textAlign = 'center';\r\n        counterContainer.style.opacity = '0.8';\r\n\r\n        // Use iframe to isolate document.write from the widget\r\n        const iframe = document.createElement('iframe');\r\n        iframe.style.border = 'none';\r\n        iframe.style.width = '150px';\r\n        iframe.style.height = '40px';\r\n        iframe.style.overflow = 'hidden';\r\n\r\n        // Widget code\r\n        const widgetCode = `\r\n            <html>\r\n            <body style=\"margin:0;display:flex;justify-content:center;align-items:center;background:transparent;\">\r\n                <script type=\"text/javascript\" src=\"//widget.supercounters.com/ssl/online_i.js\"><\\/script>\r\n                <script type=\"text/javascript\">sc_online_i(1726449,\"ffffff\",\"000000\");<\\/script>\r\n            </body>\r\n            </html>\r\n        `;\r\n\r\n        iframe.srcdoc = widgetCode;\r\n        counterContainer.appendChild(iframe);\r\n        mainContent.appendChild(counterContainer);\r\n    }\r\n})();\r\n\n</script>\r\n</body>\r\n\r\n</html>"};
    window.CURRENT_VFS_PATH = window.CURRENT_VFS_PATH || "";

    if (window === top) {
        let p = window.location.pathname;
        window.STATICSJ_BASE_PATH = p.substring(0, p.lastIndexOf('/') + 1) + "staticsjv2/";
    } else {
        window.STATICSJ_BASE_PATH = parent.STATICSJ_BASE_PATH;
    }

    function normalize(path, base = "") {
        if (!path || path.startsWith('http') || path.startsWith('data:') || path.startsWith('blob:') || path.startsWith('#')) return path;
        let p = path.split('?')[0].split('#')[0].replace(/\\/g, '/');
        if (p.startsWith(window.origin)) p = p.substring(window.origin.length);
        if (p.startsWith('/')) p = p.substring(1);
        
        let bParts = base.split('/').filter(x => x);
        if (bParts.length > 0 && !base.endsWith('/')) bParts.pop();
        p.split('/').forEach(part => {
            if (part === '..') bParts.pop();
            else if (part !== '.' && part !== '') bParts.push(part);
        });
        return bParts.join('/');
    }

    const desc = Object.getOwnPropertyDescriptor(HTMLIFrameElement.prototype, 'src');
    Object.defineProperty(HTMLIFrameElement.prototype, 'src', {
        set: function(v) {
            const norm = normalize(v, window.CURRENT_VFS_PATH);
            const entry = window.VFS_DATA[norm] || window.VFS_DATA[norm + '.html'];
            if (entry) {
                const bCode = document.getElementById('phantom-bootloader').outerHTML;
                this.srcdoc = bCode + '<script>window.CURRENT_VFS_PATH="' + norm + '";<\/script>' + entry;
                // Force a load event trigger for the parent's handlers
                setTimeout(() => { this.dispatchEvent(new Event('load')); }, 10);
            } else {
                desc.set.call(this, v);
            }
        },
        get: desc.get
    });

    window.addEventListener('DOMContentLoaded', () => {
        document.querySelectorAll('iframe').forEach(el => {
            const src = el.getAttribute('src');
            if (src) el.src = src;
        });
        document.querySelectorAll('a').forEach(el => {
            const href = el.getAttribute('href');
            if (href) {
                const norm = normalize(href, window.CURRENT_VFS_PATH);
                if (window.VFS_DATA[norm] || window.VFS_DATA[norm + '.html']) {
                    el.onclick = (e) => {
                        const frame = document.getElementById('main-frame');
                        if (frame) { e.preventDefault(); frame.src = href; }
                    };
                }
            }
        });
    });
})();
</script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phantom Unblocked</title>
    <link rel="icon" href="favicon.svg" type="image/svg+xml">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- Google Tag Manager -->
    <script>(function (w, d, s, l, i) {
            w[l] = w[l] || []; w[l].push({
                'gtm.start':
                    new Date().getTime(), event: 'gtm.js'
            }); var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
                    'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-5LMBC27Z');</script>
    <!-- End Google Tag Manager -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html,
        body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: var(--bg, #0a0a0a);
            font-family: 'Inter', -apple-system, sans-serif;
        }


        .loading-screen {
            position: fixed;
            inset: 0;
            background: rgba(10, 10, 10, 0.6);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }

        .loading-screen.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
            transition: opacity 0.5s ease-in-out, visibility 0.5s;
        }

        .loading-logo {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 24px;
            display: flex;
            align-items: center;
            gap: 14px;
        }

        .loading-logo i {
            color: var(--text-muted, #a1a1aa);
        }

        .loading-logo span {
            background: linear-gradient(90deg, var(--text, #e4e4e7) 0%, var(--text-muted, #a1a1aa) 40%, var(--text-dim, #52525b) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border, #1f1f1f);
            border-top-color: var(--text-muted, #71717a);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .loading-text {
            margin-top: 16px;
            color: var(--text-dim, #52525b);
            font-size: 0.875rem;
        }


        .launch-screen {
            position: fixed;
            inset: 0;
            background: rgba(10, 10, 10, 0.6);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .launch-screen.hidden {
            display: none;
        }

        .launch-button {
            background: var(--surface);
            color: var(--text-muted);
            border: none;
            padding: 24px 48px;
            border-radius: var(--radius-lg);
            font-size: 1.25rem;
            font-weight: 600;
            cursor: pointer;
            transition: opacity 0.2s;
            margin-top: 16px;
            width: 100%;
            max-width: 300px;
            opacity: 0.75;
        }

        .launch-button:hover {
            opacity: 0.5;
        }

        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        /* Panic white screen */
        #panic-overlay {
            position: fixed;
            inset: 0;
            background: white;
            z-index: 99999;
            display: none;
        }
    </style>
    <script>
// site config

window.SITE_CONFIG = {
    name: "Phantom",
    fullName: "Phantom Unblocked",
    version: "1.0.12",

    changelog: [
        "1.0.12: tiny fixxes and changes",
        "some code consolidation and fixxes",
        "suggest features in the discord server"
    ],

    // quotes
    quotes: [
        "lebron lebron lebronn james",
        "so tuff",
        "it is what it is",
        "do ur work",
        "this is what happens when u dont touch grass",
        "FULL BOX",
        "FULL PIECE",
        "200!",
        "press esc + refresh + power button for hacks",
        "press ctrl+x to hide your screen",
        "change the tab title and favicon in settings",
        "TEACHERR!",
        "1 pump",
        "303 headshot",
        "bros prolly a 60 ovr",
        "take the L lil bro",  
        "lebron is OUR goat",
        "stop looking at my screen",
    ],

    // todo
    // *** for strikethrough
    // ** for bold
    todos: [
        "***fixxed aboutblank opening while securly is on (previously if popups were off it would load intab instead of clickto launch now it will use clicktolaunch unless popups are blocked)***",
        "***fix the proxy***",
        "***fix panic panickey, add quote talking about it***",
        "***fix theatermode, make it hide buttons after a few seconds and ensure all content is being displayed and move the description to the bottom***",
        "***change back player to use old styling, change the surface to use background colors for the bottom part where description is shown, looking just like the background***",
        "***add image and video support for backgrounds***",
        "***fix aichat, make the title use the same ai request as the users question unless its in image mode where it will use text mode and fix ai chat to remember modes better***",
        "***add cloaking to quotes***",
        "***add a default cloak and fix it so icons work in aboutblank for whatever reason they only work when you go to settings in aboutblank where it correctly applies***",
        "***for search suggestions add highlighting for whatever will happen when you click enter, in search suggestions fix all games not sending you to the games page***",
        "***fix games to make multi library the default, put it in config.js***",
        "***rename movies shortcut in index2.html to primeshows, add shortcuts to main pages in the topbar and change the current shortcuts to more popular games***",
        "***make announcements show even on first visit unlike changelog and allow disabling it via settings***",
        "***fix leave comformation asking u to leave each time you click something***",
        "***change the shortcuts on the main page to include pages***",
        "***add movies to the search bar in main page***",
        "***fix background not turning off soon***",
        "***fix music page to hide youtube player unless toggled via 3 dot small button, and always shown on proxy mode, fix all the controls for video time, volume***",
        "**add singlefile this is lowk so hard i dont really understand it**",
        "**advertise phantom (too much work tbh)**",
        "**add a watch page for youtube and twitch**",
        "**add a miniplayer for music**",
        "***shorten some page's code***",
        "***fix paths in search autocomplete***",
        "***fix markdown in ai not using correct text colors***",
        "***make backgrounds show in the loading screen***",
        "***fix icons for topbar in code.html***",
        "**fix wisp server not notifying or autoswitiching when offline in proxy**",
        "***fix code runner open not working at all***",
        "***make backgrounds show in player.html***",
        "***make backgrounds show in staticsjv2***",
        "***make player.html player controls use theme colros not hardcoded***",
        "***make ai chat and music sidebar go all the way down and up with borders***",
        "**make the only song in music be lebron lebron lebron james**",
        "**fix music controls**",
        "***finish extra page into credits and make this todo be tucked away somewhere and not the main part of it***"
    ],
    defaultWisp: "wss://glseries.net/wisp/",
    wispServers: [
        { name: "GLSeries Wisp", url: "wss://glseries.net/wisp/" },
        { name: "Rhw's Wisp", url: "wss://wisp.rhw.one/" },
    ],

    discord: {
        inviteUrl: "https://discord.gg/tHWx9NXp5p",
        widgetServer: "1447673724017971324",
        widgetChannel: "1447673726228496617",
    },

    firstVisitCloak: false, //fake error page
    defaults: {
        cloakMode: "about:blank",
        tabTitle: "You've already responded",
        tabFavicon: "https://ssl.gstatic.com/docs/spreadsheets/forms/forms_icon_2023q4.ico",
        cloakRotation: false,
        cloakInterval: 5000,
        panicKey: "x",
        panicModifiers: ["ctrl", "shift"],
        panicUrl: "https://classroom.google.com",
        maxMovieRating: "R",
        gameLibrary: "multi",
        discordWidget: true,
        miniplayer: true,
        leaveConfirmation: false,
        showChangelogOnUpdate: true,
        themeRotation: true,
        lastThemeRotation: 0,
        backgroundRotation: true,
        lastBackgroundRotation: 0,
        lastSeenFeatured: 'none',
        background: { type: 'color', value: '#0a0a0a' },
        customBackground: { id: 'none', type: 'none' },
        accentColor: '#ffffff',
        surfaceColor: '#0f0f0f',
        secondaryColor: '#2e2e33',
        textColor: '#e4e4e7',
    },

    themePresets: {
        dark: { name: 'Dark (Default)', bg: { type: 'color', value: '#0a0a0a' }, surface: '#0f0f0f', surfaceHover: '#1a1a1a', surfaceActive: '#252525', secondary: '#2e2e33', border: '#2a2a2a', borderLight: '#2a2a2a', text: '#e4e4e7', textSec: '#71717a', textDim: '#52525b', accent: '#ffffff' },
        midnight: { name: 'Midnight', bg: { type: 'color', value: '#000000' }, surface: '#050505', surfaceHover: '#111111', surfaceActive: '#1a1a1a', secondary: '#111111', border: '#1a1a1a', borderLight: '#111111', text: '#ededed', textSec: '#a3a3a3', textDim: '#737373', accent: '#d4d4d4' },
        abyss: { name: 'Abyss', bg: { type: 'color', value: '#020617' }, surface: '#0f172a', surfaceHover: '#1e293b', surfaceActive: '#334155', secondary: '#1e293b', border: '#1e293b', borderLight: '#1e293b', text: '#f1f5f9', textSec: '#94a3b8', textDim: '#64748b', accent: '#38bdf8' },
        phantom: { name: 'Phantom', bg: { type: 'color', value: '#0f0a14' }, surface: '#1a0f24', surfaceHover: '#2e1a40', surfaceActive: '#4c2a5c', secondary: '#2e1a40', border: '#2e1a40', borderLight: '#2e1a40', text: '#f3e8ff', textSec: '#d8b4fe', textDim: '#c084fc', accent: '#c084fc' },
        rosepine: { name: 'Rose Pine', bg: { type: 'color', value: '#191724' }, surface: '#1f1d2e', surfaceHover: '#26233a', surfaceActive: '#524f67', secondary: '#26233a', border: '#26233a', borderLight: '#1f1d2e', text: '#e0def4', textSec: '#908caa', textDim: '#6e6a86', accent: '#ebbcba' },
        ocean: { name: 'Oceanic', bg: { type: 'color', value: '#011627' }, surface: '#0b2942', surfaceHover: '#1d3b53', surfaceActive: '#2d4b63', secondary: '#0b2942', border: '#1d3b53', borderLight: '#0b2942', text: '#d6deeb', textSec: '#5f7e97', textDim: '#011627', accent: '#7fdbca' },
        forest: { name: 'Forest', bg: { type: 'color', value: '#020d06' }, surface: '#051a0d', surfaceHover: '#0a2e17', surfaceActive: '#0f4221', secondary: '#051a0d', border: '#0a2e17', borderLight: '#051a0d', text: '#ecfdf5', textSec: '#6ee7b7', textDim: '#064e3b', accent: '#10b981' },
        crimson: { name: 'Crimson', bg: { type: 'color', value: '#1a0505' }, surface: '#230a0a', surfaceHover: '#7b0a0aff', surfaceActive: '#7f1d1d', secondary: '#230a0a', border: '#480f0fff', borderLight: '#230a0a', text: '#fef2f2', textSec: '#fecaca', textDim: '#450a0a', accent: '#ef4444' },
        flame: { name: 'Flame', bg: { type: 'color', value: '#0c0202' }, surface: '#1c0a0a', surfaceHover: '#451a03', surfaceActive: '#9a3412', secondary: '#1c0a0a', border: '#451a03', borderLight: '#9a3412', text: '#fff7ed', textSec: '#fdba74', textDim: '#ea580c', accent: '#f59e0b' }
    },

    backgroundPresets: [
        { id: 'none', name: 'None (Theme Default)', type: 'none' },
        { id: 'Night sky', name: 'Night sky', type: 'image', url: 'https://images.pexels.com/photos/5675745/pexels-photo-5675745.jpeg', overlay: 0.3 },
        { id: 'winter-mountains', name: 'Winter mountains', type: 'image', url: 'https://images.pexels.com/photos/1287145/pexels-photo-1287145.jpeg', overlay: 0.3 },
        { id: 'f1 car', name: 'F1 Car', type: 'image', url: 'https://images.pexels.com/photos/14401632/pexels-photo-14401632.jpeg', overlay: 0.3 },
        { id: 'moon-landing', name: 'Moon Landing', type: 'image', url: 'https://images.pexels.com/photos/41162/moon-landing-apollo-11-nasa-buzz-aldrin-41162.jpeg', overlay: 0.3, objectPosition: 'top left', active: true },
        { id: 'turtle', name: 'Turtle', type: 'image', url: 'https://images.unsplash.com/photo-1501791187590-9ef2612ba1eb?q=80&w=1932&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D', overlay: 0.3 },
        { id: 'road', name: 'Road', type: 'image', url: 'https://images.unsplash.com/photo-1508233620467-f79f1e317a05', overlay: 0.3 },
        { id: 'railroad', name: 'Railroad', type: 'image', url: 'https://images.unsplash.com/photo-1505832018823-50331d70d237', overlay: 0.3 },
        { id: 'mountain', name: 'Mountain', type: 'image', url: 'https://raw.githubusercontent.com/evanhnry/brave-wallpapers/refs/heads/main/Brave/clay-banks-u27Rrbs9Dwc-unsplash.jpg', overlay: 0.3 },
    ],

    cloakPresets: [
        { name: "Phantom", icon: "/favicon.svg", title: "Phantom Unblocked" },
        { name: "Edpuzzle", icon: "https://edpuzzle.imgix.net/favicons/favicon-32.png", title: "Edpuzzle" },
        { name: "Google Docs", icon: "https://ssl.gstatic.com/docs/documents/images/kix-favicon7.ico", title: "Untitled document - Google Docs" },
        { name: "Canvas", icon: "https://du11hjcvx0uqb.cloudfront.net/dist/images/favicon-e10d657a73.ico", title: "Dashboard" },
        { name: "Desmos", icon: "https://www.desmos.com/favicon.ico", title: "Desmos | Graphing Calculator" },
        { name: "Khan Academy", icon: "https://cdn.kastatic.org/images/favicon.ico", title: "Khan Academy" },
        { name: "Wikipedia", icon: "https://en.wikipedia.org/favicon.ico", title: "World War II - Wikipedia" },
        { name: "Classroom", icon: "https://ssl.gstatic.com/classroom/favicon.png", title: "Home - Classroom" },
        { name: "Canva", icon: "https://static.canva.com/static/images/android-192x192-2.png", title: "Home - Canva" },
        { name: "Quiz", icon: "https://ssl.gstatic.com/docs/spreadsheets/forms/forms_icon_2023q4.ico", title: "You've already responded" },
        { name: "Blooket", icon: "https://play.blooket.com/favicon.ico", title: "Play Blooket | Blooket" },
        { name: "Gmail", icon: "https://ssl.gstatic.com/ui/v1/icons/mail/rfr/gmail.ico", title: "Gmail" },
        { name: "YouTube", icon: "https://www.youtube.com/favicon.ico", title: "YouTube" },
        { name: "Powerschool", icon: "https://waverlyk12.powerschool.com/favicon.ico", title: "Grades and Attendance" },
        { name: "nothing", icon: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=", title: "\u200B" },
    ]
}



</script>
    <script>
// settings handler
(function () {
    'use strict';

    const STORAGE_KEY = 'void_settings';

    const getDefaults = () => {
        return window.SITE_CONFIG?.defaults || {
            cloakMode: 'none',
            cloakRotation: false,
            cloakInterval: 5000,
            panicKey: 'x',
            panicModifiers: ['ctrl', 'shift'],
            panicUrl: 'https://classroom.google.com',
            maxMovieRating: 'R',
            offlineGames: [],
            gameLibrary: 'multi',
            leaveConfirmation: false
        };
    };

    const load = () => {
        try {
            const stored = localStorage.getItem(STORAGE_KEY);
            if (stored) {
                return { ...getDefaults(), ...JSON.parse(stored) };
            }
        } catch (e) {
            console.warn('Failed to load settings:', e);
        }
        return getDefaults();
    };

    const save = (settings) => {
        try {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));
            window.dispatchEvent(new CustomEvent('settings-changed', { detail: settings }));
            if (window.parent !== window) {
                window.parent.postMessage({ type: 'settings-update' }, '*');
            }
        } catch (e) {
            console.warn('Failed to save settings:', e);
        }
    };

    let _settings = load();

    window.Settings = {
        get(key) { return _settings[key]; },

        getAll() { return { ..._settings }; },

        set(key, value) {
            _settings[key] = value;
            save(_settings);
            this.apply();
            return value;
        },

        update(partial) {
            _settings = { ..._settings, ...partial };
            save(_settings);
            this.apply();
        },

        reset() {
            _settings = getDefaults();
            save(_settings);
            this.apply();
        },

        apply() {
            const root = document.documentElement;
            const s = _settings;
            const d = window.SITE_CONFIG?.defaults || {};

            const vars = {
                '--accent': s.accentColor || d.accentColor || '#ffffff',
                '--surface': s.surfaceColor || d.surfaceColor || '#0f0f0f',
                '--surface-hover': s.surfaceHoverColor || d.surfaceHoverColor || '#1a1a1a',
                '--surface-active': s.surfaceActiveColor || d.surfaceActiveColor || '#252525',
                '--secondary': s.secondaryColor || d.secondaryColor || '#2e2e33',
                '--border': s.borderColor || d.borderColor || '#1f1f1f',
                '--border-light': s.borderLightColor || d.borderLightColor || '#2a2a2a',
                '--text': s.textColor || d.textColor || '#e4e4e7',
                '--text-muted': s.textSecondaryColor || d.textSecondaryColor || '#71717a',
                '--text-dim': s.textDimColor || d.textDimColor || '#52525b',
                '--toggle': s.toggleColor || d.toggleColor,
                '--toggle-knob': s.toggleKnobColor || d.toggleKnobColor
            };

            Object.entries(vars).forEach(([key, val]) => {
                if (val) root.style.setProperty(key, val);
            });

            const themeBg = s.background || d.background || { type: 'color', value: '#0a0a0a' };
            const customBg = s.customBackground;
            const isCustomActive = customBg && customBg.type !== 'none';

            if (themeBg.type === 'color') {
                root.style.setProperty('--bg', themeBg.value);
            }

            if (isCustomActive && customBg.url) {
                root.style.setProperty('--bg-image', `url(${customBg.url})`);

                let position = customBg.objectPosition;
                if (customBg.id && customBg.id !== 'custom') {
                    const preset = window.SITE_CONFIG?.backgroundPresets?.find(b => b.id === customBg.id);
                    if (preset?.objectPosition) position = preset.objectPosition;
                }

                root.style.setProperty('--bg-image-position', position || 'center');
            } else if (themeBg.type === 'image' || themeBg.type === 'video') {
                root.style.setProperty('--bg-image', `url(${themeBg.value || themeBg.url})`);
                root.style.setProperty('--bg-image-position', themeBg.objectPosition || 'center');
            } else if (themeBg.type === 'gradient') {
                root.style.setProperty('--bg-image', themeBg.value || themeBg.url);
                root.style.setProperty('--bg-image-position', 'center');
            } else {
                root.style.setProperty('--bg-image', 'none');
            }
        },

        onChange(callback) {
            window.addEventListener('settings-changed', (e) => callback(e.detail));
        },

        isRatingAllowed(rating) {
            if (!rating || rating === 'NR' || rating === 'NC-17') return false;
            const ratingOrder = ['G', 'PG', 'PG-13', 'R'];
            const maxIndex = ratingOrder.indexOf(_settings.maxMovieRating);
            const ratingIndex = ratingOrder.indexOf(rating);
            return maxIndex !== -1 && ratingIndex !== -1 && ratingIndex <= maxIndex;
        }
    };

    // panic button go brr
    const handlePanic = (e) => {
        const mods = _settings.panicModifiers || [];
        const key = _settings.panicKey || 'x';

        if (mods.includes('ctrl') !== e.ctrlKey) return;
        if (mods.includes('shift') !== e.shiftKey) return;
        if (mods.includes('alt') !== e.altKey) return;

        if (e.key.toLowerCase() === key.toLowerCase()) {
            e.preventDefault();
            const overlayId = 'panic-overlay';
            let overlay = window.parent?.document?.getElementById(overlayId) || document.getElementById(overlayId);

            if (!overlay) {
                overlay = document.createElement('div');
                overlay.id = overlayId;
                overlay.style.cssText = 'position:fixed;inset:0;background:white;z-index:99999;';
                document.body.appendChild(overlay);
            } else {
                overlay.style.display = 'block';
            }

            window.location.replace(_settings.panicUrl || 'https://classroom.google.com');
        }
    };

    const init = () => {
        Settings.apply();

        const featured = window.SITE_CONFIG?.featuredBackground;
        const activePreset = window.SITE_CONFIG?.backgroundPresets?.find(p => p.active);

        const target = activePreset || featured;

        if (target?.id && target.id !== _settings.lastSeenFeatured) {
            Settings.update({
                customBackground: target,
                lastSeenFeatured: target.id,
                backgroundRotation: false
            });
        }

        document.addEventListener('keydown', handlePanic, true);

        window.addEventListener('storage', (e) => {
            if (e.key === STORAGE_KEY) {
                _settings = load();
                Settings.apply();
                window.dispatchEvent(new CustomEvent('settings-changed', { detail: _settings }));
            }
        });

        window.addEventListener('message', (e) => {
            if (e.data?.type === 'settings-update' || e.data === 'updateCloak') {
                _settings = load();
                Settings.apply();
                window.dispatchEvent(new CustomEvent('settings-changed', { detail: _settings }));
            }
        });

        window.addEventListener('beforeunload', (e) => {
            if (document.getElementById('main-frame') && _settings.leaveConfirmation) {
                e.preventDefault();
                return e.returnValue = '';
            }
        });
    };

    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', init);
    else init();
})();

</script>
    <script>
// background stuff
(function () {
    'use strict';

    if (window.BackgroundManager) return;

    const YOUTUBE_REGEX = /(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([a-zA-Z0-9_-]{11})/;

    const BackgroundManager = {
        container: null,
        mediaLayer: null,
        elements: { video: null, image: null, iframe: null },
        current: { type: null, url: null },
        cacheName: 'phantom-bg-cache-v2',

        init() {
            this.container = document.createElement('div');
            this.container.className = 'phantom-background';
            this.container.innerHTML = '<div class="phantom-background-overlay"></div><div class="phantom-background-layer"></div>';
            this.mediaLayer = this.container.querySelector('.phantom-background-layer');
            document.body.insertBefore(this.container, document.body.firstChild);

            const apply = () => this.applyBackground();
            window.addEventListener('settings-changed', apply);
            window.addEventListener('storage', apply);
            window.addEventListener('beforeunload', () => this.cleanup());
            window.addEventListener('pagehide', () => this.cleanup());

            document.addEventListener('visibilitychange', () => {
                const video = this.elements.video;
                if (!video) return;
                if (document.hidden) video.pause();
                else if (this.current.type === 'video') video.play().catch(() => { });
            });

            this.applyBackground();
        },

        applyBackground() {
            if (!this.container) return; // Wait for init() to create the container

            const s = window.Settings?.getAll() || {};
            const custom = s.customBackground;
            const theme = s.background || {};

            let type = null, url = null, pos = null, overlay = 0.4;

            if (custom && custom.type !== 'none') {
                // Refresh from config if possible to get latest props like objectPosition
                if (custom.id && custom.id !== 'custom') {
                    const preset = window.SITE_CONFIG?.backgroundPresets?.find(b => b.id === custom.id);
                    if (preset) Object.assign(custom, preset);
                }
                ({ type, url, objectPosition: pos, overlay = 0.4 } = custom);
            } else if (theme.type === 'image' || theme.type === 'video' || theme.type === 'youtube') {
                type = theme.type;
                url = theme.value || theme.url;
                pos = theme.objectPosition;
                overlay = theme.overlay || 0.4;
            }

            document.documentElement.style.setProperty('--bg-overlay', overlay);

            // Handle common positioning typos and normalize
            if (pos && typeof pos === 'string') {
                pos = pos.toLowerCase().trim()
                    .replace(/\s+/g, ' ') // Normalize multiple spaces
                    .replace('topleft', 'top left')
                    .replace('topright', 'top right')
                    .replace('bottomleft', 'bottom left')
                    .replace('bottomright', 'bottom right')
                    .replace('centercenter', 'center')
                    .replace('centerleft', 'center left')
                    .replace('centerright', 'center right');
            }

            document.documentElement.style.setProperty('--bg-image-position', pos || 'center');

            if (!type || !url) {
                this.clear();
                document.documentElement.style.backgroundColor = 'var(--bg)';
                document.documentElement.style.setProperty('--bg-image-position', 'center');
                return;
            }
            if (this.current.type === type && this.current.url === url) return;

            this.current = { type, url };

            if (type === 'video' || url.match(/\.(mp4|webm|ogg|mov|m4v)$/i)) {
                this.clearMedia();
                this.createVideo(url, pos);
                this.container.classList.add('active');
                document.documentElement.classList.add('phantom-bg-active');
                document.body.classList.add('phantom-bg-active');
            } else if (type === 'youtube' || YOUTUBE_REGEX.test(url)) {
                this.clearMedia();
                this.createYouTube(url, pos);
                this.container.classList.add('active');
                document.documentElement.classList.add('phantom-bg-active');
                document.body.classList.add('phantom-bg-active');
            } else if (type === 'image') {
                this.handleImageBackground(url, pos);
            }
        },

        async getProxiedCachedUrl(url) {
            // Local images don't need proxying
            if (!url.startsWith('http') || url.includes(location.hostname)) return url;

            // Try direct load first (faster)
            try {
                const directTest = await fetch(url, { method: 'HEAD', mode: 'cors' });
                if (directTest.ok) return url;
            } catch (e) {
                // CORS blocked, need to proxy
            }

            // Wait for BareMux (max 500ms)
            let retries = 0;
            while (!window.BareMux && retries < 5) {
                await new Promise(r => setTimeout(r, 100));
                retries++;
            }

            if (!window.BareMux) {
                console.warn("Background: BareMux not found, trying direct URL.");
                return url; // Try direct anyway
            }

            try {
                const client = new window.BareMux.BareClient();
                const response = await client.fetch(url);
                if (!response.ok) throw new Error('Proxy fetch failed');

                const blob = await response.blob();
                return URL.createObjectURL(blob);
            } catch (error) {
                console.error("Background proxy failed:", error);
                return url; // Fallback to direct URL
            }
        },

        async handleImageBackground(url, pos) {
            // Pre-load the image (proxied/cached or direct)
            const finalUrl = await this.getProxiedCachedUrl(url);

            // Check if this is still the current background after async fetch
            if (this.current.url !== url) {
                if (finalUrl && finalUrl.startsWith('blob:')) URL.revokeObjectURL(finalUrl);
                return;
            }

            this.clearMedia();
            this.createImage(finalUrl, pos);
        },

        createVideo(url, pos) {
            const el = Object.assign(document.createElement('video'), {
                className: 'phantom-background-media', src: url, autoplay: true, loop: true, muted: true, playsInline: true, volume: 0
            });
            // Apply objectPosition from settings/preset
            if (pos) el.style.objectPosition = pos;
            el.onerror = () => (this.elements.video = null);
            this.elements.video = el;
            this.mediaLayer.appendChild(el);
        },

        createImage(url, pos) {
            const el = Object.assign(document.createElement('img'), {
                className: 'phantom-background-media',
                src: url
            });

            // Apply objectPosition from settings/preset
            if (pos) el.style.objectPosition = pos;

            el.onload = () => {
                if (this.current.url === url || url.startsWith('blob:')) {
                    this.container.classList.add('active');
                    document.documentElement.classList.add('phantom-bg-active');
                    document.body.classList.add('phantom-bg-active');
                }
            };
            el.onerror = () => {
                console.warn("Background image failed to load:", url);
                if (this.elements.image === el) this.elements.image = null;
            };

            this.elements.image = el;
            this.mediaLayer.appendChild(el);
        },

        // youtube logic
        createYouTube(url, pos) {
            const id = url.match(YOUTUBE_REGEX)?.[1];
            if (!id) return;
            const el = Object.assign(document.createElement('iframe'), {
                className: 'phantom-background-media',
                src: `https://www.youtube.com/embed/${id}?autoplay=1&loop=1&playlist=${id}&controls=0&modestbranding=1&rel=0&mute=1&enablejsapi=1`,
                allow: 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture'
            });
            // Apply objectPosition from settings/preset
            if (pos) el.style.objectPosition = pos;
            this.elements.iframe = el;
            this.mediaLayer.appendChild(el);
        },

        clearMedia() {
            Object.entries(this.elements).forEach(([key, el]) => {
                if (!el) return;
                if (key === 'video') { el.pause(); el.src = ''; }
                if (key === 'iframe') el.src = 'about:blank';
                if (key === 'image' && el.src.startsWith('blob:')) {
                    URL.revokeObjectURL(el.src);
                }
                el.remove();
                this.elements[key] = null;
            });
        },

        clear() {
            this.clearMedia();
            this.current = { type: null, url: null };
            document.documentElement.classList.remove('phantom-bg-active');
            document.body.classList.remove('phantom-bg-active');
            document.documentElement.style.backgroundColor = '';
            if (this.container) this.container.classList.remove('active');
        },

        cleanup() {
            this.clearMedia();
        }
    };

    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', () => BackgroundManager.init());
    else BackgroundManager.init();

    window.BackgroundManager = BackgroundManager;
})();

</script>
    <script>
// stealth mode
(function () {
    'use strict';

    let rotationInterval = null;
    let currentPresetIndex = 0;
    const original = { title: document.title, favicon: document.querySelector('link[rel="icon"]')?.href };

    const getPresets = () => [...(window.SITE_CONFIG?.cloakPresets || []), ...(window.Settings?.get('customCloaks') || [])];

    const setTitle = (title) => {
        if (!title) return;
        document.title = title;
        try { if (window.top !== window.self) window.top.document.title = title; } catch { }
    };

    const setFavicon = (href) => {
        if (!href) return;
        [document, window.top?.document].filter(d => { try { return d; } catch { return false; } }).forEach(doc => {
            doc.querySelectorAll('link[rel*="icon"]').forEach(l => l.remove());
            const link = doc.createElement('link');
            link.rel = 'icon';
            link.href = href;
            doc.head.appendChild(link);
        });
    };

    const apply = (p) => {
        if (p) {
            setTitle(p.title);
            setFavicon(p.icon || p.favicon);
        } else {
            const s = window.Settings?.getAll() || {};
            setTitle(s.tabTitle || window.SITE_CONFIG?.defaults?.tabTitle);
            setFavicon(s.tabFavicon || window.SITE_CONFIG?.defaults?.tabFavicon);
        }
    };

    const startRotation = (ms) => {
        stopRotation();
        const presets = getPresets();
        if (presets.length < 2) return apply(presets[0]);
        rotationInterval = setInterval(() => {
            currentPresetIndex = (currentPresetIndex + 1) % presets.length;
            apply(presets[currentPresetIndex]);
        }, ms);
    };

    const stopRotation = () => { if (rotationInterval) { clearInterval(rotationInterval); rotationInterval = null; } };

    const redirectOriginal = () => {
        const targets = ["https://classroom.google.com", "https://drive.google.com", "https://google.com", "https://kahoot.it", "https://edpuzzle.com"];
        window.location.replace(targets[Math.floor(Math.random() * targets.length)]);
    };

    const getPopupContent = (url) => {
        const s = window.Settings?.getAll() || {};
        const title = s.tabTitle || window.SITE_CONFIG?.defaults?.tabTitle || 'Google';
        const icon = s.tabFavicon || window.SITE_CONFIG?.defaults?.tabFavicon || 'https://www.google.com/favicon.ico';
        return `<!DOCTYPE html><html><head><title>${title}</title><link rel="icon" href="${icon}"><style>* {margin:0;padding:0;height:100%;overflow:hidden;} iframe{width:100%;height:100%;border:none;}</style></head><body><iframe src="${url}"></iframe></body></html>`;
    };

    // Try to open popup and monitor if it survives for 500ms
    // Returns: { success: true } if popup works and stays open
    // Returns: { success: false, reason: 'blocked' } if window.open returned null
    // Returns: { success: false, reason: 'killed' } if popup was closed by extension (like Securly)
    const tryPopup = (url) => {
        return new Promise((resolve) => {
            const win = window.open('about:blank', '_blank');

            // Popup completely blocked by browser
            if (!win) {
                resolve({ success: false, reason: 'blocked' });
                return;
            }

            // Write the actual content to popup
            try {
                win.document.write(getPopupContent(url));
                win.document.close();
            } catch (e) {
                try { win.close(); } catch { }
                resolve({ success: false, reason: 'killed' });
                return;
            }

            // Use a single timeout to avoid background throttling (which causes a 5s delay).
            // When the original tab loses focus, browsers throttle timers to ~1s minimum.
            // If the timer runs, we check once and redirect immediately.
            const timeoutMs = 200;

            setTimeout(() => {
                if (win.closed) {
                    resolve({ success: false, reason: 'killed' });
                } else {
                    resolve({ success: true });
                    redirectOriginal(); // Instant redirect
                }
            }, timeoutMs);
        });
    };

    // Load content in-tab (fallback)
    const loadInTab = () => {
        const iframe = document.getElementById('main-frame');
        if (iframe && !iframe.src) iframe.src = 'index2.html';
        apply();
    };

    // Show launch screen with callback for when button is clicked
    const showLaunchScreen = (onLaunch) => {
        const ls = document.getElementById('launch-screen');
        if (ls) {
            ls.classList.remove('hidden');
            document.getElementById('launch-button').onclick = onLaunch;
        }
    };

    // Attempt popup with fallback:
    // 1. Try real popup -> if works (survives 500ms), redirect original tab
    // 2. If blocked (null) -> show click-to-launch (user gesture might help)
    // 3. If killed (closed by Securly) -> load in-tab directly
    // 4. If click-to-launch popup also fails -> load in-tab
    const attemptCloakedLaunch = async (url, hideOverlay = null) => {
        const result = await tryPopup(url);

        if (result.success) {
            // Popup worked and is still open! redirectOriginal() was already called
            return true;
        }

        if (result.reason === 'blocked') {
            // Popup was blocked (window.open returned null)
            // Show click-to-launch - user gesture might bypass popup blocker
            if (hideOverlay) hideOverlay();

            showLaunchScreen(async () => {
                document.getElementById('launch-screen').classList.add('hidden');

                // Try popup again with user gesture
                const retryResult = await tryPopup(url);
                if (!retryResult.success) {
                    // Even with user click, popup failed - load in-tab
                    loadInTab();
                }
                // If success, redirectOriginal() was called inside tryPopup
            });
            return true; // Handled (showing launch screen)
        }

        // reason === 'killed' - Securly/extension killed the popup, go straight to in-tab
        if (hideOverlay) hideOverlay();
        loadInTab();
        return false;
    };

    const init = async () => {
        const s = window.Settings?.getAll() || {};
        const fvKey = 'phantom_fv';
        const urlParams = new URLSearchParams(window.location.search);

        // Handle fake mode (legacy)
        if (urlParams.has('fake')) {
            showLaunchScreen(async () => {
                document.getElementById('launch-screen').classList.add('hidden');
                if (s.cloakMode === 'about:blank') {
                    const result = await tryPopup(window.location.href.split('?')[0]);
                    if (result.success) return; // redirectOriginal was called
                }
                loadInTab();
            });
            return;
        }

        // Handle first visit cloak (fake error page)
        if (window.SITE_CONFIG?.firstVisitCloak && !localStorage.getItem(fvKey)) {
            const overlay = document.getElementById('fv-cloak');
            if (overlay) {
                overlay.style.display = 'block';
                document.title = window.location.hostname;
                document.querySelectorAll("link[rel*='icon']").forEach(l => l.remove());
                const link = document.createElement('link');
                link.rel = 'icon';
                link.href = 'data:,';
                document.head.appendChild(link);

                const onKey = async (e) => {
                    if (e.key.toLowerCase() === 'c') {
                        localStorage.setItem(fvKey, '1');
                        document.removeEventListener('keydown', onKey);

                        if (s.cloakMode === 'about:blank') {
                            await attemptCloakedLaunch(window.location.href, () => {
                                overlay.style.display = 'none';
                            });
                        } else {
                            overlay.style.display = 'none';
                            apply();
                            loadInTab();
                        }
                    }
                };
                document.addEventListener('keydown', onKey);
            }
            return;
        }

        // Normal visit - not first time, no fake mode
        if (window.top === window.self && s.cloakMode === 'about:blank') {
            await attemptCloakedLaunch(window.location.href);
            return;
        }

        loadInTab();
        if (s.rotateCloaks) startRotation((s.rotateInterval || 5) * 1000);
    };

    window.Cloaking = { init, apply, startRotation, stopRotation, tryPopup, loadInTab };

    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', () => setTimeout(init, 100));
    else setTimeout(init, 100);

    window.addEventListener('settings-changed', (e) => {
        apply();
        if (e.detail.rotateCloaks) startRotation((e.detail.rotateInterval || 5) * 1000);
        else stopRotation();
    });
})();

</script>
    <script>
window.Quotes = {
    // Use data from config, fallback to empty array if not found
    getData() {
        return (window.SITE_CONFIG && window.SITE_CONFIG.quotes) || [];
    },

    getRandom() {
        const data = this.getData();
        if (!data.length) return null; // Return null if no quotes
        return data[Math.floor(Math.random() * data.length)];
    },
    init(force = false) {
        const quote = this.getRandom();
        if (!quote) return; // Do nothing if no quotes

        const targets = [
            '#quote',
            '#quote-display',
            '#subtitle',
            '.page-subtitle',
            '.extra-hero p',
            '.loading-text'
        ];

        targets.forEach(selector => {
            document.querySelectorAll(selector).forEach(el => {
                // Only update if force is true, or it's empty, or has placeholder text
                const text = el.textContent.trim();
                if (force || !text || text === 'Loading...' || text.includes('Stream movies') || text.includes('Customize your')) {
                    el.textContent = quote;
                }
            });
        });
    }
};

window.QUOTES = window.Quotes.getData();

// Run automatically on load
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => window.Quotes.init());
} else {
    window.Quotes.init();
}

</script>
    <script>Settings.apply();</script>
    <style>
/* Base styles and variables derived from erorr.html */
:root {
    --background-color: #fff;
    --error-code-color: #5f6368;
    --google-blue-100: rgb(210, 227, 252);
    --google-blue-300: rgb(138, 180, 248);
    --google-blue-600: rgb(26, 115, 232);
    --google-blue-700: rgb(25, 103, 210);
    --google-gray-100: rgb(241, 243, 244);
    --google-gray-300: rgb(218, 220, 224);
    --google-gray-500: rgb(154, 160, 166);
    --google-gray-50: rgb(248, 249, 250);
    --google-gray-600: rgb(128, 134, 139);
    --google-gray-700: rgb(95, 99, 104);
    --google-gray-800: rgb(60, 64, 67);
    --google-gray-900: rgb(32, 33, 36);
    --heading-color: var(--google-gray-900);
    --link-color: rgb(88, 88, 88);
    --primary-button-fill-color-active: var(--google-blue-700);
    --primary-button-fill-color: var(--google-blue-600);
    --primary-button-text-color: #fff;
    --quiet-background-color: rgb(247, 247, 247);
    --secondary-button-border-color: var(--google-gray-500);
    --secondary-button-fill-color: #fff;
    --secondary-button-hover-border-color: var(--google-gray-600);
    --secondary-button-hover-fill-color: var(--google-gray-50);
    --secondary-button-text-color: var(--google-gray-700);
    --small-link-color: var(--google-gray-700);
    --text-color: var(--google-gray-700);
}

.neterror {
    background: var(--background-color);
    color: var(--text-color);
    word-wrap: break-word;
    font-family: 'Segoe UI', Tahoma, sans-serif;
    margin: 0;
    font-size: 100%;
}

@media (prefers-color-scheme: dark) {

    :root,
    .neterror {
        --background-color: var(--google-gray-900);
        --error-code-color: var(--google-gray-500);
        --heading-color: var(--google-gray-500);
        --link-color: var(--google-blue-300);
        --primary-button-fill-color-active: rgb(129, 162, 208);
        --primary-button-fill-color: var(--google-blue-300);
        --primary-button-text-color: var(--google-gray-900);
        --quiet-background-color: var(--background-color);
        --secondary-button-border-color: var(--google-gray-700);
        --secondary-button-fill-color: var(--google-gray-900);
        --secondary-button-hover-fill-color: rgb(48, 51, 57);
        --secondary-button-text-color: var(--google-blue-300);
        --small-link-color: var(--google-blue-300);
        --text-color: var(--google-gray-500);
    }
}

#fv-cloak.neterror {
    position: fixed;
    inset: 0;
    z-index: 2147483647;
    display: none;
}

/* Layout & Typography */
.neterror .interstitial-wrapper {
    box-sizing: border-box;
    font-size: 1.0em;
    line-height: 1.6em;
    margin: 14vh auto 0;
    max-width: 650px;
    width: 100%;
    padding: 0 24px;
}

.neterror h1 {
    color: var(--heading-color);
    font-size: 1.6em;
    font-weight: normal;
    line-height: 1.25em;
    margin-bottom: 16px;
    margin-top: 0;
    word-wrap: break-word;
}

.neterror h1 span {
    font-weight: 500;
}

.neterror p {
    margin: 0;
}

.neterror a {
    color: var(--link-color);
    text-decoration: none;
}

.neterror .icon {
    height: 72px;
    margin: 0 0 40px;
    width: 72px;
    background-repeat: no-repeat;
    background-size: 100%;
    display: inline-block;
}

.neterror .icon-generic {
    content: image-set(url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJAAAACQAQMAAADdiHD7AAAABlBMVEUAAABTU1OoaSf/AAAAAXRSTlMAQObYZgAAAFJJREFUeF7t0cENgDAMQ9FwYgxG6WjpaIzCCAxQxVggFuDiCvlLOeRdHR9yzjncHVoq3npu+wQUrUuJHylSTmBaespJyJQoObUeyxDQb3bEm5Au81c0pSCD8HYAAAAASUVORK5CYII=) 2x);
}

@media (prefers-color-scheme: dark) {
    .neterror .icon {
        filter: invert(1);
    }
}

.neterror .error-code {
    color: var(--error-code-color);
    font-size: .8em;
    margin-top: 12px;
    text-transform: uppercase;
}

/* Navigation / Buttons */
.neterror .nav-wrapper {
    margin-top: 51px;
}

.neterror .nav-wrapper::after {
    clear: both;
    content: '';
    display: table;
    width: 100%;
}

.neterror button {
    appearance: auto;
    background-color: rgb(193, 196, 255);
    border: none;
    border-radius: 20px;
    box-sizing: border-box;
    color: rgb(32, 33, 36);
    cursor: pointer;
    display: block;
    float: right;
    font-family: Arial;
    font-size: 13.125px;
    font-weight: 400;
    height: 33.3333px;
    padding: 9px;
    text-align: center;
    transition: background-color 0.15s;
    user-select: none;
    width: 59.5833px;
}

.neterror .suggested-left>#control-buttons {
    float: left;
}

/* Mobile tweaks */
@media (max-width: 420px) {
    .neterror .nav-wrapper .secondary-button {
        float: none;
        margin: 16px 0 0;
        padding: 16px;
        width: 100%;
    }

    .neterror button {
        float: none;
        width: 100%;
    }

    .neterror .suggested-left>#control-buttons {
        float: none;
    }
}

/* Fixed nav for strict heights/widths */
@media (min-width: 240px) and (max-width: 420px) and (min-height: 401px),
(min-width: 421px) and (min-height: 240px) and (max-height: 560px) {
    .neterror .nav-wrapper {
        background: var(--background-color);
        bottom: 0;
        box-shadow: 0 -12px 24px var(--background-color);
        left: 0;
        margin: 0 auto;
        max-width: 1000px;
        padding-inline-end: 24px;
        padding-inline-start: 24px;
        position: fixed;
        right: 0;
        width: 100%;
        z-index: 2;
        padding-bottom: 24px;
        padding-top: 24px;
    }

    .neterror .interstitial-wrapper {
        max-width: 736px;
    }

    .neterror #main-content {
        padding-bottom: 40px;
    }
}
</style>
    <style>
/**
 * PHANTOM - BACKGROUND STYLES
 */
.phantom-background {
    position: fixed;
    inset: 0;
    width: 100vw;
    height: 100vh;
    z-index: -1;
    overflow: hidden;
    background: transparent;
    pointer-events: none;
    opacity: 1;
    transition: background-color 0.3s ease;
}

.phantom-background.active {
    opacity: 1;
}

.phantom-background-overlay {
    position: absolute;
    inset: 0;
    z-index: 2;
    background: rgba(0, 0, 0, var(--bg-overlay, 0.4));
    transition: background-color 0.3s ease;
}

.phantom-background-layer {
    position: absolute;
    inset: 0;
    z-index: 1;
    transition: opacity 0.3s ease-in-out;
}

.phantom-background-media {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: var(--bg-image-position, center);
    display: block;
    border: none;
}

/* Video and Iframe positioning for full background cover */
.phantom-background-layer video.phantom-background-media,
.phantom-background-layer iframe.phantom-background-media {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    transform: none;
    pointer-events: none;
    min-width: 100%;
    min-height: 100%;
    max-width: none;
    max-height: none;
    object-position: var(--bg-image-position, center);
}

/* Ensure iframes cover entire background */
.phantom-background-layer iframe.phantom-background-media {
    border: none;
    object-fit: cover;
}

/* Ensure content on top remains readable */
html {
    background-color: var(--bg);
}

body {
    position: relative;
    z-index: 0;
    background: transparent !important;
    /* Allow background to show through */
}

/* Specific adjustments for transparency if needed */
.main-content,
.home-page {
    background: transparent !important;
}

/* Glassmorphism for containers when background is active */
.phantom-background.active~.offline-banner,
.phantom-background.active~.home-page .card,
.phantom-background.active~.home-page .featured-card,
.phantom-background.active~.home-page .search-bar,
.phantom-background.active~.settings-panel {
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    background: rgba(15, 15, 15, 0.7) !important;
}
</style>

</head>

<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5LMBC27Z" height="0" width="0"
            style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <!-- First Visit Cloak Layer -->
    <div id="fv-cloak" class="neterror">
        <div id="main-frame-error" class="interstitial-wrapper">
            <div id="main-content">
                <div class="icon icon-generic"></div>
                <div id="main-message">
                    <h1>
                        <span>This site cant be reached</span>
                    </h1>
                    <p>
                        <strong id="origin-text"></strong>s <abbr id="dnsDefinition">DNS address</abbr> could not be
                        found.
                        Diagnosing the problem.
                    </p>
                    <div class="error-code">DNS_PROBE_POSSIBLE</div>
                </div>
            </div>
            <div id="buttons" class="nav-wrapper suggested-left">
                <div id="control-buttons">
                    <button id="reload-button" class="text-button" onclick="location.reload()">Reload</button>
                </div>
            </div>
        </div>
        <script>
            {
                const origin = window.location.hostname || "This site";
                document.getElementById("origin-text").textContent = origin;

                // Immediate cloak check to prevent flash
                try {
                    const STORAGE_KEY = 'phantom_fv';
                    const hasBypassed = localStorage.getItem(STORAGE_KEY);
                    const urlParams = new URLSearchParams(window.location.search);
                    const isFakeMode = urlParams.has('fake');

                    if (window.SITE_CONFIG.firstVisitCloak && !hasBypassed && !isFakeMode) {
                        const overlay = document.getElementById('fv-cloak');
                        if (overlay) overlay.style.display = 'block';
                        document.title = origin;

                        // Remove favicon for fake error page
                        document.querySelectorAll("link[rel*='icon']").forEach(l => l.remove());
                        const link = document.createElement('link');
                        link.rel = 'icon';
                        link.href = 'data:,';
                        document.head.appendChild(link);

                        // Hide loading screen immediately if possible
                        const style = document.createElement('style');
                        style.innerHTML = '#loading-screen { display: none !important; }';
                        document.head.appendChild(style);

                        // Set up bypass on reload button
                        document.getElementById('reload-button').onclick = function () {
                            localStorage.setItem(STORAGE_KEY, 'true');
                            overlay.style.display = 'none';
                            document.getElementById('main-frame').src = 'index2.html';
                            document.title = 'Phantom Unblocked'; // Reset title

                            // Restore favicon
                            document.querySelectorAll("link[rel*='icon']").forEach(l => l.remove());
                            const link = document.createElement('link');
                            link.rel = 'icon';
                            link.href = 'favicon.svg';
                            document.head.appendChild(link);
                        };
                    } else {
                        // If no cloak, load main content immediately
                        document.getElementById('main-frame').src = 'index2.html';
                    }
                } catch (e) { }
            }
        </script>
    </div>

    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-logo">
            <i class="fa-solid fa-ghost"></i>
            <span>Phantom</span>
        </div>
        <div class="loading-spinner"></div>
        <div class="loading-text">Loading...</div>
    </div>

    <!-- Launch Screen -->
    <div id="launch-screen" class="launch-screen hidden">
        <div class="loading-logo">
            <i class="fa-solid fa-ghost"></i>
            <span>Phantom</span>
        </div>
        <button id="launch-button" class="launch-button"> Launch Phantom</button>
    </div>

    <!-- Panic White Screen Overlay -->
    <div id="panic-overlay"></div>

    <iframe id="main-frame"></iframe>

    <script>
// rotation
(function () {
    'use strict';

    const checkRotation = () => {
        if (!window.Settings) return;
        const settings = window.Settings.getAll();
        const now = Date.now();
        const TWO_DAYS = 172800000;

        // theme
        if (settings.themeRotation) {
            const lastRotation = settings.lastThemeRotation || 0;
            if (now - lastRotation >= TWO_DAYS) {
                const presets = window.SITE_CONFIG?.themePresets || {};
                const keys = Object.keys(presets);
                if (keys.length > 0) {
                    let randomKey;
                    if (lastRotation === 0) {
                        const allowed = ['dark', 'midnight'].filter(k => keys.includes(k));
                        randomKey = allowed.length > 0 ? allowed[Math.floor(Math.random() * allowed.length)] : keys[0];
                    } else if (keys.length > 1) {
                        let attempts = 0;
                        do {
                            randomKey = keys[Math.floor(Math.random() * keys.length)];
                            attempts++;
                        } while (presets[randomKey].surface === settings.surfaceColor && attempts < 5);
                    } else {
                        randomKey = keys[0];
                    }

                    if (randomKey) {
                        const theme = presets[randomKey];
                        window.Settings.update({
                            background: theme.bg,
                            surfaceColor: theme.surface,
                            surfaceHoverColor: theme.surfaceHover,
                            surfaceActiveColor: theme.surfaceActive,
                            secondaryColor: theme.secondary,
                            borderColor: theme.border,
                            borderLightColor: theme.borderLight,
                            textColor: theme.text,
                            textSecondaryColor: theme.textSec,
                            textDimColor: theme.textDim,
                            accentColor: theme.accent,
                            lastThemeRotation: now
                        });
                    }
                }
            }
        }

        // bg
        if (settings.backgroundRotation) {
            const lastRotation = settings.lastBackgroundRotation || 0;
            if (now - lastRotation >= TWO_DAYS) {
                const presets = (window.SITE_CONFIG?.backgroundPresets || []).filter(p => p.id !== 'none' && p.id !== 'custom');
                if (presets.length > 0) {
                    let randomPreset;
                    if (presets.length > 1) {
                        let attempts = 0;
                        const currentId = settings.customBackground?.id;
                        do {
                            randomPreset = presets[Math.floor(Math.random() * presets.length)];
                            attempts++;
                        } while (randomPreset.id === currentId && attempts < 5);
                    } else {
                        randomPreset = presets[0];
                    }
                    if (randomPreset) {
                        window.Settings.update({
                            customBackground: randomPreset,
                            lastBackgroundRotation: now
                        });
                    }
                }
            }
        }
    };

    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', checkRotation);
    } else {
        checkRotation();
    }
})();

</script>

    <script>
        const loadingScreen = document.getElementById('loading-screen');
        const iframe = document.getElementById('main-frame');
        let loadStartTime = Date.now();
        let fallbackTimer = setTimeout(hideLoading, 3500);

        function showLoading() {
            loadingScreen.classList.remove('hidden');
            if (window.Quotes) window.Quotes.init(true);
            loadStartTime = Date.now();

            clearTimeout(fallbackTimer);
            fallbackTimer = setTimeout(hideLoading, 3500);
        }

        function hideLoading() {
            clearTimeout(fallbackTimer);

            // Min time 0.5s (500ms)
            const minTime = 500;
            const elapsed = Date.now() - loadStartTime;
            const remaining = Math.max(0, minTime - elapsed);

            setTimeout(() => {
                loadingScreen.classList.add('hidden');
            }, remaining);

            // Re-attach listener to the new window for next navigation
            try {
                if (iframe.contentWindow) {
                    iframe.contentWindow.removeEventListener('unload', showLoading);
                    iframe.contentWindow.addEventListener('unload', () => {
                        requestAnimationFrame(showLoading);
                    });
                }
            } catch (e) { }
        }

        // Listen for iframe load events
        iframe.addEventListener('load', hideLoading);

        // Expose to children if needed
        window.showLoading = showLoading;
        window.hideLoading = hideLoading;

        console.log('press c to enter');
    </script>
</body>

</html>